!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=15)}([function(t,e,r){"use strict";var n=r(7),i=Object.prototype.toString;function o(t){return Array.isArray(t)}function a(t){return void 0===t}function s(t){return"[object ArrayBuffer]"===i.call(t)}function u(t){return null!==t&&"object"==typeof t}function l(t){if("[object Object]"!==i.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function c(t){return"[object Function]"===i.call(t)}function h(t,e){if(null!==t&&void 0!==t)if("object"!=typeof t&&(t=[t]),o(t))for(var r=0,n=t.length;r<n;r++)e.call(null,t[r],r,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}t.exports={isArray:o,isArrayBuffer:s,isBuffer:function(t){return null!==t&&!a(t)&&null!==t.constructor&&!a(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"[object FormData]"===i.call(t)},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&s(t.buffer)},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:u,isPlainObject:l,isUndefined:a,isDate:function(t){return"[object Date]"===i.call(t)},isFile:function(t){return"[object File]"===i.call(t)},isBlob:function(t){return"[object Blob]"===i.call(t)},isFunction:c,isStream:function(t){return u(t)&&c(t.pipe)},isURLSearchParams:function(t){return"[object URLSearchParams]"===i.call(t)},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:h,merge:function t(){var e={};function r(r,n){l(e[n])&&l(r)?e[n]=t(e[n],r):l(r)?e[n]=t({},r):o(r)?e[n]=r.slice():e[n]=r}for(var n=0,i=arguments.length;n<i;n++)h(arguments[n],r);return e},extend:function(t,e,r){return h(e,function(e,i){t[i]=r&&"function"==typeof e?n(e,r):e}),t},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}}},function(t,e,r){"use strict";(function(e){var n=r(0),i=r(34),o=r(9),a={"Content-Type":"application/x-www-form-urlencoded"};function s(t,e){!n.isUndefined(t)&&n.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var u,l={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:("undefined"!=typeof XMLHttpRequest?u=r(10):void 0!==e&&"[object process]"===Object.prototype.toString.call(e)&&(u=r(10)),u),transformRequest:[function(t,e){return i(e,"Accept"),i(e,"Content-Type"),n.isFormData(t)||n.isArrayBuffer(t)||n.isBuffer(t)||n.isStream(t)||n.isFile(t)||n.isBlob(t)?t:n.isArrayBufferView(t)?t.buffer:n.isURLSearchParams(t)?(s(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):n.isObject(t)||e&&"application/json"===e["Content-Type"]?(s(e,"application/json"),function(t,e,r){if(n.isString(t))try{return(e||JSON.parse)(t),n.trim(t)}catch(t){if("SyntaxError"!==t.name)throw t}return(r||JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){var e=this.transitional||l.transitional,r=e&&e.silentJSONParsing,i=e&&e.forcedJSONParsing,a=!r&&"json"===this.responseType;if(a||i&&n.isString(t)&&t.length)try{return JSON.parse(t)}catch(t){if(a){if("SyntaxError"===t.name)throw o(t,this,"E_JSON_PARSE");throw t}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],function(t){l.headers[t]={}}),n.forEach(["post","put","patch"],function(t){l.headers[t]=n.merge(a)}),t.exports=l}).call(e,r(33))},function(t,e,r){"use strict";function n(t){this.message=t}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n},function(t,e){t.exports=function(t,e,r,n,i,o){var a,s=t=t||{},u=typeof t.default;"object"!==u&&"function"!==u||(a=t,s=t.default);var l,c="function"==typeof s?s.options:s;if(e&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0),r&&(c.functional=!0),i&&(c._scopeId=i),o?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},c._ssrRegister=l):n&&(l=n),l){var h=c.functional,f=h?c.render:c.beforeCreate;h?(c._injectStyles=l,c.render=function(t,e){return l.call(e),f(t,e)}):c.beforeCreate=f?[].concat(f,l):[l]}return{esModule:a,exports:s,options:c}}},function(module,__webpack_exports__,__webpack_require__){"use strict";(function(global,module){(function(){var n,aa=[];function ba(t){return function(){return aa[t].apply(this,arguments)}}function ca(t,e){return aa[t]=e}function da(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function ea(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:da(t)}}var fa="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,r){t!=Array.prototype&&t!=Object.prototype&&(t[e]=r.value)},ha="undefined"!=typeof window&&window===this?this:void 0!==global&&null!=global?global:this;function ja(t,e){if(e){var r=ha;t=t.split(".");for(var n=0;n<t.length-1;n++){var i=t[n];i in r||(r[i]={}),r=r[i]}(e=e(n=r[t=t[t.length-1]]))!=n&&null!=e&&fa(r,t,{configurable:!0,writable:!0,value:e})}}function ka(){ka=function(){},ha.Symbol||(ha.Symbol=la)}function ma(t,e){this.a=t,fa(this,"description",{configurable:!0,writable:!0,value:e})}ja("Array.prototype.find",function(t){return t||function(t,e){t:{var r=this;r instanceof String&&(r=String(r));for(var n=r.length,i=0;i<n;i++){var o=r[i];if(t.call(e,o,i,r)){t=o;break t}}t=void 0}return t}}),ma.prototype.toString=function(){return this.a};var la=function(){var t=0;return function e(r){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new ma("jscomp_symbol_"+(r||"")+"_"+t++,r)}}(),qa;function na(){ka();var t=ha.Symbol.iterator;t||(t=ha.Symbol.iterator=ha.Symbol("Symbol.iterator")),"function"!=typeof Array.prototype[t]&&fa(Array.prototype,t,{configurable:!0,writable:!0,value:function(){return oa(da(this))}}),na=function(){}}function oa(t){return na(),(t={next:t})[ha.Symbol.iterator]=function(){return this},t}function pa(t,e){na(),t instanceof String&&(t+="");var r=0,n={next:function(){if(r<t.length){var i=r++;return{value:e(i,t[i]),done:!1}}return n.next=function(){return{done:!0,value:void 0}},n.next()}};return n[Symbol.iterator]=function(){return n},n}if(ja("Array.prototype.keys",function(t){return t||function(){return pa(this,function(t){return t})}}),"function"==typeof Object.setPrototypeOf)qa=Object.setPrototypeOf;else{var ra;t:{var sa={Ug:!0},ta={};try{ta.__proto__=sa,ra=ta.Ug;break t}catch(a){}ra=!1}qa=ra?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null}var ua=qa;ja("Object.setPrototypeOf",function(t){return t||ua}),ja("Promise",function(t){function e(t){this.A=0,this.b=void 0,this.a=[];var e=this.c();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function r(){this.a=null}function n(t){return t instanceof e?t:new e(function(e){e(t)})}if(t)return t;r.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c(function(){e.g()})}this.a.push(t)};var i=ha.setTimeout;r.prototype.c=function(t){i(t,0)},r.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var r=t[e];t[e]=null;try{r()}catch(t){this.f(t)}}}this.a=null},r.prototype.f=function(t){this.c(function(){throw t})},e.prototype.c=function(){function t(t){return function(n){r||(r=!0,t.call(e,n))}}var e=this,r=!1;return{resolve:t(this.o),reject:t(this.f)}},e.prototype.o=function(t){if(t===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.aa(t);else{t:switch(typeof t){case"object":var r=null!=t;break t;case"function":r=!0;break t;default:r=!1}r?this.m(t):this.g(t)}},e.prototype.m=function(t){var e=void 0;try{e=t.then}catch(t){return void this.f(t)}"function"==typeof e?this.s(e,t):this.g(t)},e.prototype.f=function(t){this.i(2,t)},e.prototype.g=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.A)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.A);this.A=t,this.b=e,this.j()},e.prototype.j=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)o.b(this.a[t]);this.a=null}};var o=new r;return e.prototype.aa=function(t){var e=this.c();t.Kf(e.resolve,e.reject)},e.prototype.s=function(t,e){var r=this.c();try{t.call(e,r.resolve,r.reject)}catch(t){r.reject(t)}},e.prototype.then=function(t,r){function n(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(t){o(t)}}:e}var i,o,a=new e(function(t,e){i=t,o=e});return this.Kf(n(t,i),n(r,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Kf=function(t,e){function r(){switch(n.A){case 1:t(n.b);break;case 2:e(n.b);break;default:throw Error("Unexpected state: "+n.A)}}var n=this;null==this.a?o.b(r):this.a.push(r)},e.resolve=n,e.reject=function(t){return new e(function(e,r){r(t)})},e.race=function(t){return new e(function(e,r){for(var i=ea(t),o=i.next();!o.done;o=i.next())n(o.value).Kf(e,r)})},e.all=function(t){var r=ea(t),i=r.next();return i.done?n([]):new e(function(t,e){function o(e){return function(r){a[e]=r,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,n(i.value).Kf(o(a.length-1),e),i=r.next()}while(!i.done)})},e}),ja("Object.entries",function(t){return t||function(t){var e,r=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&r.push([e,t[e]]);return r}}),ja("Array.prototype.fill",function(t){return t||function(t,e,r){var n=this.length||0;for(0>e&&(e=Math.max(0,n+e)),(null==r||r>n)&&(r=n),0>(r=Number(r))&&(r=Math.max(0,n+r)),e=Number(e||0);e<r;e++)this[e]=t;return this}});var va="function"==typeof Object.assign?Object.assign:function(t,e){for(var r=1;r<arguments.length;r++){var n=arguments[r];if(n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};ja("Object.assign",function(t){return t||va}),ja("Math.log2",function(t){return t||function(t){return Math.log(t)/Math.LN2}});var wa=this||self;function ya(t,e,r){t=t.split("."),r=r||wa,t[0]in r||void 0===r.execScript||r.execScript("var "+t[0]);for(var n;t.length&&(n=t.shift());)t.length||void 0===e?r=r[n]&&r[n]!==Object.prototype[n]?r[n]:r[n]={}:r[n]=e}function za(){}function Aa(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var r=Object.prototype.toString.call(t);if("[object Window]"==r)return"object";if("[object Array]"==r||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==r||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function Ba(t){var e=Aa(t);return"array"==e||"object"==e&&"number"==typeof t.length}function Ca(t){return"function"==Aa(t)}function Da(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Ea="closure_uid_"+(1e9*Math.random()>>>0),Fa=0;function Ga(t,e,r){return t.call.apply(t.bind,arguments)}function Ha(t,e,r){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),t.apply(e,r)}}return function(){return t.apply(e,arguments)}}function Ia(t,e,r){return(Ia=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ga:Ha).apply(null,arguments)}function Ja(t,e){var r=Array.prototype.slice.call(arguments,1);return function(){var e=r.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function t(t,e){ya(t,e,void 0)}function u(t,e){function r(){}r.prototype=e.prototype,t.l=e.prototype,t.prototype=new r,t.prototype.constructor=t,t.yp=function(t,r,n){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[r].apply(t,i)}}function Ka(t){if(Error.captureStackTrace)Error.captureStackTrace(this,Ka);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function La(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Ma(){this.b=this.a=null}u(Ka,Error),Ka.prototype.name="CustomError",La.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t},La.prototype.put=function(t){this.f(t),100>this.b&&(this.b++,t.next=this.a,this.a=t)};var Oa=new La(function(){return new Na},function(t){t.reset()});function Na(){this.next=this.b=this.a=null}Ma.prototype.add=function(t,e){var r=Oa.get();r.set(t,e),this.b?this.b.next=r:this.a=r,this.b=r},Ma.prototype.remove=function(){var t=null;return this.a&&(t=this.a,this.a=this.a.next,this.a||(this.b=null),t.next=null),t},Na.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Na.prototype.reset=function(){this.next=this.b=this.a=null};var Pa=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Qa(t,e){return-1!=t.indexOf(e)}function Ra(t,e){return t<e?-1:t>e?1:0}function Sa(t,e){for(var r in t)if(e.call(void 0,t[r],r,t))return!0;return!1}function Ta(t){for(var e in t)return!1;return!0}function Ua(t){var e,r={};for(e in t)r[e]=t[e];return r}var Va="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Xa;function Wa(t,e){for(var r,n,i=1;i<arguments.length;i++){for(r in n=arguments[i])t[r]=n[r];for(var o=0;o<Va.length;o++)r=Va[o],Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}}t:{var Ya=wa.navigator;if(Ya){var Za=Ya.userAgent;if(Za){Xa=Za;break t}}Xa=""}function $a(t){return Qa(Xa,t)}var ab=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var r=0;r<t.length;r++)if(r in t&&t[r]===e)return r;return-1};function bb(t,e){this.b=t===cb&&e||"",this.a=db}var db={},cb={},eb=new bb(cb,"");function fb(t,e){this.b=t===gb&&e||"",this.a=hb}fb.prototype.zc=function(){return 1};var hb={},gb={};function ib(){this.b="",this.c=jb,this.a=null}function kb(){var t=lb;return t instanceof ib&&t.constructor===ib&&t.c===jb?t.b:(Aa(t),"type_error:SafeHtml")}ib.prototype.zc=function(){return this.a};var jb={};function mb(t){var e=new ib;return e.b=t,e.a=0,e}mb("<!DOCTYPE html>");var lb=mb("");function nb(t){var e=new fb(gb,eb instanceof bb&&eb.constructor===bb&&eb.a===db?eb.b:"type_error:Const");e instanceof fb&&e.constructor===fb&&e.a===hb?e=e.b:(Aa(e),e="type_error:TrustedResourceUrl"),t.src=e.toString()}function ob(t){return ob[" "](t),t}function pb(t,e){var r=qb;return Object.prototype.hasOwnProperty.call(r,t)?r[t]:r[t]=e(t)}mb("<br>"),ob[" "]=za;var rb=$a("Opera"),sb=$a("Trident")||$a("MSIE"),tb=$a("Edge"),ub=$a("Gecko")&&!(Qa(Xa.toLowerCase(),"webkit")&&!$a("Edge"))&&!($a("Trident")||$a("MSIE"))&&!$a("Edge"),vb=Qa(Xa.toLowerCase(),"webkit")&&!$a("Edge"),yb,a;function xb(){var t=wa.document;return t?t.documentMode:void 0}t:{var zb="",Ab=(a=Xa,ub?/rv:([^\);]+)(\)|;)/.exec(a):tb?/Edge\/([\d\.]+)/.exec(a):sb?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a):vb?/WebKit\/(\S+)/.exec(a):rb?/(?:Version)[ \/]?(\S+)/.exec(a):void 0);if(Ab&&(zb=Ab?Ab[1]:""),sb){var Bb=xb();if(null!=Bb&&Bb>parseFloat(zb)){yb=String(Bb);break t}}yb=zb}var qb={},Db,Gb,Jb;function Cb(t){return pb(t,function(){for(var e=0,r=Pa(String(yb)).split("."),n=Pa(String(t)).split("."),i=Math.max(r.length,n.length),o=0;0==e&&o<i;o++){var a=r[o]||"",s=n[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=Ra(e=0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||Ra(0==a[2].length,0==s[2].length)||Ra(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}function Eb(t){var e=document;return t=String(t),"application/xhtml+xml"===e.contentType&&(t=t.toLowerCase()),e.createElement(t)}function Fb(t){wa.setTimeout(function(){throw t},0)}function Hb(){var t=wa.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!$a("Presto")&&(t=function(){var t=Eb("IFRAME");t.style.display="none",nb(t),document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(kb()),t.close();var r="callImmediate"+Math.random(),n="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=Ia(function(t){"*"!=n&&t.origin!=n||t.data!=r||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(r,n)}}}),void 0!==t&&!$a("Trident")&&!$a("MSIE")){var e=new t,r={},n=r;return e.port1.onmessage=function(){if(void 0!==r.next){var t=(r=r.next).wj;r.wj=null,t()}},function(t){n.next={wj:t},n=n.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in Eb("SCRIPT")?function(t){var e=Eb("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){wa.setTimeout(t,0)}}function Ib(t,e){Jb||Kb(),Lb||(Jb(),Lb=!0),Mb.add(t,e)}function Kb(){if(wa.Promise&&wa.Promise.resolve){var t=wa.Promise.resolve(void 0);Jb=function(){t.then(Nb)}}else Jb=function(){var t=Nb;!Ca(wa.setImmediate)||wa.Window&&wa.Window.prototype&&!$a("Edge")&&wa.Window.prototype.setImmediate==wa.setImmediate?(Gb||(Gb=Hb()),Gb(t)):wa.setImmediate(t)}}Db=wa.document&&sb?xb():void 0,!ub&&!sb||sb&&9<=Number(Db)||ub&&Cb("1.9.1"),sb&&Cb("9");var Lb=!1,Mb=new Ma;function Nb(){for(var t;t=Mb.remove();){try{t.a.call(t.b)}catch(t){Fb(t)}Oa.put(t)}Lb=!1}function Ob(t){if(this.A=Pb,this.i=void 0,this.c=this.a=this.b=null,this.f=this.g=!1,t!=za)try{var e=this;t.call(void 0,function(t){Qb(e,Rb,t)},function(t){Qb(e,Sb,t)})}catch(t){Qb(this,Sb,t)}}var Pb=0,Rb=2,Sb=3;function Tb(){this.next=this.c=this.b=this.f=this.a=null,this.g=!1}Tb.prototype.reset=function(){this.c=this.b=this.f=this.a=null,this.g=!1};var Ub=new La(function(){return new Tb},function(t){t.reset()});function Vb(t,e,r){var n=Ub.get();return n.f=t,n.b=e,n.c=r,n}function Wb(t){if(t instanceof Ob)return t;var e=new Ob(za);return Qb(e,Rb,t),e}function Yb(t){return new Ob(function(e,r){r(t)})}function Zb(){var t,e;return new $b(new Ob(function(r,n){t=r,e=n}),t,e)}function cc(t,e){if(t.A==Pb)if(t.b){var r=t.b;if(r.a){for(var n=0,i=null,o=null,a=r.a;a&&(a.g||(n++,a.a==t&&(i=a),!(i&&1<n)));a=a.next)i||(o=a);i&&(r.A==Pb&&1==n?cc(r,e):(o?((n=o).next==r.c&&(r.c=n),n.next=n.next.next):dc(r),ec(r,i,Sb,e)))}t.b=null}else Qb(t,Sb,e)}function fc(t,e){t.a||t.A!=Rb&&t.A!=Sb||hc(t),t.c?t.c.next=e:t.a=e,t.c=e}function ac(t,e,r,n){var i=Vb(null,null,null);return i.a=new Ob(function(t,o){i.f=e?function(r){try{var i=e.call(n,r);t(i)}catch(t){o(t)}}:t,i.b=r?function(e){try{var i=r.call(n,e);void 0===i&&e instanceof bc?o(e):t(i)}catch(t){o(t)}}:o}),i.a.b=t,fc(t,i),i.a}function Qb(t,e,r){if(t.A==Pb){t===r&&(e=Sb,r=new TypeError("Promise cannot resolve to itself")),t.A=1;t:{var n=r,i=t.m,o=t.o;if(n instanceof Ob){fc(n,Vb(i||za,o||null,t));var a=!0}else{if(n)try{var s=!!n.$goog_Thenable}catch(t){s=!1}else s=!1;if(s)n.then(i,o,t),a=!0;else{if(Da(n))try{var u=n.then;if(Ca(u)){ic(n,u,i,o,t),a=!0;break t}}catch(e){o.call(t,e),a=!0;break t}a=!1}}}a||(t.i=r,t.A=e,t.b=null,hc(t),e!=Sb||r instanceof bc||jc(t,r))}}function ic(t,e,r,n,i){function o(t){a||(a=!0,n.call(i,t))}var a=!1;try{e.call(t,function(t){a||(a=!0,r.call(i,t))},o)}catch(t){o(t)}}function hc(t){t.g||(t.g=!0,Ib(t.j,t))}function dc(t){var e=null;return t.a&&(e=t.a,t.a=e.next,e.next=null),t.a||(t.c=null),e}function ec(t,e,r,n){if(r==Sb&&e.b&&!e.g)for(;t&&t.f;t=t.b)t.f=!1;if(e.a)e.a.b=null,kc(e,r,n);else try{e.g?e.f.call(e.c):kc(e,r,n)}catch(t){lc.call(null,t)}Ub.put(e)}function kc(t,e,r){e==Rb?t.f.call(t.c,r):t.b&&t.b.call(t.c,r)}function jc(t,e){t.f=!0,Ib(function(){t.f&&lc.call(null,e)})}Ob.prototype.then=function(t,e,r){return ac(this,Ca(t)?t:null,Ca(e)?e:null,r)},Ob.prototype.$goog_Thenable=!0,Ob.prototype.cancel=function(t){if(this.A==Pb){var e=new bc(t);Ib(function(){cc(this,e)},this)}},Ob.prototype.m=function(t){this.A=Pb,Qb(this,Rb,t)},Ob.prototype.o=function(t){this.A=Pb,Qb(this,Sb,t)},Ob.prototype.j=function(){for(var t;t=dc(this);)ec(this,t,this.A,this.i);this.g=!1};var lc=Fb;function bc(t){Ka.call(this,t)}function $b(t,e,r){this.dl=t,this.resolve=e,this.reject=r}u(bc,Ka),bc.prototype.name="cancel";var x=this;function mc(){return Object.create(y,void 0)}var A=Ia,nc=String,oc=x.Object.freeze||function(t){return t};function pc(t){for(var e,r=Object.keys(t),n=r.length;n--;)Da(e=t[r[n]])&&pc(e);return oc(t)}function qc(t){var e=Aa(t);if("object"==e||"array"==e){if(Ca(t.clone))return t.clone();for(var r in e="array"==e?[]:{},t)t.hasOwnProperty(r)&&(e[r]=qc(t[r]));return e}return t}var B=[].pop(),y=/x/.exec("");function rc(t,e){return nc(t).split(e!==B?e:" ")}var sc="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(t,e,r,n,i){if(!(e=t instanceof e)&&r)throw new D(r,n,tc(i)?i:t);return e}function uc(t,e){if(!0===(C(t,e)&&t.constructor===e))throw new TypeError("Illegal constructor "+vc(e))}function wc(t,e,r,n,i){if(!(e=xc(t)===e)&&r)throw new D(r,n,tc(i)?i:t);return e}function yc(t,e,r,n){return wc(t,"Array",e,r,n)}function tc(t){return t!==B}function zc(t){return"string"==typeof t}t("H.lang.isArray",yc),t("H.lang.isString",zc);var Ac=parseInt,Bc=parseFloat,E=isNaN;function Cc(t){return t===+t}function Dc(t){return!E(+t)}function xc(t){var e=Object[sc[0]][sc[6]].call(t).match(/^\[object (\w+)\]$/);return e?e[1]:typeof t}t("H.lang.isNumber",Cc),t("H.lang.isInteger",Number.isInteger?Number.isInteger:function(t){return"number"==typeof t&&0==t%1});var Ec=[];function Fc(t){0>Ec.indexOf(t)&&Ec.push(t)}function vc(t,e,r,n){var i,o="",a=2>arguments.length;return a&&(e={H:x.H},r="",n=Ec.slice()),Gc(e,!0,function(e,a){try{if(a=Hc(e,i=e[a]),!(Da(i)&&i.window===i&&i.self===i||Da(i)&&0<i.nodeType&&Ca(i.cloneNode))&&Da(i)){if(i===t)return o=r+"."+a,!0;if(0>n.indexOf(i)&&(n.push(i),o=vc(t,i,r+"."+a,n)))return!0}}catch(t){}}),a&&(o=o?o.substr(1).replace("."+sc[0]+".","#"):"~"+(Ca(t)?Ic(t)+"()":xc(t))),o}function Hc(t,e){var r=[];return Gc(t,!1,function(t,n){t[n]===e&&r.push(n)}),r.sort(Jc)[0]}function Jc(t,e){return e.length-t.length}Fc(Ec);var Kc=Object[sc[0]][sc[2]];function Gc(t,e,r){var n;if(t){for(i in t)if((!e||Kc.call(t,i))&&r(t,i,!0))return;for(n=sc.length;n--;){var i=sc[n];if((!e||Kc.call(t,i))&&r(t,i,!1))break}}}function Ic(t){return(t=/^\s*function ([^\( ]+)/.exec(t))?t[1]:"anonymous"}function Lc(t,e,r){r[e]="#"+e}var Mc=!!x.__karma__;function Nc(){throw Error("unimplemented method")}function Oc(t,e){"status"in(e=e||{})&&(this.status=+e.status),"statusText"in e&&(this.statusText=e.statusText),this.ok=200<=this.status&&300>this.status,this.bodyUsed=!1,t?"string"==typeof t?this.c=t:ArrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||t.buffer)?this.a=t.buffer||t:Blob.prototype.isPrototypeOf(t)&&(this.b=t):this.c=""}function Pc(t){if(t.bodyUsed)return Yb(new TypeError("Already read"));t.bodyUsed=!0}function Qc(t){var e=new FileReader;return e.readAsText(t),new Ob(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function Rc(t,e,r){var n,i,o,a,s,u=r&&r.headers||{},l={},c=this;if(!Ca(e))throw new D(Rc,1,"function required");Wa(u,Uc.headers,u),Wa(l,Uc,r||{}),l.headers=u,this.b=e,this.T=n=new XMLHttpRequest,e=l.method;try{for(i in n.open(e,t,!0),u)u.hasOwnProperty(i)&&(o=u[i])&&n.setRequestHeader(i,o);n.withCredentials=!!l.withCredentials,a=A(c.a,c),s=+l.timeout||0,Sc?(Tc(c,"timeout",a),n.timeout=s):s&&(c.c=setTimeout(function(){n.abort(),c.a({type:"timeout"})},s)),Tc(c,"error",a),Tc(c,"load",a),n.send(l.data)}catch(a){this.a({type:"cors"})}}t("H.net.Response",Oc),Oc.prototype.type="default",Oc.prototype.type=Oc.prototype.type,Oc.prototype.status=200,Oc.prototype.status=Oc.prototype.status,Oc.prototype.statusText="OK",Oc.prototype.statusText=Oc.prototype.statusText,Oc.error=function(){return Oc.a||(Oc.a=new Oc(null,{status:0,statusText:""}),Oc.a.type="error"),Oc.a},Oc.error=Oc.error,Oc.prototype.text=function(){var t=Pc(this);if(!t)if(this.c)t=Wb(this.c);else if(this.a){var e,r=(t=new Uint8Array(this.a)).length,n=Array(r);for(e=0;e<r;e++)n[e]=String.fromCharCode(t[e]);t=Wb(n.join(""))}else t=this.b?Qc(this.b):Yb("Unsupported response body");return t},Oc.prototype.json=function(){return this.text().then(x.JSON.parse)},Oc.prototype.blob=function(){var t,e=Pc(this);return e||(this.b?t=this.b:this.a&&(t=new Blob([this.a],{type:"application/octet-stream"}))),e||Wb(t)},Oc.prototype.arrayBuffer=function(){return this.a?Pc(this)||Wb(this.a.slice(0)):this.blob().then(Oc.b)},Oc.b=function(t){var e=new FileReader;return e.readAsArrayBuffer(t),new Ob(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})},!Mc&&x.Response&&x.Response.error&&(Oc=x.Response,Fc(Oc.prototype)),t("H.net.Xhr",Rc);var Uc={method:"GET",headers:{},data:null},Vc="withCredentials"in new XMLHttpRequest,Sc="timeout"in new XMLHttpRequest,Yc,Zc,$c,bd,dd;function Tc(t,e,r){Vc?t.T.addEventListener(e,r):t.T["on"+e]=r}function Wc(t,e,r){Vc?t.T.removeEventListener(e,r):t.T["on"+e]=null}function Xc(t,e){var r=[];return t&&r.push(vc(t)),1<arguments.length&&r.push(""+e),r=Error(r.join(" ")),Object.setPrototypeOf(r,Xc.prototype),r}function D(t,e,r){var n=arguments.length;if((e=e!==B?+e:e)!==B){var i=(i=/^.*?\(([^\)]+)/.exec((""+t).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")))?rc(i[1].replace(/\s+/g,""),","):[];i.forEach(Lc),i=i[e]||"#"+e}var o=t?vc(t):"";return n=2<n?nc(r):"",(i||n)&&(o+=" (Argument "+(i||"")+(n?" "+n:"")+")"),n=Error(o),Object.setPrototypeOf(n,D.prototype),n}function ad(){if(!zc("STATIC_DB"))throw new D(this.constructor,0);if(this.g=x.indexedDB||x.qp||x.Go||x.Ho,!this.g)throw new Xc(this.constructor,"This browser does not support IndexedDB");this.a=[],this.c=[],this.ri=A(this.ri,this)}function id(t,e,r){if(t.b)t.a?(t.a.push(e),r&&t.c.push(r)):t.f?r&&r(t.f):e(t.b.result);else{t.b=t.g.open(jd+"STATIC_DB",1),t.b.onupgradeneeded=t.ri;var n=t.b.onerror=function(){clearTimeout(t.i),t.f=this.error,t.c.forEach(function(e){e(t.f)}),t.a=t.c=null};t.i=setTimeout(function(){n.call({error:Error("DbOpenTimeoutError")})},500),t.b.onsuccess=function(){clearTimeout(t.i),t.a?(t.a.forEach(function(t){t(this.result)},this),t.a=t.c=null):(t.b=t.f=null,t.a=[],t.c=[])},t.a.push(e),r&&t.c.push(r)}}function fd(t,e,r){id(t,function(t){t=t.transaction(["data"],"readwrite"),e(t.objectStore("data"))},r)}function gd(t,e,r){e&&(t.onsuccess=function(){e(this.result)}),r&&(t.onerror=function(){r(this.error)})}function ed(t){var e=Object.prototype.toString.call(t);return"[object Blob]"===e||"[object ArrayBuffer]"===e||zc(t)||Da(t)}function kd(){return bd||(bd=new ad),bd}Rc.prototype.abort=function(){this.T&&(this.T.abort(),this.T&&this.a({type:"abort"}))},Rc.prototype.abort=Rc.prototype.abort,Rc.prototype.a=function(t){var e,r,n=t.type;t=this.T,this.c&&clearTimeout(this.c),"load"===n?t instanceof XMLHttpRequest&&200!==t.status&&(e="network"):e=4===t.readyState&&0===t.status&&"error"==n?"cors":"error"!=n?n:"network",Wc(this,"timeout",n=this.a),Wc(this,"error",n),Wc(this,"load",n),r=0===t.status||e&&"network"!==e?Oc.error():new Oc(t.responseText||null,t),e=this.b,delete this.a,delete this.b,delete this.T,e(r)},u(Xc,Error),t("H.lang.IllegalOperationError",Xc),Xc.prototype.name="IllegalOperationError",u(D,Error),t("H.lang.InvalidArgumentError",D),D.prototype.name="InvalidArgumentError",n=ad.prototype,n.put=function(t,e,r,n){if(!zc(t)&&!Cc(t))throw new D(this.put,0);if(!ed(e))throw new D(this.put,1);fd(this,function(i){gd(i.put(e,t),r,n)},n)},n.get=function(t,e,r){var n;if(!zc(t)&&!Cc(t))throw new D(this.get,0);if(!Ca(e))throw new D(this.get,1);return fd(this,function(i){gd(n=i.get(t),e,r)},r),{cancel:function(){n&&(n.onsuccess=hd)}}},n.remove=function(t,e,r){if(!zc(t)&&!Cc(t))throw new D(this.remove,0);fd(this,function(n){gd(n.delete(t),e,r)},r)},n.clear=function(t,e){fd(this,function(r){gd(r.clear(),t,e)},e)},n.ri=function(){var t=this.b.result;t.objectStoreNames.contains("data")||t.createObjectStore("data")},t("H.util.IndexedDBStorage.getInstance",kd);var jd="H_";function ld(){var t="";if(!tc(dd))if("file:"===window.location.protocol&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&128<=window.location.href.length)dd=!1;else{try{var e=x.indexedDB||x.qp||x.Go||x.Ho;t=jd+"TEST_DB";var r=e&&e.open(t,1)}catch(t){}dd=!!r&&null===r.onupgradeneeded,r&&e.deleteDatabase&&e.deleteDatabase(t)}return dd}function nd(){0!=od&&(pd[this[Ea]||(this[Ea]=++Fa)]=this),this.Nd=this.Nd,this.sb=this.sb}t("H.util.IndexedDBStorage.isSupported",ld);var od=0,pd={};function qd(t){t&&"function"==typeof t.B&&t.B()}function rd(t,e){this.type=t,this.currentTarget=this.target=e,this.f=this.a=!1,this.nl=!0}function sd(t,e,r){sd.l.constructor.call(this,t,r),this.data=e}function td(t,e,r){td.l.constructor.call(this,t,r),this.message=e}nd.prototype.Nd=!1,nd.prototype.B=function(){if(!this.Nd&&(this.Nd=!0,this.u(),0!=od)){var t=this[Ea]||(this[Ea]=++Fa);if(0!=od&&this.sb&&0<this.sb.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete pd[t]}},nd.prototype.zb=function(t,e){this.Nd?void 0!==e?t.call(e):t():(this.sb||(this.sb=[]),this.sb.push(void 0!==e?Ia(t,e):t))},nd.prototype.u=function(){if(this.sb)for(;this.sb.length;)this.sb.shift()()},rd.prototype.stopPropagation=function(){this.a=!0},rd.prototype.preventDefault=function(){this.f=!0,this.nl=!1},t("H.util.Event",rd),rd.prototype.stopPropagation=rd.prototype.stopPropagation,rd.prototype.stopPropagation=rd.prototype.stopPropagation,rd.prototype.CAPTURING_PHASE=1,rd.prototype.CAPTURING_PHASE=rd.prototype.CAPTURING_PHASE,rd.prototype.AT_TARGET=2,rd.prototype.AT_TARGET=rd.prototype.AT_TARGET,rd.prototype.BUBBLING_PHASE=3,rd.prototype.BUBBLING_PHASE=rd.prototype.BUBBLING_PHASE,rd.prototype.eventPhase=0,rd.prototype.eventPhase=rd.prototype.eventPhase,u(sd,rd),t("H.util.DataEvent",sd),u(td,rd),t("H.util.ErrorEvent",td);var ud=Math,vd=ud.min,wd=ud.max,xd=ud.round,yd=ud.floor,zd=ud.ceil,Ad=ud.abs,Bd=ud.log,Cd=ud.sqrt,Dd=ud.pow,Ed=ud.exp,Fd=ud.sin,Gd=ud.asin,Hd=ud.cos,Id=ud.tan,Jd=ud.atan,Kd=ud.atan2,Ld=ud.LN2,Md=ud.PI,Nd=Md/2,Od=Md/4,Pd=2*Md,Qd=3*Md,Rd=Md/180,Sd=180/Md,Td=1/0,Ud=Dd(-2,53),Vd=Vd||function(t){return Bd(t)/Ld};function Wd(t,e){var r;return 0>(r=t%e)==0>e?r:r+e}function Xd(t,e,r){return e-=r=r||0,(t-=r)-yd(t/e)*e+r}function Yd(t,e,r){return t>r?r:t<e?e:t}function Zd(t,e,r,n){return n||(n=0),e<r?t>=e-n&&t<=r+n:t>=r-n&&t<=e+n}function $d(t,e,r,n,i,o){return Cd(Dd((t-i)*(n-o)-(e-o)*(r-i),2)/(Dd(r-i,2)+Dd(n-o,2)))}t("H.math.normalize",Xd),t("H.math.clamp",Yd);var ae={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};function be(t,e,r,n,i,o){var a=r.length,s=a,u=r[0],l=0,c=0,h=0;n=n/2||0;var f=o||2;o=f*(i?0:1)+1;for(var p=f-2;1!=l&&s>o;){s-=p;var d=r[--s];f=r[--s];var v=r[s?s-p-1:(a+(s-p-1))%a],y=r[s?s-p-2:(a+(s-p-2))%a];f>=t-n&&f<=t+n&&d>=e-n&&d<=e+n||y>=t-n&&y<=t+n&&v>=e-n&&v<=e+n?l=1:l||f!==t?!l&&Zd(t,f,y,n)&&((f<t&&y>t||f>t&&y<t)&&(c+=(u=d+(t-f)/(y-f)*(v-d))>e,h+=u<e),l=Zd(e,d,v,n)&&$d(t,e,f,d,y,v)<=n?2:0):(y===t&&(d<e&&v>e||d>e&&v<e)||(u<=t&&y>t||u>=t&&y<t)&&(d>=e?++c:++h),l=Zd(e,d,v,n)&&$d(t,e,f,d,y,v)<=n?2:0),u=f}return!l&&i&&0!==h&&0!=c%2&&(l=3),l}function ce(t,e){return be(t.x,t.y,e,0,!0)!==ae.NONE}function de(t){for(var e=t.length,r=new Float64Array(2*e),n=e&&tc(t[0].x);e--;){var i=t[e],o=e<<1;r[o]=n?i.x:i[0],r[o+1]=n?i.y:i[1]}return r}function ee(t,e,r){this.type=t,this.data=e,this.f=Zb(),this.resolve=A(this.resolve,this),this.reject=A(this.reject,this),this.priority=fe,r!==B&&(this.priority=r),this.yh().add(this)}t("H.math.CoverType",ae),t("H.math.isPointInsidePolygon",ce),t("H.math.flatten",de);var fe=1,ge={up:0,xp:fe,tp:2};function he(t){var e;for(e in this.a={},ge)this.a[ge[e]]=[];this.vf=t,this.vf.addEventListener("allocatable",A(this.b,this))}n=ee.prototype,n.then=function(t,e,r){return this.f.dl.then(t,e,r)},n.resolve=function(t){this.pe=3,this.f.resolve(t)},n.reject=function(t){this.pe=5,this.f.reject(t)},n.pe=0,n.cancel=function(){3>this.pe&&(this.Ie(),this.yh().remove(this),this.pe=4)},t("H.util.JobManager",he);var ie=Object.keys(ge).map(function(t){return ge[t]}).sort().reverse();function je(t,e,r){var n=[],i=arguments.length;return t&&n.push(vc(t)),1<i&&(i=2<i&&yc(r)?" out of ["+r[0]+"..."+r[1]+"]":"",n.push("("+e+i+")")),n=Error(n.join(" ")),Object.setPrototypeOf(n,je.prototype),n}he.prototype.add=function(t){C(t,ee,this.add,0),this.a[t.priority].push(t),this.b()},he.prototype.contains=function(t){return-1<this.a[t.priority].indexOf(t)},he.prototype.remove=function(t){var e=t.priority,r=this.a[e].indexOf(t);return-1<r?(this.a[e].splice(r,1),!0):(t.ej&&this.vf.Tf(t.ej),!1)},he.prototype.b=function(){ie.forEach(function(t){this.a[t]=this.a[t].filter(function(t){var e;if((e=this.vf.Zg(t))===y)return!0;var r=A(this.vf.Tf,this.vf,e,t);t.ej=e,t.then(r,r),t.pe=t.Lj(e)?1:5},this)},this)},u(je,Error),t("H.lang.OutOfRangeError",je),je.prototype.name="OutOfRangeError";var ke="closure_listenable_"+(1e6*Math.random()|0);function le(t){return!(!t||!t[ke])}var me=0;function ne(t,e,r,n,i){this.listener=t,this.proxy=null,this.src=e,this.type=r,this.capture=!!n,this.gg=i,this.key=++me,this.se=this.Jf=!1}function oe(t){t.se=!0,t.listener=null,t.proxy=null,t.src=null,t.gg=null}function pe(t){this.src=t,this.a={},this.b=0}function re(t,e){var r=e.type;if(!(r in t.a))return!1;var n,i=t.a[r],o=ab(i,e);return(n=0<=o)&&Array.prototype.splice.call(i,o,1),n&&(oe(e),0==t.a[r].length&&(delete t.a[r],t.b--)),n}function se(t,e){var r=void 0!==e,n=r?e.toString():"";return Sa(t.a,function(t){for(var e=0;e<t.length;++e)if(!r||t[e].type==n)return!0;return!1})}function qe(t,e,r,n){for(var i=0;i<t.length;++i){var o=t[i];if(!o.se&&o.listener==e&&o.capture==!!r&&o.gg==n)return i}return-1}pe.prototype.add=function(t,e,r,n,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=qe(t,e,n,i);return-1<a?(e=t[a],r||(e.Jf=!1)):((e=new ne(e,this.src,o,!!n,i)).Jf=r,t.push(e)),e},pe.prototype.remove=function(t,e,r,n){if(!((t=t.toString())in this.a))return!1;var i=this.a[t];return-1<(e=qe(i,e,r,n))&&(oe(i[e]),Array.prototype.splice.call(i,e,1),0==i.length&&(delete this.a[t],this.b--),!0)},pe.prototype.qa=function(t){t=t&&t.toString();var e,r=0;for(e in this.a)if(!t||e==t){for(var n=this.a[e],i=0;i<n.length;i++)++r,oe(n[i]);delete this.a[e],this.b--}return r};var te=!sb||9<=Number(Db),ue=sb&&!Cb("9");!vb||Cb("528"),ub&&Cb("1.9b")||sb&&Cb("8")||rb&&Cb("9.5")||vb&&Cb("528"),ub&&!Cb("8")||sb&&Cb("9");var ve=function(){if(!wa.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{wa.addEventListener("test",za,e),wa.removeEventListener("test",za,e)}catch(t){}return t}();function we(t,e){if(rd.call(this,t?t.type:""),this.relatedTarget=this.currentTarget=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.b=null,t){var r=this.type=t.type,n=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.currentTarget=e,e=t.relatedTarget){if(ub){t:{try{ob(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==r?e=t.fromElement:"mouseout"==r&&(e=t.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:xe[t.pointerType]||"",this.b=t,t.defaultPrevented&&this.preventDefault()}}u(we,rd);var xe={2:"touch",3:"pen",4:"mouse"};we.prototype.stopPropagation=function(){we.l.stopPropagation.call(this),this.b.stopPropagation?this.b.stopPropagation():this.b.cancelBubble=!0},we.prototype.preventDefault=function(){we.l.preventDefault.call(this);var t=this.b;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ue)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var ye="closure_lm_"+(1e6*Math.random()|0),ze={},Ae=0;function Be(t,e,r,n,i){if(n&&n.once)return Ce(t,e,r,n,i);if("array"==Aa(e)){for(var o=0;o<e.length;o++)Be(t,e[o],r,n,i);return null}return r=De(r),le(t)?t.aa.add(String(e),r,!1,Da(n)?!!n.capture:!!n,i):Ee(t,e,r,!1,n,i)}function Ee(t,e,r,n,i,o){if(!e)throw Error("Invalid event type");var a=Da(i)?!!i.capture:!!i,s=Fe(t);if(s||(t[ye]=s=new pe(t)),(r=s.add(e,r,n,a,o)).proxy)return r;if(n=Ge(),r.proxy=n,n.src=t,n.listener=r,t.addEventListener)ve||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),n,i);else if(t.attachEvent)t.attachEvent(He(e.toString()),n);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(n)}return Ae++,r}function Ge(){var t=Ie,e=te?function(r){return t.call(e.src,e.listener,r)}:function(r){if(!(r=t.call(e.src,e.listener,r)))return r};return e}function Ce(t,e,r,n,i){if("array"==Aa(e)){for(var o=0;o<e.length;o++)Ce(t,e[o],r,n,i);return null}return r=De(r),le(t)?t.aa.add(String(e),r,!0,Da(n)?!!n.capture:!!n,i):Ee(t,e,r,!0,n,i)}function Je(t,e,r,n,i){if("array"==Aa(e)){for(var o=0;o<e.length;o++)Je(t,e[o],r,n,i);return null}return n=Da(n)?!!n.capture:!!n,r=De(r),le(t)?t.aa.remove(String(e),r,n,i):!!t&&(!!((t=Fe(t))&&(e=t.a[e.toString()],t=-1,e&&(t=qe(e,r,n,i)),r=-1<t?e[t]:null))&&Ke(r))}function Ke(t){if("number"==typeof t||!t||t.se)return!1;var e=t.src;if(le(e))return re(e.aa,t);var r=t.type,n=t.proxy;return e.removeEventListener?e.removeEventListener(r,n,t.capture):e.detachEvent?e.detachEvent(He(r),n):e.addListener&&e.removeListener&&e.removeListener(n),Ae--,(r=Fe(e))?(re(r,t),0==r.b&&(r.src=null,e[ye]=null)):oe(t),!0}function He(t){return t in ze?ze[t]:ze[t]="on"+t}function Le(t,e,r,n){var i=!0;if((t=Fe(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==r&&!o.se&&(o=Me(o,n),i=i&&!1!==o)}return i}function Me(t,e){var r=t.listener,n=t.gg||t.src;return t.Jf&&Ke(t),r.call(n,e)}function Ie(t,e){if(t.se)return!0;if(!te){if(!e)t:{e=["window","event"];for(var r=wa,n=0;n<e.length;n++)if(null==(r=r[e[n]])){e=null;break t}e=r}if(e=new we(n=e,this),r=!0,!(0>n.keyCode||void 0!=n.returnValue)){t:{var i=!1;if(0==n.keyCode)try{n.keyCode=-1;break t}catch(t){i=!0}(i||void 0==n.returnValue)&&(n.returnValue=!0)}for(n=[],i=e.currentTarget;i;i=i.parentNode)n.push(i);for(t=t.type,i=n.length-1;!e.a&&0<=i;i--){e.currentTarget=n[i];var o=Le(n[i],t,!0,e);r=r&&o}for(i=0;!e.a&&i<n.length;i++)e.currentTarget=n[i],o=Le(n[i],t,!1,e),r=r&&o}return r}return Me(t,new we(e,this))}function Fe(t){return(t=t[ye])instanceof pe?t:null}var Ne="__closure_events_fn_"+(1e9*Math.random()>>>0);function De(t){return Ca(t)?t:(t[Ne]||(t[Ne]=function(e){return t.handleEvent(e)}),t[Ne])}function F(){nd.call(this),this.aa=new pe(this),this.ao=this,this.jh=null}function Oe(t){var e=(t=t||{}).callback;this.a=t.label,Ca(e)&&(this.callback=e),this.b=!!t.disabled,Oe.l.constructor.call(this)}u(F,nd),F.prototype[ke]=!0,n=F.prototype,n.Qb=function(){return this.jh},n.ka=function(t){this.jh=t},n.addEventListener=function(t,e,r,n){Be(this,t,e,r,n)},n.removeEventListener=function(t,e,r,n){Je(this,t,e,r,n)},n.dispatchEvent=function(t){var e,r=this.Qb();if(r)for(e=[];r;r=r.Qb())e.push(r);r=this.ao;var n=t.type||t;if("string"==typeof t)t=new rd(t,r);else if(t instanceof rd)t.target=t.target||r;else{var i=t;Wa(t=new rd(n,r),i)}if(i=!0,e)for(var o=e.length-1;!t.a&&0<=o;o--){var a=t.currentTarget=e[o];i=a.td(n,!0,t)&&i}if(t.a||(i=(a=t.currentTarget=r).td(n,!0,t)&&i,t.a||(i=a.td(n,!1,t)&&i)),e)for(o=0;!t.a&&o<e.length;o++)i=(a=t.currentTarget=e[o]).td(n,!1,t)&&i;return i},n.u=function(){F.l.u.call(this),this.aa&&this.aa.qa(void 0),this.jh=null},n.td=function(t,e,r){if(!(t=this.aa.a[String(t)]))return!0;t=t.concat();for(var n=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.se&&o.capture==e){var a=o.listener,s=o.gg||o.src;o.Jf&&re(this.aa,o),n=!1!==a.call(s,r)&&n}}return n&&0!=r.nl},t("H.util.EventTarget",F),F.prototype.ka=F.prototype.ka,F.prototype.setParentEventTarget=F.prototype.ka,F.prototype.Qb=F.prototype.Qb,F.prototype.getParentEventTarget=F.prototype.Qb,F.prototype.addEventListener=F.prototype.addEventListener,F.prototype.addEventListener=F.prototype.addEventListener,F.prototype.removeEventListener=F.prototype.removeEventListener,F.prototype.removeEventListener=F.prototype.removeEventListener,F.prototype.dispatchEvent=F.prototype.dispatchEvent,F.prototype.dispatchEvent=F.prototype.dispatchEvent,F.prototype.B=F.prototype.B,F.prototype.dispose=F.prototype.B,F.prototype.zb=F.prototype.zb,F.prototype.addOnDisposeCallback=F.prototype.zb,F.prototype.lo=F.prototype.td,F.prototype.td=function(t,e,r){var n,i,o=!0,a=r[r.currentTarget===r.target?"AT_TARGET":e?"CAPTURING_PHASE":(n=!0,"BUBBLING_PHASE")];return(!n||"pointerenter"!==(i=r.type)&&"pointerleave"!==i)&&(r.eventPhase=a,o=F.prototype.lo.apply(this,arguments),n&&this.Qb&&null===this.Qb()&&delete r.eventPhase),o},u(Oe,F),t("H.util.ContextItem",Oe),Oe.prototype.Ye=function(){return this.a},Oe.prototype.getLabel=Oe.prototype.Ye,Oe.prototype.Qc=function(t){return this.a!==t&&(this.a=t,this.dispatchEvent("update")),this},Oe.prototype.setLabel=Oe.prototype.Qc,Oe.prototype.mc=function(){return this.b},Oe.prototype.isDisabled=Oe.prototype.mc,Oe.prototype.Da=function(t){return t^this.b&&(this.b=t,this.dispatchEvent("update")),this},Oe.prototype.setDisabled=Oe.prototype.Da;var Pe=new Oe;function Re(){if(x.document){var t=document.createElement("canvas");return t.width=t.height=1,t.getContext("2d")}return null}function Se(){return window.devicePixelRatio||1}Oe.SEPARATOR=Pe,t("H.util.getPixelRatio",Se);var Te=/^rgba\(([^,]+),([^,]+),([^,]+),([^)]+)\)$/;function Ue(t){var e=Ve[t],r=x.RegExp;return e||(x.Uint8ClampedArray||(x.Uint8ClampedArray=function(t){return t instanceof Number?Array(t):t.map(function(t){return Yd(xd(t),0,255)})}),"none"===t?e=new Uint8ClampedArray([0,0,0,0]):(We.fillStyle="black",We.fillStyle=t,Te.test(We.fillStyle)?e=new Uint8ClampedArray([r.$1,r.$2,r.$3,255*r.$4]):(We.clearRect(0,0,1,1),We.fillRect(0,0,1,1),e=We.getImageData(0,0,1,1).data)),Ve[t]=e),e}function Xe(t){return"none"!==t&&0<Ue(t)[3]}var Ve=mc(),Ye=!!x.VBArray;function Ze(t,e){return t!==B?t:e}function $e(t){return/^<svg/.test(t)?"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(t):t}function af(t){this.oc=0<t?ud.round(t):0}t("H.util.eval",function(a){return eval(a)}),t("H.util.provide",function(t){var e=wa.$jscomp;if(e&&"function"==typeof e.Lm&&e.Lm())throw Error("goog.provide cannot be used within a module.");ya(t,void 0)}),af.prototype.next=function(t){if(9007199254740992===this.oc)throw new je(t,this.oc,[0,9007199254740991]);return this.oc++};var bf=new af,cf=A(bf.next,bf);function df(){return!0}function ef(){return!1}function hd(){}var ff=oc([]),gf=oc({});function hf(t){return"CANVAS"===t.tagName?[t]:t.getElementsByTagName("CANVAS")}function jf(t,e,r){var n;if(e=t.ownerDocument===e?t.cloneNode(!0):e.importNode(t,!0),r)for(t=hf(t),n=(r=hf(e)).length;n--;)r[n].getContext("2d").drawImage(t[n],0,0);return e}var We=Re(),kf=Re();function lf(t){var e=t.complete,r=0<t.naturalWidth;if(e&&!r&&Ye)try{kf.drawImage(t,0,0),r=!0}catch(t){}return e&&r}var mf=x.BlobBuilder||x.WebKitBlobBuilder||x.MozBlobBuilder;function nf(t,e){if(e=e||"",mf){var r=new mf;r.append(t),t=r.getBlob(e)}else t=new Blob([t],{type:e});return t}var of=x.navigator;function pf(){var t=pf.a;return t||(t=this,pf.a=t,Fc(pf.a),F.call(t),qf(this)),t}function qf(t){t.g=10,t.i=6,t.a=mc(),t.b=mc(),t.c=0}function rf(t,e,r,n){if(!this.b[t])throw new D(rf,0,"Mime type is not supported");this.g=t,"crossOrigin"in(t=n?Ua(n):{})||(t.crossOrigin="anonymous"),this.a=t,sf.href=e.toString(),ee.call(this,sf.protocol+"//"+sf.hostname,e,r)}Zc=/Edge\/\d+/.test(of.appVersion),$c=/(A|a)ndroid/.test(of.appVersion),u(pf,F),pf.prototype.u=function(){pf.l.u.call(this),qf(this)},pf.prototype.Zg=function(t){t=t.type;var e=this.a[t]||0;if(this.c<this.g&&e<this.i){var r=++this.f;return this.c++,this.a[t]=e+1,this.b[r+""]=t,r}return y},pf.prototype.Tf=function(t){var e=this.b[t];if(!tc(e)||!this.a[e])throw new Xc(this.Tf,"Unknown requestId");this.c--,this.a[e]--,this.a[e]||delete this.a[e],delete this.b[t],this.dispatchEvent("allocatable")},pf.prototype.f=-1,u(rf,ee),rf.prototype.Lj=function(){return this.c=this.b[this.g].call(this),!0},rf.prototype.Ie=function(){this.c&&(this.c.abort(),this.c=null)},rf.prototype.b={"application/json":function(){var t=this,e=tf(this.a),r=e.headers;return e.headers=r=r?Ua(r):{},r.Accept="application/json",new Rc(this.data,function(e){200<=e.status&&300>e.status?t.resolve(e.json()):t.reject(e)},e)},"text/plain":function(){var t=this;return new Rc(this.data,function(e){200<=e.status&&300>e.status?t.resolve(e.text()):t.reject(e)},tf(this.a))},image:function(){var t=x.document.createElement("img"),e=this,r=this.data;return t.onload=A(this.resolve,this,t),t.onerror=function(){e.reject(Oc.error())},t.crossOrigin=this.a.crossOrigin,t.src=r,{abort:function(){t.onerror=t.onload=null,Ye&&lf(t)||t.removeAttribute("src")}}}},function(){try{var t=new XMLHttpRequest;t.open("get","/",!0)}catch(e){t={}}"response"in t&&(rf.prototype.b.arraybuffer=function(){var t,e=new XMLHttpRequest,r=this,n=this.a,i=n.headers;if(e.open("GET",this.data),uf(e,n),e.responseType="arraybuffer",i)for(t in i)e.setRequestHeader(t,i[t]);return e.onerror=e.ontimeout=function(){r.reject(Oc.error())},e.onload=function(){r.resolve(new Oc(e.response))},e.send(),e})}();var vf=new he(new pf);rf.prototype.yh=function(){return vf};var sf=x.document.createElement("a");function tf(t){var e=Ua(t);return delete e.crossOrigin,uf(e,t),e}function uf(t,e){t.withCredentials="use-credentials"===e.crossOrigin}function I(t,e){this.x=+t,this.y=+e}function wf(t){if(!t)throw Error("invalid argument");return t instanceof I?t:new I(t.x,t.y)}function xf(t){var e=yf[t];if(!e)if(t in zf)e=yf[t]=t;else{e=Af.length;var r="",n=t.charAt(0).toUpperCase()+t.substr(1),i="",o=!1;Bf&&(o=(i=Bf+n)in zf);for(;e--&&!o;)o=(i=(r=Af[e])+n)in zf;if(o&&(Bf=r),!(e=o?i:null))throw Error("Could not find any variant of CSS property ["+t+"]");yf[t]=e}return e}t("H.math.Point",I),I.prototype.set=I,I.prototype.set=I.prototype.set,I.prototype.clone=function(t){return t?(t.x=this.x,t.y=this.y):t=new I(this.x,this.y),t},I.prototype.clone=I.prototype.clone,I.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},I.prototype.add=I.prototype.add,I.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},I.prototype.sub=I.prototype.sub,I.prototype.scale=function(t,e){return this.x*=t,this.y*=void 0===e?t:e,this},I.prototype.scale=I.prototype.scale,I.prototype.round=function(){return this.x=xd(this.x),this.y=xd(this.y),this},I.prototype.round=I.prototype.round,I.prototype.floor=function(){return this.x=yd(this.x),this.y=yd(this.y),this},I.prototype.floor=I.prototype.floor,I.prototype.ceil=function(){return this.x=zd(this.x),this.y=zd(this.y),this},I.prototype.ceil=I.prototype.ceil,I.prototype.oa=function(t){return!(!t||this.x!==t.x||this.y!==t.y)},I.prototype.equals=I.prototype.oa,I.prototype.Yj=function(t,e){var r=e.x-t.x,n=e.y-t.y,i=t;if(r||n){var o=((this.x-t.x)*r+(this.y-t.y)*n)/(r*r+n*n);i=0>=o?t:1<=o?e:new I(t.x+o*r,t.y+o*n)}return i},I.prototype.getNearest=I.prototype.Yj,I.prototype.Za=function(t){return Cd(Dd(this.x-t.x,2)+Dd(this.y-t.y,2))},I.prototype.distance=I.prototype.Za,I.fromIPoint=wf,t("H.dom.cssPrefixer.prefix",xf);var Af=["O","Ms","ms","Moz","Webkit"],yf={},Bf="",zf=document.createElement("span").style;function Cf(t,e,r,n){if(!t||!e||!r)throw new D(Cf,null,"Must specify name, version and revision parameter");this.name=t,this.version=e,this.revision=r,n&&Wa(this,n)}t("H.util.BuildInfo",Cf),Cf.prototype.toString=function(){var t,e=[];for(t in this)zc(this[t])&&e.push(this[t]);return e.join(";")};var Df={};function Ef(t,e,r,n){if(!t)throw new D(Ef,1,"Must specify a name parameter");return Df[t]||(Df[t]=new Cf(t,e,r,n))}function Ff(){Ff.l.constructor.call(this),this.a=Gf(this),this.f=mc(),this.c=A(this.c,this),this.a.addEventListener("message",this.c),this.b={}}Cf.get=Ef,u(Ff,F),Ff.prototype.u=function(){this.a.terminate()},Ff.prototype.i=function(t){var e=t.type,r=!!this.f[e],n=t.data,i=Hf++,o=n&&n.np?n.np:B,a=!0;return r?(this.b[i]=t,If(this,e,i,n&&n.message,o)):(t.reject(new D(this.i,0,"processor_not_found")),a=!1),a},Ff.prototype.c=function(t){t=t.data;var e=this.b[t.taskId],r=t.taskId,n=t.data,i=this;if(2===t.type)new rf("arraybuffer",n).then(function(t){return t.arrayBuffer()}).then(function(t){i.a.postMessage(["3",r,[t]],[t])},function(){i.a.postMessage(["3",r,[null,"ERROR"]])});else{if(e){switch(t.type){case 1:e.resolve(n);break;case 0:e.reject(n)}delete this.b[r]}this.dispatchEvent(new rd(this.g.IDLE))}};var Hf=0,Nf,Qf;function Jf(t,e,r){var n,i=Hf++;return t.b[i]=n=Zb(),If(t,e,i,r),n.dl}function If(t,e,r,n,i){n===B||Ba(n)||(n=[n]);try{t.a.postMessage([e,r,n],i)}catch(e){(t=t.b[r]).reject(e.message)}}function Gf(a){var b=x.H.__bootstrap__;if(b=Ca(b)?(""+b).replace(/^[^{]+{((.|[\r\n])+?)}\s*$/,"$1"):""+b,x.Worker&&x.URL)try{var c=new x.Worker(x.URL.createObjectURL(nf(b,"application/javascript")))}catch(t){}return c||(a=new Kf(a),function(){eval("var self = arguments[0];"+b)}(a),c=new Lf(a)),c}function Lf(t){F.call(this),this.a=t}function Kf(a){F.call(this),this.a=a,this.addEventListener=A(this.addEventListener,this),this.removeEventListener=A(this.removeEventListener,this),this.postMessage=A(this.postMessage,this),this.eval=A(eval,this)}function Mf(){var t=Nf;return t||(t=Nf=this,F.call(t),Of(this)),t}function Of(t){var e,r=t.b;if(r)for(e=r.length;e--;)r[e].B();t.b=[],Fc(t.b),t.c=mc(),t.f=mc()}function Pf(t,e,r){ee.call(this,t,e,r)}function Rf(t,e,r){var n=Yd(+t,-90,90);if(e&&E(n))throw new D(e,r,t);return n}function Sf(t,e,r){var n=+t;if((-180>n||180<n)&&(n=Wd(n+180,360)-180),e&&E(n))throw new D(e,r,t);return n}function Tf(t,e,r){var n;if(t!==B&&E(n=+t)&&e)throw new D(e,r,t);return n}function Uf(t,e){return 0!=(0>t^0>e)&&180<Ad(e-t)}function Vf(){uc(this,Vf)}function Wf(t,e,r){this.lat=Rf(t,Wf,0),this.lng=Sf(e,Wf,1),r!==B&&(this.alt=Tf(r,Wf,2))}function Yf(t,e,r){var n=Da(t)&&!(E(t.lat=Rf(t.lat))||E(t.lng=Sf(t.lng))||t.alt!==B&&E(t.alt=Tf(t.alt)));if(!n&&e)throw new D(e,r,t);return n}function Zf(t){if(!t)throw new D(Zf,0,t);return new Wf(t.lat,t.lng,t.alt)}function K(t,e,r,n){$f(this,Rf(t,K,0),Sf(e,K,1),Rf(r,K,2),Sf(n,K,3))}function $f(t,e,r,n,i){return t.ca=r,t.ia=i,e<n&&(r=e,e=n,n=r),t.la=e,t.na=n,t.c=t.a=t.b=null,t}function bg(t,e){return(t=e-t)+(0>t?360:0)}function ag(t,e){return(t+=e/2)-(180<t?360:0)}function cg(t,e,r,n,i,o,a,s,u){r=vd(r,a),t=wd(t,i);var l=ag(e,i=bg(e,n)),c=ag(o,a=bg(o,s))-l;if(180>(c+=0>c-1e-6?360:0)-1e-6){l=e;var h=s}else c=360-c,l=o,h=n;return 360<=(c=c+i/2+a/2)+5e-7?(l=-180,h=180):c-5e-7<i?(l=e,h=n):c-5e-7<a&&(l=o,h=s),u?$f(u,t,l,r,h):new K(t,l,r,h)}function dg(t,e,r){return r||(Yf(t,dg,0),Yf(e,dg,1)),new K(t.lat,t.lng,e.lat,e.lng)}function eg(t,e){var r=1,n=t.length,i=null;if(!Ba(t))throw new D(eg,0,t);if(0<n){var o=t[0];for(i=dg(o,o,e);r<n;r++)o=t[r],i.gd(o.lat,o.lng,e,i)}return i}function fg(t,e){var r,n=3,i=t.length;if(!(e||t&&null!=t.length))throw new D(fg,0,t);if(0<i)for(r=new K(t[0],t[1],t[0],t[1]);n<i;n+=3)r.gd(t[n],t[n+1],e,r);return r}function gg(t,e){var r,n=1,i=t.length;if(e&&(!t||null==t.length))throw new D(gg,0,t);if(0<i)for(r=new K(t[0].la,t[0].ca,t[0].na,t[0].ia);n<i;n++)r.nc(t[n],e,r);return r}function hg(t,e,r,n,i,o){uc(this,hg),this.c=t||10,this.b=this.a=null,this.f=n||0,this.g=i||0,this.i=e||1,this.j=r||1,this.o=!!o,this.flush()}function ig(t){var e=t.b;if(t.o&&!e){var r=t.head;(r.entries||r[0]||r[1]||r[2]||r[3])&&(e=jg([e=[r],e,e,e],[r[6],r[7],r[4],r[5]]),t.b=e)}return e}function jg(t,e){var r,n,i,o,a=0;for(r=3;0<=r;r--){var s=r+4,u=0<r%3,l=[],c=e[r],h=t[r];for(n=h.length;n--;){var f=h[n];if(i=f.entries)for(o=i.length;o--;){var p=i[o].wd(r);(u?p>c:p<c)&&(c=p)}for(o=4;o--;)(i=f[o])&&(u?i[s]>c:i[s]<c)&&l.push(i)}a+=l.length,e[r]=c,t[r]=l}return a&&(e=jg(t,e)),e}function kg(t,e,r){var n,i;if(t.o&&(n=t.b))for(i=3;0<=i;i--){var o=e.wd(i);if(i%3?o>=n[i]:o<=n[i]){if(!r){t.b=null;break}n[i]=o}}}function mg(t,e){var r,n=t.head;if(e){var i=e;if(i!==n)for(n=i;i=i.parent;)(i.entries||1<i.a)&&(n=i)}else for(;!n.entries&&2>(r=n.a)&&r;)n=i;t.head=n}function ng(t,e,r,n,i,o,a,s,u){var l,c=e.entries,h=e[7],f=e[4],p=e[5],d=e[6],v=e[8],y=e[9];if(c){var g=c.length;if(i>f||n>h||a<d||o<p)for(;g--;){f=(h=c[g]).wd(3),p=h.wd(0),d=h.wd(1),h.wd(2)>=i&&d>=n&&(p<a||s&&p==a)&&(f<o||u&&f==o)&&r.push(h)}else for(;g--;)r.push(c[g])}(o>v||u&&o==v)&&(i<y&&(l=e[1])&&ng(t,l,r,n,i,o,a,s,u),(a>y||s&&a==y)&&(l=e[3])&&ng(t,l,r,n,i,o,a,s,u)),n<v&&(i<y&&(l=e[0])&&ng(t,l,r,n,i,o,a,s,u),(a>y||s&&a==y)&&(l=e[2])&&ng(t,l,r,n,i,o,a,s,u))}Ff.prototype.g={IDLE:"idle",hj:"error"},Ff.prototype.j=function(t,e){var r=this.m||(this.m=new rd(this.g.hj));r.data=e,delete this.f[t],this.dispatchEvent(r)},u(Lf,F),Lf.prototype.postMessage=function(t){x.setTimeout(A(this.b,this,t),0)},Lf.prototype.b=function(t){var e=new rd("message");e.data=t,this.a.dispatchEvent(e)},Lf.prototype.terminate=function(){this.a.B(),this.B()},u(Kf,F),Kf.prototype.postMessage=function(t){var e=new rd("message");e.data=t,x.setTimeout(A(this.a.c,this.a,e),0)},u(Mf,F),Mf.prototype.u=function(){Mf.l.u.call(this),Of(this)},Mf.prototype.Zg=function(t){var e;if(t=t.type,!(e=this.f[t]))throw new Xc(this.Zg,'Unknown type "'+t+'"');var r=this.b,n=r[0];return n||(n=r[0]=new Ff,this.zb(Ja(qd,n)),Ta(this.c)||Jf(n,"0",r=x.Object.keys(this.c))),(r=n).f[t]||(r.f[t]=e,Jf(r,"1",[t,Ca(e)?e+"":e]).then(hd,A(r.j,r,t))),n},Mf.prototype.Tf=function(){},Mf.prototype.a=function(t,e){var r=this.f,n=r[t];if(n){if(e!==n)throw new Xc(this.a,'Type "'+t+'" is already registered')}else r[t]=e},u(Pf,ee),Pf.prototype.yh=function(){return Qf||(Qf=new he(new Mf)),Qf},Pf.prototype.Ie=function(){},Pf.prototype.Lj=function(t){return t.i(this)},t("H.geo.isDBC",Uf),t("H.geo.AbstractGeometry",Vf),Vf.prototype.getBoundingBox=Vf.prototype.G,Vf.prototype.equals=Vf.prototype.oa,Vf.prototype.rb="",Vf.prototype.Mb="",Vf.prototype.toString=function(){return this.Tc([this.rb.toUpperCase()," "]).join("")},Vf.prototype.toString=Vf.prototype.toString,Vf.prototype.Sc=function(){return{type:this.Mb,coordinates:this.md()}},Vf.prototype.toGeoJSON=Vf.prototype.Sc,Vf.prototype.X=function(){return{type:this.rb,coordinates:this.yc(),boundingBox:this.G().X()}},Vf.prototype.forWorkerMessage=Vf.prototype.X,u(Wf,Vf),t("H.geo.Point",Wf),Wf.prototype.oa=function(t){return this===t||!!t&&this.lat===t.lat&&this.lng===t.lng&&(this.alt||0)===(t.alt||0)},Wf.prototype.equals=Wf.prototype.oa,Wf.prototype.Za=function(t){if(this===t||this.lat===t.lat&&this.lng===t.lng)t=0;else{var e=this.lat*Rd,r=t.lat*Rd;t=12742001.58*Gd(vd(1,Cd(Dd(Fd((e-r)/2),2)+Hd(e)*Hd(r)*Dd(Fd((this.lng*Rd-t.lng*Rd)/2),2))))}return t},Wf.prototype.distance=Wf.prototype.Za,Wf.prototype.Ng=function(t,e,r){if(r){if(e/=6371000.79){t*=Rd;var n=Rd*this.lat,i=Fd(n),o=Fd(e),a=Hd(e),s=Rd*this.lng,u=Hd(n);n=Gd(u*Hd(t)*o+i*a),u=(t=(s+(t=Kd(Fd(t)*u*o,a-i*Fd(n)))+Md)%(2*Md)-Md)*Sd}return e?new Wf(n*Sd,(u+540)%360-180):this}if(0==((t=(t%360+360)%360)+90)%180)return n=this.lng+e/(6371000.79*Pd*Hd(this.lat*Rd))*(270===t?-360:360),new Wf(this.lat,(n+540)%360-180);if(e/=6371000.79){t*=Rd,s=this.lat*Rd,i=this.lng*Rd,a=(o=s+e*Hd(t))-s,n=Bd(Id(o/2+Od)/Id(s/2+Od)),n=E(a/n)?Hd(s):a/n;var l=e*Fd(t)/n;Ad(o)>Nd&&(o=0<o?Md-o:-(Md+o))}return e?new Wf(o*Sd,((i+l+Qd+(Ad(s+a)>Nd?Md:0))%Pd-Md)*Sd):this},Wf.prototype.walk=Wf.prototype.Ng,Wf.prototype.G=function(){return new K(this.lat,this.lng,this.lat,this.lng)},Wf.prototype.getBoundingBox=Wf.prototype.G,Wf.validate=Yf,Wf.fromIPoint=Zf,n=Wf.prototype,n.rb="Point",n.Tc=function(t){return t.push("(",this.lng," ",this.lat,")"),t},n.Mb="Point",n.md=function(){return[this.lng,this.lat,this.alt||0]},n.yc=function(){return[this.lat,this.lng,this.alt||0]},u(K,Vf),t("H.geo.Rect",K),K.prototype.rb="Polygon",K.prototype.Tc=function(t){var e=this.la,r=this.ca,n=this.na,i=this.ia;return t.push("(","(",r," ",e,",",i," ",e,",",i," ",n,",",r," ",n,",",r," ",e,")",")"),t},K.prototype.oa=function(t){return this===t||!!t&&this.la===t.la&&this.ca===t.ca&&this.na===t.na&&this.ia===t.ia},K.prototype.equals=K.prototype.oa,K.prototype.clone=function(){return new K(this.la,this.ca,this.na,this.ia)},K.prototype.clone=K.prototype.clone,K.prototype.Rb=function(){return this.c||(this.c=new Wf(this.la,this.ca)),this.c},K.prototype.getTopLeft=K.prototype.Rb,K.prototype.Nb=function(){return this.a||(this.a=new Wf(this.na,this.ia)),this.a},K.prototype.getBottomRight=K.prototype.Nb,K.prototype.On=function(){return this.la},K.prototype.getTop=K.prototype.On,K.prototype.Fm=function(){return this.na},K.prototype.getBottom=K.prototype.Fm,K.prototype.kn=function(){return this.ca},K.prototype.getLeft=K.prototype.kn,K.prototype.En=function(){return this.ia},K.prototype.getRight=K.prototype.En,K.prototype.fb=function(){return this.b||(this.b=new Wf(this.na+(this.la-this.na)/2,ag(this.ca,this.Fb()))),this.b},K.prototype.getCenter=K.prototype.fb,K.prototype.Fb=function(){return bg(this.ca,this.ia)},K.prototype.getWidth=K.prototype.Fb,K.prototype.ae=function(){return this.la-this.na},K.prototype.getHeight=K.prototype.ae,K.prototype.Gb=function(){return this.ca>this.ia},K.prototype.isCDB=K.prototype.Gb,K.prototype.jg=function(){return!this.Fb()&&!this.ae()},K.prototype.isEmpty=K.prototype.jg,K.prototype.G=function(){return new K(this.la,this.ca,this.na,this.ia)},K.prototype.getBoundingBox=K.prototype.G,K.prototype.Of=function(t,e,r){var n=this.fb();return r||(t=Rf(t,this.Of,0),e=Sf(e,this.Of,1)),(t=(e=this.gd(t,e,r)).fb()).lat===n.lat&&t.lng===n.lng&&this.ae()===e.ae()&&this.Fb()===e.Fb()},K.prototype.containsLatLng=K.prototype.Of,K.prototype.pd=function(t,e){return e||Yf(t,this.pd,0),this.Of(t.lat,t.lng,e)},K.prototype.containsPoint=K.prototype.pd,K.prototype.hh=function(t,e){var r=this.fb();if(!e&&!C(t,K))throw new D(this.hh,0,t);return(t=(e=this.nc(t,e)).fb()).lat===r.lat&&t.lng===r.lng&&this.ae()===e.ae()&&this.Fb()===e.Fb()},K.prototype.containsRect=K.prototype.hh,K.prototype.gd=function(t,e,r,n){if(!r){if(E(t=Rf(t)))throw new D(this.gd,0,t);if(E(e=Sf(e)))throw new D(this.gd,1,e)}return cg(this.la,this.ca,this.na,this.ia,t,e,t,e,n)},K.prototype.mergeLatLng=K.prototype.gd,K.prototype.Nk=function(t,e,r){return e||Yf(t,this.Nk,0),this.gd(t.lat,t.lng,e,r)},K.prototype.mergePoint=K.prototype.Nk,K.prototype.nc=function(t,e,r){if(!e&&!C(t,K))throw new D(this.nc,0,t);return cg(this.la,this.ca,this.na,this.ia,t.la,t.ca,t.na,t.ia,r)},K.prototype.mergeRect=K.prototype.nc,K.prototype.Ic=function(t,e,r,n,i,o){return i||(t=Rf(t,this.Ic,0),e=Sf(e,this.Ic,1),r=Rf(r,this.Ic,2),n=Sf(n,this.Ic,3)),cg(this.la,this.ca,this.na,this.ia,t,e,r,n,o)},K.prototype.mergeTopLeftBottomRight=K.prototype.Ic,K.prototype.Ad=function(t,e){var r=this.ca<=this.ia,n=t.ca<=t.ia,i=this.ca<t.ia,o=t.ca<this.ia;if(!e&&!C(t,K))throw new D(this.Ad,0,t);return this.na<=t.la&&t.na<=this.la&&(!r&&(!n||i||o)||!n&&(i||o)||i&&o)},K.prototype.intersects=K.prototype.Ad,K.merge=cg,K.fromPoints=dg,K.coverPoints=eg,K.coverLatLngAlts=fg,K.coverRects=gg,K.prototype.ml=function(t,e){var r=this.ca,n=this.la,i=this.ia,o=this.na,a=this.fb().lng;Yf(t,this.ml,0);var s=t.lat-o-(n-o)/2,u=t.lng-a;return t=-180>(t=r+(0>(u=180<u||-180>u?-(a+t.lng):u)?2*u:0))?360+t:t,i=180<(i+=0<u?2*u:0)?i-360:i,90<=(n=0<s?n+2*s:n)&&(n=90),-90>=(o=0>s?o+2*s:o)&&(o=-90),e?$f(e,n,t,o,i):new K(n,t,o,i)},K.prototype.resizeToCenter=K.prototype.ml,K.prototype.Mb="Polygon",K.prototype.md=function(){return[[this.ca,this.la,0],[this.ia,this.la,0],[this.ia,this.na,0],[this.ca,this.na,0],[this.ca,this.la,0]]},K.prototype.X=function(){return this.yc()},K.prototype.yc=function(){return[this.la,this.ca,this.na,this.ia]},hg.prototype.remove=function(t){var e,r,n,i=!1;return t&&(e=t.node)&&e.b===this&&(r=e.entries)&&0<=(n=r.indexOf(t))&&(r.splice(n,1),this.m(e),kg(this,t,!1),i=!0),i},hg.prototype.flush=function(){var t=new lg(null,NaN,this.f-this.i,this.g-this.j,this.f+this.i,this.g+this.j);t.b=this,this.head=this.a=t,this.b=null},hg.prototype.ab=function(t,e,r,n,i,o){var a=[],s=this.head,u=this.a;return t<=s[5]&&e<=s[6]&&(i?r>=s[7]:r>s[7])&&(o?n>=s[4]:n>s[4])&&ng(this,s,a,t,e,r,n,o||n>=u[6],i||r>=u[5]),a},hg.prototype.Uc=ba(1);var og=0;function lg(t,e,r,n,i,o){this.c=e,t&&(this.parent=t,this.b=t.b,1&e?(r=t[8],i=t[5]):(r=t[7],i=t[8]),2&e?(n=t[9],o=t[6]):(n=t[4],o=t[9])),this[7]=r,this[5]=i,this[8]=(r+i)/2,this[4]=n,this[6]=o,this[9]=(n+o)/2}function pg(t,e){return t[e]||(++t.a,t[e]=new lg(t,e))}function qg(t,e){(t.entries||(t.entries=[])).push(e),e.node=t}function rg(t,e,r,n,i){var o=t[5],a=t[6];return t[7]<=e&&t[4]<=r&&(o>n||o===n&&o===t.b.a[5])&&(a>i||a===i&&a===t.b.a[6])}function sg(t,e,r,n,i,o){sg.l.constructor.apply(this,arguments)}function tg(t,e,r,n,i){if(rg(t.a,e,r,n,i))return ug(t,t.a,e,r,n,i,t.c);throw Error("Coordinates out of bounds")}function ug(t,e,r,n,i,o,a){var s,u,l=e[8],c=e[9];return a&&(i<l||(s=r>=l))&&(o<c||(u=n>=c))?r=ug(t,pg(e,s|u<<1),r,n,i,o,a-1):(qg(e,r=new vg(r,n,i,o)),kg(t,r,!0),mg(t,e)),r}function vg(t,e,r,n){this.id=og++,this[0]=e,this[1]=r,this[2]=n,this[3]=t}function wg(t){this.f=new sg(+t||10,180,90,0,0,!0),this.c=[],this.g=!1,this.a=this.b=this.R=null}function xg(t,e,r,n,i,o){return o?(o=new vg(i,-e,r+360,-n),t.c.push(o),t.g=!0,t.a&&t.a.Ic(e,r,n,i,!0,t.a)):(o=tg(t.f,r,-e,i,-n),t.b&&t.b.Ic(e,r,n,i,!0,t.b)),++t.Xh,t.R=null,o}function yg(t,e,r,n,i,o,a){var s,u=(t=t.c).length,l=[];if(u){var c=r+360;for(s=i+360;u--;){var h=t[u];zg(h,e,r,n,i,o,a)?l.push(h):zg(h,e,c,n,s,o,a)&&l.push(h)}}return l}function zg(t,e,r,n,i,o,a){var s=t[3],u=t[0],l=t[1];return t=t[2],(o?u<=n:u<n)&&(a?s<=i:s<i)&&t>=e&&l>=r}function Ag(t,e){var r,n,i;if(r=e.length){var o=t.length;for(n={};o--;)n[t[o].id]=1;for(;r--;)(i=e[r]).id in n||t.push(i)}}function Bg(t){return x.H.gl.flexpolyline.encode(t)}function Cg(t){return x.H.gl.flexpolyline.decode(t)}function L(t){L.l.constructor.call(this),t&&Dg(t,L,0),this.Y=t||[],this.a=Eg(this,0,this.Y.length)}function Eg(t,e,r){t=t.Y;var n=0;for(e=wd(e,0),r=vd(r,t.length),r-=2,e+=1;e<r;)n+=Uf(t[e],t[e+=3]);return n}function Fg(t,e,r,n,i){var o=t.Y.length;e=Rf(e,i),r=Sf(r,i),t.Y.push(Rf(e,i),Sf(r,i),n===B?0:Tf(n,i)),o&&(t.a+=Uf(t.Y[o-2],r)),delete t.R,delete t.b}function Dg(t,e,r){for(var n,i=t.length,o=!(i%3);o&&i;)o=!(E(t[--i]=Tf((n=t[i])===B?0:n))||E(t[--i]=Sf(t[i]))||E(t[--i]=Rf(t[i])));if(!o&&e)throw new D(e,r,t)}function Gg(t){var e=new L,r=0,n=t.length;if(n%2)throw new D(Gg,0,t);for(;r<n;)Fg(e,t[r++],t[r++],0,Gg);return e}function Hg(t,e){return t.a-e.a}function Ig(t,e){var r,n=t.Y,i=-2,o=[],a=t.b;if(!a){a=t.b=new wg;var s=0,u=t.Y,l=u.length;for(r=0;r<l;r+=3){var c=u[r],h=u[r+1];if(r){if(p<h)var f=p,p=h;else f=h;if(v<c)var d=c;else{d=v;var v=c}(f=xg(a,d,f,v,p,180<p-f)).a=s++}v=c,p=h}}for(u=(a=a.ig(e).sort(Hg)).length,e=0;e<u;e++){if(l=3*(s=(s=a[e]).a),s>i+1){var y=[n[l],n[l+1]];o.push(y)}i=s,y.push(n[l+3],n[l+4])}if(t.a){for(n=[],i=o.length,e=0;e<i;e++)if(a=(y=o[e]).length){for(u=[],t=0;t<a;t+=2)s=y[t],l=y[t+1],u.push(s,l),r=y[t-1],t&&Uf(l,r)&&(n.push(u),u=[],r+=0>r?360:-360,u.push(y[t-2],r,s,l));n.push(u)}o=n}return o}function Jg(t){var e=Cg(t);t=e.polyline;var r=e.thirdDim;if(e=2===r||3===r,r=0===r,!t)throw new D(Jg,0,"data");if(e||r){r=t.length;for(var n=Array(3*r),i=0,o=0;i<r;i++){var a=t[i];n[o++]=a[0],n[o++]=a[1],n[o++]=e?a[2]:0}}if(!n)throw new D(Jg,0,"only ABSENT, ALTITUDE or ELEVATION are supported as type of the 3rd dimension");return new L(n)}function Kg(t){Kg.l.constructor.call(this),void 0!==t&&(this.data=t)}function Lg(){}lg.prototype.a=0,lg.prototype.removeChild=function(t){var e=t.c;this[e]===t&&(delete this[e],delete t.parent,--this.a)},lg.prototype.Uc=ba(0),u(sg,hg),sg.prototype.m=function(t){for(var e,r,n=this.head;t;)(e=t.entries)&&e.length||(e&&delete t.entries,t.a||!(r=t.parent))?t=y:(r.removeChild(t),n===t&&(n=r),t=r);this.head!==n&&(this.head=n,mg(this))},sg.prototype.Fc=function(t,e){return tg(this,t,e,t,e)},vg.prototype.wd=function(t){return this[t]},t("H.geo.QuadTree",wg),n=wg.prototype,n.Xh=0,n.bd=function(){return this.Xh},n.Gb=function(){return this.g},n.G=function(){var t,e;if(!this.R){var r,n,i,o=[];if(!this.b&&(t=ig(this.f))&&(this.b=new K(-t[0],t[3],-t[2],t[1])),(e=this.b)&&o.push(e),!this.a&&(i=(n=this.c).length)){t=90;var a=360,s=-90;for(r=0;i--;){var u=n[i];t=vd(t,u[0]),a=vd(a,u[3]),s=wd(s,u[2]),r=wd(r,u[1])}this.a=new K(-t,a,-s,r-360)}(e=this.a)&&o.push(e),(e=o[0])&&(o[1]&&(e=e.nc(o[1],!0)),this.R=e)}return this.R},n.Fc=function(t){var e=t.lng;return xg(this,t=t.lat,e,t,e,!1)},n.mk=function(t){var e=t.Rb(),r=t.Nb();return(t=t.Gb())?xg(this,e.lat,r.lng,r.lat,e.lng,t):xg(this,e.lat,e.lng,r.lat,r.lng,t)},wg.prototype.insertBoundingBox=wg.prototype.mk,wg.prototype.remove=function(t){var e;if(t.node){var r=this.f.remove(t);this.b=null}else(r=0<=(t=(e=this.c).indexOf(t)))&&(e.splice(t,1),this.g=0<e.length,this.a=null);return r&&(--this.Xh,this.R=null),r},wg.prototype.remove=wg.prototype.remove,wg.prototype.ig=function(t,e,r){var n=this.f,i=t.Rb(),o=t.Nb(),a=-i.lat;i=i.lng;var s=-o.lat;return o=o.lng,!e&&a===s||!r&&i===o?t=[]:t.Gb()?(Ag(t=n.ab(-180,a,o,s,r,e),n.ab(i,a,180,s,!1,e)),Ag(t,yg(this,a,o,s,i+360,e,r))):Ag(t=n.ab(i,a,o,s,r,e),yg(this,a,i,s,o,e,r)),t},wg.prototype.intersectBoundingBox=wg.prototype.ig,t("H.util.flexiblePolyline.encode",Bg),t("H.util.flexiblePolyline.decode",Cg),u(L,Vf),t("H.geo.LineString",L),L.prototype.zi=function(t,e,r){Fg(this,t,e,r,this.zi)},L.prototype.pushLatLngAlt=L.prototype.zi,L.prototype.Bf=function(t,e,r){r&&Dg(r,this.Bf,2),void 0===e&&(e=this.Y.length),e&&(this.a-=Eg(this,t-3,t+e+3));var n=r?this.Y.splice.apply(this.Y,[t,e].concat(r)):this.Y.splice(t,e);return r&&(this.a+=Eg(this,t-3,t+r.length+3)),e&&!r&&(this.a+=Eg(this,t-3,t-3)),delete this.R,delete this.b,n},L.prototype.spliceLatLngAlts=L.prototype.Bf,L.prototype.nk=function(t,e,r,n){this.Bf(t,0,[e,r,n])},L.prototype.insertLatLngAlt=L.prototype.nk,L.prototype.il=function(t){this.Bf(t,3)},L.prototype.removeLatLngAlt=L.prototype.il,L.prototype.Fd=function(t){Fg(this,t.lat,t.lng,t.alt,this.Fd)},L.prototype.pushPoint=L.prototype.Fd,L.prototype.Fc=function(t,e){this.nk(3*t,e.lat,e.lng,e.alt)},L.prototype.insertPoint=L.prototype.Fc,L.prototype.sf=function(t){this.il(3*t)},L.prototype.removePoint=L.prototype.sf,L.prototype.Qe=function(t,e){var r=this.Y,n=3*t;t=r[n];var i=r[n+1];return r=r[n+2],e&&(e.lat=t,e.lng=i,e.alt=r),e||new Wf(t,i,r)},L.prototype.extractPoint=L.prototype.Qe,L.prototype.tm=function(t,e,r){var n=this.Y;e=e||0,r=Ze(r,n.length/3);for(var i=3*e;e<r;)t(n[i++],n[i++],n[i++],e++)},L.prototype.eachLatLngAlt=L.prototype.tm,L.isDBC=Uf,L.prototype.wh=function(t){var e=this.a;return t&&(e+=Uf((t=this.Y)[t.length-2],t[1])),e},L.prototype.getDBCs=L.prototype.wh,L.prototype.Ze=function(){return this.Y.length/3},L.prototype.getPointCount=L.prototype.Ze,L.prototype.hn=function(){return this.Y},L.prototype.getLatLngAltArray=L.prototype.hn,L.prototype.R=y,L.prototype.G=function(){var t;if(!(t=this.R)){var e,r,n=(t=this.Y).length,i=3,o=y;if(3<=n){var a=e=t[0],s=r=t[1];for(o=new K(a,s,e,r);i<n;i+=3){if(a=t[i-3],s=t[i-2],e=t[i],s>(r=t[i+1])&&180<r-s||s<r&&-180>s-r||r<s&&180>Ad(r-s)){var u=s;s=r,r=u}a<e&&(u=a,a=e,e=u),cg(o.la,o.ca,o.na,o.ia,a,s,e,r,o)}}t=this.R=o}return t},L.prototype.getBoundingBox=L.prototype.G,L.prototype.Zn=function(){return this.R!==y},L.prototype.hasBoundingBox=L.prototype.Zn,L.fromLatLngArray=Gg,L.prototype.oa=function(t){var e,r=this===t;if(!r&&(r=C(t,L))){var n=this.Y;for(t=t.Y,r=(e=n.length)===t.length;r&&e--;)r=n[e]==t[e]}return r},L.prototype.equals=L.prototype.oa,n=L.prototype,n.rb="LineString",n.Tc=function(t,e){var r,n=this.Y,i=n.length;if(i){for(t.push("("),r=0;r<i;r+=3)r&&t.push(","),t.push(n[r+1]," ",n[r]);e&&(n[0]!==n[i-3]||n[1]!==n[i-2])&&t.push(",",n[1]," ",n[0]),t.push(")")}else t.push("EMPTY");return t},n.Mb="LineString",n.md=function(){var t,e=[],r=this.Y,n=r.length;for(t=0;t<n;t+=3)e.push([r[t+1],r[t],r[t+2]]);return e},n.yc=function(){var t,e=this.Y;if(this.G().Gb()){var r=1;for(t=(e=e.slice()).length;r<t;r+=3)0>e[r]&&(e[r]+=360)}return e},n.lp=function(t){t=void 0===t?5:t;for(var e=this.Y,r=e.length,n=[],i=0;i<r;i+=3)n.push([e[i],e[i+1],e[i+2]]);return Bg({polyline:n,precision:t,thirdDim:2,thirdDimPrecision:t})},L.prototype.toFlexiblePolyline=L.prototype.lp,L.fromFlexiblePolyline=Jg,u(Kg,F),t("H.map.Feature",Kg),Kg.prototype.getData=function(){return this.data},Kg.prototype.getData=Kg.prototype.getData,Kg.prototype.u=function(){Kg.l.u.call(this),delete this.data},t("H.map.provider.Invalidations",Lg),Lg.MARK_INITIAL=Ud,Lg.prototype.update=function(t,e){e!==Mg.NONE&&(this.a=t,e&Mg.SPATIAL&&(this.f=t),e&Mg.VISUAL&&(this.g=t),e&Mg.ADD&&(this.b=t),e&Mg.REMOVE&&(this.c=t),e&Mg.Z_ORDER&&(this.j=t),e&Mg.VOLATILITY&&(this.i=t))},Lg.prototype.update=Lg.prototype.update,Lg.prototype.on=function(){return this.a},Lg.prototype.getMark=Lg.prototype.on,Lg.prototype.a=Ud,Lg.prototype.eo=function(t){return this.a>t},Lg.prototype.isAny=Lg.prototype.eo,Lg.prototype.g=Ud,Lg.prototype.me=function(t){return this.g>t},Lg.prototype.isVisual=Lg.prototype.me,Lg.prototype.f=Ud,Lg.prototype.Qh=function(t){return this.f>t},Lg.prototype.isSpatial=Lg.prototype.Qh,Lg.prototype.b=Ud,Lg.prototype.pk=function(t){return this.b>t},Lg.prototype.isAdd=Lg.prototype.pk,Lg.prototype.c=Ud,Lg.prototype.kg=function(t){return this.c>t},Lg.prototype.isRemove=Lg.prototype.kg,Lg.prototype.j=Ud,Lg.prototype.Rh=function(t){return this.j>t},Lg.prototype.isZOrder=Lg.prototype.Rh,Lg.prototype.i=Ud,Lg.prototype.ko=function(t){return this.i>t},Lg.prototype.isVolatility=Lg.prototype.ko;var Mg={NONE:0,VISUAL:1,SPATIAL:2,ADD:4,REMOVE:8,Z_ORDER:16,VOLATILITY:32};function Ng(t,e,r){Ng.l.constructor.call(this,t),this.oldValue=r,this.newValue=e}function M(t){if(uc(this,M),M.l.constructor.call(this,t?t.data:B),this.N=Og.next(),t){var e="min";Cc(t[e])&&(this.v=t[e]),Cc(t[e="max"])&&(this.s=t[e]),(e="visibility")in t&&(this.c=!!t[e]),(e="volatility")in t&&(this.C=!!t[e]),(e="zIndex")in t&&(this.o=+t[e]||0),(e="provider")in t&&!C(t[e],N)&&(this.a=t[e],this.wa(Mg.ADD))}}Lg.Flag=Mg,u(Ng,rd),t("H.util.ChangeEvent",Ng),u(M,Kg),t("H.map.Object",M);var Og=new af(1),Pg={ANY:31,OVERLAY:1,SPATIAL:2,MARKER:4,DOM_MARKER:8,GROUP:16};function Qg(t,e,r){var n,i;if(!r||t[0]|e[0]){var o=t.length,a=e.length,s=vd(o,a),u=1;for(i=1+r;u<s;u+=i)if(n=t[u]-e[u])return n}return r?0:o-a}function Rg(t,e){return t.xj(e)}function Sg(t,e,r){if(null===e||e===B)return null;if(0<=Object.keys(e).length&&"[object Object]"!==Object.prototype.toString.call(e))throw Error(Tg(t,r));try{return JSON.stringify(e),e}catch(e){throw Error(Tg(t,r))}}function Tg(t,e){return"Object Remote-Id: "+t.m+" - "+(e?"The value returned by the callback is not a valid JSON object and cannot be set as Feature properties.":"The given object data is not a valid JSON object and cannot be set as Feature properties.")}function Ug(t){var e;if(t){var r=Vg;for(e=C(t,Ug);r--;){var n=Wg[r];if(t.hasOwnProperty(n)){var i=t[n];if(e)this[n]=i;else{if((i=Xg[r](i))===Yg)throw new D(Ug,0,n+": "+t[n]);i!==this[n]&&i!==B&&(this[n]=i)}}}(r=e?t.cf:this.lineWidth&&Xe(this.strokeColor))||(this.cf=r),(r=e?t.Sb:Xe(this.fillColor))||(this.Sb=r),(r=e?t.bf:"none"!==this.strokeColor&&this.lineWidth)||(this.bf=r)}oc(this)}M.Type=Pg,M.prototype.gb=function(){return this.N},M.prototype.getId=M.prototype.gb,M.prototype.Qi=function(t){if(!Cc(t)&&!zc(t))throw new D(this.Qi,0,"id must be a number or a string");return this.m=t,this},M.prototype.setRemoteId=M.prototype.Qi,M.prototype.Dn=function(){return this.m},M.prototype.getRemoteId=M.prototype.Dn,M.prototype.v=-1/0,M.prototype.s=1/0,M.prototype.Vj=function(t){var e=this.s;if(t)for(t=this;t=t.Ha;)e=vd(e,t.s);return e},M.prototype.getMax=M.prototype.Vj,M.prototype.Xj=function(t){var e=this.v;if(t)for(t=this;t=t.Ha;)e=wd(e,t.v);return e},M.prototype.getMin=M.prototype.Xj,M.prototype.c=!0,M.prototype.wb=function(t){return(t=!!t)^this.c&&(this.c=t,this.invalidate(Mg.VISUAL)),this},M.prototype.setVisibility=M.prototype.wb,M.prototype.Dc=function(t){for(var e,r=this;(e=r.c)&&t&&(r=r.Ha););return e},M.prototype.getVisibility=M.prototype.Dc,M.prototype.C=!1,M.prototype.fg=function(t){for(var e,r=this;!(e=r.C)&&t&&(r=r.Ha););return e},M.prototype.getVolatility=M.prototype.fg,M.prototype.El=function(t){var e=this.C;return e^t&&(this.C=!e,this.invalidate(Mg.VOLATILITY)),this},M.prototype.setVolatility=M.prototype.El,M.prototype.o=B,M.prototype.fk=function(){return this.o},M.prototype.getZIndex=M.prototype.fk,M.prototype.ye=function(t){return t!==this.o&&(this.uf(),this.o=t,this.invalidate(Mg.Z_ORDER)),this},M.prototype.setZIndex=M.prototype.ye,M.prototype.J=B,M.prototype.ed=function(){var t,e,r=this.J;if(!r){var n=(t=this.o)!==B;(r=this.Ha)?(r=r.ed().slice())[0]|=n:r=[0|n],r.push(t||0,0>(e=this.Ti)?this.N:e),this.J=r}return r},M.prototype.getZInfo=M.prototype.ed,M.prototype.uf=function(){this.J=B},M.compareZInfo=Qg,M.compareZOrder=Rg,M.prototype.xj=function(t){return this.Og-t.Og||Qg(this.ed(),t.ed(),!1)},M.prototype.compareZOrder=M.prototype.xj,n=M.prototype,n.previousSibling=y,n.nextSibling=y,n.Ti=-1,n.Ha=y,n.sn=function(){return this.Ha},M.prototype.getParentGroup=M.prototype.sn,M.prototype.kc=function(){for(var t,e=this;t=e.Ha;)e=t;return e},M.prototype.getRootGroup=M.prototype.kc,M.prototype.contains=function(t){return this===t},M.prototype.contains=M.prototype.contains,M.prototype.ka=function(t){if(this.Ha)throw new Xc(this.ka,"Not allowed for a child of a group");M.l.ka.call(this,t)},M.prototype.setParentEventTarget=M.prototype.ka,M.prototype.a=y,M.prototype.ga=function(){return this.a},M.prototype.getProvider=M.prototype.ga,M.prototype.xe=function(t,e){var r,n=this.a;if(r=n!==t){if(e&&(n&&!C(n,N)||t&&!C(t,N)))throw new Xc(e,"Only LocalObjectProvider allows an object transfers");e=this.type!==Pg.GROUP,n&&(this.invalidate(Mg.REMOVE),e&&n.Ia(this)),(this.a=t)&&(e&&t.ea(this),this.za=y,this.invalidate(Mg.ADD))}return r},M.prototype.Pb=function(){return this.za||(this.za=new Lg)},M.prototype.getInvalidations=M.prototype.Pb,M.prototype.wa=function(t){var e,r=this.ga();return(e=!!r)&&r.invalidateObject(this,t),e},M.prototype.invalidate=M.prototype.wa,M.prototype.u=function(){this.Ha&&this.Ha.Ia(this),M.l.u.call(this)},M.prototype.setData=function(t){return this.data=t,this},M.prototype.setData=M.prototype.setData,M.prototype.Sc=function(t){if(t&&!Ca(t))throw new D(M.prototype.Sc,0,"opt_callback must be a function");return t={type:"Feature",properties:Sg(this,t?t(this.data):this.data,!!t),geometry:this.ba().Sc()},this.m&&(t.id=this.m),t},M.prototype.toGeoJSON=M.prototype.Sc,M.prototype.X=function(){return{id:this.N,properties:{min:this.Xj(),max:this.Vj(),zIdx:this.o,sIdx:this.Ti,parent:this.Ha?this.Ha.gb():0,visible:this.Dc(),volatile:this.fg()},type:"Feature"}},M.prototype.forWorkerMessage=M.prototype.X,t("H.map.SpatialStyle",Ug),Ug.prototype.Sb=!0,Ug.prototype.cf=!0,Ug.prototype.bf=!0;var Wg="strokeColor fillColor lineWidth lineCap lineJoin miterLimit lineDash lineDashOffset lineHeadCap lineTailCap".split(" ");Ug.prototype.strokeColor="rgba(0,85,170,.6)",Ug.prototype.strokeColor=Ug.prototype.strokeColor,Ug.prototype.fillColor="rgba(0,85,170,.4)",Ug.prototype.fillColor=Ug.prototype.fillColor,Ug.prototype.lineWidth=2,Ug.prototype.lineWidth=Ug.prototype.lineWidth,Ug.prototype.lineCap="round",Ug.prototype.lineCap=Ug.prototype.lineCap,Ug.prototype.lineJoin="miter",Ug.prototype.lineJoin=Ug.prototype.lineJoin,Ug.prototype.miterLimit=1,Ug.prototype.miterLimit=Ug.prototype.miterLimit,Ug.prototype.po=ff,Ug.prototype.lineDash=Ug.prototype.po,Ug.prototype.lineDashOffset=0,Ug.prototype.lineDashOffset=Ug.prototype.lineDashOffset,Ug.prototype.qo=B,Ug.prototype.lineHeadCap=Ug.prototype.qo,Ug.prototype.ro=B,Ug.prototype.lineTailCap=Ug.prototype.ro;var Vg=Wg.length;Ug.prototype.oa=function(t){var e=this===t;if(!e&&t){for(e=0;e<Vg;e++){var r=Wg[e];if(this[r]!==t[r])break}e=e===Vg}return e},Ug.prototype.equals=Ug.prototype.oa,Ug.prototype.Rj=function(t){if(t){var e={};Wa(e,this,t)}else e=this;return new Ug(e)},Ug.prototype.getCopy=Ug.prototype.Rj;var Yg=oc({}),Xg=[function(t){return t?nc(t):Yg},function(t){return t?nc(t):Yg},function(t){return 0<=t&&100>=t?+t:Yg},function(t){return"butt"===(t=nc(t))||"square"===t||"round"===t||"arrow-head"===t||"arrow-tail"===t?t:Yg},function(t){return"round"===t||"bevel"===t||"miter"===t?t:Yg},function(t){return 0<t&&100>=t?+t:Yg},function(t){return t&&t.every&&t.every(Dc)?t:Yg},function(t){return E(+t)?Yg:+t},function(t){return tc(t)?Xg[3](t):B},function(t){return tc(t)?Xg[3](t):B}];Ug.MAX_LINE_WIDTH=100;var Zg=new Ug;Ug.DEFAULT_STYLE=Zg;var $g="fillColor strokeColor lineWidth lineCap lineJoin miterLimit lineDashOffset lineDash lineTailCap lineHeadCap".split(" ");function ah(t){var e;if(t){var r=C(t,ah);for(e in t)if(e in this){var n=t[e];n!==this[e]&&("fillColor"===e||0<(n=+n))&&(this[e]=n)}(t=r?t.Sb:!!(Xe(this.fillColor)&&this.width&&this.width))||(this.Sb=t)}oc(this)}function bh(t,e){var r;bh.l.constructor.call(this,e),e&&this.rc(e.style),t&&(this.j=!0),e&&(r=e.arrows)&&this.tl(r)}function ch(t,e){var r,n=!1,i=!1;if(e.length){for(n=0;n<e.length;n++)if(e[n]!==dh){i=!0;break}e=t.style,n=i?e.cf||e.Sb&&t.j||(r=t.g||!1)&&e.bf&&r.Sb:e.Sb}return n&&t.Dc(!0)}function eh(t,e){eh.l.constructor.call(this,t,e)}function fh(t,e,r,n){var i,o=[],a=e.length;for(i=0;i<a;i++){var s=e[i];s.length&&o.push(gh(t,s,r,n))}return o}function gh(t,e,r,n){var i,o=[],a=e.length,s=0;for(t.W=0,i=i||0;s<a;)o.push(hh(t,e[s++],e[s++],i,n));return r&&o.push(hh(t,e[0],e[1],i,n)),o}function hh(t,e,r,n,i){var o=t.W;return o&&180<Ad(o-r)&&(r+=0>o?-360:360),t.W=r,i.Sh(e,r+n)}function ih(t,e,r){for(var n,i,o,a=e,s=t.length+e;a--;){for(i=(e=t[a]).length,n=Array(i);i--;)o=e[i],n[i]=new I(o.x+r,o.y);t[--s]=n}}Ug.prototype.X=function(){for(var t,e={},r=$g.length;r--;)e[t=$g[r]]=this[t];return e},Ug.prototype.forWorkerMessage=Ug.prototype.X,t("H.map.ArrowStyle",ah),ah.prototype.Sb=!0,ah.prototype.fillColor="rgba(255,255,255,.75)",ah.prototype.width=1.2,ah.prototype.length=1.6,ah.prototype.frequency=5,ah.prototype.Qj=function(){return new ah(this)},ah.prototype.oa=function(t){var e=this===t;return!e&&t&&(e=t.width===this.width&&t.fillColor===this.fillColor&&t.length===this.length&&t.frequency===this.frequency),e},ah.prototype.equals=ah.prototype.oa,u(bh,M),t("H.map.Spatial",bh),bh.prototype.type=Pg.SPATIAL,bh.prototype.Og=0,bh.prototype.style=Zg,bh.prototype.ua=function(){return this.style},bh.prototype.getStyle=bh.prototype.ua,bh.prototype.rc=function(t){var e=!0;return t?this.style=C(t,Ug)?t:new Ug(t):this.style?delete this.style:e=!1,e&&this.invalidate(Mg.VISUAL),this},bh.prototype.setStyle=bh.prototype.rc,bh.prototype.Cm=function(){return this.g},bh.prototype.getArrows=bh.prototype.Cm,bh.prototype.tl=function(t){var e=this.g,r=!1;return!t&&e?(delete this.g,r=!0):!t||e&&e.oa(t)||(this.g=new ah(t),r=!0),r&&"none"!==this.style.strokeColor&&this.wa(1),this},bh.prototype.setArrows=bh.prototype.tl,bh.prototype.j=!1,bh.prototype.ho=function(){return this.j},bh.prototype.isClosed=bh.prototype.ho,bh.prototype.getGeometriesForTile=bh.prototype.$d,bh.prototype.zh=function(){return y},bh.prototype.getLabels=bh.prototype.zh,u(eh,bh),t("H.map.GeoShape",eh),eh.prototype.getBoundingBox=eh.prototype.G;var jh=new L([0,0,0,0,0,0,0,0,0]),sh;function kh(t){uc(this,kh),kh.l.constructor.call(this),this.pa=lh(this,t,this.constructor,0)}function lh(t,e,r,n){var i,o=[];if(!yc(e))throw new D(r,n);for(i=0;i<e.length;i++){if(!t.a(e[i]))throw new D(r,n);o.push(t.b(e[i]))}return o}function mh(t){mh.l.constructor.call(this,t)}function nh(t,e){nh.l.constructor.call(this,!1,e),this.da(t)}function oh(t,e){if(!C(t,L)||2>t.Ze())throw new D(e,0)}function ph(t,e,r,n){var i=Ig(e,r.bg());if(i.length&&(i=(t=fh(t,i,!1,e=r.dg())).length)){var o=r.af();e=e.w,r.x||ih(t,i,-e),r.x===(1<<r.z)-1&&ih(t,i,e),(r=qh(t,o.left,o.top,o.right,o.bottom,!1)).length&&n.push(new rh(r))}}function th(t,e){if(x.URL)return new x.URL(t,e).toString();if(!t||!uh(t))return t;if(!e||uh(e))throw new TypeError("Failed to construct 'URL': Invalid base URL");sh||Fc(sh=document.createElement("a"));var r=sh;return r.href=e,"/"!==t[0]?t=r.href.replace(/\/[^\/]*$/,"/")+t:((e=r.origin)||(e=r.protocol+"//"+r.host),t=e+t),t}function uh(t){var e=!1;return"string"==typeof t&&(e=!(-1<t.search(/^(http|https|data|blob):/)||"//"===t.substr(0,2))),e}function vh(t,e){var r,n,i,o=arguments.length;for(r=1;r<o;r++)if((n=arguments[r])&&n!==t&&n!==a){var a=n;for(i in n){var s=n[i];t[i]!==s&&(wh(s)?wh(t[i])?t[i]=vh(t[i],s):t[i]=qc(s):void 0!==s&&(t[i]=qc(s)))}}return t}u(kh,Vf),t("H.geo.MultiGeometry",kh),kh.prototype.splice=function(t,e,r){return t=[t],e!==B&&t.push(e),r&&(e=lh(this,r,this.splice,2),t=t.concat(e)),this.R=y,this.pa.splice.apply(this.pa,t)},kh.prototype.splice=kh.prototype.splice,kh.prototype.pc=function(t){var e=this.pa.length;if(!(0<=t&&t<e))throw new je(this.pc,t,[0,e-1]);return this.R=y,this.pa.splice(t,1)[0]},kh.prototype.removeAt=kh.prototype.pc,kh.prototype.remove=function(t){if(0<=(t=this.pa.indexOf(t))){var e=this.pa.splice(t,1)[0];this.R=y}return e||y},kh.prototype.remove=kh.prototype.remove,kh.prototype.$m=function(){return this.pa},kh.prototype.getGeometries=kh.prototype.$m,kh.prototype.push=function(t){var e=lh(this,[t],this.push,0)[0];this.R&&(this.R=this.R.nc(t.G())),this.pa.push(e)},kh.prototype.push=kh.prototype.push,kh.prototype.G=function(){var t,e,r;if(!(t=this.R)&&(t=y,this.pa.length))for(t=this.pa[0].G(),r=1;r<this.pa.length;r++)(e=this.pa[r].G())&&(t=t?t.nc(e):e);return this.R=t},kh.prototype.getBoundingBox=kh.prototype.G,kh.prototype.R=y,kh.prototype.b=function(t){return t},kh.prototype.oa=function(t){var e,r=this===t;if(!r&&(r=C(t,this.constructor))){var n=this.pa;for(t=t.pa,r=(e=n.length)===t.length;r&&e--;)r=n[e].oa(t[e])}return r},kh.prototype.equals=kh.prototype.oa,n=kh.prototype,n.Tc=function(t){var e,r,n=this.pa,i=n.length,o=!1;if(i){for(t.push("("),e=0;e<i;e++)(r=0<e&&o)&&t.push(","),n[e].Tc(t),"EMPTY"===t[t.length-1]?t.splice(-1-r,1+r):o=!0;o?t.push(")"):t.splice(-1,1,"EMPTY")}else t.push("EMPTY");return t},n.toString=function(){return this.Tc([this.rb.toUpperCase()," "]).join("")},n.yc=function(){for(var t=[],e=this.pa,r=e.length;r--;)t[r]=e[r].yc();return t},n.X=function(){var t=kh.l.X.call(this);return t.type=this.rb,t},n.md=function(){for(var t=[],e=this.pa,r=e.length;r--;)t[r]=e[r].md();return t},u(mh,kh),t("H.geo.MultiLineString",mh),mh.prototype.a=function(t){return C(t,L)},mh.prototype.rb="Multi"+L.prototype.rb,mh.prototype.Mb="Multi"+L.prototype.Mb,u(nh,eh),t("H.map.Polyline",nh),nh.prototype.G=function(){return this.eb.G()},nh.prototype.getBoundingBox=nh.prototype.G,nh.prototype.eb=y,nh.prototype.da=function(t){var e,r,n=this.da;if(C(t,mh)){var i=t.pa;if(!(e=i.length))throw new D(n,0);for(r=0;r<e;r++)oh(i[r],n)}else oh(t,n);return this.zd=!!i,this.eb=t,this.wa(Mg.SPATIAL),this},nh.prototype.setGeometry=nh.prototype.da,nh.prototype.ba=function(){return this.eb},nh.prototype.getGeometry=nh.prototype.ba,nh.prototype.clip=function(t){var e=this.eb;return Ig(this.zd?e.pa[0]:e,t)},nh.prototype.clip=nh.prototype.clip,nh.prototype.$d=function(t){var e,r=this.eb,n=[];if(this.zd)for(e=(r=r.pa).length;e--;)ph(this,r[e],t,n);else ph(this,r,t,n);return n.length?n:B},nh.prototype.getGeometriesForTile=nh.prototype.$d,nh.prototype.X=function(){var t=nh.l.X.call(this),e=t.properties;return t.geometry=this.ba().X(),e.style=this.ua().X(),e.height=0,t},nh.prototype.forWorkerMessage=nh.prototype.X,t("H.util.webgl.mergeObjects",vh);var xh=mc();function yh(t,e,r){var n=r[t];return e&&n in e&&0>sc.indexOf(n)?(e=e[n],++t<r.length?yh(t,e,r):e):xh}var zh=yh.bind(null,0),Ah={polygons:1,lines:1,"pattern-lines":1,points:1,text:1,raster:1,custom_icons:1,overlays:1},Bh={data:1,draw:1,enabled:1,filter:1,properties:1},Ch=Object.keys(Bh);function Dh(t,e,r,n,i,o){var a=n[t],s=r[a];if(++t<n.length){var u=e[a]||{};for(r=Ch.length;r--;){var l=Ch[r];if("draw"!==l||!o){var c=s[l];c!==B&&(u[l]=qc(c))}}Dh(t,u,s,n,i,o)}else i?u=qc(s):(u=s,delete r[a]);e[a]=e[a]?vh(e[a],u):u}var Eh=Dh.bind(null,0);function Fh(t,e){t in Ah&&(e[t]=1)}function Gh(t,e,r){var n,i,o;for(n in t)if(Bh[n]){if("draw"===n){var a=t[n];for(i in a){var s=a[i];(o=s.style)?(s.style=e+o,Fh(o,r)):(delete a[i],a[e+i]=s,Fh(i,r))}}}else Gh(t[n],e,r)}function Hh(t,e){var r,n,i,o,a={};if(e+="_",r=(t=vh({},t)).styles)for(n in r){var s=r[n];if(delete r[n],r[e+n]=s,i=s.mix)for(zc(i)&&(i=[i]),o=i.length;o--;)Fh(i[o],a),i[o]=e+i[o];(o=s.base)&&(i||(i=s.mix=[]),i.unshift(e+o),delete s.base,Fh(o,a)),Fh(n,a)}else r=t.styles={};if(s=t.layers)for(n in s)i=s[n],delete s[n],(o=i.data)&&!o.layer&&(o.layer=n),s[e+n]=i,Gh(i,e,a);for(n in a)r[e+n]={base:n};return t}function Ih(t,e){var r,n=t.sources,i=Object.keys(n)[0],o=vh(n[i],{uid:e});for(r in n=t.layers,t.sources={},t.sources[e]=o,n)(t=n[r]).data?t.data.source===i&&(t.data.source=e):t.data={source:e}}function Jh(t,e){var r,n=t.textures,i=t.fonts;for(r in n){var o=n[r];o.url&&(o.url=th(o.url,e))}for(r in i)if(yc(n=i[r]))for(o=0;o<n.length;o++){var a=n[o];a.url=a.url&&th(a.url,e)}else(a=t.fonts[r]).url=a.url&&th(a.url,e)}function Kh(t,e){return"function(){return feature."+t+(e||"")+";}"}function Lh(t){return Kh("style."+t,void 0)}function Mh(t,e,r,n){return t={base:t,blend:e,blend_order:r},n&&(t.clean_depth=!!n),t}function Nh(t){var e={};return e["translucent-"+(t?"extruded-":"")+"polygons"]={color:Lh("fillColor"),order:1,interactive:!0,extrude:t},e}function Oh(t,e,r,n){return t={data:{source:t,layer:e}},r&&(t.draw=r),n&&(t.filter=n),t}function wh(t){return Da(t)&&!yc(t)}function Ph(t,e){if(Ph.l.constructor.call(this),e&&uh(e))throw new D(Ph,1,"Base URL must be absolute");this.A=Qh.INIT,this.a=null,this.c=e}u(Ph,F),t("H.map.render.Style",Ph),Ph.prototype.load=Ph.prototype.load,Ph.prototype.getState=function(){return this.A},Ph.prototype.getState=Ph.prototype.getState,Ph.prototype.P=function(t){this.A=t},Ph.prototype.setState=Ph.prototype.P,Ph.prototype.hc=function(){return this.c},Ph.prototype.getBaseUrl=Ph.prototype.hc,Ph.prototype.vd=function(){return qc(this.a)},Ph.prototype.getConfig=Ph.prototype.vd,Ph.prototype.Jm=function(){return this.a},Ph.prototype.getConfigReference=Ph.prototype.Jm,Ph.prototype.Ld=function(t){this.a=t},Ph.prototype.setConfig=Ph.prototype.Ld,Ph.prototype.Lb=function(t){this.a=null,this.P(Qh.ERROR);var e=Rh;se(this.aa,void 0!==e?String(e):void 0)?this.dispatchEvent(new td(Rh,t,this)):console.error(t)},Ph.prototype.dispatchError=Ph.prototype.Lb,Ph.prototype.u=function(){Ph.l.u.call(this),this.a=null};var Rh="error",Sh={nd:"change",hj:Rh},Qh={ERROR:-1,INIT:0,LOADING:1,READY:2};function Th(t,e){if(Th.l.constructor.call(this,t,e),zc(t))Uh.test(t)&&-1===t.indexOf("import:")?(this.f=t,e||(this.j=uh(this.f)?B:this.f)):this.g=t;else{if(!Da(t))throw new D(Th,0,Vh);this.Ld(qc(t))}}function ai(t){var e,r=t.a;if(Da(r)){var n;if(n=t.i){for(var i in n=!1,r=r&&r.sources)if(r[i].type===t.i){n=!0;break}n=!(!r||n)}n&&(e="invalid source, the only valid type is "+t.i)}else e=Vh;return e&&t.Lb(e),!e}function Zh(t){t.dispatchEvent(new rd("change",t))}function Xh(t){if(t.getState()!==Qh.READY)throw new Xc(t.hf,"style is not ready yet")}function Yh(t,e,r,n){var i,o,a=[],s=yc(e)?e:[e];for(void 0===n&&(n=!0),s=s.sort().reverse();i=s.pop();){e=String(i).split(".");for(var u=t.a,l=e.length;l--&&!Bh[e[l]];);if(u&&0>l&&wh(u=zh(u.layers,e))||(u=xh),u===xh)throw new D(r,0,'Unresolvable layer ID "'+i+'"');if(a.push({id:e,hb:u}),n)for(o in u)!Bh[o]&&wh(u[o])&&s.push(i+"."+o)}return a}function $h(t,e){var r,n=0;for(r=e.length;n!==r;){var i=e[n++],o=t;if(!(t=o[i]))break}return n===r?{node:t,parent:o,wg:i}:void 0}Ph.State=Qh,u(Th,Ph),t("H.map.render.webgl.Style",Th),Th.prototype.load=function(){var t=this,e=this.hc();this.f?(this.P(Qh.LOADING),new rf("text/plain",this.f).then(function(t){var r={};return Wh(t,e,!1,(r[e]=!0,r))}).then(function(e){return t.Ld(e)},function(e){return t.Lb(e.message)}),this.f=null):this.g&&(this.P(Qh.LOADING),Wh(this.g,e).then(function(e){return t.Ld(e)},function(e){return t.Lb(e.message)}),this.g=null)},Th.prototype.zl=function(t,e,r){var n;for(Xh(this),t=Yh(this,t,this.zl,r),r=0;r<t.length;r++){var i=t[r].hb.draw;for(n in i){var o=i[n];wh(o)&&(o.interactive=!!e)}}Zh(this)},Th.prototype.setInteractive=Th.prototype.zl,Th.prototype.setProperty=function(t,e,r){var n,i=t.split("."),o=0,a=i.length;if(Xh(this),!tc(e))throw new D(this.setProperty,1,"value");if(n=$h(this.a,i)){if(!(n.parent instanceof Object)||n.parent instanceof Array){if(!r)throw new D(this.setProperty,0,t+" property is not primitive type");i.pop(),i=$h(this.a,i),n.parent=i.parent[i.wg]={}}n.parent[n.wg]=e}else{for(n=this.a;o!==a-1;)n[i[o]]={},n=n[i[o++]];n[i[o]]=e}ai(this)&&Zh(this)},Th.prototype.setProperty=Th.prototype.setProperty,Th.prototype.Eh=function(t){return Xh(this),(t=$h(this.a,t.split(".")))?qc(t.node):void 0},Th.prototype.getProperty=Th.prototype.Eh,Th.prototype.removeProperty=function(t){Xh(this),(t=$h(this.a,t.split(".")))&&t.parent&&t.parent.hasOwnProperty(t.wg)&&(delete t.parent[t.wg],ai(this)&&Zh(this))},Th.prototype.removeProperty=Th.prototype.removeProperty,Th.prototype.Pe=function(t,e,r){var n;Xh(this);var i=this.a,o=i.layers,a=Yh(this,t,this.Pe,!1);for(t=a.length,n={};t--;)Eh(n,o,a[t].id,!!e,!!r);for(r={},t=(a=Object.keys(i)).length;t--;){var s=a[t],u=i[s];r[s]=u===o?n:qc(u)}return e||Zh(this),r},Th.prototype.extractConfig=Th.prototype.Pe,Th.prototype.hf=function(t){if(Xh(this),!Da(t))throw new D(this.hf,0,"config");this.Ld(vh(this.a,t))},Th.prototype.mergeConfig=Th.prototype.hf,Th.prototype.b=ba(2),Th.prototype.toString=function(){return this.getState()===Qh.READY?x.H.gl.yaml.safeDump(this.a,{lineWidth:120}):""},Th.prototype.u=function(){Th.l.u.call(this),this.g=this.f=null};var Uh=/^(http[s]?)?.*\.ya?ml/i,Vh="invalid style configuration";function Wh(t,e,r,n){r=void 0!==r&&r,n=void 0===n?{}:n;try{var i=x.H.gl.yaml.safeLoad(t,{json:!0})}catch(t){return Promise.reject(t)}return i&&(zc(t=i.import)&&(t=[t]),r&&e&&bi(i,e),delete i.import,yc(t)&&t.length)?(r=t.reduce(function(t,r){var i=e?th(r,e):r;return n[i]||(n[i]=!0,t.push(new rf("text/plain",i).then(function(t){return Wh(t,i,!0,n)}))),t},[]),Promise.all(r).then(function(t){var e={};return t.forEach(function(t){return t&&vh(e,t)}),vh(e,i),e})):Promise.resolve(i)}function bi(t,e){function r(t){t.url&&(t.url=th(t.url,e))}var n=t&&t.fonts;if(n)for(var i in n)yc(n[i])?n[i].forEach(r):r(n[i]);if(t=t&&t.textures)for(var o in t)r(t[o])}function qh(t,e,r,n,i,o){var a,s,u,l,c=t.length;if(c)for(a=[];c--;){var h=t[c],f=h.length,p=0;for(u=1;u<f;u++)if(l=ci(h[u-1],h[u],r,e,n,i)){var d=l[0],v=l[1];p&&p.oa(d)?s.push(v):a.push(s=l),p=v,o&&(u=f,c=0)}}else a=t;return a}function ci(t,e,r,n,i,o){var a=t.x;t=-t.y;var s=e.x;if(e=-e.y,r=-r,o=-o,a>s){if(s>i||a<n)return;var u=a,l=t;a=s,t=e,s=u,e=l,u=1}else if(a>i||s<n)return;if(t>e){if(e>r||t<o)return;var c=1;t=-t,e=-e,l=o,o=-r,r=-l}else if(t>r||e<o)return;if(a<n){if((t+=(n-a)*(e-t)/(s-a))>r)return;a=n}if(t<o){if((a+=(o-t)*(s-a)/(e-t))>i)return;t=o}return s>i&&(e=t+(i-a)*(e-t)/(s-a),s=i),e>r&&(s=a+(r-t)*(s-a)/(e-t),e=r),c&&(t=-t,e=-e),u?[new I(s,-e),new I(a,-t)]:[new I(a,-t),new I(s,-e)]}function di(t,e,r){var n,i;t=ei(t,!0),e=ei(e,!1);var o={},a=n=1;switch(~~(r||0)){case 1:a=n=0;break;case 2:n=0,a=1;break;case 3:n=1,a=0}r=n;var s=a;if(e&&t){for(e.Qf=fi(e.x,e.y,null,gi(e)),t.Qf=fi(t.x,t.y,null,gi(t)),a=e;a.next;a=a.next)if(!a.ab)for(n=t;n.next;n=n.next)if(!n.ab){var u=hi(a.next),l=hi(n.next);if(i=ii(a,u,n,l,o)){i=o.dm;var c=o.em,h=o.rp,f=o.sp;ji(i=fi(h,f,null,null,null,null,!0,0,0,i),a,u),ji(u=fi(h,f,null,null,null,null,!0,0,0,c),n,l),i.ki=u,u.ki=i}}for(o=ce(e,ki(t)),r&&(o=!o),a=e;a;a=a.next)a.ab&&(a.oh=o,o=!o);for(o=ce(t,ki(e)),s&&(o=!o),n=t;n.next;n=n.next)n.ab&&(n.oh=o,o=!o);for(li(e),li(t);(t=mi(e))!=e;){for(r=null;!t.Mg;t=t.ki){for(o=t.oh;(r=fi(t.x,t.y,r)).artificial=t.ab||t.fo,t.Mg=1,t=o?t.next:t.Ub;)if(t.ab){t.Mg=1;break}if(!t)break}r.li=p;var p=r}return p}}function fi(t,e,r,n,i,o,a,s,u,l){return t={x:t,y:e,next:r||null,Ub:n||null,li:i||null,ki:o||null,ab:!!a,oh:s||0,Mg:u||0,alpha:l||0},n&&(t.Ub.next=t),r&&(t.next.Ub=t),t}function hi(t){for(;t&&t.ab;)t=t.next;return t}function gi(t){if(t)for(;t.next;)t=t.next;return t}function mi(t){var e=t;if(e)do{e=e.next}while(e!=t&&(!e.ab||e.ab&&e.Mg));return e}function li(t){var e=gi(t);e.Ub.next=t,t.Ub=e.Ub}function ii(t,e,r,n,i,o){var a,s=e.x-t.x,u=e.y-t.y,l=n.x-r.x,c=n.y-r.y,h=s*c-u*l;return h?(l=((r.x-t.x)*c-(r.y-t.y)*l)/h,h=(u*(r.x-t.x)-s*(r.y-t.y))/h,0>l||1<l||0>h||1<h?0:(0===l?a=t:1===l?a=e:0===h?a=r:1===h&&(a=n),a&&!o?(a.x+=2480549651603763e-20,a.y+=7321997314118067e-20,a.Qf&&(a.Qf.x=a.x,a.Qf.y=a.y),ii(t,e,r,n,i)):(i.rp=t.x+l*s,i.sp=t.y+l*u,i.dm=l,i.em=h,1))):0}function ki(t){for(var e=[];t;)e.push(t.x,t.y),t=t.next;return e}function ji(t,e,r){for(e=e.next;e!==r&&e.alpha<=t.alpha;)e=e.next;t.next=e,t.Ub=e.Ub,t.next.Ub=t,t.Ub.next=t}function ei(t,e){for(var r,n=null,i=0,o=t.length;i<o;i++)(r=fi(t[i].x,t[i].y,n)).fo=e,(r.next=n)&&(n.Ub=r),n=r;return n}function O(t,e){var r;if(O.l.constructor.call(this),C(t,L,O,0),e!==B&&yc(e,O,1)){for(r=0;r<e.length;r++)C(e[r],L,O,1,"index "+r);this.Pa=e}else this.Pa=[];this.cb=t,this.a=[]}function ni(t){var e=O,r=L,n=t.la,i=t.ca,o=t.na,a=t.ia;return i=[n,i,B,n,a,B,o,a,B,o,i,B],180<=t.Fb()&&(i.splice(9,0,o,t=t.fb().lng,B),i.splice(3,0,n,t,B)),new e(new r(i))}Th.normalize=bi,Th.prototype.Ld=function(t){Th.l.Ld.call(this,t),ai(this)&&(this.P(Qh.READY),Zh(this))},Th.prototype.vd=function(){return Th.l.vd.call(this)},Th.prototype.hc=function(){return this.j||Th.l.hc.call(this)},t("H.map.Style",Th),Th.State=Qh,t("H.math.clipping.clipStrips",qh),t("H.math.clipping.clipPolygon",di),u(O,Vf),t("H.geo.Polygon",O),O.fromRect=ni;var oi={NORTH:90,SOUTH:-90};function pi(t,e){var r,n,i;return(i=t.G())&&((r=t.wh(!0))&&(n=t.Ze())&&(i=i.nc(eg([t.Qe(0),t.Qe(n-1)],!0),!0)),360===i.Fb()&&1==r%2&&(i=i.gd(e,0))),i}function qi(t,e,r,n){n=void 0===n||n;var i=t.Pa,o=ri.bind(null,e,r);return be(e,r,t.cb.Y,0,!0,3)!==ae.NONE&&(!n||!i.some(o))}function ri(t,e,r){return be(t,e,r.Y,0,!0,3)===ae.SURFACE}function si(t,e){e=e.Y,t=t.cb.Y;var r,n,i=e.length-3,o=t.length-3,a={};for(r=0;r<i;r+=3){var s=e[r],u=e[r+1],l=e[r+3],c=e[r+4];for(n=0;n<o;n+=3){var h=t[n],f=t[n+1],p=t[n+3];if(ii({x:u,y:s},{x:c,y:l},{x:f,y:h},{x:t[n+4],y:p},a,!0))return!0}}return!1}function ti(t,e){var r=e.cb,n=e.Pa,i=n.length,o=r.Y,a=o.length,s=t.cb.Y,u=s.length;if(si(t,r))return!0;for(r=0;r<a;r+=3)if(qi(t,o[r],o[r+1]))return!0;for(r=0;r<u;r+=3)if(qi(e,s[r],s[r+1]))return!0;for(r=0;r<i;r++)if(si(t,n[r]))return!0;return!1}function ui(t){ui.l.constructor.call(this,t)}function rh(t,e,r){this.paths=this.a=t,e!==B&&(this.interiorsIndex=this.b=e),r!==B&&(this.outlinesIndex=this.c=r)}O.Direction=oi,O.prototype.Cd=oi.NORTH,O.prototype.Al=function(t){return this.Cd!==t&&(this.R=y,this.a.length=0,this.Cd=t),this},O.prototype.setPoleCovering=O.prototype.Al,O.prototype.xn=function(){return this.Cd},O.prototype.getPoleCovering=O.prototype.xn,O.prototype.Um=function(){return this.cb},O.prototype.getExterior=O.prototype.Um,O.prototype.xl=function(t){if(!C(t,L))throw new D(this.xl,0,t);this.cb=t,this.R=y},O.prototype.setExterior=O.prototype.xl,O.prototype.en=function(){return this.Pa},O.prototype.getInteriors=O.prototype.en,O.prototype.Lg=function(t,e,r){var n,i=arguments.length;for(n=2;n<i;n++)C(arguments[n],L,this.Lg,n);var o=this.Pa.splice.apply(this.Pa,arguments);for(n=2;n<i;n++)arguments[n]=B;return this.a.splice.apply(this.a,arguments),o},O.prototype.spliceInteriors=O.prototype.Lg,O.prototype.Vo=function(t){return this.Lg(t,1)[0]},O.prototype.removeInteriorAt=O.prototype.Vo,O.prototype.Uo=function(t){return 0>(t=this.Pa.indexOf(t))?B:this.Lg(t,1)[0]},O.prototype.removeInterior=O.prototype.Uo,O.prototype.el=function(t){if(!C(t,L))throw new D(this.el,0,t);this.Pa.push(t)},O.prototype.pushInterior=O.prototype.el,O.prototype.G=function(){var t=this.R;return t||(this.R=t=pi(this.cb,this.Cd)),t},O.prototype.getBoundingBox=O.prototype.G,n=O.prototype,n.Pj=function(t){var e=this.Pa.length;if(0>t||t>=e)throw new je(this.Pj,t,[0,e-1]);return(e=this.a[t])||(this.a[t]=e=pi(this.Pa[t],this.Cd)),e},n.cb=y,n.Pa=[],n.rb="Polygon",n.Tc=function(t){var e,r=this.Pa,n=r.length;if(this.cb.Ze()){for(t.push("("),this.cb.Tc(t,!0),e=0;e<n;e++)r[e].Ze()&&(t.push(","),r[e].Tc(t,!0));t.push(")")}else t.push("EMPTY");return t},n.Mb="Polygon",n.md=function(){var t,e=[],r=this.Pa,n=this.cb.md();for(n[0].toString()!==n[n.length-1].toString()&&n.push(n[0]),e.push(n),t=0;t<r.length;t++)(n=r[t].md())[0].toString()!==n[n.length-1].toString()&&n.push(n[0]),e.push(n);return e},n.X=function(){var t=O.l.X.call(this);return this.G().Gb()&&(t.type="Multi"+t.type),t},n.yc=function(){var t=[],e=this.Pa,r=e.length;for(t.push(this.cb.yc());r--;)t[r+1]=e[r].yc();return this.G().Gb()?[t]:t},n.oa=function(t){var e=!1;if(C(t,O)){var r=t.Pa,n=this.Pa.length;e=r.length;var i=0;for(e=this.cb.oa(t.cb)&&n===e;e&&i<n;)e=e&&this.Pa[i].oa(r[i]),i++}return e},u(ui,kh),t("H.geo.MultiPolygon",ui),ui.prototype.a=function(t){return C(t,O)},ui.prototype.rb="Multi"+O.prototype.rb,ui.prototype.Mb="Multi"+O.prototype.Mb,rh.prototype.interiorsIndex=rh.prototype.b=Td,rh.prototype.outlinesIndex=rh.prototype.c=Td;var dh=pc(new rh([])),vi=oc([]);function wi(t,e){var r=e&&(+e.extrusion||+e.extrude),n=e&&+e.elevation,i=0;if(wi.l.constructor.call(this,!0,e),0<n&&(i+=n,this.f=n),0<r&&(i+=r,this.i=r),i>xi)throw new je(wi,i,[0,xi]);C(t,L)?this.da(new O(t)):this.da(t)}u(wi,eh),t("H.map.Polygon",wi),wi.prototype.i=0,wi.prototype.f=0,wi.prototype.eb=y;var xi=2047;function zi(t,e,r,n){var i,o,a=0,s=!0;if(i=Ai(t,e.cb,r,n,e.G())){var u=new rh(i),l=e.Pa;if(o=l.length)for(u.b=u.a.length;a<o;a++)(i=Ai(t,l[a],r,n,e.Pj(a)))&&(u.a=u.a.concat(i));for(o=u.a.length,a=0;a<o;a++)if(u.a[a]!==vi){s=!1;break}s&&(u=a%2?dh:B)}return u}function Ai(t,e,r,n,i){var o,a=r.af(),s=i,u=s.Fb(),l=[[]],c=e.Y,h=[],f=c.length,p=!1;for(o=0;o<f;o+=3){var d=c[o],v=c[o+1];p||180!=Ad(v)||(h.push(d),h.push(v),h.push(d),h.push(-v),p=!0),h.push(d),h.push(v)}if(c=h,360>u&&-180==s.ca&&(s=new K(s.la,180,s.na,s.ia)),360>u&&180==s.ia&&(s=new K(s.la,s.ca,s.na,-180)),s.Gb()){for(d=(u=c).length,c=-1,h=0;h<d-2;h+=2)if(Uf(u[h+1],u[h+3])){c=h+2;break}-1===c&&Uf(u[d-1],u[1])&&(c=d),-1!==c&&(f=u[c-2],h=u[c-1],o=u[c%d],p=u[(c+1)%d],180!==Ad(f)&&180!==Ad(o)&&(v=Ad(o-f),d=Ad(p-h),d+=180<d?-360:0,p=Ad(180-p),p+=180<p?-360:0,d&&p&&(v/=Ad(d)/Ad(p),f=o+(o>f?-v:v),h=0<h?180:-180,u.splice(c,0,f,h,f,-h)))),c=u}if(l[0]=Bi([].concat(c),s.ca),360>s.Fb()&&s.pd(new Wf(s.la,180))&&(c=Bi([].concat(c),s.ia),l.push(c)),t=fh(t,l,!0,s=r.dg()),360===i.Fb()&&1==e.wh(!0)%2){for(e=t,t=r.af(),e[0][1].x>e[0][e[0].length-1].x&&(e[0]=e[0].reverse()),c=[],u=e[0].length-1,l=0;l<u;l++)h=e[0][l],c[l]=new I(h.x-2*s.w,h.y),c[l+u]=new I(h.x-s.w,h.y),c[l+2*u]=new I(h.x,h.y),c[l+3*u]=new I(h.x+s.w,h.y),c[l+4*u]=new I(h.x+2*s.w,h.y);e[0]=c,(l=s.Sh(n,0)).y=2*t[n===oi.NORTH?"top":"bottom"],n=l.clone(),l.x=e[0][e[0].length-1].x+1,n.x=e[0][0].x-1,e[0].push(l,n),t=e}if(qh(t,n=a.left,e=a.top,l=a.right,a=a.bottom,!0).length){if(!r.bg().hh(i)){for(r=t,i=[new I(n,e),new I(l,e),new I(l,a),new I(n,a)],a=[],t=r.length;t--;)if(n=di(i,r[t]))for(e=Ci(n),a.push(e);n.li;)e=Ci(n=n.li),a.push(e);t=a}}else r=Di(n,e,t[0]),t[1]&&(r^=Di(n,e,t[1])),t=r?[vi]:B;return t}function Di(t,e,r){var n,i,o,a=n=r[0].x,s=i=r[0].y,u=1;for(o=r.length;u<o;u++){var l=r[u].x,c=r[u].y;l>n?n=l:l<a&&(a=l),c>i?i=c:c<s&&(s=c)}return a<=t&&t<=n&&s<=e&&e<=i&&ce({x:t,y:e},de(r.concat(r[0])))}function Ci(t){var e=[],r=t;do{var n=xd(100*(r.Mo?r.Mo:r.x))/100,i=xd(100*(r.No?r.No:r.y))/100;if(!o||.01<Cd(Dd(o.x-n,2)+Dd(o.y-i,2))){var o=new I(n,i);e.push(o)}r=r.next}while(r&&r!==t);return e}function Bi(t,e){var r,n=Number.POSITIVE_INFINITY,i=-1,o=t.length;for(r=0;r<o;r+=2){var a=Ad(t[r+1]-e);(a+=180<a?360-a:a)<n&&(n=a,i=r)}return 0<r?(e=t.splice(i,t.length-i)).concat(t):t}function Ei(t,e,r){Ei.l.constructor.call(this,jh,r),this.Hg(t),this.Pi(e),r&&"precision"in r&&this.Ni(r.precision)}function Fi(t){t.eb!==y&&Ei.l.da.call(t,Gi(t))}function Gi(t){var e=t.b,r=e.lat,n=t.fa,i=0,o=new L;if(90===Ad(r))for(r=e.Ng(0,n,!0).lat;360>i;i+=120)o.zi(r,i-180,B);else for(t=360/(t=t.O);360>i;i+=t)o.Fd(e.Ng(i,n,!0));return e=new O(o),0>r&&e.Al(oi.SOUTH),e}function Hi(t,e){if(!C(t,Element)){if(Ii.innerHTML=t,!(t=Ii.firstElementChild))throw new D(Hi,0,"No element data");Ii.removeChild(t);var r=!0;Ii.innerHTML=""}this.a=0!==hf(t).length,this.c=r?t:jf(t,x.document,this.a),e&&((r="onAttach")in e&&wc(t=e[r],"Function",Hi,1,r)&&(this.mi=t),(r="onDetach")in e&&wc(t=e[r],"Function",Hi,1,r)&&(this.b=t))}wi.MAX_EXTRUDE_HEIGHT=xi,wi.prototype.Gi=function(t){var e=+t;if(e!==t)throw new D(this.Gi,0,t);if(0>e||this.f+e>xi)throw new je(this.Gi,this.f+e,[0,xi]);this.i=e,this.wa(Mg.SPATIAL)},wi.prototype.setExtrusion=wi.prototype.Gi,wi.prototype.Vm=function(){return this.i},wi.prototype.getExtrusion=wi.prototype.Vm,wi.prototype.Fi=function(t){var e=+t;if(e!==t)throw new D(this.Fi,0,t);if(0>e||this.i+e>xi)throw new je(this.Fi,this.i+e,[0,xi]);this.f=e,this.wa(Mg.SPATIAL)},wi.prototype.setElevation=wi.prototype.Fi,wi.prototype.Sm=function(){return this.f},wi.prototype.getElevation=wi.prototype.Sm,wi.prototype.ba=function(){return this.eb},wi.prototype.getGeometry=wi.prototype.ba,wi.prototype.da=function(t){if(t===y||C(t,O))var e=!1;else C(t,ui,this.da,0),e=!0;return this.zd=e,e=this.eb,this.eb=t,e!==y&&this.wa(Mg.SPATIAL),this},wi.prototype.setGeometry=wi.prototype.da,wi.prototype.G=function(){return this.ba().G()},wi.prototype.getBoundingBox=wi.prototype.G,wi.prototype.$d=function(t){var e,r,n,i=this.ba();if(this.zd){var o=0;for(n=(i=i.pa).length;o<n;o++)(r=zi(this,i[o],t,i[o].Cd))&&(e||(e=[]),e.push(r))}else(r=this.Xa)===B&&(r=this.zd?oi.NORTH:this.ba().Cd),(r=zi(this,i,t,r))&&(e=[r]);return e},wi.prototype.getGeometriesForTile=wi.prototype.$d,wi.prototype.U=y,wi.prototype.X=function(){var t,e=wi.l.X.call(this),r=this.ba(),n=this.zd?r.pa:[r],i=e.properties,o=e.geometry=r.X();if(i.style=this.ua().X(),i.height=this.i+this.f,i.min_height=this.f,this.G().Gb()&&(o.type="MultiPolygon",this.zd)){var a=[];n.forEach(function(e,r){t=o.coordinates[r],e.G().Gb()?a=a.concat(t):a.push(t)}),o.coordinates=a}return e},wi.prototype.forWorkerMessage=wi.prototype.X,u(Ei,wi),t("H.map.Circle",Ei),Ei.prototype.Hg=function(t){(t=Zf(t)).oa(this.b)||(this.b=t,Fi(this))},Ei.prototype.setCenter=Ei.prototype.Hg,Ei.prototype.fb=function(){return this.b},Ei.prototype.getCenter=Ei.prototype.fb,Ei.prototype.Pi=function(t){if(E(t=Yd(t,0,6371000.79*Md/2)))throw new D(this.Pi,0,t);this.fa!==t&&(this.fa=t,Fi(this))},Ei.prototype.setRadius=Ei.prototype.Pi,Ei.prototype.Cn=function(){return this.fa},Ei.prototype.getRadius=Ei.prototype.Cn,Ei.prototype.O=60,Ei.prototype.Ni=function(t){if(!Cc(t))throw new D(this.Ni,0,t);this.O!==(t=Yd(xd(t),4,360))&&(this.O=t,Fi(this))},Ei.prototype.setPrecision=Ei.prototype.Ni,Ei.prototype.zn=function(){return this.O},Ei.prototype.getPrecision=Ei.prototype.zn,Ei.prototype.da=function(){return this},Ei.prototype.setGeometry=Ei.prototype.da,Ei.prototype.ba=function(){return this.eb||Ei.l.da.call(this,Gi(this)),this.eb},Ei.prototype.getGeometry=Ei.prototype.ba,t("H.map.DomIcon",Hi);var Ii=document.createElement("DIV");function Ji(t){Ji.l.constructor.call(this,t)}function Ki(t,e){this.w=+t,this.h=+e}function Li(t,e){var r,n=t,i=e||[];if(t!==Mi.NONE){if(e=r=i.length,-1===this.b.indexOf(n))throw new D(Li,0,t);if(!i)throw new D(Li,1,i);for(;r--;)if(E(i[r]))throw new D(Li,1,i);if(n===Mi.RECT&&3<e&&(i=[i[0],i[1],i[2],i[1],i[2],i[3],i[0],i[3]],n=Mi.POLYGON),n===Mi.CIRCLE&&2<e&&0<(t=i[2])){n=i[0];var o=i[1],a=360/(r=vd(2*zd(t),40));for(i=[];r--;){var s=a*r*Rd;i.push(n+Fd(s)*t,o+Hd(s)*t)}n=Mi.POLYGON}if(n!==Mi.POLYGON||!e||i.length%2)throw new D(Li,1,i);this.a=i}}Hi.prototype.mi=null,Hi.prototype.b=null,Hi.prototype.Qj=function(t){return jf(this.c,t,this.a)},Hi.prototype.a=!1,u(Ji,kh),t("H.geo.MultiPoint",Ji),Ji.prototype.a=function(t){return Yf(t)},Ji.prototype.b=function(t){return C(t,Wf)?t:Zf(t)},Ji.prototype.rb="Multi"+Wf.prototype.rb,Ji.prototype.Mb="Multi"+Wf.prototype.Mb,t("H.math.Size",Ki),t("H.map.HitArea",Li);var Mi={NONE:0,RECT:1,CIRCLE:2,POLYGON:3};function Ni(t,e){var r;uc(this,Ni),Ni.l.constructor.call(this,e),this.da(t),e&&"icon"in e&&(r=e.icon),this.Pc(r||Oi(this))}function Oi(t){var e=t.g;return e||(e=t.constructor.prototype.g=t.f(Pi)),e}Li.ShapeType=Mi,Li.prototype.b=[Mi.RECT,Mi.CIRCLE,Mi.POLYGON],Li.prototype.hg=function(t,e,r){return this.a?be(t,e,this.a,r,!0):ae.NONE},Li.prototype.hitTest=Li.prototype.hg,u(Ni,M),t("H.map.AbstractMarker",Ni),Ni.prototype.ba=function(){return this.b},Ni.prototype.getGeometry=Ni.prototype.ba,Ni.prototype.da=function(t){var e=this.b;return C(t,Wf)||C(t,Ji)?this.b=t:(Yf(t,this.da,0),this.b=Zf(t)),e&&this.wa(Mg.SPATIAL),this},Ni.prototype.setGeometry=Ni.prototype.da,Ni.prototype.G=function(){return this.b.G()},Ni.prototype.Cb=function(){return this.icon},Ni.prototype.getIcon=Ni.prototype.Cb,Ni.prototype.Pc=function(t){var e=this.icon,r=!e;if(e!==t){if(!this.sk(t)){if(r)throw new D(this.constructor,1,t);throw new D(this.Pc,0,t)}this.icon=t,r||this.wa(Mg.VISUAL)}return this},Ni.prototype.setIcon=Ni.prototype.Pc;var Pi={svg:'<svg xmlns="http://www.w3.org/2000/svg" width="38" height="47" viewBox="0 0 38 47"><g fill="none"><path fill="#0F1621" fill-opacity=".4" d="M15 46c0 .317 1.79.574 4 .574s4-.257 4-.574c0-.317-1.79-.574-4-.574s-4 .257-4 .574z"></path><path fill="#01b6b2" d="M33.25 31.652A19.015 19.015 0 0 0 38 19.06C38 8.549 29.478 0 19 0S0 8.55 0 19.059c0 4.823 1.795 9.233 4.75 12.593L18.975 46 33.25 31.652z"></path><path fill="#6A6D74" fill-opacity=".5" d="M26.862 37.5l4.714-4.77c3.822-3.576 5.924-8.411 5.924-13.62C37.5 8.847 29.2.5 19 .5S.5 8.848.5 19.11c0 5.209 2.102 10.044 5.919 13.614l4.719 4.776h15.724zM19 0c10.493 0 19 8.525 19 19.041 0 5.507-2.348 10.454-6.079 13.932L19 46 6.079 32.973C2.348 29.495 0 24.548 0 19.04 0 8.525 8.507 0 19 0z"></path></g></svg>',size:new Ki(38,47),anchor:new I(19,45),hitArea:new Li(Mi.POLYGON,[19,46,2,27,0,18,5,6,19,0,32,5,38,15,36,27,19,47])};function Qi(t,e){Qi.l.constructor.call(this,t,e)}function Ri(t,e,r,n){Ri.l.constructor.call(this,t,e,r),this.modifiers=n}Ni.prototype.X=function(){var t=Ni.l.X.call(this),e=this.Cb(),r=e.Db(),n=e.ud();return t.geometry=this.ba().X(),r&&((e=t.properties.icon={id:e.uid}).size={w:r.w,h:r.h},e.offset=[r.w/2-(n?n.x:0),r.h/2-(n?n.y:0)]),t},Ni.prototype.forWorkerMessage=Ni.prototype.X,u(Qi,Ni),t("H.map.DomMarker",Qi),Qi.prototype.type=Pg.DOM_MARKER,Qi.prototype.Og=2,Qi.prototype.f=function(t){var e=new Hi(t.svg,t);return t=t.anchor,e.c.style.margin=-t.y+"px 0 0 -"+t.x+"px",e},Qi.prototype.sk=function(t){return C(t,Hi)},u(Ri,Ng),t("H.map.ChangeEvent",Ri);var Si={SIZE:1,POSITION:2,HEADING:4,TILT:8,INCLINE:16,ZOOM:32,BOUNDS:64};function Ti(){this.a=[],Ti.l.constructor.call(this)}function Ui(t,e,r){if(t=t.a.length,r)var n=t;else if(E(n=0>(n=+e)?wd(0,t+n):vd(t,n)))throw new je(Ti,e,[0,t-1]);return n}function Wi(t,e){var r=t.a.splice(e,1)[0];return t.dispatchEvent(new Vi(t,t.b.De,e,null,r,null)),r}function Vi(t,e,r,n,i,o){Vi.l.constructor.call(this,e,t),this.idx=r,this.added=n,this.removed=i,this.moved=o}Ri.Type=Si,Ri.prototype.Zl=Si.SIZE,Ri.prototype.SIZE=Ri.prototype.Zl,Ri.prototype.oj=Si.POSITION,Ri.prototype.POSITION=Ri.prototype.oj,Ri.prototype.ij=Si.HEADING,Ri.prototype.HEADING=Ri.prototype.ij,Ri.prototype.qj=Si.TILT,Ri.prototype.TILT=Ri.prototype.qj,Ri.prototype.jj=Si.INCLINE,Ri.prototype.INCLINE=Ri.prototype.jj,Ri.prototype.rj=Si.ZOOM,Ri.prototype.ZOOM=Ri.prototype.rj,Ri.prototype.fj=Si.BOUNDS,Ri.prototype.BOUNDS=Ri.prototype.fj,u(Ti,F),t("H.util.OList",Ti),Ti.prototype.add=function(t,e){e=Ui(this,e,E(e)),this.a.splice(e,0,t),this.dispatchEvent(new Vi(this,this.b.Be,e,t,null,null))},Ti.prototype.add=Ti.prototype.add,Ti.prototype.pc=function(t){return this.get(t),Wi(this,t)},Ti.prototype.removeAt=Ti.prototype.pc,Ti.prototype.remove=function(t){return 0<=(t=this.indexOf(t))&&(Wi(this,t),!0)},Ti.prototype.remove=Ti.prototype.remove,Ti.prototype.set=function(t,e){if(0!==this.a.length||0!==t){this.get(t),t=Ui(this,t,!1);var r=this.a[t]}return this.a[t]=e,this.dispatchEvent(new Vi(this,this.b.Ee,t,e,r,null)),r},Ti.prototype.set=Ti.prototype.set,Ti.prototype.indexOf=function(t){return this.a.indexOf(t)},Ti.prototype.indexOf=Ti.prototype.indexOf,Ti.prototype.get=function(t){var e=Ui(this,t,!1),r=this.a;if(e>=r.length)throw new je(this.get,t,[0,r.length-1]);return r[e]},Ti.prototype.get=Ti.prototype.get,Ti.prototype.ln=function(){return this.a.length},Ti.prototype.getLength=Ti.prototype.ln,Ti.prototype.Na=function(){return[].concat(this.a)},Ti.prototype.asArray=Ti.prototype.Na,Ti.prototype.flush=function(){for(var t=this.a.length;t--;)Wi(this,t)},Ti.prototype.flush=Ti.prototype.flush,Ti.prototype.u=function(){this.flush(),Ti.l.u.call(this)},Ti.prototype.b={Be:"add",De:"remove",Ee:"set",wp:"move"},u(Vi,rd);var Xi={};function Yi(t,e){this.projection=t||Xi,this.b=0,this.a=this.exp=Bd(e||256)/Ld,Zi(this),this.y=this.x=0}t("H.geo.mercator",Xi),Xi.a=function(t){return vd(1,wd(0,.5-Bd(Id(Od+Nd*t/180))/Md/2))},Xi.b=function(t){return t/360+.5},Xi.mg=function(t,e,r){return r?(r.x=Xi.b(e),r.y=Xi.a(t)):r=new I(Xi.b(e),Xi.a(t)),r},Xi.latLngToPoint=Xi.mg,Xi.$c=function(t,e){return Xi.mg(t.lat,t.lng,e)},Xi.geoToPoint=Xi.$c,Xi.f=function(t){return 0>=t?90:1<=t?-90:Sd*(2*Jd(Ed(Md*(1-2*t)))-Nd)},Xi.c=function(t){return 360*(1===t?1:Wd(t,1))-180},Xi.Sa=function(t,e,r){return r?(r.lat=Xi.f(e),r.lng=Xi.c(t)):r=new Wf(Xi.f(e),Xi.c(t)),r},Xi.xyToGeo=Xi.Sa,Xi.vg=function(t,e){return Xi.Sa(t.x,t.y,e)},Xi.pointToGeo=Xi.vg,t("H.util.constants.DEFAULT_MIN_ZOOM_LEVEL",0),t("H.util.constants.DEFAULT_MAX_ZOOM_LEVEL",22),t("H.geo.PixelProjection",Yi);var $i=Ad(24)+Ad(-8);function Zi(t){t.a>$i&&(t.a=$i),t.w=Dd(2,t.a),t.h=Dd(2,t.a)}function aj(t){t=t||{},aj.l.constructor.call(this),this.min=0,this.max=22,this.nm=this.dark=!!t.dark,t.min&&this.Ki(t.min),t.max&&this.Ii(t.max),this.pixelProjection=new Yi(t.projection,t.minWorldSize),t.provider&&(this.a=t.provider,this.g=A(this.g,this),this.a.addEventListener(P.prototype.i.Ea,this.g,!1,this),this.i=A(this.i,this),this.a.addEventListener(P.prototype.i.Ce,this.i,!1,this))}function bj(t,e,r){var n=t[e],i="min"===e,o=i?t.Ki:t.Ii;if(r!==n){if(!(i?r<=t.max:r>=t.min))throw new D(o,0,"Invalid condition min <= max");t[e]=r,t.g(),t.i(),t.dispatchEvent(new Ng(i?t.b.nj:t.b.mj,r,n))}return t}function cj(t){var e;if(cj.l.constructor.call(this),this.dispatchEvent=A(this.dispatchEvent,this),t){var r=t.length;for(e=0;e<r;e++)this.add(t[e])}}function dj(t,e){var r=e.getProvider&&e.getProvider();r&&(ej[r.uid]=r),e.ka(t)}function fj(t){var e=t.getProvider&&t.getProvider();e&&delete ej[e.uid],t.ka(null)}Yi.prototype.cl=Xi,Yi.prototype.projection=Yi.prototype.cl,Yi.prototype.x=0,Yi.prototype.x=Yi.prototype.x,Yi.prototype.y=0,Yi.prototype.y=Yi.prototype.y,Yi.prototype.pp=Dd(2,$i),Yi.prototype.w=Yi.prototype.pp,Yi.prototype.Xn=Dd(2,$i),Yi.prototype.h=Yi.prototype.Xn,Yi.prototype.Qa=function(t){if(E(t))throw new D(this.Qa,0,t);var e=this.x/this.w,r=this.y/this.h;this.b=t,this.a=this.exp+t,Zi(this),this.x=e*this.w,this.y=r*this.h},Yi.prototype.rescale=Yi.prototype.Qa,Yi.prototype.gk=function(){return this.b||0},Yi.prototype.getZoomScale=Yi.prototype.gk,Yi.prototype.lb=function(t,e){return(t=this.projection.mg(t.lat,t.lng,e)).x=t.x*this.w-this.x,t.y=t.y*this.h-this.y,t},Yi.prototype.geoToPixel=Yi.prototype.lb,Yi.prototype.lf=function(t,e){return this.projection.Sa((t.x+this.x)/this.w,(t.y+this.y)/this.h,e)},Yi.prototype.pixelToGeo=Yi.prototype.lf,Yi.prototype.Sa=function(t,e,r){return this.projection.Sa((t+this.x)/this.w,(e+this.y)/this.h,r)},Yi.prototype.xyToGeo=Yi.prototype.Sa,Yi.prototype.Sh=function(t,e,r){return(t=this.projection.mg(t,e,r)).x=t.x*this.w-this.x,t.y=t.y*this.h-this.y,t},Yi.prototype.latLngToPixel=Yi.prototype.Sh,Yi.prototype.qe=function(t){return new I(t.x*this.w-this.x,t.y*this.h-this.y)},Yi.prototype.pointToPixel=Yi.prototype.qe,u(aj,F),t("H.map.layer.Layer",aj),aj.prototype.min=0,aj.prototype.min=aj.prototype.min,aj.prototype.max=22,aj.prototype.max=aj.prototype.max,aj.prototype.ra=y,aj.prototype.pixelProjection=aj.prototype.ra,aj.prototype.b={Ea:"update",Ce:"configchange",nj:"minchange",mj:"maxchange"},aj.prototype.ga=function(){return this.a},aj.prototype.getProvider=aj.prototype.ga,aj.prototype.jo=function(t){return this.min<=t&&t<=this.max},aj.prototype.isValid=aj.prototype.jo,aj.prototype.Ki=function(t){return bj(this,"min",+t)},aj.prototype.setMin=aj.prototype.Ki,aj.prototype.Ii=function(t){return bj(this,"max",+t)},aj.prototype.setMax=aj.prototype.Ii,aj.prototype.g=function(){this.dispatchEvent(this.b.Ea)},aj.prototype.i=function(){this.dispatchEvent(this.b.Ce)},aj.prototype.u=function(){aj.l.u.call(this)},aj.prototype.ta=function(){return null},aj.prototype.getCopyrights=aj.prototype.ta,u(cj,Ti),t("H.map.DataModel",cj),cj.prototype.add=function(t,e){C(t,aj,this.add,0),dj(this,t),cj.l.add.call(this,t,e)},cj.prototype.add=cj.prototype.add,cj.prototype.set=function(t,e){return C(e,aj,this.set,0),dj(this,e),(t=cj.l.set.call(this,t,e))&&fj(t),t},cj.prototype.set=cj.prototype.set,cj.prototype.pc=function(t){var e;return(e=cj.l.pc.call(this,t))&&fj(e),e},cj.prototype.removeAt=cj.prototype.pc,cj.prototype.remove=function(t){var e;return(e=cj.l.remove.call(this,t))&&fj(t),e},cj.prototype.remove=cj.prototype.remove,cj.prototype.flush=function(){for(var t=this.a.length;t--;)this.pc(t);cj.l.flush.call(this)},cj.prototype.flush=cj.prototype.flush;var ej={};function gj(t,e,r){if(t=ej[t])return C(t[e],Function,gj,1,"invalid method"),t[e].apply(t,r)}function hj(t,e){Ca(t)&&(this.i=t),Cc(e)&&(this.a=e)}Fc(ej),cj.invoke=gj,t("H.util.Request",hj),hj.State={PENDING:0,PROCESSING:1,COMPLETE:2,CANCELLED:3,ERROR:4};var ij=[0,1,2,3,4],qj;function jj(t,e){t.b<t.a&&(tc(e)||(e=2),0===e||1===e||0!==t.A&&1!==t.A||(t.b++,2!==e&&t.g++,t.P(t.b<t.a?1:2)))}function kj(){}function lj(t,e){var r=t.L(),n=r.ownerDocument;lj.l.constructor.call(this),this.a=t,this.S=r=r.appendChild(mj(n,"DIV","position:absolute;bottom:0;right:0;left:0px;z-index:1;direction:ltr;pointer-events:none;height:40px-webkit-touch-callout: none;-webkit-user-select:none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select:none;",null,"H_imprint")),this.If=mj(n,"DIV","margin: 0 0 "+nj+"px "+nj+"px;display:inline-block;",oj,"H_logo"),r.appendChild(this.If),r=r.appendChild(mj(n,"DIV","right:0;bottom:0;position:absolute;background-color:rgba(255,255,255,.8);color:#0F1621;padding:2px 16px",null,"H_copyright")),this.g=r.appendChild(mj(n,"A","color:inherit; margin:0px 8px; text-decoration:none; pointer-events:all;","Terms of use")),this.g.target="_blank",this.f=r.appendChild(mj(n,"SPAN","margin:0px 8px")),this.j=Ua(pj),this.Li(e),this.c=A(this.c,this),this.b=A(this.b,this),this.a.addEventListener(this.a.o.lj,this.c),this.a.a.addEventListener("add",this.b),this.a.a.addEventListener("remove",this.b),this.a.a.addEventListener("set",this.b),this.b()}hj.prototype.A=0,hj.prototype.getState=function(){return this.A},hj.prototype.getState=hj.prototype.getState,hj.prototype.P=function(t){if(0>ij.indexOf(t))throw new D(this.P,0,t);(this.A!==t||1===t&&1<this.a)&&(this.A=t,this.i&&this.i(this))},hj.prototype.a=1,hj.prototype.Pn=function(){return this.a},hj.prototype.getTotal=hj.prototype.Pn,hj.prototype.b=0,hj.prototype.An=function(){return this.b},hj.prototype.getProcessed=hj.prototype.An,hj.prototype.g=0,hj.prototype.Wm=function(){return this.g},hj.prototype.getFailed=hj.prototype.Wm,hj.prototype.Ie=function(){},hj.prototype.cancel=function(){3!==this.A&&(this.Ie(),this.P(3))},hj.prototype.cancel=hj.prototype.cancel,t("H.util.ICapturable",kj),kj.prototype.capture=function(){},kj.prototype.capture=kj.prototype.capture,t("H.util.Disposable",nd),nd.prototype.zb=nd.prototype.zb,nd.prototype.addOnDisposeCallback=nd.prototype.zb,t("H.util.dispose",qd),nd.prototype.B=nd.prototype.B,nd.prototype.dispose=nd.prototype.B,nd.prototype.u=nd.prototype.u,u(lj,nd),t("H.map.Imprint",lj);var nj=16,pj={font:'11px "Lucida Grande", Arial, Helvetica, sans-serif',href:"https://legal.here.com/{LN}/terms/serviceterms/{CN}",invert:!1,reportHref:"https://wego.here.com/",locale:"en-US"};function mj(t,e,r,n,i){return t=t.createElement(e),r&&(t.style.cssText=r),n&&(t.innerHTML=n),i&&(t.className=i),t}lj.prototype.Li=function(t){var e,r=this.If.firstChild.firstChild.childNodes;t||(this.j=Ua(pj));var n=this.j;for(e in n)t&&e in t&&(n[e]=t[e]);t=(this.Oh=t=n.invert)?rj:sj,r[0].style.fill=t.Fl,r[0].style.fillOpacity=t.Gl,r[1].style.fill=t.Kl,r[1].style.fillOpacity=t.Ll,t=n.locale,tj[t]||(t="en-US",n.locale=t),this.g.innerHTML=tj[t],t=t.split("-"),this.g.href=n.href.replace("{LN}",t[0]).replace("{CN}",t[1].toLowerCase()),this.S.style.font=n.font},lj.prototype.setOptions=lj.prototype.Li,lj.prototype.L=function(){return this.S},lj.prototype.c=function(){this.f.innerHTML=this.i+" "+this.ta()},lj.prototype.b=function(){this.c(),setTimeout(this.c,5e3)};var oj='<svg height="40" viewBox="0 0 47 40" width="47" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m45.2054149 8.82876345.6003191.40637037-.2240425.6914074-.4490426 1.38570368c-.1024468.3148889-.6998936 1.9596297-2.43 3.5918519l-.017234.0163704c-.188617.1887407-.3801064.3659259-.5467021.5084444l-.4605319.4285185-.486383.4516296-.1407447-.0702963c-.7257447.4583704-1.4926596.7886667-2.2796809.9831852l.5840426.5864445-.6769149.6817778-2.052766 2.0636296-.169468.1704444-.019149.0192593-2.3821276 2.3958518c-.4902128.8493334-1.1202128 1.6331852-1.8497873 2.3111112-.6031915.6047407-1.2504255 1.1054814-1.935 1.4954814l-.4777659.4805186-4.3247873 4.3506666-.0296808.0298519-.0315958.0269629-2.1532978 1.8171111-.2661702.2253334h-.3485107-3.8948936l-3.968617 3.9914815-1.3547873 1.3616296-.6769148.6808148-.6769149-.6808148-1.3538298-1.3616296-4.80925535-4.837926-3.2687234-3.2875555-1.63436171-1.6437778h2.3112766 4.62255319 2.67223407l-4.71063832-4.7368148-.6769149-.6808148.6769149-.6808148 4.93851062-4.9650371.6769149-.6798518.6769149.6808148 2.7296809 2.7454074c.9363829-.8820741 2.1485106-1.4685185 3.4037234-1.6562963.278617-1.4694815 1.0187234-2.834963 2.168617-3.9885926.5696808-.572 1.1843617-1.0438519 1.8335106-1.4107407l.2901064-.2917778 4.3094681-4.31985187c.5830851-1.0582963 1.4256383-1.78918519 2.0364893-2.12718519l.4471277-.24748148c.3829787-.7617037.9047872-1.47622222 1.5539362-2.12622222 1.510851-1.51666667 3.3165957-2.31881482 5.22-2.31881482.0871276 0 .1752127.00192593.2594681.00577778 1.9484042.06933334 3.8441489.97933334 5.4775532 2.62792593.1512765.15022222.3303191.34859259.5361702.5797037l.0526595.05874074c.1120213.12518519.2345745.26192593.370532.40733334l1.2657446 1.36066666.6328724.67985185-.6548936.65866667-.2508511.25325926zm-27.9288192 22.17414815h-9.57446804l4.78723404 4.8148148zm23.1864894-21.70422223c-.9220213 1.38666663-2.5180851 3.63037033-4.1984042 1.94133333l4.2510638-4.27651851c-.3810638-.41022222-.6711702-.754-.8923404-.97740741-2.2921277-2.31207407-4.8743617-2.34192593-6.8984043-.312-1.3528723 1.35681481-1.7071277 2.91007407-1.313617 4.38533332l-1.332766-1.52629628c-.385851.21474074-2.0182979 1.65918518-.7937234 3.84703708l-1.5252127-1.274963-2.0240426 2.0299259 2.7344681 2.7502222c-2.1121277-1.6861481-4.3889362-1.5205185-6.2157447.312-1.9560638 1.9615556-1.8181915 4.3381482-.3532979 6.293926l-.295851-.2946667c-1.9321277-1.9432593-4.0318085-1.2576296-5.0706383-.2128148-.8023405.8079259-1.2944681 1.9191852-1.0924468 2.6905185l-4.195532-4.2187407-2.22893613 2.2408148 8.25893613 8.3065185h4.4339362l-2.9767021-2.9938519c-.5893908-.6029568-.9604155-1.0987731-1.1531529-1.5232627-.3182349-.7008886-.1504161-1.2073234.3230465-1.680515.7334043-.7318519 1.583617-.2763704 3.0829787 1.2277777l2.9412766 2.9562963 2.2164894-2.2292592-2.7909575-2.8060741c2.0125532 1.5291852 4.4224468 1.612 6.5728724-.545037 1.3567021-1.2653334 1.7425532-2.4565185 1.7425532-2.4565185l-1.6755319-1.1314815c-.9229788 1.3866666-2.5152128 3.6361481-4.195532 1.9461481l4.2606383-4.2851852 2.655 2.6712593 2.3160639-2.3294074-3.3223405-3.3424445c-1.5520212-1.5609629-.6328723-3.0275555.0124469-3.5793333.3025531.6442222.7448936 1.2624445 1.3078723 1.8296296 2.1485106 2.1676297 4.9260638 2.6038519 7.3685106.1550371 1.3567022-1.2643704 1.7425532-2.4565185 1.7425532-2.4565185zm-3.6564894-1.35537321-2.0211702 2.03377777c-.9890425-1.18251851-.9392553-1.81422222-.3245744-2.43051851.7439361-.7462963 1.4993617-.43044445 2.3457446.39674074zm-12.4879787 12.56088884c-.9890425-1.1825185-.9411702-1.819037-.3284042-2.4353333.7448936-.7462963 1.5003191-.4304444 2.3467021.3967408z" fill="#0f1621" fill-opacity=".7"/><path d="m17.2765957 31.0029116-4.787234 4.8148148-4.78723404-4.8148148zm23.1864894-21.70422223 1.6755319 1.13148153s-.385851 1.1921481-1.7425532 2.4565185c-2.4424468 2.4488148-5.22 2.0125926-7.3685106-.1550371-.5629787-.5671851-1.0053192-1.1854074-1.3078723-1.8296296-.6453192.5517778-1.5644681 2.0183704-.0124469 3.5793333l3.3223405 3.3424445-2.3160639 2.3294074-2.655-2.6712593-4.2606383 4.2851852c1.6803192 1.69 3.2725532-.5594815 4.195532-1.9461481l1.6755319 1.1314815s-.3858511 1.1911851-1.7425532 2.4565185c-2.1504256 2.157037-4.5603192 2.0742222-6.5728724.545037l2.7909575 2.8060741-2.2164894 2.2292592-2.9412766-2.9562963c-1.4993617-1.5041481-2.3495744-1.9596296-3.0829787-1.2277777-.4734626.4731916-.6412814.9796264-.3230465 1.680515.1927374.4244896.5637621.9203059 1.1531529 1.5232627l2.9767021 2.9938519h-4.4339362l-8.25893613-8.3065185 2.22893613-2.2408148 4.195532 4.2187407c-.2020213-.7713333.2901063-1.8825926 1.0924468-2.6905185 1.0388298-1.0448148 3.1385106-1.7304445 5.0706383.2128148l.295851.2946667c-1.4648936-1.9557778-1.6027659-4.3323704.3532979-6.293926 1.8268085-1.8325185 4.103617-1.9981481 6.2157447-.312l-2.7344681-2.7502222 2.0240426-2.0299259 1.5252127 1.274963c-1.2245745-2.1878519.4078724-3.63229634.7937234-3.84703708l1.332766 1.52629628c-.3935107-1.47525925-.0392553-3.02851851 1.313617-4.38533332 2.0240426-2.02992593 4.6062766-2.00007407 6.8984043.312.2211702.22340741.5112766.56718519.8923404.97740741l-4.2510638 4.27651851c1.6803191 1.689037 3.2763829-.5546667 4.1984042-1.94133333zm-16.1444681 11.20551563 2.0182979-2.0385925c-.846383-.8271852-1.6018085-1.1430371-2.3467021-.3967408-.612766.6162963-.6606383 1.2528148.3284042 2.4353333zm12.4879787-12.56088884c-.8463829-.82718519-1.6018085-1.14303704-2.3457446-.39674074-.6146809.61629629-.6644681 1.248.3245744 2.43051851z" fill="#fff" fill-opacity=".3"/></g></svg>',sj={Kl:"#0F1621",Ll:.3,Fl:"#fff",Gl:.6},rj={Kl:"#fff",Ll:1,Fl:"#0F1621",Gl:.7},uj="1987&ndash;"+wd(2015,(new Date).getFullYear())+" HERE";function vj(t,e,r,n){wj(A(function(t){t?this.Oh?r("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAADNklEQVRYR82XW6hVVRSGv7+rmJfSMKSnSkMEfY7EogcJC7tilGRopBAiSaI+SBARQSCIIqgFISih2YW0oAgLCsKXojA0RB+81VugZEFZv/yHuWTt7d7Hfc4+6+h4OWefNfcc3xlj/v+YS1zjoab5bE8DZgGngB8keSg5GwO0PQ54F3i2BnQIWCLpx14hGwG0fT3wOfBwB5DzwOOSDvQC2RTgM8Ae4D/gaeA3YDdwN5AWvyxp+6gD2r4OmAq8AbwInAMmA/OAT4CbgBWStvYClzUjWkHbrwHLgF8LVHJ8DDxah7P9JHCil7M40oA/A7OBC8ANtSqlrQOVs30/8CWQat8r6cxg1RwRQNvPA88Bk4D7gJzBV4A5teSp5MlS4VuA/ZIeu1Kr+wa0/QTwIRDlRhT5eTswBvi2CKOd42AULilndNAYCcA7gK+BmbVMiyXtsh3Qt4FFBTgW8w6wXtLfV4LrSyS2FwAvAWOBX+JtwF0laUDmS/oun23fDNwJnJb0Ty9g1ZphVdB2qrK2LdFfBbb685/AIxXkUKDqa4cMaDs2kjalRe8Fola57J3qRQSJviGHA3gMuAdYI2lDUfDOArQLWAd8VTuTOW9vjUoFy6TIGYpS9wKfAjuK5wVuSfn91iKcvZJeHy5ci0hsZwzNk5Qh3xIFbLyks7aPAtPLgv+L4VZwDwLvA6uKz6XdfcVAi22PBz4q4+lVSRurXW2vKYKIZfwEHCmmXC35HngAyITYD0ys2t8XWflyBfhmvKm24QCk7aVFCPVc7WMszzKucknI+NoHPCUppt13VICZm2nNwjoksByY0SXL72Vi3FieZ97mgrpyqF432H9xScW2O0H+W6oSE/4D2FYuA9kzlUzVTwO3Ad9IOtx3ydo2aLGZLpABm5KW2Z4AfAbMLfsEcpGkKLqRuMwHu0CukrSpCCrvGlF6hBEVL5MUw24kOhp1B8gc+FTqgxpkFLuzSbjk6jpJOkC2tDPeKCkVbDRkO67fDTTC2VK7vgfyBUlfNEpV2zyAK4HNXRLmZfshScdHC6g9T+WDGU2XpkdZdNXhWs6g7dXAhmsJ7jKR2M77bG4kV7Wt9TZfBLgYEC7PSpcIAAAAAElFTkSuQmCC"):r("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAIMSURBVFiFzdZPiE1RGADwXzPTTPIMQoodVpbKgpoUG5qExUi8DSVJQv4slJJsbNjYWFhNETWLUUosRDRLUVLCYhIiojFojHkW997uvefNGIuZc99Xp/fOO6/Or++c75xDi0d7hDlWYQNqeB9hvv+OGq6jUWjPsKZKVBbtuKOMy9p3bKqOlsROCWYc27AWr9PfJnCgKlgbluNqivmGDmzBrxR3sCocnMEw7sqXdEAzboeK9uLTFPVbed8VcesxglFJtqNEHbcxlIL68ChADuCSpEgauBULt11SDI3C5yJJdrLCCNsQumMBl+J5AKinY4slBfNTfsRcxJwYsK0YxD3J0r1RPut6Cv/twgp0xoDBBc3LNhr0RwJktNifAn7gsnLmsuxVinyVTn4i7dcLoH4sU96Tp2Pi2uSVehN75Gdev+QO7pIXztmZnLwTvf+AzU+/v5Rn50+A24gP2IW5M4mbJ7+ejgVjJ/EpHXuCa8p77nGK68FX5eWfsTgfTJoh92qu1vAaa+CtPJuDZuEh3CHZUyHyxSSYrL3DWKE/gStm8aybDDkmKYperJM/BrJMnsJuHMLq2YJNh/wsX7JuPAyQfTFg0yGPFMZreCCv4n2xgTQjxyXP+CxquK8iXBYhMlzOtliQBVg4RVuCG/iSto/YHAuWxWFTHyXDWBkbNFkc1cK4LI5rYVwW57QY7i/pZeJv8QQJRQAAAABJRU5ErkJggg=="):((t=this.If.cloneNode(!0)).firstChild.setAttribute("style","font:"+e),r($e(t.innerHTML)))},t),n)}function wj(t,e){var r="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(oj),n=qj;tc(n)?t(n):new rf("image",r).then(function(e){We.drawImage(e,0,0);try{We.getImageData(0,0,1,1),n=!1}catch(t){n=18===t.code}finally{qj=n,t(n)}},e)}lj.prototype.ta=function(){var t,e,r,n=this.a,i=n.vb(),o=n.b.mb().bounds,a=(n=n.a).a.length,s={},u=0,l=[uj];if(o)for(;u<a;u++)if(e=n.get(u).getCopyrights(o.G(),i))for(t=0;t<e.length;t++)s[r=e[t].label]||(l.push(r),s[r]=1);return l.join(", ")},lj.prototype.getCopyrights=lj.prototype.ta,lj.prototype.ua=function(){return this.S.style},lj.prototype.i=String.fromCharCode(169),lj.prototype.u=function(){if(this.a.removeEventListener(this.a.o.lj,this.c),this.a.a.removeEventListener("add",this.b),this.a.a.removeEventListener("remove",this.b),this.a.a.removeEventListener("set",this.b),this.S.parentNode){var t=this.S;t.parentNode.removeChild(t)}},lj.prototype.capture=function(t,e,r,n){var i,o=t.getContext("2d"),a=window.getComputedStyle(this.f.parentElement),s=2*Ac(a.paddingLeft,10),u=(this.f.offsetWidth+2*s)*e,l=this.f.offsetHeight*e,c=Bc(a.getPropertyValue("font-size")),h=this.S.ownerDocument,f=+t.width,p=+t.height,d=nj*e,v=this.If.childNodes[0].getBoundingClientRect(),y=v.width*e,g=v.height*e,m=hd;Ca(n)&&(m=function(){n("capture_error")}),o.fillStyle=a.backgroundColor,o.fillRect(f-u,p-l,u,l),u=this.i+" "+(i=this.ta(),(i=mj(h,"div",null,i)).textContent||i.innerText||""),o.font=c*e+"px "+a.getPropertyValue("font-family"),o.fillStyle=a.getPropertyValue("color"),o.textBaseline="bottom",o.textAlign="right",o.fillText(u,f-s*e,p),vj(this,o.font,function(e){new rf("image",e).then(function(e){o.drawImage(e,d,p-(g+d),y,g),r(t)},m)},m)},lj.prototype.capture=lj.prototype.capture,lj.prototype.Oh=!1,lj.prototype.bm=function(t,e){tj[t]=e},lj.prototype.addL11NString=lj.prototype.bm;var tj={"de-DE":"Nutzungsbedingungen","en-US":"Terms of use","en-GB":"Terms of use","es-ES":"Condiciones de uso","fi-FI":"Palveluehdot","fr-FR":"Conditions d'utilisation","it-IT":"Condizioni di utilizzo","nl-NL":"Dienstvoorwaarden","pl-PL":"Warunki świadczenia usługi","pt-BR":"Termos de serviço","pt-PT":"Termos do serviço","ru-RU":"Условия использования","tr-TR":"Servis Koşulları","zh-CN":"使用条款"};function Q(t){var e={};this.i=e.previousSibling=e.nextSibling=e,this.j=new af,Q.l.constructor.call(this,t),t&&"objects"in t&&this.fc(t.objects)}function xj(t,e,r){t.xe(r.a)}function yj(t){t.uf()}function zj(t,e,r){t.wa(r.g)}function Aj(t){this.push(t)}function Bj(t,e){for(var r,n,i=0,o=e.length,a=[];i<o;i++)n={},(r=e[i])instanceof Q?(n.type="GeometryCollection",n.geometries=Bj(t,r.Va())):n=r.ba().Sc(),a.push(n);return a}u(Q,M),t("H.map.Group",Q),Q.prototype.type=Pg.GROUP,Q.prototype.xe=function(t,e){return this.f=!0,t=Q.l.xe.call(this,t,e),this.f=!1,t&&this.forEach(xj,!0),t},Q.prototype.setProvider=Q.prototype.xe,Q.prototype.contains=function(t){var e=this===t;if(!e&&this.b&&C(t,M))for(;!e&&t;)t===this?e=!0:t=t.Ha;return e},Q.prototype.contains=Q.prototype.contains,Q.prototype.uf=function(){this.J=B,this.forEach(yj,!0)},Q.prototype.resetZInfo=Q.prototype.uf,Q.prototype.f=!1,Q.prototype.wa=function(t){var e=Q.l.wa.call(this,t);return e&&!this.f&&(this.g=t,this.forEach(zj,!0),delete this.g),e},Q.prototype.invalidate=Q.prototype.wa,Q.prototype.forEach=function(t,e,r){var n;if(this.b){var i=this.i,o=i.nextSibling;for(n=0;o!==i;){var a=o.nextSibling;t.call(r,o,n++,this),e&&C(o,Q)&&o.forEach(t,e,r),o=a}}},Q.prototype.forEach=Q.prototype.forEach,Q.prototype.Va=function(t){var e=[];return this.forEach(Aj,t,e),e},Q.prototype.getObjects=Q.prototype.Va,Q.prototype.G=function(){var t=null;return this.b&&this.forEach(function(e){(e=e.G())&&(t=t?t.nc(e):e)}),t},Q.prototype.getBoundingBox=Q.prototype.G,Q.prototype.b=0,Q.prototype.Hm=function(){return this.b},Q.prototype.getChildCount=Q.prototype.Hm,Q.prototype.ea=function(t){var e=this.i,r=e.previousSibling;if(C(t,M,this.ea,0),t.contains(this))throw new Xc(this.ea,"The new object contains the parent group");var n=t.fg(!0),i=t.Ha;if(i!==this){if(i){i=t.previousSibling;var o=t.nextSibling;i.nextSibling=o,o.previousSibling=i}t.Ha=this,M.l.ka.call(t,this),r.nextSibling=t,t.previousSibling=r,t.nextSibling=e,e.previousSibling=t,this.b++}return t.Ti=this.j.next(),t.uf(),e=t.xe(this.a,this.ea),t.fg(!0)^n&&t.wa(Mg.VOLATILITY),e||t.wa(Mg.Z_ORDER),t},Q.prototype.addObject=Q.prototype.ea,Q.prototype.fc=function(t){var e;yc(t,this.fc,0);var r=t.length;for(e=0;e<r;e++)this.ea(t[e])},Q.prototype.addObjects=Q.prototype.fc,Q.prototype.Ia=function(t){if(!t||t.Ha!==this)throw new Xc(this.Ia,"object not found");var e=t.previousSibling,r=t.nextSibling;return e.nextSibling=r,r.previousSibling=e,t.Ha=null,M.l.ka.call(t,null),delete t.previousSibling,delete t.nextSibling,C(t.a,N)&&t.xe(null,this.Ia),this.b--,t},Q.prototype.removeObject=Q.prototype.Ia,Q.prototype.Gd=function(t){var e;yc(t,this.Gd,0);var r=t.length;for(e=0;e<r;e++)this.Ia(t[e])},Q.prototype.removeObjects=Q.prototype.Gd,Q.prototype.qa=function(){var t=this.Va();this.Gd(t)},Q.prototype.removeAll=Q.prototype.qa,Q.prototype.Sc=function(t){for(var e,r,n,i=this.Va(),o=0,a=i.length,s=[];o<a;o++)(n=i[o])instanceof Q?(r=Sg(this,e=t?t(n.getData()):n.getData(),!!t),(e={type:"Feature"}).properties=r,n.m&&(e.id=n.m),e.geometry={},e.geometry.type="GeometryCollection",e.geometry.geometries=Bj(this,n.Va()),s.push(e)):s.push(n.Sc(t));return{type:"FeatureCollection",features:s}},Q.prototype.toGeoJSON=Q.prototype.Sc,Q.prototype.X=function(){var t=Q.l.X.call(this);return t.type="Group",t},Q.prototype.forWorkerMessage=Q.prototype.X;var Cj={PROVIDES_BY_VIEWPORT:1,PROVIDES_RASTERS:2,PROVIDES_SPATIALS:4,PROVIDES_OVERLAYS:8,PROVIDES_MARKERS:16,PROVIDES_DOM_MARKERS:32,PROVIDES_GEOJSON:64,PROVIDES_OMV:128,CROP_LINES_BY_TILE:256,CROP_POLYGONS_BY_TILE:512,HAS_VOLATILE_DATA:1024};function Dj(t,e,r,n,i){switch(e&&(this.b=e),tc(r)&&(this.$g=!!r),this.$g&&n&&(this.ah=new Ki(n.w,n.h)),tc(i)&&(this.c={crossOrigin:i}),Ej[xc(t)]){case 2:this.Dd=t,Fj(this,1);break;case 1:if(lf(t)){this.Dd=t,Gj(this),Fj(this,1);break}t=t.src;case 0:if(t){t=$e(t),this.a=new rf("image",t,B,this.c),this.a.then(A(this.Jo,this),A(this.Io,this));break}default:throw Fj(this,-1),new D(Dj,0,"No image data")}}function Fj(t,e){t.A=e,delete t.a,t.b&&t.b(e,t)}function Gj(t){if(t.$g){var e=t.Dd,r=Hj(t),n=r&&r.w||+e.width,i=r&&r.h||+e.height,o=Se();if(C(e,x.HTMLCanvasElement))r=e;else{(r=e.ownerDocument.createElement("canvas")).width=zd(n*o),r.height=zd(i*o);var a=r.getContext("2d");a.scale(o,o),a.drawImage(e,0,0,n,i),Zc&&(a.clearRect(0,0,n,i),a.drawImage(e,0,0,n,i))}t.Dd=r}}t("H.map.provider.Capabilities",Cj),Cj.PROVIDES_WEBGL_RENDERABLE_OBJECTS=Cj.PROVIDES_SPATIALS|Cj.PROVIDES_OVERLAYS|Cj.PROVIDES_MARKERS,n=Dj.prototype,n.A=0,n.getState=function(){return this.A},n.$g=!0,n.Dd=y,n.getData=function(){return this.Dd};var Ej={String:0,HTMLImageElement:1,HTMLCanvasElement:2};function Hj(t){var e,r=t.ah;if(!r){var n=t.Dd;if(0===(r=n.naturalWidth||n.width)&&Ye&&1===Ej[xc(n)]){var i=!0;if(e=n.parentNode)var o=n.nextSibling;document.body.appendChild(n)}t.ah=r=new Ki(n.naturalWidth||n.width,n.naturalHeight||n.height),i&&(e?e.insertBefore(n,o):document.body.removeChild(n))}return r}function Ij(t,e){var r,n="anonymous";if(this.uid=Jj.next(),Ij.l.constructor.call(this),e){var i="size";if(i in e){var o=e[i];if(!o||isNaN(o.w)||isNaN(o.h))throw new D(Ij,1,i);this.c=new Ki(o.w,o.h)}if((i="anchor")in e){if(!(o=e[i])||isNaN(o.x)||isNaN(o.y))throw new D(Ij,1,i);this.b=new I(o.x,o.y)}(i="hitArea")in e&&(C(o=e[i],Li,Ij,1),this.g=e[i]),(i="asCanvas")in e&&(r=e[i]),(i="crossOrigin")in e&&(n=e[i]),(o=e.stickHeight)===+o&&0<o&&(this.hp=o),o=e[i="stickColor"],i in e&&zc(o)&&(this.gp=o)}t=new Dj(t,A(this.i,this),r,this.c,n),0!==(e=this.A=t.getState())?this.i(e,t):this.f=t}n=Dj.prototype,n.ah=y,n.Db=function(){return 1===this.A?Hj(this):y},n.Jo=function(t){this.Dd=t,Gj(this),Fj(this,1)},n.Io=function(){Fj(this,-1)},n.cancel=function(){this.a&&this.a.cancel()},u(Ij,F),t("H.map.Icon",Ij);var Jj=new af;function Kj(t,e,r,n,i,o){Kj.l.constructor.call(this,isNaN(t)?15:t,e,r,n,i,o)}function Lj(t,e,r,n,i){var o=e.entries;if(i)if(e.a)o=Mj(t,e,r,n,i);else if(o){var a=pg(e,(o=o[0])[1]>=e[8]|(o[0]>=e[9])<<1);a.entries=e.entries,delete e.entries,o.node=a,mg(t,a),o=Mj(t,e,r,n,i)}else qg(e,o=new Nj(r,n)),mg(t,e),kg(t,o,!0);else o||mg(t,e),qg(e,o=new Nj(r,n)),kg(t,o,!0);return o}function Mj(t,e,r,n,i){return Lj(t,pg(e,r>=e[8]|(n>=e[9])<<1),r,n,i-1)}function Nj(t,e){this.id=og++,this[0]=e,this[1]=t}function Oj(){this.a=new Kj(10,180,90,0,0,!0)}function Pj(t,e,r){this.c=t,this.a=e,this.g=r,this.f=this.c&Cj.PROVIDES_BY_VIEWPORT?"function(){return sources[$source].isInMinMaxRange(feature, $zoom) && feature.ref.effectiveVisibility;}":B,this.b={}}function Qj(t,e,r,n){this.a=t,this.b=e,this.c=r,this.Df=n}function Rj(t,e,r,n){return t={type:e,uid:t.b,tiled:r,max_zoom:t.c},n&&Wa(t,n),t}function Sj(t){this.a=t}function Tj(t,e,r,n,i){this.a=t,this.b=e,this.c=r,this.f=n,this.Df=i}function Uj(t){if(t.a&Cj.PROVIDES_DOM_MARKERS&&!(t.a&Cj.PROVIDES_MARKERS))return{};var e=new Qj(t.a,t.b,t.c,t.Df),r=new Sj(t.a);t=new Pj(t.a,t.b,t.f);var n={},i=e.b;if(e=e.a&Cj.PROVIDES_BY_VIEWPORT?Rj(e,"ObjectSource",!1,{progressiveUpdate:!0,has_volatile_data:!!(e.a&Cj.HAS_VOLATILE_DATA)}):e.a&Cj.PROVIDES_RASTERS?Rj(e,"RemoteRasterTileSource",!0,{url:""}):Rj(e,"ObjectTileSource",!0,{tile_size:e.Df}),n[i]=e,e={},r.a&Cj.PROVIDES_RASTERS&&(e={"translucent-raster":Mh("raster","inlay",1)}),r.a&Cj.PROVIDES_WEBGL_RENDERABLE_OBJECTS){i=!!(r.a&Cj.CROP_LINES_BY_TILE);var o={"translucent-polygons":Mh("polygons","inlay",2),"translucent-extruded-polygons":Mh("polygons","translucent",3),"translucent-pattern-lines":Mh("pattern-lines","translucent",4),"translucent-overlays":Mh("overlays","inlay",5),markers:Mh("custom_icons","overlay",6,!1)};o["translucent-polygons"].crop_by_tile=!!(r.a&Cj.CROP_POLYGONS_BY_TILE),o["translucent-pattern-lines"].crop_by_tile=i,o.markers.suppress_fade=!0,o.markers.stick=!0,Wa(e,o)}if(t.c&Cj.PROVIDES_RASTERS&&(t.b["tile_layer_"+t.a]=Oh(t.a,"_default",{"translucent-raster":{color:[1,1,1,t.g],order:0}})),t.c&Cj.PROVIDES_SPATIALS){r={"translucent-pattern-lines":{color:Lh("strokeColor"),width:Lh("lineWidth * $meters_per_pixel"),join:Lh("lineJoin"),cap:Lh("lineCap"),tail_cap:Lh("lineTailCap"),head_cap:Lh("lineHeadCap"),miter_limit:Lh("miterLimit"),order:"function() { return 2 + feature.effectiveZIdx / 2; }",interactive:!0,dash:Lh("lineDash"),extrude:!0,dash_phase:Lh("lineDashOffset")}},i=t.b,o="polygon_layer_"+t.a;var a=Oh(t.a,"polygons",void 0,t.f);a.flat={filter:"function(){return !feature.height && !feature.min_height;}",draw:Nh(!1)},a.extruded={filter:"function(){return feature.height || feature.min_height;}",draw:Nh(!0)},i[o]=a,t.b["outline_layer_"+t.a]=Oh(t.a,"outlines",r,t.f),t.b["polyline_layer_"+t.a]=Oh(t.a,"polylines",r,t.f)}return t.c&Cj.PROVIDES_OVERLAYS&&(t.b["overlay_layer_"+t.a]=Oh(t.a,"overlays",{"translucent-overlays":{color:[1,1,1,t.g],order:8190,interactive:!0}})),t.c&Cj.PROVIDES_MARKERS&&(t.b["marker_layer_"+t.a]=Oh(t.a,"markers",{markers:{sprite:Kh("icon.id"),offset:Kh("icon.offset"),collide:!1,priority:8191,elevate_by_altitude:!0,interactive:!0,stick:{color:Kh("icon.stick_color"),height:Kh("icon.stick_height")}}},t.f)),{sources:n,styles:e,layers:t.b}}function P(t){var e,r=""+cf();if(P.l.constructor.call(this),t=t||{},this.min=t.min||0,this.max=t.max||22,e=t.uri){if(/_/.test(e))throw new D(P,0,"uri "+e)}else e=r;if(this.uri=e||r,this.uid=r,t.getCopyrights&&wc(t.getCopyrights,"Function",P)&&(this.getCopyrights=t.getCopyrights),this.g=this.g.bind(this),this.za=!0,this.f=t.engineType||Vj.WEBGL,this.f===Vj.HARP&&!H.map.render.harp)throw new D(P,0,"HARP engine is not supported, module not found")}function Wj(t,e,r){t.dispatchEvent(new sd(t.i.Ea,r,e))}function Xj(t,e){e=Yd(e,0,1),E(e)&&(e=1),t.j!==e&&(t.j=e,t.za&&Yj(t),t.g(),Wj(t))}function Yj(t){if(t.f===Vj.WEBGL){var e=new Tj(t.getCapabilities(),t.uid,t.max,t.j,t.tileSize);t.b=new Th(Uj(e))}else t.f===Vj.HARP&&H.map.render.harp&&(t.b=new H.map.render.harp.Style({}));t.za=!0}function ak(t){var e;for(e in uc(this,ak),ak.l.constructor.call(this,t),this.Aa=t=[],Pg)t[Pg[e]]=new Lg}function N(t){t=t||{},N.l.constructor.call(this,t),this.c=t=new Q({min:t.min,max:t.max}),t.a=this,t.ka(this),t.wa(Mg.ADD),this.O=new wg,this.m=new wg,this.s=new Oj,this.v=new wg,this.J=new Oj,this.U=new wg}function bk(t,e,r,n,i,o,a){if(a=a||[],e.bd())for(t=e!==t.s&&e!==t.v,i=!i,r=(e=e.ig(r,o,o)).length,o=0;o<r;o++){var s,u=e[o].dj;if(s=void 0!==n){for(var l=yd(n),c=u;(s=c.v<=l&&c.s>=l)&&(c=c.Ha););s=!s}s||!i&&!u.Dc(!0)||(t||1===u.Cb().getState())&&a.push(u)}return a}function ck(t,e,r,n,i){var o=bk(t,t.s,e,r,n,i);return bk(t,t.v,e,r,n,i,o),o}function dk(t,e,r,n,i){var o=bk(t,t.J,e,r,n,i);return bk(t,t.U,e,r,n,i,o),o}function ek(t,e,r){var n,i=r.ba(),o=fk.bind(null,t);t=gk.bind(null,t),C(r,nh)?n=C(i,L)?o(i):i.pa.some(o):C(r,wi)?n=C(i,O)?t(i):i.pa.some(t):C(r,hk)&&(n=t(ni(i))),n&&e.push(r)}function fk(t,e){t:{var r=e.Y,n=si(t,e);if(!n){e=e.Y.length;for(var i=0;i<e;i+=3)if(qi(t,r[i],r[i+1])){t=!0;break t}}t=n}return t}function gk(t,e){return ti(t,e)}function ik(t,e,r){for(var n=t.length;n--;){var i=t[n],o=i.ba();if(C(o,Ji)){for(var a,s=(o=o.pa).length;s--;)if(qi(e,(a=o[s]).lat,a.lng)){r.push(i);break}}else qi(e,o.lat,o.lng)&&r.push(i)}}Ij.State={ERROR:-1,LOADING:0,READY:1},Ij.prototype.getState=function(){return this.A},Ij.prototype.getState=Ij.prototype.getState,Ij.prototype.i=function(t,e){if(this.a=e.getData(),1===t){var r=this.c;r||(r=this.c=e.Db()),this.b||(this.b=new I(r.w/2|0,r.h))}this.f&&(this.A=t,delete this.f,this.dispatchEvent("statechange"))},Ij.prototype.a=y,Ij.prototype.ad=function(){return this.a},Ij.prototype.getBitmap=Ij.prototype.ad,Ij.prototype.c=y,Ij.prototype.Db=function(){return this.c},Ij.prototype.getSize=Ij.prototype.Db,Ij.prototype.b=y,Ij.prototype.ud=function(){return this.b},Ij.prototype.getAnchor=Ij.prototype.ud,Ij.prototype.g=y,Ij.prototype.an=function(){return this.g},Ij.prototype.getHitArea=Ij.prototype.an,Ij.prototype.u=function(){Ij.l.u.call(this),this.a?(this.a.removeAttribute("src"),delete this.a):(this.f.cancel(),delete this.f)},u(Kj,hg),Kj.prototype.m=function(t){for(var e,r,n,i=this.head;t;){if(e=t.entries)if(r=e.length){if(2>r&&(n=t.parent)&&1===n.a){n.removeChild(t),i===t&&(i=n),n.entries=e,t=e[0].node=n;continue}}else if(delete t.entries,(n=t.parent)&&(n.removeChild(t),i===t&&(i=n),1===n.a)){t=n.a?n[0]||n[1]||n[2]||n[3]:null;continue}t=y}this.head!==i&&(this.head=i,mg(this))},Kj.prototype.Fc=function(t,e){if(rg(this.a,t,e,t,e))return Lj(this,this.a,t,e,this.c);throw Error("Coordinates out of bounds")},Nj.prototype.wd=function(t){return this[t%2]},n=Oj.prototype,n.Wh=0,n.bd=function(){return this.Wh},n.R=null,n.G=function(){var t,e=this.R;return!e&&(t=ig(this.a))&&(this.R=e=new K(-t[0],t[3],-t[2],t[1])),e},n.Fc=function(t){return++this.Wh,this.R=null,this.a.Fc(t.lng,-t.lat)},n.remove=function(t){return(t=this.a.remove(t))&&(--this.Wh,this.R=null),t},n.ig=function(t,e,r){var n=this.a,i=t.Rb(),o=t.Nb(),a=-i.lat;i=i.lng;var s=-o.lat;return o=o.lng,t.Gb()?n.ab(-180,a,o,s,r,e).concat(n.ab(i,a,180,s,r,e)):n.ab(i,a,o,s,r,e)},u(P,F),t("H.map.provider.Provider",P),P.prototype.i={Ce:"configchange",Ea:"update"},P.prototype.g=function(){this.dispatchEvent(this.i.Ce)},P.prototype.u=function(){F.prototype.u.call(this),this.b&&(this.b.removeEventListener("change",this.g),this.b=null)},P.prototype.ta=function(){return null},P.prototype.getCopyrights=P.prototype.ta,P.prototype.getCapabilities=function(){var t=0;return this.wi()&&(t|=Cj.PROVIDES_BY_VIEWPORT),this.providesRasters()&&(t|=Cj.PROVIDES_RASTERS),this.providesSpatials()&&(t|=Cj.PROVIDES_SPATIALS),this.providesOverlays()&&(t|=Cj.PROVIDES_OVERLAYS),this.providesMarkers()&&(t|=Cj.PROVIDES_MARKERS),this.providesDomMarkers()&&(t|=Cj.PROVIDES_DOM_MARKERS),this.providesGeoJSON()&&(t|=Cj.PROVIDES_GEOJSON),this.providesOMV()&&(t|=Cj.PROVIDES_OMV),t},P.prototype.getCapabilities=P.prototype.getCapabilities,P.prototype.wi=ef,P.prototype.pf=ef,P.prototype.providesRasters=P.prototype.pf,P.prototype.Jc=ef,P.prototype.providesSpatials=P.prototype.Jc,P.prototype.yi=ef,P.prototype.providesOverlays=P.prototype.yi,P.prototype.Wb=ef,P.prototype.providesMarkers=P.prototype.Wb,P.prototype.Vb=ef,P.prototype.providesDomMarkers=P.prototype.Vb,P.prototype.xi=ef,P.prototype.providesGeoJSON=P.prototype.xi,P.prototype.Ed=ef,P.prototype.providesOMV=P.prototype.Ed,P.prototype.Tm=function(){return this.f},P.prototype.getEngineType=P.prototype.Tm,P.prototype.nf=hd,P.prototype.preprocessData=P.prototype.nf,P.prototype.j=1,P.prototype.rn=function(){return this.j},P.prototype.getOpacityInternal=P.prototype.rn,P.prototype.ac=function(t,e){var r=this;if(this.f===Vj.WEBGL&&!C(t,Th)||this.f===Vj.HARP&&!C(t,H.map.render.harp.Style))throw t=Object.entries(Vj).find(function(t){return t[1]===r.f}),new D(this.ac,0,"Invalid style for engineType "+t);this.b&&(this.b.removeEventListener("change",this.g),this.b.removeEventListener(Rh,this.g)),this.b=t,this.b.addEventListener("change",this.g),this.b.addEventListener(Rh,this.g),e||this.g(),this.za=!1},P.prototype.setStyleInternal=P.prototype.ac,P.prototype.ub=function(){return this.b||Yj(this),this.b},P.prototype.getStyleInternal=P.prototype.ub,P.prototype.ak=function(){var t=this.getCapabilities(),e=Zj.FEATURE;return t&Cj.PROVIDES_BY_VIEWPORT?e=Zj.SOURCE:t&Cj.PROVIDES_RASTERS?e=null:t&Cj.PROVIDES_WEBGL_RENDERABLE_OBJECTS&&(e=Zj.PROVIDER),e},P.prototype.getPickingMode=P.prototype.ak,P.prototype.Xm=function(){return!1},P.prototype.getFeatureProxy=P.prototype.Xm,u(ak,P),t("H.map.provider.ObjectProvider",ak),ak.prototype.wi=df,ak.prototype.providesByViewport=ak.prototype.wi,ak.prototype.Pb=function(t){return this.Aa[t||Pg.ANY]},ak.prototype.getInvalidations=ak.prototype.Pb,ak.prototype.ke=function(t,e){if(e!==Mg.NONE){var r=this.Aa[Pg.ANY],n=r.a+1;r.update(n,e),(r=this.Aa[t.type]).update(n,e),t.Pb().update(n,e),Wj(this,t)}},ak.prototype.invalidateObject=ak.prototype.ke,ak.prototype.requestOverlays=ak.prototype.Hd,ak.prototype.requestSpatials=ak.prototype.Ag,ak.prototype.requestSpatialsByTile=ak.prototype.Bg,ak.prototype.yb=!1,ak.prototype.requestMarkers=ak.prototype.Lc,ak.prototype.requestDomMarkers=ak.prototype.Kc,u(N,ak),t("H.map.provider.LocalObjectProvider",N),N.prototype.getCapabilities=function(){return Cj.PROVIDES_BY_VIEWPORT|Cj.PROVIDES_WEBGL_RENDERABLE_OBJECTS|Cj.PROVIDES_DOM_MARKERS|Cj.CROP_LINES_BY_TILE},N.prototype.ub=function(){if(!this.fa){this.fa=N.l.ub.call(this);var t=new Tj(this.getCapabilities()|Cj.HAS_VOLATILE_DATA,this.uid+"_vol",this.max,this.j,this.tileSize);this.fa.hf(Uj(t))}return this.fa},N.prototype.kc=function(){return this.c},N.prototype.getRootGroup=N.prototype.kc,N.prototype.ke=function(t,e){e&Mg.SPATIAL&&this.ea(t),N.l.ke.call(this,t,e)},N.prototype.invalidateObject=N.prototype.ke,N.prototype.ea=function(t){var e;if(C(t,M,this.ea,0),t.a!==this)throw new Xc(this.ea,"foreign object");this.Ia(t);var r=t.type;if(r===Pg.MARKER)if((e=t.ba())instanceof Wf){var n=!0;r=this.s}else r=this.v;else r===Pg.DOM_MARKER?(e=t.ba())instanceof Wf?(n=!0,r=this.J):r=this.U:r=r===Pg.OVERLAY?this.O:this.m;(n=n?r.Fc(e):r.mk(t.G())).dj=t,t.ma=n},N.prototype.Ia=function(t){var e;if(t)if(t.a!==this){if(C(t,M))throw new Xc(this.Ia,"foreign object")}else if(e=t.ma){var r=t.type;r===Pg.MARKER?this.s.remove(e)||this.v.remove(e):r===Pg.DOM_MARKER?this.J.remove(e)||this.U.remove(e):r===Pg.OVERLAY?this.O.remove(e):this.m.remove(e),delete e.dj,delete t.ma}},N.prototype.removeObject=N.prototype.Ia,N.prototype.yi=function(){return 0<this.O.bd()},N.prototype.providesOverlays=N.prototype.yi,N.prototype.Hd=function(t,e,r){return bk(this,this.O,t,e,r,!1).filter(function(t){return t.ad()})},N.prototype.requestOverlays=N.prototype.Hd,N.prototype.Jc=function(){return 0<this.m.bd()},N.prototype.providesSpatials=N.prototype.Jc,N.prototype.Ag=function(t,e,r){return bk(this,this.m,t,e,r,!1)},N.prototype.requestSpatials=N.prototype.Ag,N.prototype.Bg=function(t,e){return bk(this,this.m,t.bg(),t.zL,e,!1)},N.prototype.requestSpatialsByTile=N.prototype.Bg,N.prototype.Wb=function(){return 0<this.s.bd()+this.v.bd()},N.prototype.providesMarkers=N.prototype.Wb,N.prototype.Lc=function(t,e,r){return ck(this,t,e,r,!1)},N.prototype.requestMarkers=N.prototype.Lc,N.prototype.Vb=function(){return 0<this.J.bd()+this.U.bd()},N.prototype.providesDomMarkers=N.prototype.Vb,N.prototype.Kc=function(t,e,r){return dk(this,t,e,r,!1)},N.prototype.requestDomMarkers=N.prototype.Kc,N.prototype.Va=function(t,e,r,n,i){for(var o=this,a=t.G(),s=[],u=Wb(),l=1;l&Pg.ANY;){if(l&n)switch(l){case Pg.MARKER:u=u.then(function(){return ck(o,a,r,e,!0)}).then(function(e){return ik(e,t,s)});break;case Pg.DOM_MARKER:u=u.then(function(){return dk(o,a,r,e,!0)}).then(function(e){return ik(e,t,s)});break;case Pg.SPATIAL:u=u.then(function(){return bk(o,o.m,a,r,e,!0)}).then(function(e){e.forEach(ek.bind(null,t,s))});break;case Pg.OVERLAY:u=u.then(function(){return bk(o,o.O,a,r,e,!0)}).then(function(e){e.forEach(ek.bind(null,t,s))})}l<<=1}u.then(function(){return i(s)})},N.prototype.u=function(){N.l.u.call(this),this.c.qa()};var jk={PENDING:0,ACTIVE:1,DONE:2};function kk(t,e){var r;if(e=e||{},!C(t,Element))throw new D(kk,0,t);var n=t.ownerDocument.createElement("div");this.S=t,kk.l.constructor.call(this),this.padding=new lk(0,0,0,0),this.center=new I(0,0),this.margin=0,this.element=n,n.style.zIndex=0,n.style.height=n.style.width="100%",n.style.direction="ltr",n.style.position="relative"===t.style.position?"absolute":"relative",this.resize(),t.appendChild(n),(r=e.padding)!==B&&this.Mi(r.top,r.right,r.bottom,r.left),this.Hi((r=e.margin)!==B?r:0)}function mk(t){var e=t.padding;t.center.set((t.width+e.left-e.right)/2<<0,(t.height+e.top-e.bottom)/2<<0)}function nk(t,e,r,n,i,o){var a;for(a=[];n<=i;n++)a=a.concat(ok(t,r,n));for(t=a.length,hj.call(this,o,t),this.j=r=[],this.f=A(this.f,this),this.c=A(this.c,this),this.P(1);t--;)o=a[t],r.push(pk(e,o[0],o[1],o[2],this.f,this.c))}function qk(){}function rk(t,e){var r=this;if(!Ca(e))throw new D(sk,1,e);if(!Ca(t.next||Ca(t.cycle)))throw new D(rk,2,'Argument "mode" must implement H.util.AsyncQueue.Mode');this.b=[],this.c=[],this.g=t,this.i=e,this.j=function(){tk(r)},this.a=null,this.f=function(){r.a||(r.a=x.setTimeout(r.j,1))}}function tk(t){var e=t.c,r=0,n=t.g;for(n.a(),t.a=null;r<e.length;){var i=e[r];i.rk?e.splice(r,1):r++}for(;i=n.next(t.b,t.c);)i.cancelled?i.done(null,"cancelled"):(e.push(i),t.i(i,i.data))}function vk(){uk(this,null,null,null)}function uk(t,e,r,n){return t.data=e,t.cancelled=!1,t.rk=!1,t.b=r,t.c=n,t.a=null,t}function wk(){}function xk(t,e){xk.l.constructor.call(this,new yk(t),e)}function yk(t){if(isNaN(t)||0>t)throw new D(xk,1,'Argument "maxTime" must be a positive number');this.b=t,this.Rc=zk()}function Ak(t){if(uc(this,Ak),Ak.l.constructor.call(this,t),t&&"tileSize"in t){var e=Bd(+t.tileSize)/Ld;if(isNaN(e)||e%1||0>e||30<e)throw new D(Ak,0,"tileSize: "+t.tileSize);this.tileSize=+t.tileSize}}function Bk(t,e){return Vd(t)-8-xd(Vd(e))}function Ck(){}function Dk(t,e,r){if(this.g=[],e&&this.re(e),r&&!Ca(r))throw new D(Dk,2,r);this.b=0,this.filter=r,this.a={},this.f=this.c=null,this.Ji(t)}function Fk(t,e){return e&&(t.c=Gk(t,e,t.c)),e}function Hk(t){for(;t.b>t.i&&t.f;)Ik(t,t.f,!0)}function Gk(t,e,r){return r!==e&&((e.oc||e.jd)&&Ik(t,e,!1),(e.oc=r)&&(e.jd=r.jd,r.jd=e),e.jd||(t.c=e),e.oc||(t.f=e),t.b+=e.size),e}function Ik(t,e,r){var n=e.jd,i=e.oc;(n||i||e==t.c&&e==t.f)&&(n?n.oc=i:t.c=i,i?i.jd=n:t.f=n,t.b-=e.size,r&&(delete t.a[e.id],Ek(t,e))),e.oc=e.jd=null}function Ek(t,e){for(var r=t.g.length;r--;)t.g[r].call(t,e.id,e.data,e.size)}t("H.map.render.RenderState",jk),u(kk,F),t("H.map.ViewPort",kk),kk.prototype.a={Ea:"update",Fe:"sync"},kk.prototype.Hi=function(t){if(this.margin!==+t){if(E(this.margin=+t))throw new D(this.Hi,0,t);mk(this),this.dispatchEvent(this.a.Ea)}},kk.prototype.setMargin=kk.prototype.Hi,kk.prototype.Mi=function(t,e,r,n){var i=this.padding;if(i.top!==t||i.right!==e||i.bottom!==r||i.left!==n){if(E(t+e+r+n))throw new D(this.Mi);i.top=t,i.right=e,i.bottom=r,i.left=n,mk(this),this.dispatchEvent(this.a.Ea)}},kk.prototype.setPadding=kk.prototype.Mi,kk.prototype.resize=function(){var t=this.S.offsetWidth,e=this.S.offsetHeight;this.width===t&&this.height===e||(this.c=new Ki(this.width,this.height),this.width=t,this.height=e,mk(this),this.dispatchEvent(this.a.Ea))},kk.prototype.resize=kk.prototype.resize,kk.prototype.bb=function(t){this.dispatchEvent(new Ri(this.a.Fe,this.c,t,Si.SIZE))},kk.prototype.synchronize=kk.prototype.bb,kk.prototype.u=function(){x.clearTimeout(this.b),this.b=null,this.S.removeChild(this.element),this.element=this.S=null,kk.l.u.call(this)},kk.prototype.uc=Nc,kk.prototype.startInteraction=kk.prototype.uc,kk.prototype.lc=Nc,kk.prototype.interaction=kk.prototype.lc,kk.prototype.Bb=Nc,kk.prototype.endInteraction=kk.prototype.Bb,u(nk,hj),nk.prototype.f=function(){jj(this,2)},nk.prototype.c=function(){jj(this,4)},nk.prototype.Ie=function(){for(var t=this.j,e=t.length;e--;)t[e].cancel();this.j=y},t("H.util.ICancelable",qk),qk.prototype.cancel=function(){},qk.prototype.cancel=qk.prototype.cancel,t("H.util.AsyncQueue",rk),rk.prototype.push=function(t,e){if(!Ca(e))throw new D(this.push,1,e);return t=uk(new vk,t,this.f,e),this.b.push(t),this.f(),t},rk.prototype.push=rk.prototype.push,rk.Task=vk,vk.prototype.done=function(t,e){this.rk=!0,this.b(),this.c(this,t,e)},vk.prototype.done=vk.prototype.done,vk.prototype.cancel=function(){this.a&&this.a(),this.cancelled=!0},vk.prototype.cancel=vk.prototype.cancel,vk.prototype.$o=function(t){return this.a=t,this},vk.prototype.setCancelFn=vk.prototype.$o,rk.Mode=wk,wk.prototype.next=function(){},wk.prototype.a=function(){},u(xk,rk),t("H.util.SequentialQueue",xk),yk.prototype.next=function(t){return t.length&&zk()-this.Rc<this.b?t=t.shift():null},yk.prototype.a=function(){this.Rc=zk()},u(Ak,P),t("H.map.provider.TileProvider",Ak),Ak.getZoomLevelOffset=Bk,Ak.prototype.yd=function(t,e,r){return this.uri.concat("_",t,"_",e,"_",r)},Ak.prototype.getTileKey=Ak.prototype.yd,Ak.prototype.Df=256,Ak.prototype.tileSize=Ak.prototype.Df,t("H.util.ICache",Ck),Ck.prototype.add=function(){},Ck.prototype.add=Ck.prototype.add,Ck.prototype.get=function(){},Ck.prototype.get=Ck.prototype.get,Ck.prototype.Uf=function(){},Ck.prototype.drop=Ck.prototype.Uf,Ck.prototype.forEach=function(){},Ck.prototype.forEach=Ck.prototype.forEach,Ck.prototype.qa=function(){},Ck.prototype.removeAll=Ck.prototype.qa,Ck.prototype.re=function(){},Ck.prototype.registerOnDrop=Ck.prototype.re,Ck.prototype.lh=function(){},Ck.prototype.deRegisterOnDrop=Ck.prototype.lh,t("H.util.Cache",Dk),Dk.prototype.add=function(t,e,r){var n,i;if(!Cc(r=+r)||0>r)throw new D(this.add,2,r);return t=String(t),(i=!this.filter||this.filter(t,e,r))&&((n=this.a[t])?(n.data!==e&&Ek(this,n),this.b+=r-n.size,n.size=r,n.data=e,Fk(this,n)):this.a[t]=Gk(this,{id:t,data:e,size:r,oc:null,jd:null},this.c),Hk(this)),i},Dk.prototype.add=Dk.prototype.add,Dk.prototype.re=function(t){if(!Ca(t))throw new D(this.re,0,t);this.g.push(t)},Dk.prototype.registerOnDrop=Dk.prototype.re,Dk.prototype.lh=function(t){this.g=this.g.filter(function(e){return e!==t})},Dk.prototype.deRegisterOnDrop=Dk.prototype.lh,Dk.prototype.get=function(t,e){return(t=e?this.a[t]:Fk(this,this.a[t]))&&t.data},Dk.prototype.get=Dk.prototype.get,Dk.prototype.Uf=function(t){var e;(e=this.a[t])&&Ik(this,e,!0)},Dk.prototype.drop=Dk.prototype.Uf,Dk.prototype.forEach=function(t,e,r){var n;for(n in this.a){var i=this.a[n];(!r||r(n,i.data,i.size))&&t.call(e,n,i.data,i.size)}},Dk.prototype.forEach=Dk.prototype.forEach,Dk.prototype.qa=function(t){var e;for(e in this.a){var r=this.a[e];(!t||t(e,r.data,r.size))&&Ik(this,this.a[e],!0)}},Dk.prototype.removeAll=Dk.prototype.qa,Dk.prototype.Ji=function(t){if(!(0<+t))throw new D(Dk.prototype.Ji,0,t);return this.i=+t,Hk(this),this},Dk.prototype.setMaxSize=Dk.prototype.Ji,Dk.prototype.pn=function(){return this.i},Dk.prototype.getMaxSize=Dk.prototype.pn,Dk.prototype.Nm=function(){return this.b},Dk.prototype.getCurrentSize=Dk.prototype.Nm;var Jk,Kk=function(){function t(){}for(var e,r,n,i=rc("o ms moz webkit "),o=5;o--&&!e;)e=i[o],e=(r=x[e+(e?"R":"r")+"equestAnimationFrame"])&&!E(r.call(window,t))&&(n=x[e+(e?"C":"c")+"ancelAnimationFrame"]);return Jk=e?function(t){return r.call(x,t)}:function(t){return x.setTimeout(t,25)},e?function(t){return n.call(x,t)}:function(t){return x.clearTimeout(t)}}(),zk=x.performance&&x.performance.now?function(){return x.performance.now()}:function(){return x.Date.now()};function Lk(t,e,r,n){this.key="",this.x=t,this.y=e,this.z=r,this.data=n,this.valid=!0}function Mk(t,e,r,n){return(t-=r)*t+(e-=n)*e}function Nk(t,e,r){return Ok(t,e*e,r||0,0,t.length-1)}function Ok(t,e,r,n,i){var o=0,a=n,s=t[n].x,u=t[n].y,l=t[i].x,c=t[i].y,h=n+1,f=Mk(s,u,l,c);if(f)for(;h<i;){var p=t[h++],d=p.x,v=((d-s)*(l-s)+((p=p.y)-u)*(c-u))/f;(d=0>v?Mk(d,p,s,u):1<v?Mk(d,p,l,c):Mk(d,p,s+v*(l-s),u+v*(c-u)))>o&&(o=d,a=h-1)}else for(;h<i;)(d=Mk(d=(p=t[h++]).x,p=p.y,s,u))>o&&(o=d,a=h-1);return o>=e||0<r&&a-n?(--r,1<a-n?(n=Ok(t,e,r,n,a)).splice(n.length-1,1):n=[t[n]],n=1<i-a?n.concat(Ok(t,e,r,a,i)):n.concat(t.slice(a,i+1))):n=[t[n],t[i]],n}function Pk(t,e,r,n,i,o,a,s){Pk.l.constructor.call(this,e,r,n,null),this.key=t,this.aa=s,this.a=i,this.g=o,this.i={},this.zL=a,this.o=zd(Ug.MAX_LINE_WIDTH/2*this.g+1)}function Qk(t){return t.aa.getInvalidations(Pg.SPATIAL)}function Rk(t){var e,r=Qk(t),n=r.a,i=t.c,o=i===n;if(!(o||r.pk(i)||r.Qh(i))){o=t.f;var a=t.i;if(r.kg(i))for(e=o.length;e--;){var s=o[e];if(s.Pb().kg(i)){o.splice(e,1);var u=u||Sk(t,s.gb())}}if(r.Rh(i)){for(e=o.length;e--;)if((s=o[e]).Pb().Rh(i)){var l=1;if((s=a[s.gb()])&&s.a){u=1;break}}l&&o.sort(Tk)}if(!u&&r.me(i))for(e=o.length;e--;)if(o[e].Pb().me(i)){var c=1;break}t.s!==i||c||(t.s=n,t.b!==i||u||(t.b=n)),t.c=n,o=!0}return o}function Uk(t,e){this.b=t,this.a=e}function Sk(t,e){var r=(t=t.i)[e];if(r)return delete t[e],r.a}function Vk(t){var e,r=Qk(t),n=t.c,i=t.f;if(!Rk(t)){for(e=i.length;e--;){var o=i[e],a=o.Pb();(a.kg(n)||a.Qh(n))&&Sk(t,o.gb())}t.f=t.aa.requestSpatialsByTile(t,!1,!1).sort(Tk),t.c=r.a}}function Tk(t,e){return Qg(t.ed(),e.ed(),!1)}t("H.map.provider.Tile",Lk),t("H.math.simplifyDP",Nk),u(Pk,Lk),t("H.map.provider.SpatialTile",Pk),Pk.prototype.c=Ud,Pk.prototype.s=Ud,Pk.prototype.b=Ud,Pk.prototype.le=function(){var t=Qk(this),e=t.a,r=this.b,n=r===e;return n||(this.aa.yb&&!t.me(r)?n=!0:Rk(this)&&(n=this.b===e)),n},Pk.prototype.isCanvasValid=Pk.prototype.le,Object.defineProperty(Pk.prototype,"valid",{get:function(){return this.le()},set:hd,configurable:!0}),Pk.prototype.f=ff,Pk.prototype.Va=function(){return this.f},Pk.prototype.getObjects=Pk.prototype.Va,Pk.prototype.Mn=function(){return this.a},Pk.prototype.getTileSize=Pk.prototype.Mn;var Wk={};function Yk(t,e,r,n,i,o,a,s,u){var l=t.a,c=-a;if(a=o+a,s=s||0,u===B&&(u=l.length),i&&t===dh)e.fillRect(0,0,o,o);else if(u>s){for(e.beginPath(),o=s;o<u;o++){var h=l[o],f=h.length;if(h===vi)e.moveTo(c,c),e.lineTo(c,a),e.lineTo(a,a),e.lineTo(a,c);else{var p=h[0];for(e.moveTo(p.x,p.y),s=1;s<f;s++)p=h[s],e.lineTo(p.x,p.y)}r&&e.closePath()}r&&i&&e.fill(t.b!==Td?"evenodd":"nonzero"),n&&e.stroke()}}function Xk(t,e,r){var n;t.strokeStyle=e.strokeColor,t.lineWidth=e.lineWidth*r,t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.setLineDash&&(n=e.lineDash)!==ff&&(t.setLineDash(n),t.lineDashOffset=e.lineDashOffset)}function Zk(t,e){t.fillStyle=e.fillColor}function $k(t,e,r,n,i,o){var a=i*n.width/2,s=(i=i*n.length/2)/2;n=2*i*n.frequency;var u=Cd(Dd(i,2)+Dd(a,2));t=new lk(u,u,t=t.a-u,t),r=r.a;var l,c,h,f,p,d,v,y=Md/2;for(o=o||0,u=r.length;u-- >o;){var g=0,m=r[u];if(c=l=m.length){var _=m;for(c=_.length,h=0;--c;)h+=_[c].Za(_[c-1]);c=(_=h)>=n}if(c)for(h=(c=_/((c=vd(yd(_/n),1e3))+1))/2;--l;){for(f=(p=m[l]).Za(d=m[l-1]);h<=g+f;){var b=p.x+(d.x-p.x)*(v=(h-g)/f);v=p.y+(d.y-p.y)*v,t.Pf(b,v)&&(e.save(),e.translate(b,v),e.rotate(-Jd((d.y-p.y)/(p.x-d.x))+(p.x<d.x?y:-y)),e.beginPath(),e.moveTo(-a,-i),e.lineTo(0,i),e.lineTo(a,-i),e.lineTo(0,-s),e.closePath(),e.fill(),e.restore()),h+=c}g+=f}}}Pk.prototype.af=function(){var t=this.a+"_"+this.g,e=Wk[t];if(!e){e=-this.o;var r=this.a-e;e=Wk[t]=new lk(e,e,r,r)}return e},Pk.prototype.getPxClipRect=Pk.prototype.af,Pk.prototype.bg=function(){var t=this.sb;if(!t){var e=this.dg();t=0;var r=this.a;this.z&&(r-=t+=this.af().top),t=this.sb=dg(e.lf(new I(t,t)),e.lf(new I(r,r)))}return t},Pk.prototype.getGeoClipRect=Pk.prototype.bg,Pk.prototype.dg=function(){var t=this.v;if(!t){var e=this.a;(t=this.v=new Yi(B,e)).Qa(this.z),t.x=this.x*e,t.y=this.y*e}return t},Pk.prototype.getPxProj=Pk.prototype.dg,Pk.prototype.$a=function(){return this.g},Pk.prototype.getPixelRatio=Pk.prototype.$a,Pk.prototype.xg=function(){var t=this.data;return this.data=null,this.b=Ud,t},Pk.prototype.releaseCanvas=Pk.prototype.xg,Pk.prototype.yg=function(){this.i={},delete this.f,this.c=Ud},Pk.prototype.releaseData=Pk.prototype.yg,Pk.prototype.V=function(t){var e,r,n,i,o=t.getContext("2d"),a=0;if(Vk(this),this.b<this.c){var s=this.f;if(e=s.length){t.width=t.height=this.a,o.clearRect(0,0,this.a,this.a);var u=this.i;for(r=0;r<e;r++){var l=s[r],c=l.gb();if(i=(n=u[c])?n.b:l.getGeometriesForTile(this)){if(n)l.Pb().me(this.b)&&(n.a=ch(l,i)),n=n.a;else{var h;n=ch(l,i);for(var f=i,p=l.j?2:0,d=f.length;d--;){var v=f[d];if(v!==dh){var y=v.a;for(h=y.length;h--;)4<(v=y[h]).length&&(y[h]=Nk(v,.6,p))}}this.i[c]=new Uk(i,n)}if(n){for(o.save(),f=l.j?this.O:this.C,c=0;c<i.length;c++)f.call(this,l,i[c],l.ua(),o);if(i=l.getLabels(this))for(l=o,c=i.length;c--;)for(f=(p=i[c]).size,l.font=f+"px "+p.font,l.fillStyle=p.color,l.textAlign="center",l.translate(p.x,p.y),l.rotate(p.angle),f=p.lineHeight||1.375*f,p=(d=p.lines).length;p--;)l.fillText(d[p],0,p*f);o.restore()}a|=n}}}this.data=a?t:null,this.s=this.b=this.c}else this.data&&(a=1);return 0<a},Pk.prototype.render=Pk.prototype.V,Pk.prototype.C=function(t,e,r,n){var i;r.cf&&(Xk(n,r,this.g),Yk(e,n,!1,!0,!1,this.a,this.o)),r.bf&&(i=t.g)&&i.Sb&&(Zk(n,i),$k(this,n,e,i,r.lineWidth))},Pk.prototype.O=function(t,e,r,n){var i,o=r.Sb,a=r.cf,s=this.a,u=this.o;if(e===dh)o&&(Zk(n,r),n.fillRect(0,0,s,s));else{if(a&&Xk(n,r,this.g),r.bf&&(i=t.g)){var l=r.lineWidth;i.Sb||(i=null)}(t=e.c)===Td?((a||o)&&(Zk(n,r),Yk(e,n,!0,a,o,s,this.o)),i&&(Zk(n,i),$k(this,n,e,i,l,0))):(o&&(Zk(n,r),Yk(e,n,!0,!1,o,s,u,0,t)),a&&Yk(e,n,!1,a,!1,s,u,t),i&&(Zk(n,i),$k(this,n,e,i,l,t)))}};var al=[];function bl(t,e){var r;bl.l.constructor.call(this,e),this.C=t,this.N=t=e.pixelRatio,this.tileSize=r=1<<xd(Vd((e.tileSize||256)*t)),this.U=Bk(r,t),this.Zh=A(this.Zh,this),this.ni=A(this.ni,this),this.$h=A(this.$h,this),this.Yh=A(this.Yh,this),this.v=A(this.v,this),this.C.addEventListener(P.prototype.i.Ea,this.v,!1,this),this.c=[],this.m=new Dk(e.tileCacheSize||256,this.Zh),this.s=new Dk(e.dataCacheSize||512,this.ni),this.J=new xk(20,this.$h),this.a={},this.O=zk()}function cl(t,e){if(e=e||{},!t)throw new D(cl,0,t);this.tileSize=t.tileSize,this.c={},aj.call(this,{min:void 0!==e.min?e.min:t.min,max:void 0!==e.max?e.max:t.max,minWorldSize:this.tileSize,projection:e.cl,dark:e.dark,provider:t})}function el(t,e,r,n,i){n=yd(n);var o=Dd(2,n),a=e.left,s=e.top,u=e.right;r=u+(r?o+(u===e.left?0:1):1);var l=e.bottom,c=[];if(i)var h=a+(1+u-a)/2+i.x/t.tileSize-.5,f=s+(1+l-s)/2+i.y/t.tileSize-.5;for(;a<r;){for(s=e.top;s<=l;)t=a%o,c.push([t,s,n,i?Ad(h-a)+Ad(f-s):0]),s++;a++}return c}function ok(t,e,r){return r=yd(r),t.pixelProjection.Qa(r),e=t.Te(e),el(t,t.je(e,r),e.left>e.right,r)}function fl(t,e){return e[3]-t[3]}function R(t){uc(this,R),R.l.constructor.call(this,t),this.ec=new gl,this.gc=A(this.gc,this),this.U=hl,this.createTileInternal=this.rd.bind(this)}Pk.prototype.Ga=function(t,e,r){for(var n,i,o,a,s,u,l,c=this.f,h=c.length,f=ff,p=this.g;h--;)if((i=c[h]).Dc(!0)&&(o=this.i[i.gb()])&&(a=o.b)){for(u="none"!==(n=i.ua()).fillColor&&i.j,l="none"===n.strokeColor?0:n.lineWidth*p,n=a.length;n--;){var d;if(s=a[n],!(d=u&&s===dh)&&(d=u||l)){var v;d=t;var y=e,g=u,m=l,_=s.b,b=s.c,x=b!==Td,w=s.a,E=w.length,T=0,A=0,k=!1;for(s=0;s<E;s++){var S=w[s],M=s>=b,O=!M&&s>=_;if(S===vi&&g)O?T++:A++;else{var I=S.length;for(al.length=2*I,v=0;v<I;v++){var L=S[v];al[2*v]=L.x,al[2*v+1]=L.y}if(v=g&&!M,M=x&&!M?0:m,v||M){if((M=be(d,y,al,M,v))===ae.EDGE||M===ae.VERTEX){k=!0;break}if(M===ae.SURFACE)if(O)T++;else if(A++,_===Td)break}}}d=k||0<A&&!(T%2)}if(d){f===ff&&(f=[]),f.push(i);break}}if(r&&f.length)break}return f},u(bl,Ak),bl.prototype.v=function(t){t.target.type===Pg.SPATIAL&&Wj(this,t.target)},bl.prototype.jb=function(t,e,r,n){var i,o=this.getTileKey(t,e,r);if(i=this.m.get(o,n)){if(n||i.le())return i;n||this.m.Uf(o)}if((i=this.s.get(o,n))&&(n||Rk(i)))return t=this.c.pop()||document.createElement("canvas"),i.V(t)||this.c.push(t),this.m.add(o,i,1),i;n||((i=this.a[o])?i.count++:((i=this.J.push([o,t,e,r],this.Yh)).count=1,this.a[o]=i))},bl.prototype.requestTile=bl.prototype.jb,bl.prototype.rd=function(){},bl.prototype.Wc=function(t,e,r){this.Lf(this.getTileKey(t,e,r))},bl.prototype.cancelTile=bl.prototype.Wc,bl.prototype.Lf=function(t){var e;(e=this.a[t])&&(e.count--,e.count||(e.cancel(),delete this.a[t]))},bl.prototype.cancelTileByKey=bl.prototype.Lf,n=bl.prototype,n.$h=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3];n=(r=this.m.get(r)||new Pk(r,n,i,o,this.tileSize,this.N,o+this.U,this.C)).data||this.c.pop()||document.createElement("canvas"),r.V(n)||this.c.push(n),e.push(r),t.done(r)},n.Yh=function(t,e){t=t.data[0],e&&this.m.add(t,e,1),delete this.a[t],Wj(this)},n.Zh=function(t,e){e.data&&this.c.push(e.xg()),this.s.add(t,e,1)},n.ni=function(t,e){e.yg()},n.u=function(){for(var t in this.a)this.a[t].cancel();this.m.qa(),this.s.qa(),this.c.length=0,bl.l.u.call(this)},u(cl,aj),t("H.map.layer.BaseTileLayer",cl),cl.prototype.Te=function(t,e){var r=this.pixelProjection;if(!C(t,K))throw new D(this.Te,0,t);if(!E(e)){var n=r.gk();r.Qa(e)}return t=dl(r.lb(t.Rb()),r.lb(t.Nb())),!E(n)&&r.Qa(n),t},cl.prototype.geoRectToRect=cl.prototype.Te,cl.prototype.je=function(t,e){var r=Dd(2,yd(e)),n=this.tileSize;if(!C(t,lk))throw new D(this.je,0,t);if(E(e=+e))throw new D(this.je,1,e);(e=yd(t.left/n))===r&&--e;var i=yd(t.right/n);return i===r&&--i,new lk(e,Yd(yd(t.top/n),0,r-1),i,Yd(yd(t.bottom/n),0,r-1))},cl.prototype.getTileBounds=cl.prototype.je,cl.prototype.jb=function(t,e,r,n){return this.a.requestTile(t,e,r,n)},cl.prototype.Wc=function(t,e,r){this.a.cancelTile(t,e,r)},cl.prototype.cancelTile=cl.prototype.Wc,cl.prototype.ta=function(t,e){return this.a.getCopyrights?this.a.getCopyrights(t,e):null},cl.prototype.getCopyrights=cl.prototype.ta,cl.prototype.$e=function(t,e,r,n,i,o){var a,s,u=[],l=this.a;o=null!=o?o:"__default__";var c=l.requestTile;if(!C(t,lk))throw new D(this.$e,0,t);if(E(r=+r))throw new D(this.$e,1,r);if(n||(a={}),t=(e=el(this,t,e,r,i)).length)for(n||e.sort(fl),r=t;r--;)i=e[r],n||(a[l.yd.apply(l,i)]=!0),i[3]=+n,(s=c.apply(l,i))&&u.push(s);if(!n){var h;for(h in n=a,a=this.c[o]||{})a.hasOwnProperty(h)&&a[h]&&!n[h]&&this.a.cancelTileByKey(h);this.c[o]=n}return{total:t,tiles:u}},cl.prototype.getProviderTiles=cl.prototype.$e,u(R,Ak),t("H.map.provider.RemoteTileProvider",R),R.prototype.Yd=function(){return 1},R.prototype.getEntryWeight=R.prototype.Yd;var hl=new Dk(65536);function pk(t,e,r,n,i,o){return n=~~n,t.requestInternal(e,r,n,function(a,s){t.ge().put(t.yd(e,r,n),{raw:s&&s.raw||a,timestamp:x.Date.now()},i,o)},o,0)}function jl(t,e){delete t.m[e],delete t.fa[e]}function il(t){for(var e in t.m)t.gc(e)&&t.cancelTileByKey(e)}R.prototype.m={},R.prototype.fa={},R.prototype.Ob=function(){return this.U},R.prototype.getCache=R.prototype.Ob,R.prototype.O=ba(3),R.prototype.gc=function(t){var e=this.uri;return!t.indexOf(e)&&"_"===t.charAt(e.length)},R.prototype.cacheFilter=R.prototype.gc,R.prototype.Xa=function(t,e){e.valid=!1},R.prototype.reload=function(t){var e=this.getCache();t?e.qa(this.gc):e.forEach(this.Xa,this,this.gc),il(this),Wj(this,this,{isReload:!0})},R.prototype.reload=R.prototype.reload,R.prototype.fh=function(){return!1},R.prototype.MAX_STORE_TIME=1/0,R.prototype.ge=function(){return this.ec},R.prototype.ma=function(t,e){e(t)},R.prototype.requestInternal=R.prototype.K,R.prototype.jb=function(t,e,r,n){var i=this,o=this.getCache();if(E(t=+t))throw new D(this.jb,0,t);if(E(e=+e))throw new D(this.jb,0,e);if(E(r=+r))throw new D(this.jb,0,r);r=~~r;var a=this.getTileKey(t,e,r);return(o=o.get(a))&&o.valid||n||this.m[a]||(o=B,this.requestTileAsPromise(t,e,r,n).then(function(t){Wj(i,t)},hd)),o},R.prototype.requestTile=R.prototype.jb,R.prototype.ll=function(t,e,r,n){var i,o=this,a=this.getCache(),s=this.getTileKey(t,e,r),u=this.m,l=this.fa,c=this.ge();return l[s]?l[s]:(l[s]=l=new Ob(function(l,h){function f(i){var f,p,d=function(n,i){(p=o.createTileInternal(t,e,r,n,i)).key=s,a.add(s,p,o.Yd(n)),l(p),jl(o,s)};i&&(f=x.Date.now()-i.timestamp),i&&f<o.MAX_STORE_TIME?o.ma(i.raw,d):(f&&c.remove(s),(p=a.get(s))&&p.valid||n?l(p||null):u[s]=o.requestInternal(t,e,r,d,h))}i=c.get(s,f,f)}),u[s]||(u[s]=i),l.then(function(){jl(o,s)},function(){jl(o,s)}),l)},R.prototype.requestTileAsPromise=R.prototype.ll,R.prototype.kl=function(t,e){var r=this,n=t.id,i=t.tile.coords;return new Ob(function(t,o){r.ll(i.x,i.y,i.z,e).then(function(e){for(var r,i=y,o=(e=e.Va?e.Va():e.data).length;o--;)if((r=e[o]).gb()===n){i=r;break}t(i)},o)})},R.prototype.requestObjectAsPromise=R.prototype.kl;var kl={cancel:function(){}};function gl(){}function sk(t){if(sk.l.constructor.call(this,t),t&&(this.C={crossOrigin:t.crossOrigin||"anonymous",headers:t.headers||{}},this.v=t.getURL),!Ca(this.v))throw new D(sk,0,"getURL");if(Xj(this,t.opacity),this.c=x.URL||x.webkitURL,!(t="anonymous"===(t=this.C.crossOrigin)||"use-credentials"===t)){t=this.v(0,0,0);var e=window.location,r=document.createElement("a");r.href=t,t=r.hostname===e.hostname&&r.port===e.port&&r.protocol===e.protocol}(this.N=t&&!!rf.prototype.b.arraybuffer&&!!this.c)&&this.Ob().re(A(this.Aa,this))}function lk(t,e,r,n){this.left=+t,this.top=+e,this.right=+r,this.bottom=+n}function dl(t,e){return new lk(t.x,t.y,e.x,e.y)}function ll(t,e){cl.call(this,t,e)}function ml(t,e){(e=e?Ua(e):{}).tileSize=e.tileSize||256,e.pixelRatio=e.pixelRatio||Se(),e.max=24,this.c=new bl(t,e),this.f=new ll(this.c),e.minWorldSize=this.c.tileSize,e.provider=t,ml.l.constructor.call(this,e),this.tileSize=this.f.tileSize,this.j=A(this.j,this),this.c.addEventListener(this.c.i.Ea,this.j),t.addEventListener(t.i.Ea,this.j)}R.prototype.rd=function(t,e,r,n){return new Lk(t,e,r,n)},R.prototype.Lf=function(t){var e=this.m[t];e&&(e.cancel(),jl(this,t))},R.prototype.cancelTileByKey=R.prototype.Lf,R.prototype.Wc=function(t,e,r){this.cancelTileByKey(this.getTileKey(t,e,r))},R.prototype.cancelTile=R.prototype.Wc,R.prototype.u=function(){R.l.u.call(this),this.getCache().qa(this.gc),il(this)},R.NullStorage=gl,gl.prototype.get=function(t,e){return e(),kl},gl.prototype.get=gl.prototype.get,gl.prototype.put=function(t,e,r){r&&r()},gl.prototype.put=gl.prototype.put,gl.prototype.clear=function(t){t&&t()},gl.prototype.clear=gl.prototype.clear,gl.prototype.remove=function(t,e){e&&e()},gl.prototype.remove=gl.prototype.remove,u(sk,R),t("H.map.provider.ImageTileProvider",sk),sk.prototype.qc=function(t){Xj(this,t)},sk.prototype.setOpacity=sk.prototype.qc,sk.prototype.dd=function(){return this.j},sk.prototype.getOpacity=sk.prototype.dd,sk.prototype.pf=df,sk.prototype.providesRasters=sk.prototype.pf,sk.prototype.Yd=function(){return this.tileSize},sk.prototype.getEntryWeight=sk.prototype.Yd,sk.prototype.K=function(t,e,r,n,i,o){var a,s=this,u=this.v(t,e,r);if(t=null,u){var l=x.setTimeout(function(){s.N?(a=new rf("arraybuffer",u,o,s.C)).then(function(t){return t.blob()}).then(function(t){var e=new Image;e.onload=A(n,null,e,{raw:t}),e.onerror=A(i,null,"bad url");try{e.src=s.c.createObjectURL(t)}catch(t){}},i):(a=new rf("image",u,o,s.C)).then(n,i)},150);t={cancel:function(){a?a.cancel():x.clearTimeout(l)}}}else n(null);return t},sk.prototype.requestInternal=sk.prototype.K,sk.prototype.ma=function(t,e){var r=new Image;r.onload=function(){e(this)},r.src=this.c.createObjectURL(t)},sk.prototype.Aa=function(t,e){(t=e.data)&&t instanceof HTMLImageElement&&this.c.revokeObjectURL(t.src)},t("H.math.Rect",lk),lk.prototype.set=lk,lk.prototype.set=lk.prototype.set,lk.prototype.Rb=function(){return this.c||(this.c=new I(this.left,this.top))},lk.prototype.getTopLeft=lk.prototype.Rb,lk.prototype.Nb=function(){return this.a||(this.a=new I(this.right,this.bottom))},lk.prototype.getBottomRight=lk.prototype.Nb,lk.prototype.Pf=function(t,e){return this.left<=t&&this.right>=t&&this.top<=e&&this.bottom>=e},lk.prototype.containsXY=lk.prototype.Pf,lk.fromPoints=dl,lk.prototype.clone=function(){return new lk(this.left,this.top,this.right,this.bottom)},lk.prototype.clone=lk.prototype.clone,u(ll,cl),t("H.map.layer.TileLayer",ll),ll.prototype.Id=function(t,e,r,n,i){if(!C(t,K))throw new D(this.Id,0,t);if(E(e=+e))throw new D(this.Id,1,e);e=yd(e),this.pixelProjection.Qa(e),t=this.Te(t);var o=this.je(t,e);return this.$e(o,t.left>t.right,e,r,n,i)},ll.prototype.requestTiles=ll.prototype.Id,u(ml,aj),t("H.map.layer.ObjectLayer",ml),ml.prototype.j=function(t){t.currentTarget!==this.c&&t.target.type===Pg.SPATIAL||this.g()};var nl={markers:ff,total:0};ml.prototype.Lc=function(t,e,r){var n,i=this.a;return i.providesMarkers()&&(n=i.requestMarkers(t,e,!0,r)).length?{markers:n,total:n.length}:nl},ml.prototype.requestMarkers=ml.prototype.Lc,ml.prototype.Kc=function(t,e,r){var n,i=this.a;return i.providesDomMarkers()&&(n=i.requestDomMarkers(t,e,!0,r)).length?{markers:n,total:n.length}:nl},ml.prototype.requestDomMarkers=ml.prototype.Kc;var ol={tiles:ff,total:0};ml.prototype.Id=function(t,e,r,n){if(this.a.providesSpatials()){var i=this.f.Id(t,e,r,n);r||(r=this.c,33<(i=zk())-r.O&&(tk(r.J),r.O=i),i=this.f.Id(t,e,!0,n))}else i=ol;return i},ml.prototype.requestTiles=ml.prototype.Id,ml.prototype.jb=function(t,e,r,n){return this.f.jb(t,e,r,n)},ml.prototype.requestTile=ml.prototype.jb,ml.prototype.Wc=function(t,e,r){this.f.Wc(t,e,r)},ml.prototype.cancelTile=ml.prototype.Wc;var pl={overlays:ff,total:0};function ql(t,e,r,n){var i=new lk(0,0,0,0);if(ql.l.constructor.call(this),!t)throw new D(ql,0,t);if(!e)throw new D(ql,1,e);if(!r)throw new D(ql,2,r);if("object"!=typeof n)throw new D(ql,3,n+" is not an object");if("number"!=typeof n.pixelRatio)throw new D(ql,3,n.pixelRatio+" is not a number");this.sa=n.pixelRatio,this.zoom=0,this.ib=Bd(this.sa)/Ld,this.ra=new Yi,this.yb={1:i.clone(),2:i.clone(),4:i.clone()},this.m=new I(.5,.5),this.g=t,rl(this,this.sa),this.uc=A(this.uc,this),this.lc=A(this.lc,this),this.Bb=A(this.Bb,this),t.startInteraction=this.uc,t.interaction=this.lc,t.endInteraction=this.Bb,t.addEventListener(t.a.Ea,this.U,!1,this),this.getCapabilities=this.getCapabilities,this.capture=this.capture,this.zoomAt=this.Ae,this.relaunch=this.ha,this.dispose=this.B,this.screenToGeo=this.Wa,this.geoToScreen=this.Fa,this.screenToLookAtData=this.Eg,this.O=e,this.tc=A(this.tc,this),this.control=A(this.control,this),this.Ab=A(this.Ab,this),e.startControl=this.tc,e.control=this.control,e.endControl=this.Ab,e.addEventListener(e.a.Ea,this.bh,!1,this),this.c=r,this.qg=A(this.qg,this),this.ef=A(this.ef,this),this.ff=A(this.ff,this),this.pg=A(this.pg,this),r.addEventListener(aj.prototype.b.Ea,this.qg,!1,this),r.addEventListener(r.b.Be,this.ef,!1,this),r.addEventListener(r.b.De,this.ff,!1,this),r.addEventListener(r.b.Ee,this.pg,!1,this)}function rl(t,e){var r=t.g,n=r.width,i=r.height,o=r.padding,a=o.top,s=o.left,u=o.bottom;o=o.right,r=r.margin;var l=-(n+s-o)/2<<0,c=-(i+a-u)/2<<0;n+=l,i+=c,(t=t.yb)[1].set((l-r)*e,(c-r)*e,(n+r)*e,(i+r)*e),t[2].set(l*e,c*e,n*e,i*e),t[4].set((l+s)*e,(c+a)*e,(n-o)*e,(i-u)*e)}function tl(t,e){t.style.transition="opacity 1.5s",Ce(t,"transitionend",e,!1),t.style.opacity=0}ml.prototype.Hd=function(t,e,r){var n=this.a,i=pl;return n.providesOverlays&&n.providesOverlays()&&(e=(t=n.requestOverlays(t,e,!0,r)).length)&&(i={overlays:t,total:e}),i},ml.prototype.requestOverlays=ml.prototype.Hd,ml.prototype.u=function(){this.c.B(),this.f.B(),this.a.dispose(),ml.l.u.call(this)},u(ql,F),t("H.map.render.RenderEngine",ql),ql.prototype.U=function(){rl(this,this.sa)},ql.prototype.u=function(){var t=this.g,e=this.O,r=this.c;t.removeEventListener(t.a.Ea,this.U,!1,this),t.startInteraction===this.uc&&(t.startInteraction=kk.prototype.uc),t.interaction===this.lc&&(t.interaction=kk.prototype.lc),t.endInteraction===this.Bb&&(t.endInteraction=kk.prototype.Bb),e.removeEventListener(e.a.Ea,this.bh,!1,this),e.startControl===this.tc&&(e.startControl=sl.prototype.tc),e.control===this.control&&(e.control=sl.prototype.control),e.endControl===this.Ab&&(e.endControl=sl.prototype.Ab),r.removeEventListener(aj.prototype.b.Ea,this.qg,!1,this),r.removeEventListener(r.b.Be,this.ef,!1,this),r.removeEventListener(r.b.De,this.ff,!1,this),r.removeEventListener(r.b.Ee,this.pg,!1,this)},ql.prototype.Di=function(t){this.Sg=t},ql.prototype.setAnimationCallback=ql.prototype.Di,ql.prototype.Ai=function(){this.Sg=void 0},ql.prototype.resetAnimationCallback=ql.prototype.Ai,ql.prototype.control=function(){},ql.prototype.capture=function(){return Yb(Error("not implemented"))};var ul={ZOOM:1,HEADING:2,TILT:4,INCLINE:8,COORD:16};function xl(t,e){return e.tilt=yl(t,e.tilt),e.heading=zl(t,e.heading),e.incline=t.getCapabilities().lookAt.incline.min,e}function wl(t,e){var r=t.getCapabilities().lookAt.zoom;return Yd(e,wd(r.min,t.Pg),vd(r.max,t.Tg))}function yl(t,e){return Yd(e,(t=t.getCapabilities().lookAt.tilt).min,t.max)}function zl(t,e){return Yd((e%360+360)%360,(t=t.getCapabilities().lookAt.heading).min,t.max)}function vl(t,e,r){(r=r?e.addEventListener:e.removeEventListener).call(e,e.b.nj,t.pi,!1,t),r.call(e,e.b.mj,t.pi,!1,t)}ql.InteractionModifiers=ul,n=ql.prototype,n.zk={pj:"render"},n.qg=function(t){this.Rk(t),this.ha()},n.ef=function(t){this.jf(t.idx,t.added)},n.ff=function(t){this.oi(t.idx,t.removed,t.type===this.c.b.Ee)},n.pg=function(t){t.removed&&this.ff(t),this.ef(t)},n.Rk=hd,n.jf=function(t,e){this.Mh(t,e),0===t&&this.Jb(),C(e,aj)&&vl(this,e,!0),this.te(),this.ha()},n.Jb=function(){var t=this.c.Na();if(0<t.length){var e=t[0].max;this.Pg=t[0].min,this.Tg=e}else e=(t=this.getCapabilities().lookAt.zoom).max,this.Pg=t.min,this.Tg=e;(t=wl(this,this.zoom))!==this.zoom&&(this.zoom=t,this.ra.Qa(t),this.bb())},n.bb=function(t){this.J=this.mb(),t&&(this.J.position=t),this.J.zoom=this.zoom-this.ib,this.J.position.alt=0},n.Nl=0,n.heading=180,n.mb=function(){return xl(this,{position:this.ra.projection.vg(this.m),zoom:this.zoom,tilt:this.Nl,heading:this.heading})},n.Mh=hd,n.oi=hd,n.ap=function(t,e){this.C={before:t,after:e}},ql.prototype.setOnRenderCallbacks=ql.prototype.ap;var Al={P2D:0,WEBGL:1,HARP:2};ql.EngineType=Al;var Bl={lookAt:{zoom:{min:-8,max:24},tilt:{min:0,max:85},incline:{min:0,max:0},heading:{min:0,max:360}},interaction:{ZOOM:ul.ZOOM,COORD:ul.COORD},capture:!0};function Cl(t){var e,r=this,n=x.H.gl;Cl.l.constructor.call(this),this.a=e=n.Scene.create(x.URL.createObjectURL(nf(JSON.stringify(Dl))),{viewport:t.viewport,container:t.vc,disableRenderLoop:!0,devicePixelRatio:t.devicePixelRatio,logLevel:"error"}),t.Ko&&e.subscribe({load:t.Ko}),e.subscribe({view_complete:function(){r.g=!0,t.Tk()}});var i=e.requestRedraw;e.requestRedraw=function(){i.apply(e),t.Tk()},this.i=A(this.i,this),this.f=A(this.f,this),this.j=0,this.c={},this.b={}}function El(t){var e;for(e in t=t.a.sources){var r=t[e];if(r.hasPendingCommands&&r.hasPendingCommands())return!0}return x.H.gl.Task.hasPendingTasks()}function Fl(t){t.g=!1,t.a.resetViewComplete()}function Gl(t){return t.a.view}function Hl(t,e){function r(){var r,i,o,a,s,u=e.Na(),l={},c={},h=++t.j;for(vh(c,Dl),i=0;i<u.length;i++){var f=u[i];if(r=f.ga()){var p=r.ub();if(p.getState()===Qh.READY){var d=p.vd();if(!Ta(d)){for(o in delete d.cameras,delete d.camera,l[i]=d=Hh(d,i),!C(f,ml)&&d.sources&&Ih(d,r.uid),d.sources){var v=d.sources[o];v.max_zoom=vd(r.max,Bl.lookAt.zoom.max),v.max_display_zoom=f.max,v.min_display_zoom=f.min,(s=r.tileSize)&&(2<=n&&256<s&&r instanceof sk&&(s/=2),v.tile_size=s)}(a=p.hc())&&Jh(d,a),vh(c,d)}}}}return vh(c.layers.skybox.draw.skybox.color,c.scene.sky),t.a.config=c,t.a.updateConfig().then(function(){var e,r,n={};if(h!==t.j)return!1;for(r in t.j=0,l){f=u[+r];var i=l[r].sources;for(e in i)(i=t.a.sources[e])&&(n[e]=i,i.initialize&&f.getProvider()&&i.initialize(f.getProvider(),t.i,t.a.getWorkers().length,i.tiled?B:t.a.tile_manager.getWorkerForTile(y,i)))}for(e in t.c)!n[e]&&t.c[e].dispose&&t.c[e].dispose();return t.c=n,!0})}var n=t.a.pixelRatio();t.a.initialized?r():t.a.load(y,{blocking:!1}).then(r)}t("H.map.render.webgl.capabilities",Bl),u(Cl,nd),Cl.prototype.g=!1,Cl.prototype.V=function(){var t=x.H.gl.Task;return this.a.immediateRedraw(),t.setState({user_moving_view:this.a.view.user_input_active}),t.processAll(),this.g&&!this.a.dirty&&!this.a.building&&!El(this)&&!Object.keys(this.b).length},Cl.prototype.i=function(t,e,r){var n=this,i=this.a.sources[t],o=r&&r.isReload;e?!0!==this.b[t]&&(this.b[t]||(this.b[t]={Ml:{},vj:[]}),C(e,Lk)?this.b[t].Ml[e.x+"/"+e.y+"/"+e.z]=!0:(e=e.boundingBox,this.b[t].vj.push(new K(e[0],e[1],e[2],e[3])))):this.b[t]=!0,i&&i.has_volatile_data?Il(this,o):(x.clearTimeout(this.m),this.m=x.setTimeout(function(){return Il(n,o)},Jl))};var Jl=100;function Il(t,e){var r=t.a.tile_manager;r.removeTiles(t.f),r.updateTilesForView(),e&&r.removeCachedTiles(t.f),Fl(t),t.b={}}function Kl(t,e,r,n){t.a.getFeatureAt(e,r,n),t.a.update()}function Ll(t){return t.a.screenshot(void 0).then(function(t){return new Ob(function(e,r){new Dj(URL.createObjectURL(t.blob),function(t,n){1===t?e(n.getData()):r()},!1)})})}Cl.prototype.f=function(t){var e=!1,r=this.b[t.source.name],n=x.H.gl;if(r)if(!0===r)e=!0;else{var i=n.Tile.coord(n.Geo.wrapTile(t.coords));if(!(e=!!r.Ml[i.key])){var o=n.Geo.getTileBoundingBox(i,t.source.tile_size,Ug.MAX_LINE_WIDTH/2);o=dg(o.getTopLeft(),o.getBottomRight()),e=r.vj.some(function(t){return t.Ad(o,!0)||o.pd(t.fb(),!0)})}}return e},Cl.prototype.vd=function(){return this.a.config},Cl.prototype.$a=function(){return this.a.pixelRatio()},Cl.prototype.u=function(){var t=this.c;Cl.l.u.call(this),this.a.destroy(),this.b={},t&&Object.keys(t).forEach(function(e){t[e].dispose()}),x.clearTimeout(this.m),this.c=this.a=null};var Dl={scene:{background:{color:"#FFFFFF"},sky:{zenith:"#347BC0",horizon:"#EDF2F9",fog:"#FFFFFF"}},lights:{default_light:{type:"directional",name:"default_light",visible:!0}},camera:{type:"perspective"},styles:{},fonts:{},sources:{skybox:{type:"SkyBox"}},layers:{skybox:{data:{source:"skybox"},draw:{skybox:{color:{}}}}},global:{}},Zj={FEATURE:1,SOURCE:2,PROVIDER:3};function Ml(t){return t}function Nl(t){return-t*(t-2)}function Ol(t){return 1-Math.sqrt(1-t*t)}function Pl(t){return Cd(2*t-t*t)}function Ql(t){return 1-Math.cos(t*Math.PI/2)}function Rl(t){return Math.sin(t*Math.PI/2)}function Sl(t,e){this.a={tilt:Tl(t.tilt,e.tilt),heading:Tl(t.heading,e.heading),zoom:e.zoom-t.zoom};var r=this.b=Zf(t.position),n=e.position;t=n.lat*Rd;var i=r.lat*Rd;n=n.lng*Rd-r.lng*Rd,r=Fd(n)*Hd(t),t=Hd(i)*Fd(t)-Fd(i)*Hd(t)*Hd(n),t=Math.atan2(r,t),this.j=(0<=t?t:Pd+t)*Sd,this.c=this.b.Za(e.position),e=this.a.zoom,this.i=0===e?this.f:Object.assign({},this.f,{zoom:0>e?Pl:Ol,position:0>e?Ql:Rl}),this.g=Object.assign({},{tilt:0,heading:0,zoom:0})}function Tl(t,e){return-180<(t=e-t)&&180>=t?t:180<t?t-360:t+360}function Ul(t,e){if(E(this.x=+t))throw new D(Ul,0,t);if(E(this.y=+e))throw new D(Ul,1,e)}function Vl(t){return Cd(t.a(t))}function Wl(t){t=t||gf,this.sb=tc(t.Fo)?t.Fo:3,this.aa=tc(t.Do)?t.Do:300,this.s=tc(t.op)?t.op:3,this.v=tc(t.kp)?t.kp:50,this.f=[],this.clear()}function Zl(t,e){t.i^=t.i&e}t("H.map.provider.PickingMode",Zj),t("H.util.animation.ease.LINEAR",Ml),t("H.util.animation.ease.EASE_IN_QUAD",function(t){return t*t}),t("H.util.animation.ease.EASE_OUT_QUAD",Nl),t("H.util.animation.ease.EASE_IN_OUT_QUINT",function(t){return 1>(t*=2)?Dd(t,5)/2:Dd(t-=2,5)/2+1}),t("H.util.animation.ease.EASE_OUT_CIRC",Pl),Sl.prototype.f={tilt:Ml,heading:Ml,zoom:Ml,position:Ml},Ul.prototype.add=function(t){return new Ul(this.x+t.x,this.y+t.y)},Ul.prototype.a=function(t){if(!C(t,Ul))throw new D(this.a,0,t);return(t=this.b(t)).x+t.y},Ul.prototype.b=function(t){if(!C(t,Ul))throw new D(this.b,0,t);return new Ul(this.x*t.x,this.y*t.y)},Ul.prototype.Qa=function(t){return new Ul(this.x*t,this.y*t)},t("H.map.render.InteractionUtils",Wl),Wl.prototype.io=function(){return this.c},Wl.prototype.isGestureDetected=Wl.prototype.io,Wl.prototype.start=function(t,e){var r=ul.HEADING,n=ul.TILT;this.a&&this.clear(),this.i=t,this.m=!!e,this.a=!0,this.c=!(t&(r|n))||t===r||t===n},Wl.prototype.start=Wl.prototype.start,Wl.prototype.store=function(t,e,r,n,i){var o=!1;if(this.a){if(o=(t=new Xl(t,e,r,n,i)).c,this.o=this.b,this.b=t,this.g){if(this.j=!0,o){e=this.i;var a=this.c;if(!a&&this.j){i=ul.HEADING;var s=ul.TILT;r=ul.COORD,n=ul.ZOOM;var u=e&(r|s)?this.ce(!0):Yl,l=e&n?this.Xf(!0):1,c=e&i?Ad(this.uh(!0)):0,h=Ad(u.x),f=Ad(u.y);u=10<h||10<f,h=10<f&&f>3*h,l=.8>l||1.2<l,c=7<c,e&s&&(c||l||u&&!h?Zl(this,s):h&&(Zl(this,~s>>>0),a=!0)),!a&&e&i&&e&(r|n)&&(l||u?(Zl(this,i),a=!0):c&&(Zl(this,s),a=!0)),this.c=a}}}else this.g=t,o||(this.c=!0);this.m&&this.f.push(t)}return o},Wl.prototype.store=Wl.prototype.store,Wl.prototype.clear=function(){this.f.length=0,this.a=this.m=this.j=this.c=!1,this.g=this.o=this.b=void 0},Wl.prototype.clear=Wl.prototype.clear,Wl.prototype.Hc=function(t){return 0<(this.i&t)},Wl.prototype.isModifierEnabled=Wl.prototype.Hc,Wl.prototype.va=function(){return this.a},Wl.prototype.isRunning=Wl.prototype.va;var Yl=oc(new Ul(0,0));function Xl(t,e,r,n,i){this.a=new I(t,e),r!==B&&(this.b=new I(r,n),this.c=!0),this.timestamp=i!==B?i:zk()}function am(t){var e=t.a;return(t=t.b)?new I(e.x-(e.x-t.x)/2,e.y-(e.y-t.y)/2):B}function cm(t,e){var r=t.a;return(t=t.b)&&t.Za(e)<r.Za(e)?t:r}function $l(t,e){var r=t.b,n=e.b;return n&&r?(e=am(e),t=am(t)):r?t=cm(t,e=e.a):n?e=cm(e,t=t.a):(e=e.a,t=t.a),new Ul(e.x-t.x,e.y-t.y)}function bm(t){var e=t.b;return e?t.a.Za(e):0}function dm(){F.call(this),this.reset()}function fm(t){fm.l.constructor.call(this,dm.prototype.g.Rg),this.c=t}function gm(t){return x.Object.create(t.f)}function em(t,e,r,n,i,o){this.nb=t,this.ob=e,this.pb=r,this.ue=n,this.ve=i,this.wf=o}function hm(t,e,r,n){hm.l.constructor.call(this),this.vc=t,this.sa=n,this.a=t.appendChild(this.createElement(t.ownerDocument)),this.yf(e,r)}function im(t,e,r,n){im.l.constructor.apply(this,arguments)}function jm(t,e,r,n,i,o){var a=i||"2d";jm.l.constructor.apply(this,arguments),this.b=this.a.getContext(a,o),this.c="2d"===a,this.f=a,this.uo=o}function km(t){this.hb=t}function lm(t){var e="dom";lm.l.constructor.call(this,t),C(this.hb,mm)&&(e="2d"===t.Xd()?"2d":"webgl"),this.a=e}function nm(t,e,r,n,i){if(!Ca(t.Di)||!Ca(t.Ai))throw new D(nm,0,t);if(this.b=t,!Ca(this.i=e))throw new D(nm,1,e);if(E(this.g=+r))throw new D(nm,2,r);if(!Ca(this.f=n)&&null!=n)throw new D(nm,3,n);if(!Ca(this.c=i)&&null!=i)throw new D(nm,4,i);this.id=(new af).next(),this.a=!1}function om(t,e){om.l.constructor.call(this,t),this.xc=!(!e||!e.xc),this.f={}}Wl.prototype.zc=function(){var t;if(this.m){var e=this.f,r=e.length,n=0;for(t=new Ul(0,0);--r&&n<this.s;)t=t.add($l(e[r-1],e[r])),n++}else t=this.ce();return 0!==(r=Vl(e=t))?new Ul(e.x/r,e.y/r):e},Wl.prototype.getDirection=Wl.prototype.zc,Wl.prototype.Eb=function(t){var e,r;if(t=t||zk(),this.m){var n=this.f,i=this.f.length,o=this.f[i-1];for(r=e=0;--i&&e<this.s;)r+=Vl($l(n[i],n[i-1])),e++;n=r/e}else o=this.b,n=Vl(this.ce());return n>=this.sb&&t-o.timestamp<=this.v?n>this.aa?this.aa:n:0},Wl.prototype.getSpeed=Wl.prototype.Eb,Wl.prototype.Wf=function(){return this.b?am(this.b):B},Wl.prototype.getBifocalCenter=Wl.prototype.Wf,Wl.prototype.ce=function(t){return(t=t?this.g:this.o)?$l(t,this.b):new Ul(0,0)},Wl.prototype.getMoveVector=Wl.prototype.ce,Wl.prototype.Xf=function(t){var e=1;if(this.j){var r=this.b;(t=bm(t=t?this.g:this.o))&&(r=bm(r))&&(e=r/t)}return e},Wl.prototype.getBifocalScaling=Wl.prototype.Xf,Wl.prototype.uh=function(t){if(this.j){var e=t?this.g:this.o,r=this.b;t=e.b;var n=r.b,i=0;t&&n&&(e=e.a,r=r.a,i-=Kd(n.y-r.y,n.x-r.x)*Sd-Kd(t.y-e.y,t.x-e.x)*Sd),t=i}else t=0;return t},Wl.prototype.getBifocalRotation=Wl.prototype.uh,Xl.prototype.c=!1,u(dm,F),dm.prototype.start=function(t,e){this.a&&this.reset(),E(t-e)||(this.b=+t,this.c=+e),this.a=!0},dm.prototype.reset=function(){this.a=!1,this.b=this.c=null,this.f=new em(0,0,0,0,0,0)},dm.prototype.va=function(){return this.a},dm.prototype.g={Rg:"animationupdate"},u(fm,rd),dm.prototype.set=function(t,e,r,n,i,o){var a=this.f;this.a&&(t=new em(t/1e3,e/1e3,r/1e3,n/1e3,i/1e3,o/1e3),a.oa(t)||(this.f=t,this.dispatchEvent(new fm(gm(this)))))},dm.prototype.Eb=function(){return gm(this).Eb()},dm.prototype.zc=function(){var t=gm(this),e=this.Eb()||1;return new em(t.nb/e,t.ob/e,t.pb/e,t.ue,t.ve,t.wf)},dm.prototype.u=function(){this.reset(),dm.l.u.call(this)},em.prototype.Eb=function(){return Cd(this.nb*this.nb+this.ob*this.ob+this.pb*this.pb)},em.prototype.zc=function(){var t=this.Eb()||1;return new em(this.nb/t,this.ob/t,this.pb/t,this.ue,this.ve,this.wf)},em.prototype.oa=function(t){return!!t&&this.nb===t.nb&&this.ob===t.ob&&this.pb===t.pb&&this.ue===t.ue&&this.ve===t.ve&&this.wf===t.wf},u(hm,nd),hm.prototype.L=function(){return this.a},hm.prototype.yf=function(t,e){this.size?(this.size.w=t,this.size.h=e):this.size=new Ki(t,e),this.Dl(this.a,this.a.style,t,e,this.sa)},hm.prototype.setSize=hm.prototype.yf,n=hm.prototype,n.Db=function(){return this.size},n.$a=function(){return this.sa},n.tk=!0,n.wb=function(t){t!==this.tk&&(this.a.style.display=t?"block":"none",this.tk=t)},n.ai=1,n.qc=function(t){this.ai!==t&&(this.Ak(t),this.ai=t)},n.dd=function(){return this.ai},n.ye=function(t){this.a.style.zIndex=t},hm.prototype.setZIndex=hm.prototype.ye,n=hm.prototype,n.fk=function(){return+this.a.style.zIndex},n.Zc=function(){},n.clear=function(){},n.u=function(){this.clear(),this.vc.removeChild(this.a),this.yf(0,0),this.a=this.vc=null,hm.l.u.call(this)},n.hl=0,n.Dg=function(){++this.hl},n.release=function(){--this.hl||this.B()},u(im,hm),t("H.map.render.dom.Surface",im),n=im.prototype,n.Xd=function(){return"dom"},n.createElement=function(t){return(t=t.createElement("DIV")).style.position="absolute",t.style.pointerEvents="none",t},n.Dl=function(t,e,r,n){e.width=r+"px",e.height=n+"px"},n.Ak=function(t){this.a.style.opacity=t},n.Zc=function(t,e,r){var n=this.sa,i=t.style;i[xf("transform")]="matrix(1,0,0,1,"+e/n+","+r/n+")",t.parentNode!==this.a&&(i.position="absolute",this.a.appendChild(t),this.a.style.pointerEvents="auto","auto"===getComputedStyle(t).pointerEvents&&(t.style.pointerEvents="all"),this.a.style.pointerEvents="none")},n.clear=function(t){t?this.a.removeChild(t):this.a.innerHTML=""},u(jm,hm),n=jm.prototype,n.createElement=function(t){var e=(t=t.createElement("canvas")).style;return e.position="absolute",e.top=e.left="0",t},n.Dl=function(t,e,r,n,i){t.width=wd(r,1),t.height=wd(n,1),e.width=xd(r/i)+"px",e.height=xd(n/i)+"px"},n.Ak=function(t){this.b.globalAlpha=t},n.Zc=function(t,e,r,n,i){this.c&&this.b.drawImage(t,e,r,n,i)},n.Xd=function(){return this.f},n.clear=function(t){var e,r;this.c&&(t?this.b.clearRect(e=t.left,r=t.top,t.right-e,t.bottom-r):this.a.width=this.size.w)},n.u=function(){this.a.width=this.a.height=0,this.b=y,jm.l.u.call(this)},u(km,nd),km.prototype.tb=function(){return this.hb},km.prototype.getLayer=km.prototype.tb,km.prototype.Kn=function(){return this.xb},km.prototype.getSurface=km.prototype.Kn,km.prototype.ld=function(t){var e=this.xb;t!==e&&(this.xb=t,t.Dg(),e&&e.release())},km.prototype.setSurface=km.prototype.ld,km.prototype.u=function(){this.xb.release()},km.prototype.ie=function(){},km.prototype.render=km.prototype.V,u(lm,km),lm.prototype.V=function(t,e,r,n,i,o,a,s){a=this.hb;var u=this.xb,l=!(C(u,jm)&&"2d"===u.Xd());return n>=a.min&&n<=a.max?(l&&u.wb(!0),a.V(u.L(),{boundingBox:t,zoom:n,screenCenter:e,priorityCenter:o,projection:r,cacheOnly:i,size:u.Db(),pixelRatio:u.$a(),cameraMatrix:s})):(l&&u.wb(!1),jk.DONE)},lm.prototype.ie=function(){return this.a},t("H.util.animation.Animation",nm),nm.prototype.start=function(){var t=this;this.Rc=zk(),this.a=!0;var e=this.Rc;this.b.Di(function(){if(t.a){var r=zk(),n=r-t.Rc,i=n/t.g,o=!1;1<=i&&(i=1,o=!0),t.i(t.c?t.c(i):i,n,r-e,r),e=r,o&&t.stop()}else t.stop()})},nm.prototype.start=nm.prototype.start,nm.prototype.stop=function(t){this.a=!1,this.b.Ai(),t||this.f&&this.f(this)},nm.prototype.stop=nm.prototype.stop,nm.prototype.va=function(){return this.a},nm.prototype.isRunning=nm.prototype.va,u(om,km),om.prototype.ld=function(t){om.l.ld.call(this,t),this.g=t.vc.ownerDocument},om.prototype.setSurface=om.prototype.ld;var pm=function(t,e){return C(e=e.ba(),kh)?e.pa:(t[0]=e,t)}.bind(null,[]);function qm(t,e){var r=t[1].ed(),n=e[1].ed();return Qg(r,n,!0)||t[5]-e[5]||Qg(r,n,!1)}function rm(t,e){rm.l.constructor.apply(this,arguments),this.c=0,this.a=[],this.b=A(this.b,this)}om.prototype.V=function(t,e,r,n,i,o,a){var s,u,l,c,h=this.hb;if(this.m=e=this.f,this.f=r={},n>=h.min&&n<=h.max){var f=this.Nj(t,n,i,o),p=f.markers;if(t=p.length){for(n=[],i=this.xb,o=0;o<t;o++){h=p[o];var d=pm(h);for(s=d.length;s--;)(u=a(d[s]))&&((c=e[l=h.gb()+"_"+s])?delete e[l]:c={Mk:h},r[l]=c,n.push([c,h,h.Cb(),i,u.x,u.y]))}for(n.sort(qm),t=n.length,o=0;o<t;o++)this.jl.apply(this,n[o])}}return!f||f.requested&&f.requested===f.total||!f.requested&&p.length===f.total?jk.DONE:jk.PENDING},om.prototype.render=om.prototype.V,om.prototype.Ga=function(){},om.prototype.getObjectsAt=om.prototype.Ga,u(rm,om),t("H.map.render.dom.MarkerRenderer",rm),rm.prototype.Nj=function(){return this.hb.Kc.apply(this.hb,arguments)},rm.prototype.V=function(t,e,r,n,i,o,a){this.b(),this.j=0;var s,u=rm.l.V.apply(this,arguments),l=this.xb,c=this.m;for(s in c)sm(this,l,c[s]);return 0===this.a.length&&u?jk.DONE:jk.PENDING},rm.prototype.render=rm.prototype.V,rm.prototype.ld=function(t){rm.l.ld.call(this,t),this.i=t.$a()},rm.prototype.setSurface=rm.prototype.ld,rm.prototype.b=function(){for(var t,e,r,n=this.a.length;n--;)t=(r=this.a[n]).Ef,(e=r.Ef.Cb()).mi(r,e,t);this.a.length=0},rm.prototype.jl=function(t,e,r,n,i,o){var a,s=n.$a(),u=e.Pb();i*=s,o*=s,this.xc||(i=xd(i),o=xd(o)),t.detail&&(u.me(t.co)?sm(this,n,t):a=t.detail),a||(t.detail=a=r.Qj(this.g),this.c++,Ca(r.mi)&&this.a.push(a)),t.co=u.a,a.style.zIndex=this.j++,a.Ef=e,n.Zc(a,i,o,0,0)};var tm,um="pointer-events",vm,wm;Ye&&(Ye&&Yc!==y&&(Yc=(wm=/(MSIE\s+|rv:)([^\);]+)(\)|;)/.exec(navigator.userAgent))?+wm[2]:y),vm=Yc,9===vm?um="display":10===vm&&(um="visibility"));function sm(t,e,r){e.clear(e=r.detail),delete e.Ef,t.c--,(r=(t=r.Mk).Cb()).b&&r.b(e,r,t)}function mm(t,e){var r=e||{},n=r.contextType;if(r=r.contextAttributes,mm.l.constructor.call(this,e),wc(t,"Function",mm,0,"invalid render callback"),n){if(-1===xm.indexOf(n))throw new D(mm,1,"invalid context type");this.f=n}r&&(this.m=r),this.j=t}tm=um,rm.prototype.Ga=function(t,e,r){var n,i,o,a,s,u=this.i,l=ff;if(this.c){t/=u,e/=u;var c=(u=this.g).documentElement,h=this.xb.L(),f=h.getBoundingClientRect();for(t+=f.left,e+=f.top;(i=o=u.elementFromPoint(t,e))&&i!==h&&i!==c&&o!==p;){for(;(a=i.parentNode)&&(!Ca(a.contains)||!a.contains(h));)i=a;if(a===h&&(i!==o||"svg"!==i.nodeName)&&0>l.indexOf(s=i.Ef)&&(l===ff&&(l=[]),l.push(s),r))break;n||(n=[]);var p=i.style;n.push({Aj:p.getPropertyValue(tm),bo:p.getPropertyPriority(tm),style:p}),p.setProperty(tm,"visibility"===tm?"hidden":"none","important"),p=o}if(n)for(e=n.length;e--;)(t=n[e]).style.removeProperty(tm),zc(t.Aj)&&t.style.setProperty(tm,t.Aj,t.bo)}return l},rm.prototype.getObjectsAt=rm.prototype.Ga,rm.prototype.ie=function(){return"dom"},rm.prototype.u=function(){this.a.length=0;var t,e=this.xb,r=this.f;for(t in r)sm(this,e,r[t]);this.xb.B(),rm.l.u.call(this)},u(mm,aj),t("H.map.layer.CanvasLayer",mm);var xm=["2d","webgl","webgl2","experimental-webgl"];function ym(t,e){ym.l.constructor.call(this,e),wc(t,"Function",ym,0,"invalid render callback"),this.c=t}function zm(t,e){if(E(this.b=+t))throw new D(zm,0,t);this.a=0,e&&this.yl(e)}function Am(t,e){this.a=t,this.b=e}function Bm(t,e,r){var n=[],i={vc:t.a,width:e.w,height:e.h,sa:t.b};for(t=0;t<r.length;t++){var o=(e=r[t]).ie(),a={};Wa(a,i);var s=e.xb;switch(o){case"2d":if(C(e.tb(),mm)&&(a.ih=e.tb().m),o=c&&"2d"===c.Xd()){o=a.ih;var u=c.uo;o=u===o||(u&&!o?!u.alpha&&!u.willReadFrequently:o&&!u?!o.alpha&&!o.willReadFrequently:!o.alpha==!o.alpha&&!u.willReadFrequently==!o.willReadFrequently)}if(o)var l=!1;else if(s&&!l){var c=s;l=!1}else c=new jm(a.vc,a.width,a.height,a.sa,"2d",a.ih),l=!0;break;case"dom":c=s||new im(a.vc,a.width,a.height,a.sa),l=!s;break;default:c=s||new jm(a.vc,a.width,a.height,a.sa,e.tb().Xd(),a.ih),l=!s}n[n.length-1]!==c&&(c.ye(n.length),n.push(c)),e.ld(c)}return n}mm.prototype.f="2d",mm.prototype.Xd=function(){return this.f},mm.prototype.V=function(t,e){return this.c&&this.c.canvas===t||(this.c=t.getContext(this.f,this.m)),this.j(this.c,e)},mm.prototype.u=function(){mm.l.u.call(this),this.c=B},u(ym,aj),t("H.map.layer.DomLayer",ym),ym.prototype.V=function(t,e){return this.c(t,e)},t("H.util.kinetics.KineticMove",zm),zm.prototype.yl=function(t){return this.a=t,this},zm.prototype.setInitialSpeed=zm.prototype.yl,zm.prototype.Rm=function(){return Math.abs(this.a/this.b)},zm.prototype.getDuration=zm.prototype.Rm,zm.prototype.We=function(t){return this.a+this.b*t},zm.prototype.getCurrentSpeed=zm.prototype.We,zm.prototype.Mm=function(t){return this.a*t+this.b*t*t/2},zm.prototype.getCurrentPath=zm.prototype.Mm,t("H.util.events.listenOnce",Ce),t("H.util.events.dispatchEvent",function(t,e){return t.dispatchEvent(e)}),t("H.util.events.fireListeners",function(t,e,r,n){return le(t)?t.td(e,r,n):Le(t,e,r,n)}),t("H.util.events.listen",Be),t("H.util.events.unlisten",Je);var Cm=Me;function sl(){sl.l.constructor.call(this),this.c={},this.b={position:new Wf(0,0),zoom:0,heading:180,incline:0,tilt:0,bounds:new O(Gg([90,-180,90,0,90,180,-90,180,-90,-180]))}}Me=function(t,e){var r,n,i=!0,o=e[e.currentTarget===e.target?"AT_TARGET":t.capture?"CAPTURING_PHASE":(r=!0,"BUBBLING_PHASE")];return(!r||"pointerenter"!==(n=e.type)&&"pointerleave"!==n)&&(e.eventPhase=o,i=Cm(t,e),r&&t.src&&t.src.Qb&&null===t.src.Qb()&&delete e.eventPhase),i},u(sl,F),t("H.map.ViewModel",sl),sl.prototype.a={Ea:"update",Fe:"sync"},sl.prototype.$b=function(t,e){if(!t)throw new D(this.$b,0,t);var r=t[Dm];if(tc(r)&&!Yf(r))throw new D(this.$b,0,Dm);if(tc(r=t[Em])&&E(+r))throw new D(this.$b,0,Em);if(tc(r=t[Fm])&&!C(r,Vf))throw new D(this.$b,0,Fm);return r=Gm(t=x.Object.assign({},t),this.c,this.b),Hm(this,this.c,t),this.dispatchEvent(new Im(this.c,r,e)),this},sl.prototype.setLookAtData=sl.prototype.$b,sl.prototype.mb=function(){var t={};return t[Dm]=Zf(this.b[Dm]),Hm(this,t,this.b,!0),t},sl.prototype.getLookAtData=sl.prototype.mb;var Dm="position",Em="zoom",Fm="bounds",Jm={oj:Dm,rj:Em,ij:"heading",qj:"tilt",jj:"incline",fj:Fm},Km=Object.keys(Jm).map(function(t){return Jm[t]});function Hm(t,e,r,n){t.i={},t.g={},t.f=[];for(var i,o,a,s=t.m,u=t.j,l=Km.length;l--;)if(a=r[i=Km[l]],null==(o=e[i])||!n)if(null!=a){tc(s)&&s.call(t,i,o,a);var c,h=i;if((c="position"!==i)||(c=!(!(c=a)||E(c.lat)||E(c.lng))),e[h]=c?a:Zf(a),tc(u)){switch(i){case"position":o=a&&o&&(a.lat!==o.lat||a.lng!==o.lng);break;case"bounds":o=a&&o&&!a.oa(o);break;default:o=a!==o}o&&u.call(t,i)}}else delete e[i]}sl.prototype.m=function(t,e,r){this.i[t]=e,this.g[t]=r},sl.prototype.j=function(t){this.f.push(Lm[t])};var Lm=Km.reduce(function(t,e){return t[e]=Si[e.toUpperCase()],t},{});function Gm(t,e,r){var n=0;return["tilt","incline","heading",Em].forEach(function(i){if(E(t[i])){var o=E(e[i])?r[i]:e[i];t[i]=o}else n|=Lm[i]}),[Dm,Fm].forEach(function(i){t[i]?n|=Lm[i]:t[i]=e[i]||r[i]}),n}function Mm(t,e){return t|e}function Im(t,e,r){Im.l.constructor.call(this,sl.prototype.a.Ea,t,null,e),this.b=this.animate=!!r}function S(t,e,r,n){if(S.l.constructor.call(this,t,e,r,n),this.Aa=new Dk(100),this.fa=new I(0,0),this.Ne=!!n.enableSubpixelRendering,this.kb=Nm,this.o=new Wl,this.i=n=new dm,this.dc=A(this.dc,this),n.addEventListener(n.g.Rg,this.dc),n=t.element,this.N=t=n.ownerDocument.createElement("div"),t.style.position="absolute",t.style.width=t.style.height="100%",t.style.zIndex=0,n.insertBefore(t,n.firstChild),this.Pd=new Am(this.N,this.sa),this.ma=e.mb().position,!(e=x.H.gl))throw new Xc(S,'"H-webgl" module is missing');for(this.a=new Cl({viewport:this.g,vc:this.N,devicePixelRatio:this.sa,Tk:A(this.ha,this)}),e.WorkerBroker.addTarget("model",cj),t=0,n=(e=this.c.Na()).length,this.j={Yc:[],ja:[]},this.f=e;t<n;t++){var i=e[t];this.jf(t,i),vl(this,i,!0)}this.Jb(),this.ec=A(this.ec,this),this.ci=A(this.ci,this),this.Fa=A(this.Fa,this),r.addEventListener(aj.prototype.b.Ce,this.ec),this.A=Om,this.zoom=wl(this,this.O.vb()),this.Jb(),this.U()}sl.prototype.bb=function(t){var e={},r={};Hm(this,this.b,t),this.c={},e.lookAt=this.g,r.lookAt=this.i,t=(t=this.f).length?t.reduce(Mm):0,this.dispatchEvent(new Ri(this.a.Fe,e,r,t))},sl.prototype.synchronize=sl.prototype.bb,sl.prototype.zf=function(t,e){if(E(t=+t))throw new D(this.zf,0,Em);this.$b({zoom:t},e)},sl.prototype.vb=function(){return this.b.zoom},sl.prototype.tc=Nc,sl.prototype.startControl=sl.prototype.tc,sl.prototype.control=Nc,sl.prototype.control=sl.prototype.control,sl.prototype.Ab=Nc,sl.prototype.endControl=sl.prototype.Ab,u(Im,Ri),u(S,ql),t("H.map.render.webgl.RenderEngine",S),S.prototype.mb=function(){var t=this.ma;return xl(this,{position:{vk:t.vk,xk:t.xk},zoom:this.zoom,tilt:this.Nl,heading:this.heading})},S.prototype.ec=function(t){((t=(t=t.target.ga())&&t.ub())&&t.getState())===Qh.INIT?t.load():(Fl(this.a),Hl(this.a,this.c),this.ha())},S.prototype.type=Al.WEBGL,S.prototype.type=S.prototype.type;var Om=2;function Pm(t,e,r){return(e=r-e)<(t=Dd(2,8+t.zoom))/2?e:e-t*r/Ad(r)}function Qm(t,e,r){function n(t){return i[t]+Tl(i[t],e[t])/2}if(!(r&Si.POSITION||r&Si.BOUNDS))return null;var i=Gl(t.a).getLookAtData();r=i.position;var o=e.position,a=e.bounds;return qi(i.bounds,o.lat,o.lng,!1)||a&&qi(a,r.lat,r.lng,!1)?null:((r=Rm(t,{tilt:n("tilt"),heading:n("heading"),incline:0,bounds:eg([r,o])})).zoom=wl(t,r.zoom-.5),delete r.bounds,r)}function Sm(t,e,r,n){return t=(t=t.getCapabilities().lookAt[n]).max-t.min,Ad("zoom"===n?r[n]-e[n]:Tl(e[n],r[n]))/t||0}function Tm(t,e,r){return Yd(3e3*(t=wd(8*Sm(t,e,r,"zoom"),Sm(t,e,r,"heading"),Sm(t,e,r,"tilt")/2)),300,4e3)}function Rm(t,e){return Xm(e),Gl(t.a).getBestLookAtData(e)}function Xm(t){var e=t.bounds;!e||e instanceof O||(t.bounds=ni(e.G()))}function Zm(t,e,r){Gl(t.a).setLookAtData(e),Fl(t.a),Ym(t),t.ha(),r&&setTimeout(r,0)}function Wm(t,e,r,n){var i=Gl(t.a).getLookAtData(),o=new Sl(i,e);0!==o.a.tilt+o.a.heading+o.a.zoom+o.c?$m(t,function(e){for(var r in o.a)if(0!==o.a[r]){var n=o.i[r](e);i[r]+=o.a[r]*(n-o.g[r]),o.g[r]=n}return 0!==o.c&&(i.position=o.b.Ng(o.j,o.c*o.i.position(e),!0)),Zm(t,i)},r,function(){return Zm(t,e,n)}):Zm(t,e,n)}function an(t,e){t.Aa.qa(function(t,r){return r.Qb()===e})}function bn(t){return!(C(t,ym)||C(t,mm))}function Vm(t,e){var r=e.position;return xl(t,{zoom:wl(t,e.zoom),position:new Wf(r.lat,r.lng),tilt:e.tilt,heading:e.heading,bounds:e.bounds})}function Ym(t){var e=Gl(t.a).getLookAtData();t.zoom=e.zoom,t.ma=e.position}function dn(t,e){return new I((t=Gl(t.a).geoToMeters(e)).x/40075016.68557849+.5,1-(t.y/40075016.68557849+.5))}function en(t,e){return e.sub(dn(t,t.ma)).scale(Dd(2,8+t.zoom))}function fn(t,e,r,n,i,o,a,s){var u,l,c,h=0,f=function(){0==--h&&o(i)};if(s&&s.features)for(h=l=s.features.length,c=0;c<l;c++){var p=s.features[c],d=p.id;if(u=t.a.a.sources[p.source_name]){var v=u.provider,y=v.ak();if(y===Zj.SOURCE){var g=p.source_layer;if("overlays"===g)gn(t,e,r,n,i,u,p.properties.overlays_config);else if(u=u.getMapObjectById(d))if("markers"!==g)i.push(u);else if(hn(t,e,r,u))i.push(u);else if(n&&!a){var m=!0;Kl(t.a,{x:e,y:r},{radius:jn,top_most_only:!1},function(a){fn(t,e,r,n,i,o,!0,a)})}h--}else y===Zj.FEATURE?(g=p.tile.coords,(m=v.getFeatureProxy(p.properties,g,function(t){if(t){for(var e,r=t;r&&(e=r.Qb())&&e!==v;)r=e;e||r.ka(v),i.push(t)}f()}))||((u=t.Aa.get(d))||((u=new Kg(p)).ka(v),t.Aa.add(d,u,1)),i.push(u),h--)):y===Zj.PROVIDER&&(m=!0,v.kl(p,!1).then(function(t){t&&(!(t instanceof Ni)||hn(this,e,r,t))&&i.push(t),f()},function(){f()},t))}}y&&(m||0!==h)||o(i)}function gn(t,e,r,n,i,o,a){var s;for(t=t.Wa(e,r),e=a.length;e--&&(!(s=o.getMapObjectById(a[e].id))||0<=i.indexOf(s)||!s.ba().pd(t)||(i.push(s),!n)););}function hn(t,e,r,n){var i,o=n.Cb(),a=o.g,s=!a;if(a)if(e+=(o=o.ud()).x,r+=o.y,C(o=n.ba(),Ji))for(i=(n=o.pa).length;i--&&!s;)o=t.Fa(n[i]),s=a.hg(e-o.x,r-o.y,0)!==ae.NONE;else o=t.Fa(o),s=a.hg(e-o.x,r-o.y,0)!==ae.NONE;return s}function kn(t,e,r,n,i){for(var o,a=e.length;a--&&!((o=e[a])&&o.Ga&&(t=t.concat(o.Ga(r,n,i)),t.length&&i)););return t}function cn(t){return{w:(t=t.yb[2]).right-t.left,h:t.bottom-t.top}}function ln(t){t.b&&t.b.va()||(El(t.a)||zk()-t.Xa<t.kb)&&!t.v?t.Vd||(t.Vd=Jk(t.ci)):(t.v&&(t.te(),mn(t)),t.A=Om)}function mn(t,e){t.od||setTimeout(A(t.dispatchEvent,t,{type:t.zk.pj,target:e||t}),1)}function on(t,e,r){Gl(t.a).applyPxOffset([e,r]),Ym(t),t.fa.set(0,0),Fl(t.a),t.ha()}function pn(t,e,r,n){Gl(t.a).setLookAtData({zoom:e},Cc(r)&&Cc(r)?[r,n]:B),Ym(t),Fl(t.a),t.ha()}function Um(t){nn(t),t.i.va()&&t.Ab(!0),t.o.va()&&t.Bb(!0)}function qn(t,e){if(e){var r={};r.mf=e.power,r.Oe=e.ease,r.duration=e.duration,t.s=r}}function sn(t,e){var r=en(t,dn(t,e.position)),n=r.y;r=r.x;var i=e.zoom,o=en(t,dn(t,t.ma));e=o.y;var a=o.x;o=t.zoom;var s=t.i.Eb(),u=t.i.b,l=t.i.c,c=0;if(r=Pm(t,a,r),e=Cd((r-=a)*r+(n-=e)*n+(o=i-o)*o),0!==s&&0!==e){var h=r/e,f=n/e,p=o/e,d=s*s/(2*e);$m(t,function(e,r){var n;1!==e?((n=p*(r=(e=s*r-d*r*r/2)-c))&&(n=wl(t,t.zoom+n),pn(t,n,u,l)),on(t,xd(h*r),xd(f*r)),c=e):(pn(t,wl(t,i),u,l),t.ha())},2*e/s)}}function rn(t,e,r){r=r||0;var n=t.i,i=Gl(t.a),o=i.getLookAtData();e.pb&&pn(t,wl(t,o.zoom+e.pb*r),n.b,n.c),i.setLookAtData({heading:zl(t,o.heading+e.ve*r),tilt:yl(t,o.tilt+e.ue*r)}),Ym(t),on(t,e.nb*r,e.ob*r)}function $m(t,e,r,n,i){t.b&&t.b.va()&&t.b.stop(!0),t.b=new nm(t,e,r,n,i),t.b.start()}function nn(t){t.b&&t.b.va()&&t.b.stop(!0)}S.prototype.getState=function(){return this.A},S.prototype.getState=S.prototype.getState,S.prototype.od=!1,S.prototype.bh=function(t){var e=this,r=t.newValue,n=t.modifiers,i=Gl(this.a);Um(this),this.fa.set(0,0);var o=Vm(this,r);if(Km.forEach(function(e){n&t[e.toUpperCase()]||delete o[e]}),t.b){i=Gl(this.a).getLookAtData();var a=Rm(this,o);r=Qm(this,a,n);var s=function(){return e.od=!1};if(delete a.bounds,this.od=!0,r){i=Tm(this,i,r);var u=Tm(this,r,a);Wm(this,r,i,function(){return Wm(e,a,u,s)})}else r=Tm(this,i,a),Wm(this,a,r,s)}else Xm(o),i.setLookAtData(o);Ym(this),Fl(this.a),this.ha()},S.prototype.Fg=function(){},S.prototype.setAnimationDuration=S.prototype.Fg,S.prototype.sh=function(){},S.prototype.getAnimationDuration=S.prototype.sh,S.prototype.Gg=function(){},S.prototype.setAnimationEase=S.prototype.Gg,S.prototype.th=function(){},S.prototype.getAnimationEase=S.prototype.th,S.prototype.Cg=function(){},S.prototype.resetAnimationDefaults=S.prototype.Cg,n=S.prototype,n.Rk=function(t){an(this,t.target.ga()),Fl(this.a),this.ha()},n.jf=function(t,e){S.l.jf.call(this,t,e),bn(e)&&(Fl(this.a),(t=(t=e.ga())&&t.ub())&&t.getState()===Qh.INIT&&t.load())},n.oi=function(t,e,r){var n;if(this.Xa=zk(),an(this,e.ga()),e.requestDomMarkers||C(e,mm)||C(e,ym)){var i=this.j.ja;for(n=i.length;n--;){var o=i[n];if(o.tb()===e){i.splice(n,1),o.B();break}}}bn(e)&&Hl(this.a,this.c),this.f=this.c.Na(),0===t&&(vl(this,e,!1),this.Jb()),Bm(this.Pd,cn(this),this.j.ja.filter(tc)),this.te(),r||this.ha()},n.pi=function(){this.Jb()},n.Jb=function(){S.l.Jb.call(this);var t=this.getCapabilities().lookAt.zoom;Gl(this.a).setZoomConstraints(wd(t.min,this.Pg),vd(t.max,this.Tg))},n.Mh=function(t,e){var r;if(e){if(t={xc:this.Ne,ib:this.ib},e.V?C(e,mm)?r=new lm(e):C(e,ym)&&(r=new lm(e)):e.requestDomMarkers&&(r=new rm(e,t)),r){this.j.ja.push(r);var n=this.c.Na();this.j.ja.sort(function(t,e){return n.indexOf(t.hb)-n.indexOf(e.hb)}),Bm(this.Pd,cn(this),this.j.ja.filter(tc))}bn(e)&&Hl(this.a,this.c)}this.f=this.c.Na()},n.Fa=function(t){return Gl(this.a).geoToPixel(t)},S.prototype.geoToScreen=S.prototype.Fa,S.prototype.Wa=function(t,e){return Gl(this.a).xyToGeo(t,e)},S.prototype.screenToGeo=S.prototype.Wa,S.prototype.Eg=function(t,e){return t=this.Wa(t,e),(e=this.O.mb()).position=t,e},S.prototype.Ga=function(t,e,r,n){var i=this,o=[];o=kn(o,this.j.ja,t*this.sa,e*this.sa,r),r&&o.length?n(o):this.a.a.initialized?Kl(this.a,{x:t,y:e},{radius:jn,top_most_only:r},function(a){fn(i,t,e,r,o,n,!1,a)}):n(o)},S.prototype.getObjectsAt=S.prototype.Ga,S.prototype.W=y,S.prototype.U=function(){var t=this.j.ja.length;rl(this,this.sa),this.fa.set(0,0);var e=cn(this),r=e.w,n=e.h;for(this.a.a.handleViewportUpdate();t--;){var i=(e=this.j.ja[t].xb).Db();i.w===r&&i.h===n||e.yf(r,n)}this.W=new Ki(r,n),Fl(this.a),this.ha()},S.prototype.getCapabilities=function(){return Bl},S.prototype.getCapabilities=S.prototype.getCapabilities,n=S.prototype,n.Vd=0,n.te=function(){this.j.Yc.length=0},n.ci=function(){this.Vd=0,this.C&&this.C.before();var t=Gl(this.a),e=t.getLookAtData(!1),r=t.getLookAtData(!0);t=this.g.center.clone(),r=r.bounds.G();var n=this.zoom,i=this.fa,o=this.f,a=o.length;for(this.kb=Nm;a--;){var s=o[a];C(s,aj)&&s.ga()&&s.ga().nf(r,n)}this.v=this.a.V(),this.O.bb(e),e=this.v,a=(o=this.j).ja.length;var u,l=!0;for(u=0;u<a;u++){s=o.ja[u];var c=o.Yc;if(s){var h=s.V(r,t,void 0,n,!1,i,this.Fa,this.a.a.getCameraMatrix());h===jk.ACTIVE&&(this.kb=1/0),h!==jk.DONE||c[u]||(mn(this,s.tb()),c[u]=!0),c[u]||(l=!1)}}this.v=e&l,this.W&&(this.g.bb(this.W),this.W=y),this.b&&this.b.va()&&this.Sg(),this.C&&this.C.after(),ln(this)},n.u=function(){var t=this.c.Na()[0],e=this.g;Kk(this.Vd),nn(this),t&&vl(this,t,!1),this.j.ja.filter(tc).forEach(function(t){t.B()}),e.element&&e.element.removeChild(this.N),this.N=null,this.A=3,this.a.B(),S.l.u.call(this)},n.ha=function(){this.Xa=zk(),this.A===Om&&(this.v=!1,this.A=1,ln(this))},n.Ae=function(t,e,r){pn(this,t=wl(this,wl(this,t)),e,r)},S.prototype.zoomAt=S.prototype.Ae,S.prototype.uc=function(t,e){var r=!!(e||t&(ul.HEADING|ul.TILT));Um(this),qn(this,e),this.o.start(t,r),Gl(this.a).setPanning(!0)},S.prototype.startInteraction=S.prototype.uc,S.prototype.lc=function(t,e,r,n,i){var o=this.o,a=!1;if(o.va()){var s=Gl(this.a),u=s.getLookAtData(),l=this.g.center;l=[l.x,l.y],e=o.store(t,e,r,n,i),r=o.Wf(),t=o.ce(),i=this.o.Xf(),n=this.o.uh(),o.c&&(o.Hc(ul.TILT)&&(s.setLookAtData({tilt:yl(this,u.tilt+t.y/this.g.height*-180)},l),a=!0),e&&1!==i&&o.Hc(ul.ZOOM)&&(a=o.Wf(),pn(this,wl(this,i=Bd(Dd(2,this.zoom)*i)/Ld),a.x,a.y),a=!0),o.Hc(ul.COORD)&&0<Vl(t)&&(on(this,-t.x,-t.y),a=!0),o.Hc(ul.HEADING)&&(e?s.setLookAtData({heading:u.heading+zl(this,n)},[r.x,r.y]):t.x&&s.setLookAtData({heading:zl(this,u.heading+t.x/this.g.width*360)},l),a=!0),a&&(Fl(this.a),this.ha()))}},S.prototype.interaction=S.prototype.lc,S.prototype.Bb=function(t){var e=this;if(this.o.va()&&!t){if(this.s){t=this.o.Eb();var r=this.o.zc(),n=this.s.duration,i=(this.s.mf||1)*t,o=new zm(-i/(0<n?n:1),i);!E(r.x)&&!E(r.y)&&0<i&&e.o.Hc(ul.COORD)&&$m(this,function(t){i=o.We(t*n),E(i)||on(e,xd(-r.x*i),xd(-r.y*i))},n,void 0,this.s.Oe)}this.s=null,this.o.clear()}Gl(this.a).setPanning(!1),this.ha()},S.prototype.endInteraction=S.prototype.Bb,S.prototype.tc=function(t,e,r){Um(this),this.i.start(e,r),qn(this,t),Gl(this.a).setPanning(!0)},S.prototype.startControl=S.prototype.tc,S.prototype.control=function(t,e,r,n,i,o){for(var a,s=0;s<arguments.length;s++)if((a=+arguments[s])!=a)throw new D(this.control,s,a);this.i.va()&&this.i.set(t,e,r,n,i,o)},S.prototype.control=S.prototype.control,S.prototype.Ab=function(t,e){var r,n=this;if(this.i.va()){nn(this);var i=zk(),o=i-this.za;if(1<=o)rn(this,gm(this.i),o);if(!this.s||t||e)"function"==typeof e&&(e(t=(t=Gl(this.a)).getLookAtData()),sn(this,t));else{e=this.i.Eb();var a=this.i.zc(),s=this.s.duration,u=(this.s.mf||1)*e,l=new zm(-u/(0<s?s:1),u);!E(a.nb)&&!E(a.ob)&&0<u&&$m(this,function(t,e,o,c){i&&(o=c-i,i=0),u=l.We(t*s)*o,E(u)||((r=a.pb*u)&&pn(n,wl(n,n.zoom+r),n.i.b,n.i.c),on(n,xd(a.nb*u),xd(a.ob*u)))},s,void 0,this.s.Oe)}this.i.reset(),Gl(this.a).setPanning(!1),this.ha()}},S.prototype.endControl=S.prototype.Ab,S.prototype.dc=function(t){var e=this,r=t.c;this.fa.set(0,0),r.nb||r.ob||r.pb||r.ue||r.ve||r.wf?(this.za=zk(),$m(this,function(t,n,i,o){e.za=o,rn(e,r,i)},Td),this.ha()):nn(this)},S.prototype.nh=function(){},S.prototype.enter=S.prototype.nh,S.prototype.Vf=function(t){tl(this.N,t)},S.prototype.exit=S.prototype.Vf,S.prototype.capture=function(t,e,r,n){var i=this;return Ll(i.a).then(function(o){var a=i.N.ownerDocument.createElement("canvas"),s=i.sa,u=a.getContext("2d"),l=i.a.$a()/s,c=(r-t)*s;return s*=n-e,a.width=c,a.height=s,u.drawImage(o,t*l,e*l,c*l,s*l,0,0,c,s),a})},S.prototype.ym=function(t){return Gl(this.a).geoToMeters(t)},S.prototype.geoToMeters=S.prototype.ym,S.prototype.Eo=function(t){return Gl(this.a).metersToGeo(t)},S.prototype.metersToGeo=S.prototype.Eo;var Nm=5e3,jn=3.5;function T(t,e,r){var n={};if(T.l.constructor.call(this),this.J=A(T.prototype.J,this),this.i=tn(r,T),this.b=r=new sl,this.N=!1,r.addEventListener(r.a.Fe,this.za,!1,this),!C(t,Element))throw new D(T,0,t);var i=(r=this.S=t.ownerDocument.createElement("div")).style;if(i.position="relative",i.height=r.style.width="100%",i.overflow="hidden",i.webkitTapHighlightColor="transparent","transparent"!==i.webkitTapHighlightColor&&(i.webkitTapHighlightColor="rgba(0,0,0,0)"),t.appendChild(r),this.ya=new kk(this.S,this.i),this.ya.addEventListener(this.ya.a.Fe,this.za,!1,this),(t=this.a=new cj(this.i.layers)).addEventListener(t.b.Ee,this.U,!1,this),t.addEventListener(t.b.Be,this.U,!1,this),t.addEventListener(t.b.De,this.U,!1,this),!this.f&&un(this),this.c=null,this.a.add(e,0),this.g=this.O(null!=this.i.engineType?this.i.engineType:Vj.WEBGL,this.i),this.v=A(this.v,this),this.C=A(this.C,this),(e=this.i.imprint)!==B&&"object"!=typeof e)throw new D(T,1,"imprint");this.m=null===e?e:new lj(this,e),e=this.i.autoColor,this.fa=e===B||!!e,vn(this),(e=this.i.zoom)&&(n.zoom=e),(e=this.i.bounds)&&(n.bounds=e),(e=this.i.center)&&(n.position=e),this.b.$b(n)}function tn(t,e){if(t){var r=t.pixelRatio;if(r===B)t.pixelRatio=Se();else if(!(0<r))throw new D(e,0,"pixelRatio: "+r)}else(t={}).pixelRatio=Se();return t.renderBaseBackground||(t.renderBaseBackground={lower:3,higher:2}),t}function vn(t){t.m&&t.fa&&t.m.Li({invert:t.c&&t.c.nm})}function wn(t,e,r){t.dispatchEvent(r?new Ri(t.o.kj,r.newValue,r.oldValue,r.modifiers):t.o.kj+e)}function xn(t){hj.call(this,t)}function un(t){t.j=new N({max:24}),t.f=new ml(t.j,t.i),t.a.add(t.f)}u(T,F),t("H.Map",T),T.prototype.u=function(){this.fa=!1,this.m&&this.m.B(),this.g.dispose(),this.b.B(),this.ya.B(),this.f.B(),this.j.B(),this.a.B();var t=this.S;t.parentNode.removeChild(t),this.S=null,F.prototype.u.call(this)},T.prototype.L=function(){return this.S},T.prototype.getElement=T.prototype.L,T.prototype.$a=function(){return this.i.pixelRatio},T.prototype.getPixelRatio=T.prototype.$a,T.prototype.U=function(t){var e=t.added,r=t.removed;e&&e.ga()&&e.ga().ka(this),r&&r.ga()&&r.ga().ka(null),r===this.f&&(this.j=this.f=null),r===this.c&&(this.c=null),0===t.idx&&(this.dispatchEvent(new Ng(this.o.Ff,this.c=t.type!==this.a.b.De?e:0<this.a.a.length?this.a.get(0):y,t.type!==this.a.b.Be?r:1<this.a.a.length?this.a.get(1):y)),vn(this))},T.prototype.za=function(t){t.modifiers&&(this.N||(wn(this,"start"),this.N=!0),wn(this,"",t),this.W&&x.clearTimeout(this.W),this.W=x.setTimeout(this.C,333))},T.prototype.C=function(){wn(this,"end"),this.N=!1},T.prototype.Hg=function(t,e){return this.g.getCapabilities().lookAt&&this.b.$b({position:t},!!e),this},T.prototype.setCenter=T.prototype.Hg,T.prototype.fb=function(){var t=this.b.mb();return t?t.position:y},T.prototype.getCenter=T.prototype.fb,T.prototype.zf=function(t,e){return this.b.zf(t,!!e),this},T.prototype.setZoom=T.prototype.zf,T.prototype.vb=function(){return this.b.vb()},T.prototype.getZoom=T.prototype.vb,T.prototype.Ae=function(t,e,r){this.g.zoomAt(t,e,r)},T.prototype.zoomAt=T.prototype.Ae,T.prototype.Un=function(){return this.ya},T.prototype.getViewPort=T.prototype.Un,T.prototype.Tn=function(){return this.b},T.prototype.getViewModel=T.prototype.Tn,T.prototype.jn=function(){return this.a},T.prototype.getLayers=T.prototype.jn,T.prototype.dn=function(){return this.m},T.prototype.getImprint=T.prototype.dn,T.prototype.capture=function(t,e,r,n,i,o){function a(t,e){d?t.cancel():(l.save(),e.capture(u,f,function(e){l.restore(),t.done(e)},function(e){t.done(null,e),s(null)}))}function s(e){d||(d=!0,t(e))}var u,l,c=this.ic(),h=c.getCapabilities(),f=this.i.pixelRatio,p=this.ya,d=!1,v=this;if(!Ca(t))throw new D(this.capture,0,t);r=r||0,n=n||0,i=i||p.width,o=o||p.height;var g=wd(0,vd(r,i)),m=wd(0,vd(n,o));r=vd(p.width,wd(r,i)),n=vd(p.height,wd(n,o)),h.capture?c.capture(g,m,r,n).then(function(t){var r=v.m,n=e||[];l=(u=t).getContext("2d"),u.style.width=u.width/f+"px",u.style.height=u.height/f+"px";var i=new xk(10,a);(n=n.concat(r).filter(function(t){return Ca(t&&t.capture)})).length?(t=n.pop(),n.forEach(function(t){i.push(t,hd)}),i.push(t,A(s,v,u)),tk(i)):s(u)},function(){s(y)}):t(null)},T.prototype.capture=T.prototype.capture,T.prototype.ic=function(){return this.s||this.g},T.prototype.getEngine=T.prototype.ic,T.prototype.wl=function(t){return this.g.type===t||this.ma||(this.ma=!0,this.s=this.O(t),this.s.addEventListener("render",this.v)),this},T.prototype.setEngineType=T.prototype.wl,T.prototype.v=function(t){t.target===this.s&&(this.s.removeEventListener("render",this.v),this.g.Vf(this.J))},T.prototype.J=function(){var t=this.g.type;this.g.B(),this.g=this.s,this.s=B,this.ma=!1,this.dispatchEvent(new Ng(this.o.Vl,this.g.type,t))},T.prototype.O=function(t,e){if(e=e?tn(e,this.O):this.i,vn(this),t===Vj.P2D)return new x.H.map.render.p2d.RenderEngine(this.ya,this.b,this.a,e);if(t===Vj.WEBGL)return new S(this.ya,this.b,this.a,e);if(t===Vj.HARP)return new x.H.map.render.harp.RenderEngine(this.ya,this.b,this.a,e);throw new D(this.wl,0,t)},T.prototype.Cf=function(t,e,r,n,i){if(e=tc(e)?C(e,K,this.Cf,1,e)&&e:this.b.mb().bounds.G(),!C(i=i||this.c,cl))throw new D(this.Cf,4);var o=i.ga(),a=this.$a(),s=i.tileSize;if(2<=a&&256<s&&o instanceof sk&&(s/=2),a=this.vb(),s=Math.log2(s)-8,!((r=tc(r)?+r:a)<=(n=tc(n)?+n:a)))throw new D(this.Cf,B,"!(min <= max)");a=o.min;var u=o.max,l=this.ic().type===Vj.WEBGL?yd:xd;if(r=Yd(l(r)-s,a,u),n=Yd(l(n)-s,a,u),!(o&&C(o,R)&&ld()&&o.fh()))throw new Xc(this.Cf,"Storing is not supported");return new nk(i,o,e,r,n,t)},T.prototype.storeContent=T.prototype.Cf,u(xn,hj),xn.prototype.f=function(){jj(this,2)},xn.prototype.c=function(){jj(this,4)},T.prototype.mm=function(t){return t=new xn(t),kd().clear(A(t.f,t),A(t.c,t)),t},T.prototype.clearContent=T.prototype.mm,T.prototype.Xg=function(t,e){var r=this.a,n=r.indexOf(t),i=e!==+e;return e=i?r.a.length-1:e,0>n?r.add(t,e):n-e&&(r.pc(n),r.add(t,i?e-1:e)),this},T.prototype.addLayer=T.prototype.Xg,T.prototype.rf=function(t){var e=this.a.indexOf(t);return t!==this.c&&t!==this.f&&-1!==e&&this.a.pc(e),this},T.prototype.removeLayer=T.prototype.rf,T.prototype.Kd=function(t){return this.c!==t&&(this.a.a.length&&this.a.get(0)!==this.f?this.a.set(0,t):this.a.add(t,0),this.c=t),this},T.prototype.setBaseLayer=T.prototype.Kd,T.prototype.Em=function(){return this.c},T.prototype.getBaseLayer=T.prototype.Em,T.prototype.Fa=function(t){if(!Yf(t))throw new D(this.Fa,0,t);return(t=this.g.geoToScreen(t))?wf(t):y},T.prototype.geoToScreen=T.prototype.Fa,T.prototype.Wa=function(t,e){var r;if(r=+E(t)||2*E(e))throw new D(this.Wa,r-1,arguments[r-1]);return(r=this.g.screenToGeo(t,e))?Zf(r):y},T.prototype.screenToGeo=T.prototype.Wa,T.prototype.Eg=function(t,e){return this.g.screenToLookAtData(t,e)},T.prototype.screenToLookAtData=T.prototype.Eg,T.prototype.ea=function(t){if(!C(t,M))throw new D(this.ea,0,t);return!this.f&&un(this),this.j.kc().ea(t),t},T.prototype.addObject=T.prototype.ea,T.prototype.Ia=function(t){if(!C(t,M))throw new D(this.Ia,0,t);return!this.f&&un(this),this.j.kc().Ia(t),t},T.prototype.removeObject=T.prototype.Ia,T.prototype.Va=function(t){return!this.f&&un(this),this.j.kc().Va(t)},T.prototype.getObjects=T.prototype.Va,T.prototype.fc=function(t){var e;yc(t,this.fc,0,t),!this.f&&un(this);var r=t.length;for(e=0;e<r;e++)this.ea(t[e]);return this},T.prototype.addObjects=T.prototype.fc,T.prototype.Gd=function(t){var e;yc(t,this.Gd,0,t),!this.f&&un(this);var r=t.length;for(e=0;e<r;e++)this.Ia(t[e]);return this},T.prototype.removeObjects=T.prototype.Gd,T.prototype.de=function(t,e,r){var n;if(n=+E(t)||2*E(e))throw new D(this.de,n-1,arguments[n-1]);this.g.getObjectsAt(t,e,!0,function(t){r(t[0])})},T.prototype.getObjectAt=T.prototype.de,T.prototype.Ga=function(t,e,r){var n;if(n=+E(t)||2*E(e))throw new D(this.de,n-1,arguments[n-1]);this.g.getObjectsAt(t,e,!1,r)},T.prototype.getObjectsAt=T.prototype.Ga,T.prototype.Bh=function(t,e,r){var n=r||gf;r=n.visiblesOnly;var i=n.zoom;n=n.types;var o=Pg.ANY;C(t,O,this.Bh,0,"area"),wc(e,"Function",this.Bh,1,"callback"),this.j.Va(t,!tc(r)||!!r,tc(i)?+i:this.b.vb(),tc(n)?n&o:o,e)},T.prototype.getObjectsWithin=T.prototype.Bh;var Vj={P2D:Al.P2D,WEBGL:Al.WEBGL};function yn(t,e){yn.l.constructor.call(this,t,e)}function zn(t,e){zn.l.constructor.call(this,jh,e),this.we(t)}function hk(t,e,r){var n="anonymous",i=1;this.f=A(this.f,this),M.call(this,r),this.da(t),r&&((t="crossOrigin")in r&&(n=r[t]),(t="opacity")in r&&(i=r[t])),this.vl(e,n),this.qc(i)}function An(t){if(!t||!Ca(t.requestData))throw new D(An,0,"options.requestData");An.l.constructor.call(this,t),this.N=t.requestData,this.J=!!t.providesDomMarkers}function Bn(t,e){Bn.l.constructor.call(this,t,e)}T.EngineType=Vj,Vj.HARP=Al.HARP,T.prototype.o={vp:"mapviewchangestart",kj:"mapviewchange",lj:"mapviewchangeend",Ff:"baselayerchange",Vl:"enginechange"},u(yn,Ni),t("H.map.Marker",yn),n=yn.prototype,n.type=Pg.MARKER,n.Og=1,n.wa=function(t){if(t!==Mg.VISUAL||1===this.bl||1===this.icon.getState())var e=yn.l.wa.call(this,t);return e||!1},n.bl=0,n.sk=function(t){return C(t,Ij)},n.Ph=!1,n.Qk=function(){this.wa(Mg.VISUAL)},n.Pc=function(t){var e=this.icon;return this.Ph&&(e.removeEventListener("statechange",this.Qk,!1,this),delete this.Ph),e&&(this.bl=e.getState()),yn.l.Pc.call(this,t),0===t.getState()&&(this.Ph=!0,Ce(t,"statechange",this.Qk,!1,this)),this},yn.prototype.setIcon=yn.prototype.Pc,yn.prototype.f=function(t){return new Ij(t.svg,t)},yn.prototype.X=function(){var t=this.getIcon(),e=t.hp||0,r=yn.l.forWorkerMessage.call(this),n=r.properties.icon;return n&&0<e&&Wa(n,{stick_color:t.gp,stick_height:e}),r},yn.prototype.forWorkerMessage=yn.prototype.X,u(zn,wi),t("H.map.Rect",zn),zn.prototype.we=function(t){if(!C(t,K))throw new D(this.we,0,t);t.oa(this.U)||(this.U=this.R=t,this.eb!==y&&zn.l.da.call(this,ni(t)))},zn.prototype.setBoundingBox=zn.prototype.we,zn.prototype.G=function(){return this.R},zn.prototype.getBoundingBox=zn.prototype.G,zn.prototype.da=function(){return this},zn.prototype.setGeometry=zn.prototype.da,zn.prototype.ba=function(){return this.eb||zn.l.da.call(this,ni(this.U)),this.eb},zn.prototype.getGeometry=zn.prototype.ba,u(hk,M),t("H.map.Overlay",hk),hk.prototype.type=Pg.OVERLAY,hk.prototype.G=function(){return this.R},hk.prototype.getBoundingBox=hk.prototype.G,hk.prototype.we=function(t){return C(t,K,this.we,0,t),this.da(t)},hk.prototype.setBoundingBox=hk.prototype.we,hk.prototype.ba=function(){return this.R},hk.prototype.getGeometry=hk.prototype.ba,hk.prototype.da=function(t){var e=this.R,r=!e;return C(t,K,this.da,0,t),!r&&e.oa(t)||(this.R=t,r||this.wa(Mg.SPATIAL)),this},hk.prototype.setGeometry=hk.prototype.da,hk.prototype.ad=function(){return this.b.getData()},hk.prototype.getBitmap=hk.prototype.ad,hk.prototype.vl=function(t,e){var r=this.b;return r&&1!==r.getState()&&r.cancel(),this.b=new Dj(t,this.f,!0,B,e),this},hk.prototype.setBitmap=hk.prototype.vl,hk.prototype.f=function(t,e){this.b=e,1===t&&this.wa(Mg.VISUAL)},hk.prototype.dd=function(){return this.g},hk.prototype.getOpacity=hk.prototype.dd,hk.prototype.qc=function(t){var e=this.g,r=2>e;if(!(0<=t&&1>=t))throw new D(this.qc,0);return t!==e&&(this.g=t,r&&this.wa(Mg.VISUAL)),this},hk.prototype.setOpacity=hk.prototype.qc,hk.prototype.X=function(){var t=hk.l.X.call(this);return t.geometry=ni(this.R).X(),t.properties.overlay=!0,t},hk.prototype.forWorkerMessage=hk.prototype.X,u(An,R),t("H.map.provider.MarkerTileProvider",An),An.prototype.Yd=function(t){return t?t.length+1:1},An.prototype.getEntryWeight=An.prototype.Yd,An.prototype.K=function(t,e,r,n,i){var o=this;return this.N(t,e,r,function(i){for(var a,s,u=[],l=i.length;l--;)(s=i[l]).jp=o.getTileKey(t,e,r),s.ka(o),a=s.Cb(),(C(s,Qi)||1===a.getState())&&u.push(i[l]);n(u)},i)},An.prototype.requestInternal=An.prototype.K,An.prototype.ke=function(t,e){e===Mg.VISUAL&&(t=this.Ob().get(t.jp))&&(t.valid=!1,Wj(this,t))},An.prototype.invalidateObject=An.prototype.ke,An.prototype.Vb=function(){return this.J},An.prototype.providesDomMarkers=An.prototype.Vb,An.prototype.Wb=df,An.prototype.providesMarkers=An.prototype.Wb,u(Bn,cl),t("H.map.layer.MarkerTileLayer",Bn);var Cn={markers:[],total:0,requested:0};function Dn(t,e,r,n,i){var o,a=yd(r);for(t.pixelProjection.Qa(a),e=t.je(t.Te(e),a),t=(r=t.$e(e,e.left>e.right,~~r,n,i)).tiles,r=r.total,n=t.length,i=[],o=0;o<n;o++)for(a=(e=t[o]).data.length;a--;)i.push(e.data[a]);return{markers:i,total:t.length,requested:r}}function En(t,e,r){var n,i=6;if(e){for(n=' expected close to: "'+e;i--;)-1!==(e=t.a.next())&&(n+=String.fromCharCode(e));n+='"'}throw new D(Fn,0,"- Malformed WKT: "+(n?r+n:"unexpected end of stream"))}Bn.prototype.Lc=function(t,e,r,n){return this.a.providesDomMarkers()?Cn:Dn(this,t,e,r,n)},Bn.prototype.requestMarkers=Bn.prototype.Lc,Bn.prototype.Kc=function(t,e,r,n){return this.a.providesDomMarkers()?Dn(this,t,e,r,n):Cn},Bn.prototype.requestDomMarkers=Bn.prototype.Kc;var Gn={$l:" ",Xl:"(",Yl:")",Ul:",",Wl:""};function Hn(t,e){var r=t.next();r!==(e=e?")":"(")&&En(t,r,'"'+e+'"')}function In(t){return","===Jn(t)&&(t.next(),!0)}function Kn(t,e,r,n,i){var o,a,s=2+e+r;for(a=1;a<=s;a++)(r=t.next())?(o=+r)!==o?En(t,r,"number"):1===a?n[i+1]=o:2===a?n[i]=o:3===a&&(n[i+2]=o):En(t,r);e||(n[i+2]=0)}Object.keys(Gn).reduce(function(t,e){return t[Gn[e]]=!0,t},mc());var Ln=[];function Mn(t,e,r,n){return n||Hn(t,0),Kn(t,e,r,Ln,0),n||Hn(t,1),new Wf(Ln[0],Ln[1],e?Ln[2]:B)}function Nn(t,e,r){var n=[];Hn(t,0);do{Kn(t,e,r,n,n.length)}while(In(t));return Hn(t,1),new L(n)}function On(t,e,r){Hn(t,0);var n=Nn(t,e,r);if(In(t)){var i=[];do{i.push(Nn(t,e,r))}while(In(t))}return Hn(t,1),new O(n,i)}var Pn=[],Qn=[On],Rn=[Mn],Sn={POINT:Rn,LINESTRING:[Nn],POLYGON:Qn,MULTIPOINT:[Mn,Ji],MULTILINESTRING:[Nn,mh],MULTIPOLYGON:[On,ui],GEOMETRY:Pn,GEOMETRYCOLLECTION:Pn,CIRCULARSTRING:Pn,COMPOUNDCURVE:Pn,CURVEPOLYGON:Pn,MULTICURVE:Pn,MULTISURFACE:Pn,CURVE:Pn,SURFACE:Pn,POLYHEDRALSURFACE:Pn,TIN:Pn,TRIANGLE:Pn},Tn={Z:1,M:2,ZM:3};function Fn(t){var e,r=(t=new Un(t)).next();if((e=Sn[r.toUpperCase()])||En(t,r,"type name"),e!==Pn){r=Jn(t);var n=1&(r=Tn[r.toUpperCase()]),i=r>>1;if(n|i&&t.next(),"EMPTY"===(r=Jn(t)))if(t.next(),n=e[1])var o=new n([]);else e!==Rn&&(o=new L([]),e===Qn&&(o=new O(o)));else if("("===r){if(o=e[0],e=e[1]){var a=[];if(Hn(t,0),o===Mn){var s="("!==Jn(t);do{a.push(o(t,n,i,s))}while(In(t))}else do{a.push(o(t,n,i))}while(In(t));Hn(t,1),n=new e(a)}else n=o(t,n,i);o=n}else En(t,r,'"Z", "M", "ZM", "(" or "EMPTY"');t.next()&&En(t,r,"end of stream")}return o||y}function Un(t){this.a=t}function Jn(t){var e=t.b;if(e===B){for(e=t.a;e.Tb()===Vn;)e.next();if(Wn[e.Tb()])e=(e=e.next())===Xn?"":String.fromCharCode(e);else{e.ze();do{e.next()}while(!Wn[e.Tb()]);e=String.fromCharCode.apply(null,e.Ud())}t.b=e}return e}Un.prototype.next=function(){var t=Jn(this);return""!==t&&delete this.b,t};var Vn=32,Xn=-1,Yn={$l:Vn,Xl:40,Yl:41,Ul:44,Wl:Xn},Wn=Object.keys(Yn).reduce(function(t,e){return t[Yn[e]]=!0,t},mc());function Zn(){}function $n(t){this.c=String(t),this.f=0,this.a=[],this.b=!1}t("H.util.ICharStream",Zn),Zn.prototype.next=function(){},Zn.prototype.ze=function(){},Zn.prototype.Ud=function(){},Zn.prototype.Tb=function(){},t("H.util.CharStream",$n),$n.prototype.next=function(){var t=this.c.charCodeAt(this.f++);return t=isNaN(t)?-1:t,this.b&&this.a.push(t),t},$n.prototype.ze=function(){this.b=!0,this.a=[]},$n.prototype.Ud=function(){var t=this.a.slice();return this.b=!1,this.a=[],t},$n.prototype.Tb=function(){var t=this.c.charCodeAt(this.f);return isNaN(t)?-1:t},t("H.util.wkt.toGeometry",function(t){return Fn(new $n(t))}),t("H.buildInfo",function(){return Ef("H-core","1.30.7","48980f00")});var ao,bo="maps".concat("js-"),co,eo,fo,go,ho;if(co=x.document.querySelector('script[src*="'+bo+'"]'),!co)for(eo=x.document.getElementsByTagName("script"),go=new RegExp("^.*"+bo),ho=0,fo=eo.length;ho<fo;ho++)if(go.test(eo[ho].src)){co=eo[ho];break}function io(t,e){if(!t)throw new D(io,0,t);io.l.constructor.call(this,t),this.b={},this.c=e&&e.xc,this.f=jo++}ao=co?co.src.replace(/\/[^\/]*$/,"/"):"",t("H.getScriptPath",function(){return ao}),u(io,km);var jo=0;function ko(t,e){e=e||{},C(t,ml,ko,0),ko.l.constructor.call(this,t),this.xc=!!e.xc,this.c=e.ib||0,this.a=[],this.b={}}io.prototype.V=function(t,e,r,n,i,o){var a=xd(n),s=this.hb,u=a+(r.exp-s.pixelProjection.exp),l=s.min,c=s.max;n=s.tileSize;var h=s.ga().j,f=this.xb,p=f.dd(),d=f.Db().w,v=r.w,y=r.x,g=r.y,m={};if(a<l||a>c)return jk.DONE;for(t=(i=s.requestTiles(t,u,i,o,this.f)).total,o=(i=i.tiles).length,this.g=r,this.j=e,this.a=u,p!==h&&f.qc(h),r=n=n*v/(Dd(2,u)*n),this.c||(n%1&&(y/=v=r/(n=yd(n)),g/=v,v=Dd(2,u)*n),y=yd(y),g=yd(g)),this.i=r,u=-n,a=d+n,s=0;s<o;s++){if((l=(d=i[s]).data)&&l.tagName){for(r=e.x-(y-d.x*n),h=e.y-(g-d.y*n),f.Zc(l,r,h,n,n),p=r;(p-=v)>u;)f.Zc(l,p,h,n,n);for(p=r;(p+=v)<a;)f.Zc(l,p,h,n,n)}m[this.a+"_"+d.x+"_"+d.y]=d}return this.b=m,o===t?jk.DONE:jk.PENDING},io.prototype.Ga=function(t,e,r){var n,i=this.i,o=i/this.hb.tileSize,a=this.g,s=this.j;if(tc(this.a)&&a){t=a.x+(t-s.x),e=a.y+(e-s.y);var u=yd(a.w/i),l=a=yd(t/i);s=yd(e/i),Ad(l)>=u&&(l%=u),0>l&&(l=u+l),(u=this.b[this.a+"_"+l+"_"+s])&&u.Ga&&(n=u.Ga((t-i*a)/o,(e-i*s)/o,r))}return n||ff},io.prototype.ie=function(){return"2d"},u(ko,km),ko.prototype.V=function(t,e,r,n,i,o){var a,s,u=this.hb;n-=this.c,this.a.length=0;var l=this.b;if(this.b=a={},n>=u.min&&n<=u.max){var c=u.Hd(t,n,i,o),h=c.overlays;if(t=h.length)for(h.sort(Rg),n=this.xb,i=this.xc,o=0;o<t;o++){var f=(u=h[o]).G(),p=r.lb(f.Rb()),d=r.lb(f.Nb());f=r.w,p.x>=d.x&&(p.x-=f),f=-((p.x+d.x)/f>>1)*f,p.x+=f,p.add(e),d.x+=f,d.add(e),i||(p.round(),d.round()),(f=l[s=u.gb()])?delete l[s]:f={Oo:u},a[s]=f;var v=p.x;p=p.y;var y=d.x,g=y-v,m=(d=d.y)-p;n.qc(u.dd()),n.Zc(u.ad(),v,p,g,m),f.mh?f.mh.set(v,p,y,d):f.mh=new lk(v,p,y,d),this.a.push(f)}}return!c||c.requested&&c.requested===c.total||!c.requested&&h.length===c.total?jk.DONE:jk.PENDING},ko.prototype.Ga=function(t,e,r){for(var n,i,o=this.a,a=o.length;a--;)if((n=o[a]).mh.Pf(t,e))if(n=n.Oo,i)i.push(n);else if(i=[n],r)break;return i||ff},ko.prototype.ie=function(){return"2d"},ko.prototype.u=function(){this.a=null,ko.l.u.call(this)};var lo={lookAt:{zoom:{min:-8,max:24},tilt:{min:0,max:0},incline:{min:0,max:0},heading:{min:180,max:180}},interaction:{ZOOM:ul.ZOOM,COORD:ul.COORD},capture:!0};function mo(t,e){this.a=[],mo.l.constructor.apply(this,arguments)}function V(t,e,r,n){V.l.constructor.call(this,t,e,r,n),this.N=new I(0,0),(r=n.renderBaseBackground)&&(this.to=r.lower,this.no=r.higher),this.mo=!!n.enableSubpixelRendering,this.od=no,this.Oj=0,this.Ne=this.Mj=!1,this.i=new Wl,this.a=n=new dm,this.Pd=A(this.Pd,this),n.addEventListener(n.g.Rg,this.Pd),this.Fa=A(this.Fa,this),n=t.element,this.Aa=t=n.ownerDocument.createElement("div"),t.style.position="absolute",t.style.width=t.style.height="100%",t.style.zIndex=0,n.insertBefore(t,n.firstChild),this.ik=new Am(this.Aa,this.sa),this.o=[],oo(this),this.bi=A(V.prototype.bi,this),this.A=po,this.Cg(),this.zoom=qo(this,this.O.vb()+this.ib),this.Jb(),ro(this,e.mb().position,this.zoom),this.bb(),this.U()}t("H.map.render.p2d.capabilities",lo),u(mo,om),n=mo.prototype,n.Nj=function(){return this.hb.Lc.apply(this.hb,arguments)},n.V=function(t,e,r,n,i,o,a){return this.a=[],mo.l.V.apply(this,arguments)},n.Ck=1,n.jl=function(t,e,r,n,i,o){var a=this.Ck=n.$a();i*=a,o*=a;var s=r.Db();e=s.w*a,s=s.h*a;var u=r.ud();this.xc?(i-=u.x*a,o-=u.y*a):(i=xd(i-u.x*a),o=xd(o-u.y*a)),n.Zc(r.ad(),i,o,e,s),t.detail?t.detail.set(i,o,i+e,o+s):t.detail=new lk(i,o,i+e,o+s),this.a.push(t)},n.Ga=function(t,e,r){for(var n,i,o,a=this.a,s=a.length,u=ff,l=this.Ck;s--&&!((i=(n=a[s]).detail).Pf(t,e)&&(n=n.Mk,(!(o=n.Cb().g)||o.hg((t-i.left)/l,(e-i.top)/l,0))&&0>u.indexOf(n)&&(u===ff&&(u=[]),u.push(n),r))););return u},n.ie=function(){return"2d"},n.u=function(){this.a=null,mo.l.u.call(this)},u(V,ql),t("H.map.render.p2d.RenderEngine",V),V.prototype.type=Al.P2D,V.prototype.type=V.prototype.type;var po=2;function so(t,e,r){return Ad(e=r-e)<t.ra.w/2?e:e-t.ra.w*r/Ad(r)}function oo(t){var e=t.c.Na(),r=0,n=e.length;for([t.fa={},t.s={},t.W={},t.ma={}].forEach(function(t){t.Yc=[],t.ja=[]}),t.f=t.c.Na();r<n;r++)t.jf(r,e[r]);t.Jb()}function Bo(t){var e=[];return(e=(e=(e=(e=e.concat(t.s.ja)).concat(t.fa.ja)).concat(t.W.ja)).concat(t.ma.ja)).filter(tc)}function vo(t,e){var r=wl(t,wl(t,e.zoom)+t.ib);return(t=xl(t,e)).zoom=r,t}function ro(t,e,r){var n=t.ra;n.Qa(r),t.m=n.projection.$c(e),n.x=n.w*t.m.x,n.y=n.h*t.m.y}function Ao(t){return{w:(t=t.yb[2]).right-t.left,h:t.bottom-t.top}}function Co(t){t.b&&t.b.va()||zk()-t.Xa<t.od&&!t.v?t.Vd=Jk(t.bi):(t.v&&(t.te(),Do(t)),t.A=po)}function Do(t,e){t.dispatchEvent({type:t.zk.pj,target:e||t})}function Ho(t,e,r){xo(t,e*t.sa,r*t.sa),t.N.set(0,0),t.bb(),t.ha()}function xo(t,e,r){var n=t.ra;t=t.m,n.x=Wd(n.x+e,n.w),n.y=wd(0,vd(n.w,n.y+r)),t.x=n.x/n.w,t.y=n.y/n.h}function yo(t,e,r,n){var i=t.sa,o=t.g.center;r===+r&&n===+n?(r=(r-o.x)*i,n=(n-o.y)*i,t.N.set(r,n),xo(t,r,n),t.ra.Qa(e),xo(t,-r,-n)):(t.N.set(0,0),t.ra.Qa(e)),t.zoom=e,t.bb(),t.ha()}function to(t,e,r,n){var i=t.getCapabilities().lookAt.zoom.max,o=e.fb(),a=n||o;if(e.jg()||r&&n)r=r===B?i:r;else{var s=new Yi(t.ra.projection);s.Qa(i);var u=s.lb(e.Rb()).round(),l=s.lb(e.Nb()).round();i=s.w,e.Gb()&&(u.x-=i),n?(o=s.lb(a),e=2*wd(o.x-u.x,l.x-o.x),u=2*wd(o.y-u.y,l.y-o.y)):(e=l.x-u.x,u=l.y-u.y,a=o),r===B&&(r=(o=t.yb[4]).right-o.left,o=o.bottom-o.top,r=wl(t,r=-8+vd(Bd(r/e*i)/Ld,Bd(o/u*i)/Ld)-t.ib))}return{zoom:yd(r),position:a}}function uo(t){zo(t,!0),t.a.va()&&t.Ab(!0),t.i.va()&&t.Bb(!0),zo(t,!0)}function Io(t,e){if(e){var r={};r.mf=e.power,r.Oe=e.ease,r.duration=e.duration,t.j=r}}function qo(t,e){return wl(t,wl(t,e-t.ib)+t.ib)}function Ko(t,e){var r=t.m,n=t.ra.projection.$c(e.position),i=t.ra.qe(n),o=i.y;i=i.x;var a=e.zoom;e=(r=t.ra.qe(r)).y;var s=r.x;r=t.zoom;var u=t.a.Eb(),l=t.a.b,c=t.a.c,h=0;if(i=so(t,s,i),e=Cd((i-=s)*i+(o-=e)*o+(r=a-r)*r),0!==u&&0!==e){var f=i/e,p=o/e,d=r/e,v=u*u/(2*e);wo(t,function(e,r){var i;1!==e?((i=d*(r=(e=u*r-v*r*r/2)-h))&&(i=qo(t,t.zoom+i),yo(t,qo(t,i),l,c)),Ho(t,xd(f*r),xd(p*r)),h=e):(t.m=n,yo(t,qo(t,a),l,c),t.bb(),t.ha())},2*e/u)}}function Jo(t,e,r){r=r||0,e.pb&&yo(t,qo(t,t.zoom+e.pb*r),t.a.atX,t.a.atY),Ho(t,e.nb*r,e.ob*r)}function wo(t,e,r,n,i){t.b&&t.b.va()&&t.b.stop(!0),t.b=new nm(t,e,r,n,i),t.b.start()}function zo(t,e){t.b&&t.b.va()&&t.b.stop(e)}V.prototype.getState=function(){return this.A},V.prototype.getState=V.prototype.getState,V.prototype.bh=function(t){var e=this,r=t.b,n=t.newValue,i=t.modifiers;t=n.position;var o,a=n.bounds,s=this.zoom,u=this.m,l=0;if(i&Si.POSITION&&(o=e.ra.lb(t)),i&Si.BOUNDS)n=to(this,a.G(),i&Si.ZOOM?n.zoom:B,i&Si.POSITION?t:B),this.O.$b(n,r);else{i&Si.POSITION||(o=e.ra.lb(n.position));var c=o.x,h=o.y;uo(this),this.N.set(0,0);var f=(n=vo(this,n)).zoom,p=n.position;if(r){var d=f-s,v={x:u.x,y:u.y};r=this.ra.qe(v).x;var y=this.ra.projection.$c(t);y.x===this.m.x&&y.y===this.m.y&&f===this.zoom||(c=so(this,r,c),wo(this,function(t){var r=t-l;if(f!==s){o=e.ra.qe(y);var n=e.ra.qe(v);c=so(e,n.x,o.x),h=o.y-n.y}l=t,xo(e,c*r,h*r),yo(e,s+=d*r),e.bb(),e.ha()},this.kb,function(){ro(e,p,f),yo(e,f),e.bb(p),e.ha()},this.dc))}else zo(this),ro(this,p,f),yo(this,f),this.bb(p);this.ha()}},V.prototype.kb=300,V.prototype.Fg=function(t){var e=Cc(t);if(!e||e&&0>t)throw new D(this.Fg,1,"positive number required");this.kb=t},V.prototype.setAnimationDuration=V.prototype.Fg,V.prototype.sh=function(){return this.kb},V.prototype.getAnimationDuration=V.prototype.sh,V.prototype.dc=Nl,V.prototype.Gg=function(t){if(!Ca(t))throw new D(this.Gg,1,"function required");this.dc=t},V.prototype.setAnimationEase=V.prototype.Gg,V.prototype.th=function(){return this.dc},V.prototype.getAnimationEase=V.prototype.th,V.prototype.Cg=function(){this.dc=Nl,this.kb=300},V.prototype.resetAnimationDefaults=V.prototype.Cg,V.prototype.oi=function(t,e,r){var n;this.Xa=zk(),(n=this.fa.ja.splice(t,1)[0])&&n.B&&n.B(),(n=this.s.ja.splice(t,1)[0])&&n.B&&n.B(),(n=this.W.ja.splice(t,1)[0])&&n.B&&n.B(),(n=this.ma.ja.splice(t,1)[0])&&n.B&&n.B(),this.f=this.c.Na(),0===t&&(vl(this,e,!1),this.Jb()),this.o=Bm(this.ik,Ao(this),Bo(this)),this.te(),r||this.ha()},V.prototype.pi=function(){this.Jb(),this.ha()},V.prototype.Mh=function(t,e,r){var n,i,o,a;if(e){var s={xc:this.mo,ib:this.ib};e.V?C(e,mm)?i=new lm(e):C(e,ym)&&(a=new lm(e)):(e.requestOverlays&&(n=new ko(e,s)),e.requestTiles&&(i=new io(e,s)),e.requestMarkers&&(o=new mo(e,s)),e.requestDomMarkers&&(a=new rm(e,s)))}r=r||0,this.fa.ja.splice(t,r,n),this.s.ja.splice(t,r,i),this.W.ja.splice(t,r,o),this.ma.ja.splice(t,r,a),this.f=this.c.Na(),this.o=Bm(this.ik,Ao(this),Bo(this))},V.prototype.Wa=function(t,e){var r=this.g.center,n=this.sa;return this.ra.Sa((t-r.x)*n,(e-r.y)*n)},V.prototype.screenToGeo=V.prototype.Wa,V.prototype.Eg=function(t,e){return t=this.Wa(t,e),(e=this.O.mb()).position=t,e},V.prototype.Fa=function(t){var e=this.sa,r=this.g.center,n=r.x*e;r=r.y*e,t=this.ra.lb(t);var i=this.ra.w;return new I(xd((t.x-xd(t.x/i)*i+n)/e),xd((t.y+r)/e))},V.prototype.geoToScreen=V.prototype.Fa,V.prototype.G=function(t,e){var r=this.yb[t||4];t=this.ra;var n=r.left-e,i=t.Sa(n,r.top-e),o=r.right+e;return e=t.Sa(o,r.bottom+e),o-n>=t.w&&(i.lng=-(e.lng=180)),dg(i,e)},V.prototype.Ga=function(t,e,r,n){var i,o=[],a=this.sa;for(t*=a,e*=a,i=(a=[this.fa,this.s,this.W,this.ma]).length;i--&&(!r||!o.length);){for(var s=o,u=a[i].ja,l=t,c=e,h=r,f=u.length;f--&&!((o=u[f])&&o.Ga&&(s=s.concat(o.Ga(l,c,h)),s.length&&h)););o=s}n(o)},V.prototype.getObjectsAt=V.prototype.Ga,V.prototype.ec=y,V.prototype.U=function(){var t,e=this.o.length;V.l.U.call(this);var r=Ao(this);this.N.set(0,0);var n=r.w;for(t=r.h;e--;){var i=(r=this.o[e]).Db();i.w===n&&i.h===t||r.yf(n,t)}this.ec=new Ki(n,t),this.ha()},V.prototype.getCapabilities=function(){return lo},V.prototype.getCapabilities=V.prototype.getCapabilities,n=V.prototype,n.te=function(){this.fa.Yc.length=0,this.s.Yc.length=0,this.W.Yc.length=0,this.ma.Yc.length=0},n.bi=function(){var t;this.C&&this.C.before();var e=this.s.ja,r=this.g.center.clone().scale(this.sa).round(),n=this.G(1,0),i=this.G(1,Eo),o=this.zoom,a=o-this.ib,s=this.ra,u=this.to,l=this.no,c=e[0];e=this.N;var h=this.o.length,f=this.f;for(t=f.length;h--;){var p=this.o[h];C(p,jm)&&p.clear()}if(c){if(u)for(;u;)h=o-u,c.V(n,r,s,h,!0,e),--u;if(l&&this.Ne)for(p=1;p<=l&&(h=o+p,s.Qa(h),u=this.G(2,0),s.Qa(o),!c.V(u,r,s,h,!0,e));p++);}for(this.od=no;t--;)C(s=f[t],aj)&&s.ga()&&s.ga().nf(i,a);n=this.Bk(n,r,o,!1,e,Fo,this.s,this.fa),r=this.Bk(i,r,a,!1,e,Go,this.W,this.ma),this.v=n&&r,this.b&&this.b.va()&&this.Sg(),this.J||(this.J=this.O.mb()),this.J.bounds=this.G(4,0),this.O.bb(this.J),this.J=null,this.ec&&(this.g.bb(this.ec),this.ec=y),o<this.Oj?this.Ne=!0:this.Mj&&(this.Ne=!1),this.Oj=o,this.Mj=n,this.C&&this.C.after(),Co(this)},n.Bk=function(t,e,r,n,i,o,a){var s,u=Array.prototype.slice.call(arguments,6),l=u.length,c=u[0].ja.length,h=l*c,f=!!h;for(s=0;s<h;s++){if(o===Fo)var p=s%l,d=Math.floor(s/l);else p=Math.floor(s/c),d=s%c;var v=u[p].ja[d];p=u[p].Yc,v&&((v=v.V(t,e,this.ra,r,n,i,this.Fa))===jk.ACTIVE&&(this.od=1/0),v!==jk.DONE||p[d]||(Do(this,this.f[d]),p[d]=!0),p[d]||(f=!1))}return f},n.u=function(){var t=this.c.Na()[0],e=this.g;Kk(this.Vd),zo(this,!0),t&&vl(this,t,!1),Bo(this).forEach(function(t){t.B()}),e.element&&e.element.removeChild(this.Aa),this.Aa=null,this.A=3,V.l.u.call(this)},n.ha=function(){this.Xa=zk(),this.A===po&&(this.v=!1,this.A=1,Co(this))},n.Ae=function(t,e,r){yo(this,t=wl(this,wl(this,t)+this.ib),e,r)},V.prototype.zoomAt=V.prototype.Ae,V.prototype.uc=function(t,e){uo(this),Io(this,e),this.i.start(t,!!e)},V.prototype.startInteraction=V.prototype.uc,V.prototype.lc=function(t,e,r,n,i){var o=!1;this.i.va()&&(e=this.i.store(t,e,r,n,i),this.i.Hc(ul.COORD)&&(0<Vl(t=this.i.ce())&&(Ho(this,-t.x,-t.y),o=!0)),e&&this.i.Hc(ul.ZOOM)&&(t=this.i.Wf(),e=this.i.Xf(),(e=Bd(Dd(2,this.zoom)*e)/Ld)!==this.zoom&&(yo(this,e=qo(this,e),t.x,t.y),o=!0)),o&&this.ha())},V.prototype.interaction=V.prototype.lc,V.prototype.Bb=function(t){var e=this;if(this.i.va()&&!t){if(this.j){t=this.i.Eb();var r=this.i.zc(),n=this.j.duration,i=(this.j.mf||1)*t,o=new zm(-i/(0<n?n:1),i);!E(r.x)&&!E(r.y)&&0<i&&e.i.Hc(ul.COORD)&&wo(this,function(t){i=o.We(t*n),E(i)||Ho(e,xd(-r.x*i),xd(-r.y*i))},n,void 0,this.j.Oe)}this.j=null,this.i.clear()}},V.prototype.endInteraction=V.prototype.Bb,V.prototype.tc=function(t,e,r){uo(this),this.a.start(e,r),Io(this,t)},V.prototype.startControl=V.prototype.tc,V.prototype.control=function(t,e,r){if(E(+r))throw new D(this.control,2,r);if(E(t))throw new D(this.control,0,t);if(E(e))throw new D(this.control,1,e);this.a.va()&&this.a.set(t,e,r,0,0,0)},V.prototype.control=V.prototype.control,V.prototype.Ab=function(t,e){var r,n=this;if(this.a.va()){zo(this,!0);var i=zk(),o=i-this.za;if(1<=o)Jo(this,gm(this.a),o);if(!this.j||t||e)"function"==typeof e&&((t=this.mb()).zoom=this.zoom-this.ib,e(t),t.zoom+=this.ib,Ko(this,t));else{e=this.a.Eb();var a=this.a.zc(),s=this.j.duration,u=(this.j.mf||1)*e,l=new zm(-u/(0<s?s:1),u);!E(a.nb)&&!E(a.ob)&&0<u&&wo(this,function(t,e,o,c){i&&(o=c-i,i=0),u=l.We(t*s)*o,E(u)||((r=a.pb*u)&&yo(n,qo(n,n.zoom+r),n.a.b,n.a.c),Ho(n,xd(a.nb*u),xd(a.ob*u)))},s,void 0,this.j.Oe)}this.a.reset()}},V.prototype.endControl=V.prototype.Ab,V.prototype.Pd=function(t){var e=this,r=t.c;this.N.set(0,0),r.nb||r.ob||r.pb?(this.za=zk(),wo(this,function(t,n,i,o){e.za=o,Jo(e,r,i)},Number.POSITIVE_INFINITY),this.ha()):zo(this,!0)},V.prototype.nh=function(){},V.prototype.enter=V.prototype.nh,V.prototype.Vf=function(t){tl(this.Aa,t)},V.prototype.exit=V.prototype.Vf,V.prototype.capture=function(t,e,r,n){var i=this.Aa.ownerDocument.createElement("canvas"),o=i.getContext("2d"),a=this.sa;for(i.width=(r-t)*a,i.height=(n-e)*a,r=0;r<this.o.length;r++)C(n=this.o[r],jm)&&o.drawImage(n.L(),-t*a,-e*a);return Wb(i)};var Go=0,Fo=1,no=1e3,Eo=256;function Lo(t){var e=t.ownerDocument;e=e.documentElement||e.body.parentNode||e.body;try{var r=t.getBoundingClientRect()}catch(t){r={top:0,right:0,bottom:0,left:0,height:0,width:0}}return{x:r.left+("number"==typeof window.pageXOffset?window.pageXOffset:e.scrollLeft),y:r.top+("number"==typeof window.pageYOffset?window.pageYOffset:e.scrollTop)}}var Mo=function(){return this}.apply(null);function No(t,e,r,n,i,o,a){No.l.constructor.call(this,t),this.pointers=e,this.changedPointers=r,this.targetPointers=n,this.currentPointer=i,this.originalEvent=a,this.target=o}function Oo(t,e,r,n,i,o){if(isNaN(t))throw Error("x needs to be a number");if(isNaN(e))throw Error("y needs to be a number");if(isNaN(r))throw Error("pointer must have an id");this.viewportX=t,this.viewportY=e,this.target=null,this.id=r,this.type=n,this.dragTarget=null,this.button=tc(i)?i:-1,this.buttons=tc(o)?o:0,this.a=this.button}function Po(t,e,r){if(isNaN(e))throw Error("x needs to be a number");if(isNaN(r))throw Error("y needs to be a number");t.viewportX=e,t.viewportY=r}function Qo(t,e){t.a=e,t.buttons|=Oo.prototype.b[+e]||0}function Ro(t,e){t.a=e,t.buttons&=~(Oo.prototype.b[+e]||0)}u(No,rd),t("H.mapevents.Event",No),t("H.mapevents.Pointer",Oo),Oo.prototype.gn=function(){return this.a},Oo.prototype.getLastChangedButton=Oo.prototype.gn,Oo.prototype.b=[1,4,2];var So={NONE:-1,LEFT:0,MIDDLE:1,RIGHT:2};function To(t){this.a=t instanceof Array?t.slice(0):[]}function Uo(t,e){return-1!==(e=t.indexOf(e))?t.a[e]:null}function Vo(t,e){for(var r=t.a.length,n=[];r--;)t.a[r].type!==e&&n.push(t.a[r]);t.a=n}function Wo(t,e){for(var r=t.a.length;r--;)if(t.a[r].dragTarget===e)return!0;return!1}function Xo(t,e,r){if(r=r||{},!(t instanceof T))throw Error("events: map instance required");if(!(e instanceof Array))throw Error("events: map array required");nd.call(this),this.kh=r.kh||300,this.Bj=r.Bj||50,this.Il=r.Il||50,this.Jl=r.Jl||500,this.Vh=r.Vh||900,this.Uh=r.Uh||8,this.map=t,this.o=this.map.ya,this.j=this.o.element,this.O=e,this.a=new To,this.b=new To,this.i={},this.c=null,this.s=!0,this.aa={},this.f={},this.m=null,this.Le=A(this.Le,this),this.C={pointerdown:this.qm,pointermove:this.rm,pointerup:this.sm,pointercancel:this.pm},Yo(this)}function Yo(t,e){var r,n=t.O.length;for(r=0;r<n;r++){var i=t.O[r],o=i.listener;"function"==typeof o&&(e?(i.target||t.j).removeEventListener(i.Ta,o):(i.target||t.j).addEventListener(i.Ta,o))}}function Zo(t,e,r){var n;if("function"==typeof t.C[e]){"pointermove"!==e&&(t.s=!0);var i=0;for(n=t.b.length();i<n;i++){var o=t.b.a[i];t.j.contains(r.composedPath()[0])?$o(t,o,t.Ij.bind(t,r,e,o)):t.Ij(r,e,o,null)}}t.b.clear()}function $o(t,e,r){if(t.c===e)r(e.target);else{var n=t.o,i=e.viewportX;if(e=e.viewportY,0>i||0>e||i>=n.width||e>=n.height)r(y);else{var o=t.map;o.de(i,e,function(t){r(t||o)})}}}function bp(t,e,r){e===t.c&&(cp(t,e.dragTarget,"dragend",r,e),t.c=null,ap(e.id,t.aa)),e.dragTarget=null}function ap(t,e){e[t]&&(e[t].timeout?clearTimeout(e[t].timeout):clearTimeout(e[t]),delete e[t])}function dp(t,e,r){var n=e.target,i=new I(e.viewportX,e.viewportY),o=e.id;ap(o,t.f);var a=setTimeout(function(){n&&n===e.target&&i.Za({x:e.viewportX,y:e.viewportY})<t.Uh&&(cp(t,n,"longpress",r,e),delete t.i[e.id])},t.Vh);t.f[o]={timeout:a,He:i}}function cp(t,e,r,n,i){if(e&&"function"==typeof e.dispatchEvent){var o,a=No,s=t.a.Na(),u=t.b.Na(),l=(t=t.a).a.length,c=[];for(o=0;o<l;o++)t.a[o].target===e&&c.push(t.a[o]);a=new a(r,s,u,c,i,e,n),i.button=/^(?:longpress|(?:dbl)?tap|pointer(?:down|up))$/.test(r)?i.a:So.NONE,e.dispatchEvent(a)}return a}function ep(t){this.g=A(this.g,this),Xo.call(this,t,[{Ta:"touchstart",listener:this.g},{Ta:"touchmove",listener:this.g},{Ta:"touchend",listener:this.g},{Ta:"touchcancel",listener:this.g}]),this.J={touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",touchcancel:"pointercancel"},this.v=(t=(t=t.m)?t.L():null)?Array.prototype.slice.call(t.querySelectorAll("a"),0):[]}function fp(t){var e=gp(this);(window.PointerEvent||window.MSPointerEvent)&&e.push({Ta:"MSHoldVisual",listener:"prevent"}),Xo.call(this,t,e)}function gp(t){var e,r,n=!!window.PointerEvent,i=[];return t.g=A(t.g,t),"MSPointerDown MSPointerMove MSPointerUp MSPointerCancel MSPointerOut MSPointerOver".split(" ").forEach(function(o){e=o.toLowerCase().replace(/ms/g,""),r=n?e:o,i.push({Ta:r,listener:t.g,target:/^pointer(up|move)$/.test(e)?window:null})}),i}Oo.Button=So,n=To.prototype,n.clear=function(){this.a.splice(0,this.a.length)},n.length=function(){return this.a.length},n.indexOf=function(t){for(var e=this.a.length;e--;)if(this.a[e].id===t)return e;return-1},n.remove=function(t){return-1!==(t=this.indexOf(t))?this.a.splice(t,1)[0]:null},n.push=function(t){if(t instanceof Oo)return this.a.push(t);throw Error("list needs a pointer")},n.Na=function(){return this.a},n.clone=function(){return new To(this.a)},u(Xo,nd),n=Xo.prototype,n.Ij=function(t,e,r,n){ap(r.id,this.aa),this.C[e].call(this,r,n,t)},n.sm=function(t,e,r){var n=t.id;t.target=e,bp(this,t,r),cp(this,e,"pointerup",r,t),"mouse"!==t.type&&cp(this,e,"pointerleave",r,t),e=this.i[t.id];var i={x:t.viewportX,y:t.viewportY},o=r.timeStamp,a=t.target,s=this.m;e&&e.target===a&&e.He.Za(i)<this.Il&&o-e.Yi<this.Jl?(cp(this,a,"tap",r,t),s&&s.target===a&&o-s.Yi<this.kh?s.He.Za({x:t.viewportX,y:t.viewportY})<this.Bj&&(cp(this,a,"dbltap",r,t),this.m=null):this.m={target:a,He:new I(t.viewportX,t.viewportY),Yi:r.timeStamp}):this.m=null,this.i={},ap(n,this.f)},n.Le=function(t,e){var r=this;cp(this,t.dragTarget,"drag",e,t),ap(t.id,this.aa),this.aa[t.id]=setTimeout(function(){r.Le(t,e)},150)},n.rm=function(t,e,r){var n=t.dragTarget,i=t.id,o=t.target;t.target=e,o!==e&&(cp(this,o,"pointerleave",r,t),cp(this,e,"pointerenter",r,t)),n?this.c?(this.Le(t,r),this.f[i]&&this.f[i].He.Za({x:t.viewportX,y:t.viewportY})>this.Uh&&ap(i,this.f)):this.s?this.s=!1:(this.c=t,cp(this,n,"dragstart",r,t),this.Le(t,r),delete this.i[i],this.s=!0):(!this.c||this.c&&this.c.dragTarget!==e&&this.c.dragTarget!==this.map)&&cp(this,e,"pointermove",r,t)},n.qm=function(t,e,r){var n=!(/^(?:mouse|pen)$/.test(t.type)&&0!==r.button);if(e){t.target=e,this.i[t.id]={He:new I(t.viewportX,t.viewportY),target:t.target,Yi:r.timeStamp},"mouse"!==t.type&&cp(this,e,"pointerenter",r,t);var i=cp(this,e,"pointerdown",r,t);!this.c&&n&&(e.draggable&&!Wo(this.a,e)?t.dragTarget=e:!this.map.draggable||i.defaultPrevented||Wo(this.a,this.map)||(t.dragTarget=this.map)),dp(this,t,r)}},n.pm=function(t,e,r){var n=t.id;t.target=null,e?(cp(this,e,"pointerleave",r,t),cp(this,e,"pointercancel",r,t)):cp(this,this.map,"pointercancel",r,t),bp(this,t,r),this.i={},ap(n,this.f)},n.u=function(){Yo(this,!0),this.a.clear(),this.b.clear();var t,e=this.aa;for(t in e)ap(t,e);for(var r in e=this.f)ap(r,e);this.c=this.i=this.m=this.map=this.b=this.a=this.O=this.S=null,nd.prototype.u.call(this)},u(ep,Xo),ep.prototype.g=function(t){var e,r=t.touches,n=this.a.length();if("touchstart"===t.type&&n>=r.length){for(n=this.a.clone(),e=r.length;e--;)n.remove(r[e].identifier);for(e=n.length();e--;)this.a.remove(n.a[e].id);this.b=n,Zo(this,"pointercancel",t),this.b.clear()}if(this.J[t.type]){r=Lo(this.o.element),n=t.type;var i,o=(e=t.changedTouches).length;for(this.b.clear(),i=0;i<o;i++){var a=e[i],s=Uo(this.a,a.identifier),u=a.pageX-r.x,l=a.pageY-r.y;if(s)if("touchmove"===n){a=Math.abs(s.viewportX-u);var c=Math.abs(s.viewportY-l);(1<a||1<c||1===a&&1===c)&&(Po(s,u,l),this.b.push(s))}else"touchend"===n&&(this.a.remove(s.id),this.b.push(s),Ro(s,So.LEFT));else s=new Oo(u,l,a.identifier,"touch",So.LEFT,1),this.a.push(s),this.b.push(s)}Zo(this,this.J[t.type],t),-1===this.v.indexOf(t.target)&&t.preventDefault()}},ep.prototype.u=function(){this.v=null,Xo.prototype.u.call(this)},u(fp,Xo);var hp={2:"touch",3:"pen",4:"mouse"};function ip(t,e,r,n){ip.l.constructor.call(this,"contextmenu"),this.items=[],this.viewportX=t,this.viewportY=e,this.target=r,this.originalEvent=n}function jp(t){this.Hh=A(this.Hh,this),this.Jh=A(this.Jh,this),this.Ih=A(this.Ih,this),this.v=!1,this.g=-1,this.J=0,jp.l.constructor.call(this,t,[{Ta:"contextmenu",listener:this.Hh},{target:t,Ta:"longpress",listener:this.Jh},{target:t,Ta:"dbltap",listener:this.Ih}])}function kp(t,e,r,n,i){var o=t.map,a=Date.now()-t.J;i?!t.v&&a>t.Vh&&(t.v=!0,i.dispatchEvent(new ip(e,r,i,n)),Ce(o.L(),t.gj,t.Hj,!1,t)):o.de(e,r,t.vo.bind(t,e,r,n))}function lp(t,e,r,n,i){lp.l.constructor.call(this,"wheel"),this.delta=t,this.viewportX=e,this.viewportY=r,this.target=n,this.originalEvent=i}function mp(t){var e="onwheel"in document;this.N=e,this.J=(e?"d":"wheelD")+"elta",this.g=A(this.g,this),mp.l.constructor.call(this,t,[{Ta:(e?"":"mouse")+"wheel",listener:this.g}]),this.v=this.map.ya}function np(t){this.g=A(this.g,this),Xo.call(this,t,[{Ta:"mousedown",listener:this.g},{Ta:"mousemove",listener:this.g,target:window},{Ta:"mouseup",listener:this.g,target:window},{Ta:"mouseover",listener:this.g},{Ta:"mouseout",listener:this.g},{Ta:"dragstart",listener:this.v}])}function op(t){var e=t.ya.element.style;if(-1!==pp.indexOf(t))throw Error("InvalidArgument: map is already in use");this.a=t,pp.push(t),e.msTouchAction=e.touchAction="none",$c||!window.PointerEvent&&!window.MSPointerEvent?(this.c=new ep(this.a),this.b=new np(this.a)):this.c=new fp(this.a),this.g=new mp(this.a),this.f=new jp(this.a),this.a.zb(this.B,this),nd.call(this)}fp.prototype.g=function(t){var e=window.PointerEvent?t.type:t.type.toLowerCase().replace(/ms/g,""),r=Lo(this.j),n=Uo(this.a,t.pointerId),i=t.pageX-r.x;r=t.pageY-r.y;var o=hp[t.pointerType]||t.pointerType;if(Zc&&"rtl"===x.getComputedStyle(this.o.element).direction&&(i-=(x.devicePixelRatio-1)*this.o.width),!(n||/^pointer(up|out|cancel)$/.test(e)||"touch"===o&&"pointerdown"!==e)){n={x:i,y:r};var a=t.pointerType;"number"==typeof a&&(a=hp[a]),n=new Oo(n.x,n.y,t.pointerId,a,t.button,t.buttons),this.a.push(n)}n&&(/^pointer(up|cancel)$/.test(e)?("touch"===o&&this.a.remove(n.id),Ro(n,t.button)):"pointerdown"===e&&("touch"===t.pointerType&&(Vo(this.a,"mouse"),Vo(this.a,"pen")),Qo(n,t.button)),this.b.push(n),"pointermove"!==e?(Po(n,i,r),Zo(this,/^pointer(over|out)$/.test(e)?"pointermove":e,t)):n.viewportX===i&&n.viewportY===r||(Po(n,i,r),Zo(this,e,t))),this.b.clear()},u(ip,rd),t("H.mapevents.ContextMenuEvent",ip),u(jp,Xo),n=jp.prototype,n.Jh=function(t){var e=t.currentPointer;"touch"===e.type&&1===t.pointers.length&&kp(this,e.viewportX,e.viewportY,t.originalEvent,t.target)},n.Ih=function(t){"touch"===t.currentPointer.type&&(this.J=Date.now())},n.Hh=function(t){var e=this;-1===this.g?this.g=setTimeout(function(){var r=Lo(e.j),n=t.pageX-r.x;r=t.pageY-r.y,e.g=-1,kp(e,n,r,t)},this.kh):(clearInterval(this.g),this.g=-1),t.preventDefault()},n.vo=function(t,e,r,n){kp(this,t,e,r,n=n&&Ca(n.dispatchEvent)?n:this.map)},n.gj=["mousedown","touchstart","pointerdown","wheel"],n.Hj=function(){this.v&&(this.v=!1,this.map.dispatchEvent(new rd("contextmenuclose",this.map)))},n.u=function(){var t=this.map.L();clearInterval(this.g),t&&Je(t,this.gj,this.Hj,!1,this),Xo.prototype.u.call(this)},u(lp,rd),t("H.mapevents.WheelEvent",lp),u(mp,Xo),mp.prototype.g=function(t){if(!t.Tl){var e=Lo(this.j),r=t.pageX-e.x;e=t.pageY-e.y;var n,i=this.J,o=t[i+(i+"Y"in t?"Y":"")];if(Zc&&"rtl"===x.getComputedStyle(this.v.element).direction&&(r-=(x.devicePixelRatio-1)*this.v.width),o){var a=Math.abs,s=a(o);o=(!(n=t[i+"X"])||3<=s/a(n))&&(!(n=t[i+"Z"])||3<=s/a(n))?((0<o)-(0>o))*(this.N?1:-1):0}(r=new lp(o,r,e,null,t)).delta&&(t.stopImmediatePropagation(),t.preventDefault(),this.map.de(r.viewportX,r.viewportY,this.U.bind(this,r)))}},mp.prototype.U=function(t,e){var r,n,i=t.target=e||this.map;setTimeout(function(){i.dispatchEvent(t),t.f||(r=t.originalEvent,(n=new x.WheelEvent("wheel",r)).Tl=1,r.target.dispatchEvent(n))},0)},u(np,Xo),np.prototype.g=function(t){var e,r=t.type,n=Lo(this.j);n={x:t.pageX-n.x,y:t.pageY-n.y},(e=this.a.a[0])||(e=new Oo(n.x,n.y,1,"mouse"),this.a.push(e)),this.b.push(e),Po(e,n.x,n.y),/^mouse(?:move|over|out)$/.test(r)?Zo(this,"pointermove",t):(/^mouse(down|up)$/.test(r)&&(n=t.which-1,"up"===Mo.RegExp.$1?Ro(e,n):Qo(e,n)),Zo(this,r.replace("mouse","pointer"),t)),this.b.clear()},np.prototype.v=function(t){t.preventDefault()},u(op,nd),t("H.mapevents.MapEvents",op),op.prototype.c=null,op.prototype.b=null,op.prototype.g=null,op.prototype.f=null;var pp=[];function qp(t,e){var r;if(e=void 0===e?{}:e,qp.l.constructor.call(this),-1!==rp.indexOf(t))throw new D(qp,0,"events are already used");this.a=r=t.a,this.j=t,rp.push(t),r.draggable=!0,this.i=e.kinetics||{duration:600,ease:Nl},this.m=e.modifierKey||"Alt",this.enable(e.enabled),this.c=r.ya,this.f=this.c.element,this.g=0,r.addEventListener("dragstart",this.ei,!1,this),r.addEventListener("drag",this.Ek,!1,this),r.addEventListener("dragend",this.di,!0,this),r.addEventListener("wheel",this.Uk,!1,this),r.addEventListener("dbltap",this.Pk,!1,this),r.addEventListener("pointermove",this.Fk,!1,this),Be(this.f,"contextmenu",this.Dk,!1,this),t.zb(this.B,this)}Fc(pp),op.prototype.B=function(){this.a=null,this.c.B(),this.g.B(),this.f.B(),this.b&&this.b.B(),pp.splice(pp.indexOf(this.a),1),nd.prototype.B.call(this)},op.prototype.dispose=op.prototype.B,op.prototype.Dm=function(){return this.a},op.prototype.getAttachedMap=op.prototype.Dm,u(qp,nd),t("H.mapevents.Behavior",qp);var rp=[];Fc(rp),qp.prototype.b=0;var sp={PANNING:1,PINCH_ZOOM:2,WHEEL_ZOOM:4,DBL_TAP_ZOOM:8,FRACTIONAL_ZOOM:16,TILT:32,HEADING:64};qp.Feature=sp;var tp=sp.PANNING,up=sp.PINCH_ZOOM,vp=sp.WHEEL_ZOOM,wp=sp.DBL_TAP_ZOOM,xp=sp.FRACTIONAL_ZOOM,yp=sp.TILT,zp=sp.HEADING,Ap=tp|up|vp|wp|xp|yp|zp;function Bp(t,e){if(t!==+t||t%1||0>t||2147483647<t)throw new D(e,0,"integer in range [0...0x7FFFFFFF] required")}function Cp(t,e,r){var n,i="touch"===e.currentPointer.type,o=0;if(n=!i){n=t.m;var a=e.originalEvent;n=a.getModifierState?a.getModifierState(n):!!a[n.replace(/^Control$/,"ctrl").toLowerCase()+"Key"]}return n?o|=yp|zp:(o|=tp,i&&(2===(e=e.pointers).length&&(o|=up|zp,r?55>Ad(e[0].viewportY-e[1].viewportY)&&(o|=yp):t.Nh&ul.TILT&&(o|=yp)))),((o&=t.b)&yp?ul.TILT:0)|(o&zp?ul.HEADING:0)|(o&up?ul.ZOOM:0)|(o&tp?ul.COORD:0)}function Dp(t){var e=t.pointers;return t=e[0],e=e[1],t=[t.viewportX,t.viewportY],e&&t.push(e.viewportX,e.viewportY),t}function Ep(t,e,r,n,i){var o=+r-+e;if(t=t.a.b,isNaN(+e))throw Error("start zoom needs to be a number");if(isNaN(+r))throw Error("to zoom needs to be a number");0!==o&&(t.startControl(null,n,i),t.control(0,0,6,0,0,0),t.endControl(!0,function(t){t.zoom=r}))}function Fp(t,e){return Wa.apply(null,arguments),t}function Gp(){this.a={}}function Hp(t,e){for(var r in e)if(e.hasOwnProperty(r)){var n,i=e[r],o=t.a[r]||(t.a[r]=[]),a=i.length;for(n=0;n<a;n++)o.push(new Ip(i[n]))}}function Jp(t,e,r,n){var i=(t=t.a[e])?t.length:0,o=[];for(e=0;e<i;e++)t[e].Ad(r,n)&&o.push(t[e]);return o}function Ip(t){var e,r=t.boxes;if(this.label=t.label,this.min=t.minLevel,this.max=t.maxLevel,this.b=[],r&&(e=r.length)){var n=r[0],i=new K(n[0],n[1],n[2],n[3]);for(this.b.push(i),this.a=new K(n[0],n[1],n[2],n[3]),t=1;t<e;t++)i=new K((n=r[t])[0],n[1],n[2],n[3]),this.b.push(i),this.a.nc(i,!1,this.a)}}function W(t,e,r,n,i,o){if(!t||!e)throw Error('Parameters "scheme" and "host" must be specified');this.Cl(t),this.Ig(e),this.Md(r),this.Bl(i),this.rl(o),this.Oi(n)}function Kp(t,e){var r,n=x.document,i=n&&n.createElement("a"),o="";if(n){if(e){var a=(r=n.getElementsByTagName("base")[0])&&r.href,s=n.head,u=r||s.appendChild(n.createElement("base"));u.href=e}i.href=t,o=i.href,e&&(r?r.href=a:s.removeChild(u))}else/[\w]+:\/\//.test(t)&&(o=t);if(t=(a=/(?:(\w+):\/\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\/[^?#]*)?(\?[^#]+)?(#.*)?/.exec(o))[1],u=a[4],e=a[5],s=a[6],n=a[7],r=a[8],!a[2]&&u&&/@/.test(u)&&(u=u.split("@")[1]),a=u,s=s&&0<s.length?s.substr(1):"",u={},n)for(i=/([?&]?([^=&+]+))(=([^&]+))?/g;o=i.exec(n);)u[decodeURIComponent(o[2])]=o[4]?decodeURIComponent(o[4]):void 0;return new W(t,a,s,u,isNaN(+e)?void 0:+e,r&&0<r.length?r.substr(1):"")}qp.DRAGGING=tp,qp.WHEELZOOM=vp,qp.DBLTAPZOOM=wp,qp.FRACTIONALZOOM=xp,qp.prototype.disable=function(t){var e=this.b;t!==B?(Bp(t,this.disable),e^=e&t):e=0,this.c.endInteraction(!0),this.b=e,this.a.draggable=0<(e&(tp|yp|zp|up))},qp.prototype.disable=qp.prototype.disable,qp.prototype.enable=function(t){var e=this.b;t!==B?(Bp(t,this.enable),e|=t&Ap):e=Ap,this.b=e,this.a.draggable=0<(e&(tp|yp|zp|up))},qp.prototype.enable=qp.prototype.enable,qp.prototype.isEnabled=function(t){return Bp(t,this.isEnabled),t===(this.b&t)},qp.prototype.isEnabled=qp.prototype.isEnabled,n=qp.prototype,n.Nh=0,n.ei=function(t){var e=Cp(this,t,!0);if(this.Nh=e){var r=this.c;if(t=Dp(t),r.startInteraction(e,this.i),r.interaction.apply(r,t),this.b&vp&&!(this.b&xp)&&(e=t[0],r=t[1],this.g)){t=this.a.vb();var n=(0>this.g?zd:yd)(t);t!==n&&(this.g=0,Ep(this,t,n,e,r))}}},n.Ek=function(t){var e=Cp(this,t,!1);if(e!==this.Nh)"pointerout"!==t.originalEvent.type&&"pointerover"!==t.originalEvent.type&&(this.di(t),this.ei(t));else if(e){e=this.c;var r=Dp(t);e.interaction.apply(e,r),t.originalEvent.preventDefault()}},n.di=function(t){Cp(this,t,!1)&&this.c.endInteraction(!this.i)},n.Uk=function(t){if(!t.defaultPrevented&&this.b&vp){var e=t.delta,r=this.a.vb(),n=this.a,i=n.ic().type;n=this.b&xp?r-e:(0>-e?zd:yd)(r)-e,i!==Vj.P2D&&i!==Vj.WEBGL&&i!==Vj.HARP||(Ep(this,r,n,t.viewportX,t.viewportY),this.g=e),t.preventDefault()}},n.Fk=function(){},n.Pk=function(t){var e=t.currentPointer,r=this.a.vb(),n=t.currentPointer.type,i=this.a.ic().type;(i===Vj.P2D||i===Vj.WEBGL||i===Vj.HARP)&&this.b&wp&&(t="mouse"===n?0===t.originalEvent.button?-1:1:0<t.pointers.length?1:-1,Ep(this,r,t=this.b&xp?r-t:(0>-t?zd:yd)(r)-t,e.viewportX,e.viewportY))},n.Dk=function(t){return!(this.b&wp)||(t.preventDefault(),!1)},n.B=function(){var t=this.a;t&&(t.draggable=!1,t.removeEventListener("dragstart",this.ei,!1,this),t.removeEventListener("drag",this.Ek,!1,this),t.removeEventListener("dragend",this.di,!0,this),t.removeEventListener("wheel",this.Uk,!1,this),t.removeEventListener("dbltap",this.Pk,!1,this),t.removeEventListener("pointermove",this.Fk,!1,this),this.a=null),this.f&&(this.f.style.msTouchAction="",Je(this.f,"contextmenu",this.Dk,!1,this),this.f=null),this.i=this.c=null,rp.splice(rp.indexOf(this.j),1),nd.prototype.B.call(this)},qp.prototype.dispose=qp.prototype.B,t("H.mapevents.buildInfo",function(){return Ef("H-mapevents","1.30.7","cb4e043")}),R.prototype.O=ca(3,function(t){var e=this.getCache(),r=this;if(t!==y){C(t,Dk,R.prototype.O,0);var n=t}else n=hl;n!==e&&e.qa(function(t,e,i){return!!r.gc(t)&&(n.add(t,e,i),!0)}),this.U=n}),Th.prototype.b=ca(2,function(t){this.i=t,(t=this.getState())!==Qh.INIT&&t!==Qh.LOADING&&ai(this)}),Ip.prototype.Ad=function(t,e){if(t>=this.min&&t<=this.max){if(!(t=this.b.length)||!this.a)return!0;if(this.a.Ad(e))for(;t--;)if(this.b[t].Ad(e))return!0}return!1},t("H.service.Url",W),W.parse=Kp;var Lp=0;function Np(t){function e(t,e){return encodeURIComponent(t)+(void 0===e?"":"="+encodeURIComponent(e).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16)}))}var r,n=[],i=t.a;for(r in i)if(i.hasOwnProperty(r)&&"function"!=typeof i[r]){var o=t.a[r];C(o,Op)?o.Rl.forEach(function(t){n.push(e(r,t))}):n.push(e(r,o))}return 0<n.length?"?"+n.join("&"):""}function Pp(t){var e=Ef("H-service","1.30.7","776722f");return t.a.xnlp="CL_JSMv3."+e.version,t}function Mp(t){var e,r=0;for(e in t.a)if(t.a.hasOwnProperty(e)&&"function"!=typeof t.a[e]&&0<++r)break;return!r}function Op(t){var e;if(!yc(t))throw new D(Op,0,t);for(e=0;e<t.length;e++){var r=t[e];if(!zc(r)&&!Cc(r))throw new D(Op,0,"The array can only contain strings and numbers")}this.Rl=t}W.prototype.clone=function(){Lp++;var t,e={};for(t in this.a)e[t]=this.a[t];return new W(this.s,this.f,this.c,e,this.g,this.b)},W.prototype.clone=W.prototype.clone,W.prototype.Cl=function(t){if(!t||"string"!=typeof t)throw Error('The "scheme" parameter must be a non-empty string.');return this.s=t,this},W.prototype.setScheme=W.prototype.Cl,W.prototype.Hn=function(){return this.s},W.prototype.getScheme=W.prototype.Hn,W.prototype.Ig=function(t){if(!t||"string"!=typeof t||"-"===t.charAt(0)||"."===t.charAt(0)||"."===t.charAt(t.length-1))throw Error('The "host" parameter is not a valid host name.');return this.f=t,this},W.prototype.setHost=W.prototype.Ig,W.prototype.bn=function(){return this.f},W.prototype.getHost=W.prototype.bn,W.prototype.Md=function(t){return this.c=t||void 0,this},W.prototype.setPath=W.prototype.Md,W.prototype.un=function(){return this.c},W.prototype.getPath=W.prototype.un,W.prototype.Oi=function(t){if(t){if("object"!=typeof t)throw Error('Parameter "params" must be an object.');this.a=t}else this.a={};return this},W.prototype.setQuery=W.prototype.Oi,W.prototype.jk=function(){return!Mp(this)},W.prototype.hasQuery=W.prototype.jk,W.prototype.getQuery=function(){return this.a},W.prototype.getQuery=W.prototype.getQuery,W.prototype.Bl=function(t){if(t&&isNaN(parseInt(t,10)))throw Error('Parameter "port" must be a number or undefined');return this.g=+t||void 0,this},W.prototype.setPort=W.prototype.Bl,W.prototype.yn=function(){return this.g},W.prototype.getPort=W.prototype.yn,W.prototype.rl=function(t){return this.b=t||void 0,this},W.prototype.setAnchor=W.prototype.rl,W.prototype.ud=function(){return this.b},W.prototype.getAnchor=W.prototype.ud,W.prototype.I=function(t){if("object"!=typeof t)throw Error('Parameter "other" must be an object.');var e,r=this.a;for(e in t)t.hasOwnProperty(e)&&"function"!=typeof t[e]&&(r[e]=t[e]);return this},W.prototype.mergeQuery=W.prototype.I,W.prototype.Ma=function(t){if(!t||"string"!=typeof t)throw Error('Parameter "subDomain" must be a non-empty string');return"."===t.substr(t.length-1)&&(t=t.substr(0,t.length-1)),this.Ig(t+"."+this.f)},W.prototype.addSubDomain=W.prototype.Ma,W.prototype.F=function(t){if(!t||"string"!=typeof t)throw Error('Parameter "subPath" must be a non-empty string');return this.Md((this.c?this.c+"/":"")+t)},W.prototype.addSubPath=W.prototype.F,W.prototype.toString=function(){return[this.s+"://",this.f,this.g?":"+this.g:"",this.c||!Mp(this)||this.b?"/":"",this.c?encodeURI(this.c):"",Np(this),this.b?"#"+encodeURIComponent(this.b):""].join("")},W.prototype.toString=W.prototype.toString,W.MultiValueQueryParameter=Op,Op.prototype.Sn=function(){return this.Rl},Op.prototype.getValues=Op.prototype.Sn;var Qp=globalThis;function Rp(){}rc("monospace serif"),Rp.prototype.pop=function(t){return this[t]||(this[t]=[]),this[t].pop()||Qp.document.createElement("canvas")},Rp.prototype.push=function(t,e){this[e]||(this[e]=[]),this[e].push(t)};var Sp=new Rp;function Tp(){var t=decodeURIComponent(x.H.getScriptPath());return Kp(t=t?"/"===t[t.length-1]?t.substring(0,t.length-1):t:"https://js.api.here.com/v3/3.1.30.7").F("styles")}function Up(t,e,r,n,i,o,a){var s=this;a=a||{},o=o||{};var u=t.D().clone().F(e+"/"+t.Cc()+"/"+r).I(o),l=t.Fh();this.J=t,this.W=u,sk.call(this,{tileSize:n,max:512===n?19:20,min:512===n?2:0,getURL:function(t,e,r){var o=s.W.clone();return l&&o.Ma(l[(r+e+t)%l.length]),o.F(r+"/"+t+"/"+e+"/"+n+"/"+i),o.toString()},crossOrigin:a.crossOrigin,headers:a.headers,uri:u.toString().replace(/_/g,"")+n,engineType:a.engineType}),this.kb=e,this.s=r,this.a=o,this.yb=r.split(".")[0],this.ng=A(this.ng,this),this.getCopyrights=this.ta,t.addEventListener("versionupdate",this.ng)}function Vp(t,e){if(e=void 0===e?{}:e,!t.qk)throw new Xc(t);Vp.l.constructor.call(this);var r=Wp(this,e);if(!r.baseUrl&&!r.platformBaseUrl)throw new D(t,0,'either "baseUrl" or "platformBaseUrl" must be specified');this.c=(r.baseUrl?r.baseUrl:r.platformBaseUrl).clone(),(t=r.baseUrl?e:r).host&&this.c.Ig(t.host),t.subDomain&&this.c.Ma(t.subDomain),t.path&&this.c.Md(t.path),Pp(this.c),this.gf=r.headers||{}}function Wp(t,e){return t=t.a(),e?Fp({},t,e):t}function Xp(t,e,r){return function(n){return"function"!=typeof n.json?Promise.reject(r(Zp(e,n))):n.json().then(function(e){return r(t.b(e))},function(){return r(Zp(e,n))})}}function Zp(t,e){return Error((e.statusText?"["+e.statusText+"] ":"")+t+" request failed")}function Y(t){var e=(t=Fp({},this.b,t)).apikey||t.apiKey,r=t.baseUrl;if(r=e?r?0:"baseUrl":"apikey")throw new D(Y,0,'"'+r+'" must be specified');this.ul(t.baseUrl),this.a=e,this.c.I({apikey:e}),this.f=t.headers||{},this.g=Ua(t.servicesConfig||{})}function $p(t){$p.l.constructor.call(this,$p,t),t=Wp(this,t),this.bc=t.shards,(this.Ra=t.ignoreTypes?null:t.type)&&this.D().Ma(this.Ra),this.cc=t.version,this.Xc=new Gp,this.vi={},this.Rf=0,"newest"===this.cc&&this.ph()}function aq(t,e){for(var r={},n=t[e+"s"][e],i=n.length;i--;)r[n[i].id]=n[i];t[e+"s"]=r}function bq(t,e,r){var n,i=this,o=+(r=r||{}).min,a=+r.max;r.tileSize=r.tileSize||512,r.min=o?Yd(o,1,17):1,r.min+=Bk(r.tileSize,1),r.max=a?Yd(a,1,17):17,bq.l.constructor.call(this,r),C(t,cq,bq,0),C(e,Ph,bq,1),this.o=t,e.b&&e.b("OMV"),this.ac(e,!0),this.s=function(){dq(i),i.reload(!1)},t.addEventListener("versionupdate",this.s),dq(this),bq.prototype.J=(n=/^v2\/vectortiles\/(.+)\/mc$/.exec(t.D().c))?n[1]:B+""}function dq(t){var e=t.yd("_#-;,:","_#-;,:","_#-;,:");t.v=new RegExp("^"+e.replace(/[.*+?^${}()|[\]\\\/]/g,"\\$&").replace(/_#-;,:/g,"\\d+")+"$")}function fq(t,e,r){var n=t.ub().getState()===Qh.READY,i=zc(e),o=zc(r);i&&(t.c=e),o&&(t.a=r),(i||o)&&(t.C=!0,n&&t.g())}function cq(t){cq.l.constructor.call(this,cq,t),t=Wp(this,t).mapVersion,this.df=tc(t)?t:gq[this.D().toString()],tc(this.df)||hq(this)}t("H.service.util.eval",function(a){return eval(a)}),u(Up,sk),Up.prototype.MAX_STORE_TIME=2592e6,n=Up.prototype,n.u=function(){sk.prototype.u.call(this),this.J.removeEventListener("versionupdate",this.ng)},n.ta=function(t,e){return Jp(this.J.ta(),this.yb,e,t)},n.ng=function(){var t=this.J;this.W=t.D().clone().F(this.kb+"/"+t.Cc()+"/"+this.s).I(this.a),this.reload(!1)},n.fh=function(){return ld()},n.ge=function(){return ld()?kd():Up.l.ge.call(this)},u(Vp,F),t("H.service.Service",Vp),Vp.prototype.a=function(){return{}},Vp.prototype.D=function(){return this.c},Vp.prototype.getUrl=Vp.prototype.D,Vp.prototype.K=function(t,e,r,n){return(n=new rf(void 0===n?"application/json":n,t.toString(),fe,{headers:this.gf})).then(e,Xp(this,t,r)),n},Vp.prototype.b=function(t){return Error(t.message)},t("H.service.Platform",Y),Y.prototype.b={apikey:null,baseUrl:new W("https","hereapi.com")},Y.prototype.ul=function(t){this.c=Pp(t.clone()),this.a=t=this.a,this.c.I({apikey:t})},Y.prototype.setBaseUrl=Y.prototype.ul,Y.prototype.hc=function(){return this.c},Y.prototype.getBaseUrl=Y.prototype.hc,Y.prototype.Ya=function(t,e){try{return t.qk=!0,new t(Fp({platformBaseUrl:this.hc(),headers:this.f},this.g[t.CONFIG_KEY]||{},e||{}))}finally{delete t.qk}},Y.prototype.createService=Y.prototype.Ya,u($p,Vp),t("H.service.MapTileService",$p),$p.prototype.a=function(){return{subDomain:"maps.ls",path:"maptile/2.1",type:"base",version:"newest",shards:["1","2","3","4"]}},$p.CONFIG_KEY="maptile",$p.prototype.Fh=function(){return this.bc},$p.prototype.ek=function(){return this.Ra},$p.prototype.getType=$p.prototype.ek,$p.prototype.Cc=function(){return this.cc},$p.prototype.getVersion=$p.prototype.Cc,$p.prototype.Si=function(t){this.cc=t},$p.prototype.ta=function(){return this.Rf||(this.cc&&"newest"!==this.cc||"traffic"===this.Ra)&&this.Re(),this.Xc},$p.prototype.getCopyrights=$p.prototype.ta,n=$p.prototype,n.$i=function(t){var e;if(aq(t=t.response,"map"),aq(t,"scheme"),aq(t,"tiletype"),aq(t,"format"),aq(t,"resolution"),aq(t,"language"),"newest"===this.cc&&"traffic"!==this.Ra)for(e in t.maps)t.maps[e].hash&&t.maps[e].newest&&(this.Si(t.maps[e].hash),this.dispatchEvent("versionupdate"));this.Lh=t,this.dispatchEvent("infoupdate")},n.Zi=function(t){Hp(this.Xc,t),this.dispatchEvent("copyrightupdate")},n.ph=function(){var t=this,e=this.D().clone().F("info").I({output:"json"});this.bc&&e.Ma(this.bc[0]),this.K(e,function(e){t.$i(e)},function(t){throw t})},n.Re=function(){var t=this,e=this.D().clone().F("copyright").F(t.Cc()).I({output:"json"});this.bc&&e.Ma(this.bc[0]),this.Rf=1,this.K(e,function(e){t.Rf=2,t.Zi(e)},function(e){throw t.Rf=-1,e})},n.xh=function(){return this.Lh},$p.prototype.getInfo=$p.prototype.xh,$p.prototype.Me=function(t,e,r,n,i,o){var a,s=this.D().clone().F(t+"/"+this.Cc()+"/"+e+"/"+r+"/"+n).I(i||{}).toString(),u=0,l=s.length;if(0!==l)for(a=0;a<l;a++){u=(u<<5)-u+s.charCodeAt(a),u|=0}return s=u,(u=this.vi[s])||(u=new Up(this,t,e,r,n,i,Fp({headers:this.gf},o||{})),this.vi[s]=u),u},$p.prototype.createTileProvider=$p.prototype.Me,$p.prototype.wc=function(t,e,r,n,i,o,a,s){return new ll(t=this.Me(t,e,r,n,i,s),{opacity:o,dark:!!a})},$p.prototype.createTileLayer=$p.prototype.wc,Y.prototype.Ah=function(t){return this.Ya($p,t)},Y.prototype.getMapTileService=Y.prototype.Ah,u(bq,R),t("H.service.omv.Provider",bq),bq.prototype.Ed=df,bq.prototype.providesOMV=bq.prototype.Ed,bq.prototype.gc=function(t){return this.v.test(t)},bq.prototype.cacheFilter=bq.prototype.gc,bq.prototype.yd=function(t,e,r){return eq(this.o,t,e,r).toString()},bq.prototype.getTileKey=bq.prototype.yd,bq.prototype.Ob=function(){return this.N},bq.prototype.getCache=bq.prototype.Ob,bq.prototype.MAX_STORE_TIME=2592e6,bq.prototype.fh=function(){return ld()},bq.prototype.ge=function(){return ld()?kd():bq.l.ge.call(this)},bq.prototype.K=function(t,e,r,n,i){return this.o.jb(t,e,r,n,i)},bq.prototype.requestInternal=bq.prototype.K,bq.prototype.rc=function(t){t.b&&t.b("OMV"),this.ac(t)},bq.prototype.setStyle=bq.prototype.rc,bq.prototype.ua=function(){return bq.l.ub.apply(this)},bq.prototype.getStyle=bq.prototype.ua,bq.prototype.ub=function(){var t,e=bq.l.ub.apply(this);return this.C&&(e.getState()===Qh.READY?(t=e.vd())&&t.global&&(this.c&&(t.global.ux_language=this.c),this.a&&(t.global.ux_language_fallback=this.a),e=new Th(t,e.hc())):e.load()),e},bq.prototype.u=function(){bq.l.u.call(this),this.o.removeEventListener("versionupdate",this.s)},bq.prototype.N=new Dk(256),bq.prototype.ta=function(t,e){return Jp(this.o.ta(),this.J,e,t)},bq.prototype.getCopyrights=bq.prototype.ta,u(cq,Vp),t("H.service.omv.Service",cq),cq.prototype.a=function(){return{subDomain:"vector",path:"v2/vectortiles/base/mc"}},cq.CONFIG_KEY="omv";var gq={};function hq(t){t.K(t.D().clone().F("../../info"),function(e){e=e.mapVersion;var r=t.D().toString();t.df=e,e!==gq[r]&&(gq[r]=e,t.dispatchEvent("versionupdate"))},function(){})}function eq(t,e,r,n){return e=t.D().clone().F(n+"/"+e+"/"+r+"/omv"),tc(t.df)&&e.I({mv:t.df}),e}function iq(){this.a={}}Fc(gq),cq.prototype.nn=function(){return this.df},cq.prototype.getMapVersion=cq.prototype.nn,cq.prototype.qd=function(t,e){return new ll(new bq(this,t,e),{max:22})},cq.prototype.createLayer=cq.prototype.qd,cq.prototype.jb=function(t,e,r,n,i){return this.K(eq(this,t,e,r),function(t){return t.arrayBuffer().then(n,i)},i,"arraybuffer")},cq.prototype.he=function(t){return Tp().F(t)},cq.prototype.Ch=function(t,e){if(!Ca(t))throw new D(this.Ch,0,'"onResult" must be a function');if(!Ca(e))throw new D(this.Ch,1,'"onError" must be a function');return this.K(this.D().clone().Md("v2/vectortiles/pviews"),t,e)},cq.prototype.getPoliticalViews=cq.prototype.Ch,Y.prototype.$j=function(t){return this.Ya(cq,t)},Y.prototype.getOMVService=Y.prototype.$j,cq.prototype.Re=function(){this.Xc=new Gp,this.K(this.D().clone().F("../../copyrights"),A(this.Zi,this),hd)},cq.prototype.Zi=function(t){Hp(this.Xc,t),this.dispatchEvent("copyrightupdate")},cq.prototype.ta=function(){return this.Xc||this.Re(),this.Xc},cq.prototype.getCopyrights=cq.prototype.ta,Y.prototype.Sf=function(t,e,r,n,i,o){var a=this.Ah(),s=this.Ah({type:"aerial"}),u=this.dk(),l=this.$j(),c=Vj.WEBGL,h={},f={crossOrigin:"anonymous"};if(Da(t)){var p=t;"crossOrigin"in p&&(f.crossOrigin=p.crossOrigin),t=p.tileSize,e=p.ppi,r=p.lg,n=p.lg2,i=p.style,o=p.pois,p.engineType&&(c=p.engineType,f.engineType=c)}var d=t||512;if(0>[72,250,320,500].indexOf(+e)){if(e!==B)throw new D(this.Sf,1,e)}else h.ppi=+e;if(r&&(h.lg=r),n&&(h.lg2=n),i&&(h.style=i),o&&(h.pois=o),t=function(t,e,r,n,i){return t.wc(e,r,d,n,h,1,i,f)},c===Vj.HARP&&!H.map.render.harp)throw new D(this.Sf,0,"HARP engine is not supported, module not found");return e=c===Vj.WEBGL?new Th(l.he("omv/miami/normal.day.yaml").toString()):new H.map.render.harp.Style(l.he("harp/oslo/normal.day.json").toString()),r=c===Vj.WEBGL?new Th(l.he("omv/miami/truck.day.yaml").toString()):new H.map.render.harp.Style(l.he("harp/oslo/normal.day.json").toString()),n={engineType:c},fq((e=l.qd(e,n)).ga(),h.lg,h.lg2),fq((r=l.qd(r,n)).ga(),h.lg,h.lg2),l=u.zj(h.lg?{lg:h.lg,i18n:!0,engineType:c}:{engineType:c}),{vector:{normal:{map:e,truck:r,traffic:u.yj(void 0,c),trafficincidents:l}},raster:{normal:{xbase:t(a,"xbasetile","normal.day","png8",!1),xbasenight:t(a,"xbasetile","normal.night","png8",!0),base:t(a,"basetile","normal.day","png8",!1),basenight:t(a,"basetile","normal.night","png8",!0),map:t(a,"maptile","normal.day","png8",!1),mapnight:t(a,"maptile","normal.night","png8",!0),trafficincidents:l,transit:t(a,"maptile","normal.day.transit","png8",!1),labels:t(a,"labeltile","normal.day","png",!1)},satellite:{xbase:t(s,"xbasetile","hybrid.day","jpg",!0),base:t(s,"basetile","hybrid.day","jpg",!0),map:t(s,"maptile","hybrid.day","jpg",!0),labels:t(s,"labeltile","hybrid.day","png",!0)},terrain:{xbase:t(s,"xbasetile","terrain.day","jpg",!1),base:t(s,"basetile","terrain.day","jpg",!1),map:t(s,"maptile","terrain.day","jpg",!1),labels:t(s,"labeltile","terrain.day","png",!1)}}}},Y.prototype.createDefaultLayers=Y.prototype.Sf,iq.prototype.Cb=function(t,e){var r,n=t+e;return(r=this.a[n])?r:(t=(t=jq.MARKER.replace("{{icon}}",kq[t]||kq.OTHER)).replace("{{color}}",lq[e]||lq.BLOCKING),e={size:{w:26,h:33},anchor:{x:13,y:30},hitArea:new Li(Mi.POLYGON,mq.MARKER)},this.a[n]=new Ij(t,e))};var jq={MARKER:'<svg width="26" height="33" enable-background="new 0 0 26 33" viewBox="0 0 26 33" xmlns="http://www.w3.org/2000/svg"><path d="m26 33h-26v-33h26z" fill="#8c8c8c" opacity="0"/><path d="m17 29.566c0 1.116-1.791 2.022-4 2.022s-4-.906-4-2.022c0-1.118 1.791-2.026 4-2.026s4 .908 4 2.026" fill="#878787" opacity=".6"/><path d="m1.795 17.971c-1.562-1.555-1.574-3.828-.028-5.655l8.343-10.021c.769-.895 1.795-1.384 2.894-1.384 1.117 0 2.197.521 2.889 1.394l8.338 10.014c1.588 1.854 1.578 4.022-.029 5.65l-11.202 11.202z" fill="{{color}}"/>{{icon}}</svg>'},kq={CONGESTION:'<path style="fill:#FFFFFF;" d="M12.966,1.177c0.965,0,1.894,0.442,2.496,1.204l8.378,10.258c1.362,1.592,1.482,3.477,0,4.979L12.994,28.464L2.143,17.618c-1.381-1.375-1.38-3.348,0-4.979l8.314-10.258C11.174,1.547,12.085,1.177,12.966,1.177 M12.967,0.177L12.967,0.177c-1.247,0-2.408,0.551-3.269,1.552l-8.332,10.28c-1.711,2.022-1.688,4.567,0.07,6.317l10.85,10.845l0.707,0.707l0.707-0.707l10.847-10.846c1.784-1.807,1.803-4.292,0.053-6.337L16.237,1.748C15.462,0.769,14.236,0.177,12.967,0.177L12.967,0.177z M16.645,10.405l-2.025-2.22c-0.48-0.51-1.15-0.8-1.84-0.8H9.53c-0.69,0-1.36,0.29-1.84,0.8l-1.94,2.22c-0.39,0.63-0.59,1.35-0.59,2.09v1.64c0,0.69,0.56,1.25,1.25,1.25h1.44l0.255-0.539c0.204-0.431,0.456-0.837,0.753-1.21l0.962-1.211l0.83-0.9c0.32-0.35,0.72-0.63,1.15-0.82H8.23c-0.28,0-0.55-0.07-0.79-0.22l-0.28-0.17l1.27-1.45c0.28-0.31,0.68-0.48,1.1-0.48h3.25c0.42,0,0.82,0.17,1.1,0.48l1.354,1.54H16.645z M18.31,12.205c-0.35-0.37-0.81-0.63-1.3-0.74c-0.18-0.04-0.36-0.06-0.54-0.06h-3.24c-0.7,0-1.37,0.29-1.84,0.8l-1.13,1.22l-0.82,1c-0.38,0.63-0.59,1.35-0.59,2.09v1.64c0,0.69,0.56,1.25,1.25,1.25h1.75v-1h5.99v1h1.75c0.69,0,1.25-0.56,1.25-1.25v-1.64c0-0.74-0.2-1.46-0.59-2.09L18.31,12.205z M12.1,17.105h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C12.35,16.993,12.238,17.105,12.1,17.105z M18.59,17.105h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C18.84,16.993,18.728,17.105,18.59,17.105z M18.56,14.505c-0.24,0.15-0.51,0.22-0.79,0.22h-5.85c-0.28,0-0.55-0.07-0.78-0.22l-0.29-0.17l1.27-1.45c0.15-0.16,0.33-0.28,0.53-0.37c0.18-0.07,0.38-0.11,0.58-0.11h3.24c0.24,0,0.48,0.06,0.68,0.16c0.16,0.08,0.3,0.19,0.42,0.32l1.27,1.45L18.56,14.505z M8.42,13.03h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C8.67,12.918,8.559,13.03,8.42,13.03z"/>',ROADWORKS:'<path d="m13.004 1.411c.964 0 1.894.441 2.496 1.204l8.346 10.023c1.363 1.592 1.482 3.477 0 4.979l-10.846 10.847-10.852-10.846c-1.381-1.375-1.379-3.348 0-4.979l8.346-10.023c.717-.835 1.628-1.205 2.51-1.205m0-1c-1.248 0-2.408.551-3.268 1.552l-8.356 10.035c-1.718 2.033-1.695 4.578.064 6.328l10.85 10.845.706.707.707-.707 10.846-10.846c1.784-1.808 1.803-4.293.053-6.337l-8.337-10.012c-.769-.973-1.996-1.565-3.265-1.565zm-.575 15.264c.018-.332-.13-.651-.394-.851l-2.945-2.235-.21.36c-.22.39-.41.78-.58 1.19l-.677 2.129-1.364 3.051h1.314l2.109-4.672 1.317 1.212.138 3.46h1.092zm6.16-1.327c-.401-.54-1.209-.539-1.609.001l-1.17 1.58-2.29-1.74-.139-4.054c-.011-.276-.134-.535-.342-.716l-.7-.61c-.185-.161-.422-.25-.667-.25h-1.885c-.335 0-.648.168-.833.447l-1.144 1.723 7.58 5.76-1.86 2.51c-.098.132-.004.32.161.32h6.648l1.142-1.077zm-8.79-2.989-.876-.665.841-1.018.965.043zm1.63 1.24.969-1.781.118 2.61zm2.76-5.79c-.64 0-1.16.52-1.16 1.16 0 .65.52 1.17 1.16 1.17s1.16-.52 1.16-1.17c0-.64-.52-1.16-1.16-1.16z" fill="#fff"/>',ACCIDENT:'<path style="fill:#FFFFFF;" d="M12.998,1.091c0.964,0,1.894,0.442,2.496,1.204l8.346,10.344c1.363,1.592,1.482,3.477,0,4.979L12.994,28.465L2.143,17.618c-1.381-1.375-1.379-3.348,0-4.979l8.346-10.344C11.205,1.462,12.115,1.091,12.998,1.091 M12.998,0.091L12.998,0.091c-1.248,0-2.408,0.551-3.269,1.552L1.364,12.011c-1.708,2.021-1.685,4.566,0.073,6.316l10.85,10.845l0.707,0.707l0.707-0.707l10.846-10.846c1.784-1.808,1.803-4.293,0.053-6.337l-8.327-10.32C15.494,0.684,14.268,0.091,12.998,0.091L12.998,0.091z M7.83,18.982l-3.309-1.855l0.945,1.855H7.83z M16.111,19h3.942l1.596-2L16.111,19z M10.512,20.064l1.021-1.021l1.632,0.076c0.329,0.018,0.651-0.022,0.963-0.123c0.626-0.206,1.122-0.76,1.288-1.44l0.264-1.089l2.066-0.93c0.373-0.17,0.673-0.42,0.861-0.731c0.275-0.449,0.405-0.97,0.369-1.498L18.9,11.676l1.021-1.021l-0.724-0.724l-0.427,0.427l-0.121-0.364c-0.201-0.603-0.54-1.151-0.989-1.6l-1.159-1.159c-0.5-0.5-1.31-0.5-1.809,0l-1.267,1.267l0.724,0.724l-5.066,5.066l-0.724-0.724l-1.267,1.267c-0.5,0.5-0.5,1.31,0,1.809l1.159,1.159c0.449,0.449,0.997,0.788,1.6,0.989l0.364,0.121l-0.427,0.427L10.512,20.064z M14.901,10.349l0.732-0.732c0.098-0.098,0.256-0.098,0.354,0l0.732,0.732c0.098,0.098,0.098,0.256,0,0.354l-0.732,0.732c-0.098,0.098-0.256,0.098-0.354,0l-0.732-0.732C14.803,10.604,14.803,10.446,14.901,10.349z M9.472,15.777l0.732-0.732c0.098-0.098,0.256-0.098,0.354,0l0.732,0.732c0.098,0.098,0.098,0.256,0,0.354l-0.732,0.732c-0.098,0.098-0.256,0.098-0.354,0L9.472,16.13C9.375,16.033,9.375,15.874,9.472,15.777z M11.391,17.615c0.069-0.271,0.206-0.518,0.405-0.717l4.961-4.961c0.195-0.195,0.445-0.337,0.717-0.405l0.344-0.083l0.137,1.925c0.022,0.318-0.058,0.63-0.221,0.901c-0.101,0.166-0.279,0.271-0.409,0.329L14.8,15.74l-0.38,1.574c-0.083,0.344-0.318,0.615-0.612,0.713c-0.188,0.058-0.38,0.083-0.579,0.072l-1.925-0.138L11.391,17.615z"/>',OTHER:'<path style="fill:#FFFFFF;" d="M13.004,1.411c0.964,0,1.894,0.441,2.496,1.204l8.346,10.023c1.363,1.592,1.482,3.477,0,4.979L13,28.465L2.148,17.618c-1.381-1.375-1.379-3.348,0-4.979l8.346-10.023C11.211,1.781,12.122,1.411,13.004,1.411 M13.004,0.411L13.004,0.411c-1.248,0-2.408,0.551-3.268,1.552L1.38,11.998c-1.718,2.033-1.694,4.579,0.064,6.328l10.85,10.845L13,29.878l0.707-0.707l10.846-10.846c1.784-1.808,1.803-4.293,0.053-6.337L16.269,1.976C15.5,1.003,14.273,0.411,13.004,0.411L13.004,0.411z M14.716,20.139c0,0.947-0.758,1.724-1.724,1.724c-0.947,0-1.704-0.777-1.704-1.724c0-0.928,0.757-1.704,1.704-1.704C13.958,18.435,14.716,19.211,14.716,20.139z M14.204,16.33H11.78l-0.537-8.533h3.5L14.204,16.33z"/>'},lq={BLOCKING:"#323232",VERYHIGH:"#d5232f",HIGH:"#ffa100"},mq={MARKER:[24.1,17.8,14.2,28.42,16.8,29.4,12.8,31.4,8.79,29.4,11.23,28.42,1.7,17.8,1.7,12.1,10,1.9,12.9,.498,15.8,1.9,24.1,12.1,24.1,17.8]};function nq(t,e,r){(r=r||{}).criticality||(r.criticality="major,critical"),C(t,oq,nq,0),An.call(this,{max:20,min:8,requestData:A(this.W,this),engineType:r.engineType}),this.s=new iq,this.C=t,this.a=r,this.reload=A(this.reload,this),this.v=setInterval(this.reload,e||18e4)}u(nq,An),t("H.service.traffic.incidents.Provider",nq),nq.prototype.c={minor:"HIGH","low impact":"HIGH",major:"VERYHIGH",critical:"BLOCKING"},nq.prototype.W=function(t,e,r,n,i){var o=this,a=this.c,s=this.s;return this.C.requestIncidentsByTile(t,e,r,function(t){var e,r=[];if(t=t.TRAFFIC_ITEMS)for(e=(t=t.TRAFFIC_ITEM).length;e--;){var i=t[e],u=i.TRAFFIC_ITEM_TYPE_DESC;switch(u){case"ACCIDENT":case"CONGESTION":var l=u;break;case"CONSTRUCTION":l="ROADWORKS";break;default:l="OTHER"}l=s.Cb(l,a[i.CRITICALITY.DESCRIPTION]),(u=new yn({lat:(u=i.LOCATION.GEOLOC.ORIGIN).LATITUDE,lng:u.LONGITUDE},{provider:o,icon:l})).setData(i),r.push(u)}n(r)},i,this.a)},nq.prototype.B=function(){An.prototype.B.call(this),clearInterval(this.v)};var pq="A21 A22 F01 F02 F08 F04 F05 F07 F03 F06 A2F F13 A25 A2C F12 D1B F1B A27 E12 A3A A24 A3D A3F F1F F25 F2C E32 A33 F29 D26 D36 F26 D0F F0F F2B E0C D3A A45 D23 D11 F2E F19 F14 F39 A4A A4B A5C D38 F2A F1A D0A F1C A48 D25 D1D F32 A46 A3E D24 E1C E32 A5F D2E D22 D0A".split(" ");function qq(t,e){var r={};this.a=t,Wa(r,e||r),ak.call(this,r),this.zg={},(t=this.Pb(Pg.SPATIAL)).update(t.a+1,Mg.ADD)}function rq(t){return t.Dc(!0)}function sq(t,e,r){var n,i=e.j&&e.j[r];return!i&&(n=e.m)&&(delete e.m,(e.j=t=t.a.parse(t,e,n))&&(i=t[r])),i||ff}u(qq,ak),t("H.service.remote.ObjectProvider",qq),qq.prototype.B=function(){ak.prototype.B.call(this)},qq.prototype.Lc=function(){return ff},qq.prototype.requestMarkers=qq.prototype.Lc,qq.prototype.Kc=function(){return ff},qq.prototype.requestDomMarkers=qq.prototype.Kc,qq.prototype.Hd=function(){return ff},qq.prototype.requestOverlays=qq.prototype.Hd,qq.prototype.Wb=df,qq.prototype.providesMarkers=qq.prototype.Wb,qq.prototype.Vb=df,qq.prototype.providesDomMarkers=qq.prototype.Vb,qq.prototype.Jc=df,qq.prototype.providesSpatials=qq.prototype.Jc,qq.prototype.Ag=function(){return ff},qq.prototype.requestSpatials=qq.prototype.Ag,qq.prototype.Bg=function(t,e){return t=sq(this,t,tq),e&&(t=t.filter(rq)),t},qq.prototype.requestSpatialsByTile=qq.prototype.Bg,qq.prototype.ea=function(t){var e=t.gb();if(this.zg[e])throw new Xc(this.ea,"Remote object "+e+" already added");return this.zg[e]=t},qq.prototype.Ia=function(t){delete this.zg[t.gb()]};var tq="spatials";function uq(t,e,r,n){uq.l.constructor.call(this,{min:vq,max:wq,engineType:n}),C(t,oq,uq,0),this.s=t,this.a=r||xq,this.a.responseattributes="sh,fc",this.c=setInterval(A(this.reload,this),e||18e4),this.f===Vj.WEBGL?this.ac(new Th(t.he("traffic/flow.yaml").toString()),!0):this.ac(new H.map.render.harp.Style({styles:[{when:["==",["geometry-type"],"LineString"],technique:"solid-line",renderOrder:10002,attr:{color:["case",[">=",["get","JF"],10],"black",[">=",["get","JF"],8],"red",[">=",["get","JF"],4],"yellow","green"],lineWidth:3,metricUnit:"Pixel"}}]}))}u(uq,R),t("H.service.traffic.flow.Provider",uq),uq.prototype.xi=df,uq.prototype.providesGeoJSON=uq.prototype.xi,uq.prototype.ua=function(){return this.ub()},uq.prototype.getStyle=uq.prototype.ua,uq.prototype.rc=function(t){t.b&&t.b("GeoJSONTileSource"),this.ac(t)},uq.prototype.setStyle=uq.prototype.rc;var xq={locationreferences:"tmc,shp"};uq.prototype.u=function(){uq.l.u.call(this),clearInterval(this.c)},uq.prototype.K=function(t,e,r,n,i){return this.s.requestFlowByTile(t,e,r,function(t){t.type&&-1!==t.type.indexOf("Error")?i(t.Details):n(t)},i,this.a)},uq.prototype.requestInternal=uq.prototype.K,uq.prototype.rd=function(t,e,r,n,i){var o,a,s,u,l,c={type:"FeatureCollection",features:[]},h=n.RWS.length;for(o=0;o<h;o++){var f=n.RWS[o],p=f.RW,d=p.length,v=-1!==pq.indexOf(f.EXTENDED_COUNTRY_CODE+f.EBU_COUNTRY_CODE);for(f=0;f<d;f++){var y=p[f].FIS,g=y.length;for(y=0;y<g;y++){var m=p[f].FIS[y].FI,_=m.length;for(a=0;a<_;a++){var b=m[a],x=[],w=b.CF[0],E=!!w.SSS,T={type:"Feature",properties:w,geometry:{type:"MultiLineString",coordinates:x}};for(T.properties.LHT=v,b.SHP.length&&(T.properties.FC=b.SHP[0].FC),E&&(l=[]),w=0;w<b.SHP.length;w++){var A=b.SHP[w].value,k=A.length;for(s=0;s<k;s++){var S=E?l:void 0,M=new $n(A[s].trim()),O=[],I={};for(M.ze();-1!==(u=M.Tb());)u===yq?(I.lat=+String.fromCharCode.apply(uq,M.Ud()),M.next(),M.ze()):u===zq?(I.lng=+String.fromCharCode.apply(uq,M.Ud()),O.push([I.lng,I.lat]),S&&S.push(Zf(I)),I=[],M.next(),M.ze()):M.next();I.lng=+String.fromCharCode.apply(uq,M.Ud()),O.push([I.lng,I.lat]),S&&S.push(Zf(I)),u=O,x.push(u)}}c.features.push(T)}}}}return uq.l.rd.call(this,t,e,r,c,i)},uq.prototype.createTileInternal=uq.prototype.rd;var wq=21,vq=10,zq=32,yq=44;function Aq(t){function e(e){n.contains(i)&&n.removeChild(i),l&&clearTimeout(l),delete Aq.a[o],e&&t.Kj&&t.Kj.call(u,e)}if(!t.url||!t.eh)throw Error('Parameter "options" must specify at least a URL and a callback.');if("function"!=typeof t.eh)throw Error("Parameters options.callback must be a function");var r=t.Ap||document,n=r.getElementsByTagName("head")[0],i=r.createElement("script");r=t.url instanceof W?t.url:Kp(t.url,t.zp);var o=Aq.b++,a=t.jm||"callback",s=t.eh,u={},l=null;return u.id=o,u.cancel=function(){e("cancelled")},0!==t.timeout&&(l=x.setTimeout(function(){e("timeout")},t.timeout||3e4)),Aq.a[o]=function(t){e(),s.call(u,t)},i.type="text/javascript",i.src=r.toString()+(r.jk()?"&":"?")+a+"="+(t.Bp?"H.service.jsonp.handleResponse("+o+")":encodeURI("H.service.jsonp.handleResponse("+o+")")),n.appendChild(i),u}function oq(t){oq.l.constructor.call(this,oq,t),this.km=Wp(this,t).callbackKey}function Bq(t,e,r,n){return Aq({url:e,eh:r,Kj:function(t){n(Error("["+t+"] "+e+" request failed"))},jm:t.km})}function Cq(t){Cq.l.constructor.call(this,Cq,t),this.ol=Wp(this,t).reverseSubDomain}function Dq(t){Dq.l.constructor.call(this,Dq,t)}function Eq(t){Eq.l.constructor.call(this,Eq,t),this.f=t.getToken}function Mq(t,e,r,n){return t.D().clone().F(e+"/layers/"+r+"/features").I(n||{})}function Kq(t,e,r,n,i){return Mq(t,r,n,e=Object.assign({},i,{id:new Op(e)}))}function Iq(t,e,r,n,i){return t.D().clone().F(r+"/layers/"+n+"/features/"+e).I(i||{})}function Fq(t,e,r,n){wc(r,"String",t,e,"must be a string"),wc(n,"String",t,e+1,"must be a string")}function Hq(t,e){wc(e,"String",t,0,"must be a string")}function Jq(t,e){if(!Array.isArray(e)||0===e.length||e.some(function(t){return"string"!=typeof t}))throw new D(t,0,"must be a non-empty array of strings")}function Lq(t,e,r){if(!Da(r))throw new D(t,e,"must be a GeoJSON object")}function Gq(t,e,r,n){if(!Ca(r))throw new D(t,e,"must be a function");if(!Ca(n))throw new D(t,e+1,"must be a function")}function Nq(t,e,r,n){if(Nq.l.constructor.call(this,n?{min:n.min,max:n.max,engineType:n.engineType}:void 0),C(t,Eq,Nq,0),!zc(e))throw new D(Nq,1,'"catalogHrn" must be a string');if(!zc(r))throw new D(Nq,2,'"layerId" must be a string');this.v=t,this.a=e,this.c=r,this.s=Da(n)&&Da(n.parameters)?n.parameters:{},this.ac(this.f===Vj.WEBGL?new Th({sources:{iml:{type:"MVT"}},layers:{iml:{data:{source:"iml",layer:this.a+":"+this.c},points:{filter:{$geometry:"point"},draw:{points:{collide:!1,order:200,color:"#92CF48",size:[[10,"8px"],[14,"12px"],[18,"16px"]]}}},polygons:{filter:{$geometry:"polygon"},draw:{polygons:{order:201,color:"#E39E3C"},lines:{order:202,color:"#755DA5",width:"1px"}}},lines:{filter:{$geometry:"line"},draw:{lines:{order:203,color:"#0258AE",width:"2px",join:"round",cap:"round"}}}}}}):new H.map.render.harp.Style({styles:[{layer:this.a+":"+this.c,when:["==",["geometry-type"],"Point"],technique:"circles",renderOrder:200,color:"#92CF48",size:["interpolate",["linear"],["zoom"],10,8,14,12,18,16]},{layer:this.a+":"+this.c,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:"#E39E3C",renderOrder:201},{layer:this.a+":"+this.c,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#755DA5",lineWidth:"1px",renderOrder:202},{layer:this.a+":"+this.c,when:["==",["geometry-type"],"LineString"],technique:"solid-line",color:"#0258AE",lineWidth:"2px",renderOrder:203}]}))}function Oq(t){Oq.l.constructor.call(this,Oq,t)}function Pq(t){Pq.l.constructor.call(this,Pq,t)}function Qq(t){Qq.l.constructor.call(this,Qq,t)}function Rq(){}function Sq(){}function Tq(t,e){this.a=t,this.b=e}function Uq(){}function Vq(t,e){this.b=t,this.a=e}function Wq(t,e,r){var n;if(e=e||(t&&t.length?Object.keys(t[0]):B),this.Hb=t,e)for(this.Rd=e,this.gh=t=mc(),n=e.length;n--;)t[e[n]]=!0;r!==B&&(this.ji=r)}function Xq(t,e){return t.Hb?t.Hb.push(e):t.Hb=[e],t.Hb.length-1}function Yq(t){var e=Zq;if(!t||!zc(Ze(t.layerId,t.layer))||!Cc(t.level)||tc(t.rowFilter)&&!Ca(t.rowFilter)||tc(t.rowFilterContext)&&!Da(t.rowFilterContext))throw new D(e,1,tc("invalid layer config")?"invalid layer config":t)}function $q(t,e,r,n){n=n||ar,this.tf={},n.provider=t,this.invalidate=ef,$q.l.constructor.call(this,e,n),delete this.invalidate,r&&(this.b=r),this.wa(Mg.ADD)}t("H.service.jsonp",Aq),Aq.Yn=function(t){return(t=Aq.a[t])?t:function(){}},Aq.handleResponse=Aq.Yn,Aq.b=0,Aq.a={},u(oq,Vp),t("H.service.traffic.Service",oq),oq.prototype.a=function(){return{subDomain:"traffic.ls",path:"traffic/6.1",callbackKey:"jsoncallback"}},oq.CONFIG_KEY="traffic",oq.prototype.yj=function(t,e){return new ll(new uq(this,void 0,t,e),{max:22})},oq.prototype.createFlowLayer=oq.prototype.yj,oq.prototype.zj=function(t){return new Bn(new nq(this,void 0,t))},oq.prototype.createIncidentsLayer=oq.prototype.zj,oq.prototype.Xo=function(t,e,r){return Bq(this,t=this.D().clone().F("incidents.json").I(t),e,r)},oq.prototype.requestIncidents=oq.prototype.Xo,oq.prototype.Wo=function(t,e,r,n,i,o){return Bq(this,t=this.D().clone().F(["flow/json",r,t,e].join("/")).I(o||{}),n,i)},oq.prototype.requestFlowByTile=oq.prototype.Wo,oq.prototype.Yo=function(t,e,r,n,i,o){return Bq(this,t=this.D().clone().F(["incidents/json",r,t,e].join("/")).I(o||{}),n,i)},oq.prototype.requestIncidentsByTile=oq.prototype.Yo,oq.prototype.he=function(t){return Tp().F(t)},Y.prototype.dk=function(t){return this.Ya(oq,t)},Y.prototype.getTrafficService=Y.prototype.dk,u(Cq,Vp),t("H.service.GeocodingService",Cq),Cq.prototype.a=function(){return{subDomain:"geocoder.ls",reverseSubDomain:"reverse",path:"6.2"}},Cq.CONFIG_KEY="geocoding",Cq.prototype.b=function(t){return Error(t.Details||t.message||t.error)},Cq.prototype.rh=function(t,e,r){return t=this.D().clone().F("geocode.json").I(t),this.K(t,e,r)},Cq.prototype.geocode=Cq.prototype.rh,Cq.prototype.Bi=function(t,e,r){return t=this.D().clone().F("reversegeocode.json").I(t),this.ol&&t.Ma(this.ol),this.K(t,e,r)},Cq.prototype.reverseGeocode=Cq.prototype.Bi,Cq.prototype.search=function(t,e,r){return t=this.D().clone().F("search.json").I(t),this.K(t,e,r)},Cq.prototype.search=Cq.prototype.search,Y.prototype.Ym=function(t){return this.Ya(Cq,t)},Y.prototype.getGeocodingService=Y.prototype.Ym,u(Dq,Vp),t("H.service.PlacesService",Dq),Dq.prototype.a=function(){return{subDomain:"places.ls",path:"places/v1"}},Dq.CONFIG_KEY="places",Dq.EntryPoint={SEARCH:"discover/search",SUGGEST:"suggest",EXPLORE:"discover/explore",AROUND:"discover/around",HERE:"discover/here",CATEGORIES:"categories/places"},Dq.prototype.request=function(t,e,r,n){return this.T(t,e,r,n)},Dq.prototype.T=function(t,e,r,n){return t=this.D().clone().F(t).I(e||{}),this.K(t,r,n)},Dq.prototype.search=function(t,e,r){return this.T("discover/search",t,e,r)},Dq.prototype.search=Dq.prototype.search,Dq.prototype.ip=function(t,e,r){return this.T("suggest",t,e,r)},Dq.prototype.suggest=Dq.prototype.ip,Dq.prototype.um=function(t,e,r){return this.T("discover/explore",t,e,r)},Dq.prototype.explore=Dq.prototype.um,Dq.prototype.fm=function(t,e,r){return this.T("discover/around",t,e,r)},Dq.prototype.around=Dq.prototype.fm,Dq.prototype.$n=function(t,e,r){return this.T("discover/here",t,e,r)},Dq.prototype.here=Dq.prototype.$n,Dq.prototype.lm=function(t,e,r){return this.T("categories/places",t,e,r)},Dq.prototype.categories=Dq.prototype.lm,Dq.prototype.wm=function(t,e,r,n){return t=Kp(t).I(this.D().getQuery()).I(n||{}),this.K(t,e,r)},Dq.prototype.follow=Dq.prototype.wm,Y.prototype.vn=function(t){return this.Ya(Dq,t)},Y.prototype.getPlacesService=Y.prototype.vn,u(Eq,Vp),t("H.service.iml.Service",Eq),Eq.prototype.a=function(){return{host:"interactive.data.api.platform.here.com",path:"interactive/v1/catalogs"}},Eq.prototype.b=function(t){var e=[{keys:["code","title","cause","action"],format:function(){return t.code+": "+t.title+"; cause: "+t.cause+"; action: "+t.action}},{keys:["error","error_description"],format:function(){return t.error+": "+t.error_description}},{keys:["error","errorMessage"],format:function(){return t.error+": "+t.errorMessage}}];return Error(Da(t)?function(){for(var r=ea(e),n=r.next();!n.done;n=r.next()){var i=(n=n.value).format;if(n.keys.every(function(e){return t[e]}))return i()}return JSON.stringify(t)}():t)},Eq.prototype.fe=function(t,e,r,n,i){var o=this.fe;return Fq(o,0,t,e),Gq(o,2,r,n),t=this.D().clone().F(t+"/layers/"+e+"/statistics").I(i||{}),this.T(t,"GET",r,n)},Eq.prototype.getStatistics=Eq.prototype.fe,Eq.prototype.$f=function(t,e,r,n,i,o,a,s,u){var l=u?"":".mvtf";return t=this.D().clone().F(n+"/layers/"+i+"/tile/web/"+r+"_"+t+"_"+e+l).I(Object.assign({clip:!0},s)),this.T(t,"GET",u?o:function(t){return t.arrayBuffer().then(o)},a,void 0,u?"application/json":"arraybuffer")},Eq.prototype.getFeaturesByTile=Eq.prototype.$f,Eq.prototype.Sj=function(t,e,r,n,i,o){var a=this.Sj;return Hq(a,t),Fq(a,1,e,r),Gq(a,3,n,i),t=Iq(this,t,e,r,o),this.T(t,"GET",n,i)},Eq.prototype.getFeatureById=Eq.prototype.Sj,Eq.prototype.cd=function(t,e,r,n,i,o){var a=this.cd;return Jq(a,t),Fq(a,1,e,r),Gq(a,3,n,i),t=Kq(this,t,e,r,o),this.T(t,"GET",n,i)},Eq.prototype.getFeaturesById=Eq.prototype.cd,Eq.prototype.Zd=function(t,e,r,n,i){var o=this.Zd;if(!Da(t)||!(t.bbox||t.north&&t.east&&t.south&&t.west))throw new D(o,0,'must be an object with either "bbox" or a full set of "north", "east", "south" and "west"');return Fq(o,1,e,r),Gq(o,3,n,i),t=this.D().clone().F(e+"/layers/"+r+"/bbox").I(t),this.T(t,"GET",n,i)},Eq.prototype.getFeaturesByBoundingBox=Eq.prototype.Zd,Eq.prototype.Uj=function(t,e,r,n,i){var o=this.Uj;if(!(Da(t)&&t.radius&&(t.lat&&(t.lng||t.lon)||t.refCatalogHrn&&t.refLayerId&&t.refFeatureId)))throw new D(o,0,'must be an object with "radius" and a combination of either "lat"+"lng" or "refCatalogHrn"+"refLayerId"+"refFeatureId"');return Fq(o,1,e,r),Gq(o,3,n,i),t=this.D().clone().F(e+"/layers/"+r+"/spatial").I(t),this.T(t,"GET",n,i)},Eq.prototype.getFeaturesByPointAndRadius=Eq.prototype.Uj,Eq.prototype.Tj=function(t,e,r,n,i,o){var a=this.Tj;if(!Da(t)||!t.radius)throw new D(a,0,'must be an object with "radius"');return Lq(a,1,e),Fq(a,2,r,n),Gq(a,4,i,o),t=this.D().clone().F(r+"/layers/"+n+"/spatial").I(t),this.T(t,"POST",i,o,e)},Eq.prototype.getFeaturesByGeometryAndRadius=Eq.prototype.Tj,Eq.prototype.pl=function(t,e,r,n,i){var o=this.pl;return Fq(o,0,t,e),Gq(o,2,r,n),t=this.D().clone().F(t+"/layers/"+e+"/search").I(i||{}),this.T(t,"GET",r,n)},Eq.prototype.searchFeatures=Eq.prototype.pl,Eq.prototype.uk=function(t,e,r,n,i){var o=this.uk;return Fq(o,0,t,e),Gq(o,2,r,n),t=this.D().clone().F(t+"/layers/"+e+"/iterate").I(i||{}),this.T(t,"GET",r,n)},Eq.prototype.iterateFeatures=Eq.prototype.uk,Eq.prototype.kd=function(t,e,r,n,i,o){var a=this.kd;return Lq(a,0,t),Fq(a,1,e,r),Gq(a,3,n,i),e=Mq(this,e,r,o),this.T(e,"PUT",n,i,t)},Eq.prototype.putFeatures=Eq.prototype.kd,Eq.prototype.hd=function(t,e,r,n,i,o){var a=this.hd;return Lq(a,0,t),Fq(a,1,e,r),Gq(a,3,n,i),e=Mq(this,e,r,o),this.T(e,"POST",n,i,t)},Eq.prototype.postFeatures=Eq.prototype.hd,Eq.prototype.sd=function(t,e,r,n,i){var o=this.sd;return Jq(o,t),Fq(o,1,e,r),Gq(o,3,n,i),t=Kq(this,t,e,r),this.T(t,"DELETE",n,i)},Eq.prototype.deleteFeatures=Eq.prototype.sd,Eq.prototype.fl=function(t,e,r,n,i,o,a){var s=this.fl;return Hq(s,t),Lq(s,1,e),Fq(s,2,r,n),Gq(s,4,i,o),t=Iq(this,t,r,n,a),this.T(t,"PUT",i,o,e)},Eq.prototype.putFeature=Eq.prototype.fl,Eq.prototype.Zk=function(t,e,r,n,i,o,a){var s=this.Zk;return Hq(s,t),Lq(s,1,e),Fq(s,2,r,n),Gq(s,4,i,o),t=Iq(this,t,r,n,a),this.T(t,"PATCH",i,o,e)},Eq.prototype.patchFeature=Eq.prototype.Zk,Eq.prototype.Dj=function(t,e,r,n,i){var o=this.Dj;return Hq(o,t),Fq(o,1,e,r),Gq(o,3,n,i),t=Iq(this,t,e,r),this.T(t,"DELETE",n,i,void 0,"text/plain")},Eq.prototype.deleteFeature=Eq.prototype.Dj,Eq.prototype.T=function(t,e,r,n,i,o){return o=void 0===o?"application/json":o,e={method:e,headers:Object.assign({},i?{"Content-Type":"application/geo+json"}:void 0,"function"==typeof this.f?{Authorization:"Bearer "+this.f()}:void 0,this.gf)},i&&(e.data=JSON.stringify(i)),(i=new rf(o,t.toString(),fe,e)).then(r,Xp(this,t,n)),i},Eq.CONFIG_KEY="iml",Y.prototype.cn=function(t){return this.Ya(Eq,t)},Y.prototype.getIMLService=Y.prototype.cn,u(Nq,R),t("H.service.iml.Provider",Nq),Nq.prototype.K=function(t,e,r,n,i){return this.v.$f(t,e,r,this.a,this.c,n,i,this.s)},Nq.prototype.requestInternal=Nq.prototype.K,Nq.prototype.Ed=df,Nq.prototype.providesOMV=Nq.prototype.Ed,Nq.prototype.ua=function(){return this.ub()},Nq.prototype.getStyle=Nq.prototype.ua,Nq.prototype.rc=function(t){C(t,Th)&&t.b("MVT"),this.ac(t)},Nq.prototype.setStyle=Nq.prototype.rc,u(Oq,Vp),t("H.service.publicTransit.Service",Oq),Oq.prototype.a=function(){return{subDomain:"transit.router",path:"v8"}},Oq.CONFIG_KEY="publicTransit",Oq.prototype.Fn=function(t,e,r){return t=this.D().clone().F("routes").I(t),this.K(t,e,r)},Oq.prototype.getRoutes=Oq.prototype.Fn,Oq.prototype.Qm=function(t,e,r){return t=this.D().clone().F("departures").I(t),this.K(t,e,r)},Oq.prototype.getDepartures=Oq.prototype.Qm,Oq.prototype.Jn=function(t,e,r){return t=this.D().clone().F("stations").I(t),this.K(t,e,r)},Oq.prototype.getStations=Oq.prototype.Jn,Oq.prototype.b=function(t){return Error(JSON.stringify(t))},Y.prototype.Bn=function(t){return this.Ya(Oq,t)},Y.prototype.getPublicTransitService=Y.prototype.Bn,u(Pq,Vp),t("H.service.RoutingService",Pq),Pq.prototype.a=function(){return{subDomain:"route.ls",path:"routing/7.2"}},Pq.prototype.b=function(t){return Error(t.details)},Pq.CONFIG_KEY="routing",Pq.prototype.Qd=function(t,e,r){return t=this.D().clone().F("calculateroute.json").I(t),this.K(t,e,r)},Pq.prototype.calculateRoute=Pq.prototype.Qd,Pq.prototype.dh=function(t,e,r){return t=this.D().clone().Ma("isoline").F("calculateisoline.json").I(t),this.K(t,e,r)},Pq.prototype.calculateIsoline=Pq.prototype.dh,u(Qq,Vp),t("H.service.RoutingService8",Qq),Qq.CONFIG_KEY="routing_v8",Qq.prototype.a=function(){return{subDomain:"router",path:"v8/routes"}},Qq.prototype.b=function(t){return Error(t.error)},Qq.prototype.Qd=function(t,e,r){return t=this.D().clone().I(t),this.K(t,e,r)},Qq.prototype.calculateRoute=Qq.prototype.Qd,Qq.prototype.dh=function(t,e,r){return t=this.D().clone().Ma("isoline").Md("v8/isolines").I(t),this.K(t,e,r)},Qq.prototype.calculateIsoline=Qq.prototype.dh,Y.prototype.bk=function(t,e){if(7===(e=+e||7))e=Pq;else{if(8!==e)throw new D(this.bk,1,"allowed values are 7 and 8");e=Qq}return this.Ya(e,t)},Y.prototype.getRoutingService=Y.prototype.bk,t("H.service.extension.dataView.ITable",Rq),Rq.prototype.be=function(){},Rq.prototype.getMeta=Rq.prototype.be,Rq.prototype.ee=function(){},Rq.prototype.getRowCount=Rq.prototype.ee,Rq.prototype.Bc=function(){},Rq.prototype.getRow=Rq.prototype.Bc,Rq.prototype.Ua=function(){},Rq.prototype.getColumnNames=Rq.prototype.Ua,Rq.prototype.Ue=function(){},Rq.prototype.getColumn=Rq.prototype.Ue,Rq.prototype.xa=function(){},Rq.prototype.getCell=Rq.prototype.xa,Rq.prototype.concat=function(){},Rq.prototype.concat=Rq.prototype.concat,t("H.service.extension.dataView.IRow",Sq),Sq.prototype.Ua=function(){},Sq.prototype.getColumnNames=Sq.prototype.Ua,Sq.prototype.xa=function(){},Sq.prototype.getCell=Sq.prototype.xa,Sq.prototype.xd=function(){},Sq.prototype.getTable=Sq.prototype.xd,t("H.service.extension.dataView.ObjRow",Tq),Tq.prototype.Ua=function(){return this.a.Ua()},Tq.prototype.getColumnNames=Tq.prototype.Ua,Tq.prototype.xa=function(t){return this.a.xa(this.b,t)},Tq.prototype.getCell=Tq.prototype.xa,Tq.prototype.xd=function(){return this.a},Tq.prototype.getTable=Tq.prototype.xd,t("H.service.extension.dataView.IColumn",Uq),Uq.prototype.xa=function(){},Uq.prototype.getCell=Uq.prototype.xa,t("H.service.extension.dataView.ObjColumn",Vq),Vq.prototype.xa=function(t){return this.b.xa(t,this.a)},Vq.prototype.getCell=Vq.prototype.xa,t("H.service.extension.dataView.ObjTable",Wq),n=Wq.prototype,n.ji=B,n.Hb=B,n.Rd=B,n.gh=B,n.be=function(){return this.ji},Wq.prototype.getMeta=Wq.prototype.be,Wq.prototype.ee=function(){return this.Hb?this.Hb.length:0},Wq.prototype.getRowCount=Wq.prototype.ee,Wq.prototype.Bc=function(t){var e=this.Hb;return e&&e[t]?new Tq(this,t):B},Wq.prototype.getRow=Wq.prototype.Bc,Wq.prototype.Ua=function(){return this.Rd||ff},Wq.prototype.getColumnNames=Wq.prototype.Ua,Wq.prototype.Ue=function(t){return this.gh[t]?new Vq(this,t):B},Wq.prototype.getColumn=Wq.prototype.Ue,Wq.prototype.xa=function(t,e){var r=this.Hb;return(t=r&&this.gh[e]&&r[t])&&t[e]},Wq.prototype.getCell=Wq.prototype.xa,Wq.prototype.concat=function(){var t,e=arguments.length,r=this.Rd,n=""+this.Rd,i=(this.Hb||[]).slice();for(t=0;t<e;t++){var o=arguments[t];if(!(o instanceof Wq))throw new D(this.concat,t);if(o.Hb){if(r&&""+o.Rd!==n)throw new D(this.concat,t,"Incompatible columns!");i=i.concat(o.Hb)}}return new Wq(i,this.Rd,this.ji)},Wq.prototype.concat=Wq.prototype.concat,u($q,bh),t("H.service.remote.Spatial",$q);var ar={};function br(t,e){this.a=t,e&&(this.b=e)}$q.prototype.gb=function(){return this.b||bh.prototype.gb.call(this)},$q.prototype.getId=$q.prototype.gb,$q.prototype.Dg=hd,$q.prototype.retain=$q.prototype.Dg,$q.prototype.release=df,$q.prototype.release=$q.prototype.release;var cr=new br([]);function dr(t,e,r){t.tf[e.key]=new br(r,void 0)}function er(t,e,r,n,i,o){fr(er,1,e,r),fr(er,2,n,i),(this.f=t.length)?(this.s=t,this.aa=e,this.i=r,this.b=0,this.c=A(this.c,this),this.o=n,this.j=i,this.a=mc(),Wa(this.a,gr,o||{}),this.g={},x.setTimeout(this.c,0)):e(ff,!0)}$q.prototype.$d=function(t){return(this.tf[t.key]||cr).a},$q.prototype.getGeometriesForTile=$q.prototype.$d,$q.prototype.zh=function(t){return(this.tf[t.key]||cr).b},$q.prototype.getLabels=$q.prototype.zh;var gr={duration:100,Am:"geometry",zm:"WKT",Zo:"searchAttributes",Cj:B};function fr(t,e,r,n){if(!Ca(r))throw new D(t,e,"has invalid type");if(!Ca(n))throw new D(t,e+1,"has invalid type")}function hr(t,e,r){var n=8===t;this.b=e,this.c=r||hd,(this.a=4===t||n)?this.j=n:this.g=1===t,this.f=this.a?"$HProjGeometry":"geometry"}function ir(t,e,r,n,i){var o=[],a=i.paths,s=a.length,u=0,l=t.b&&t.b(n);for(t=new $q(e,t.j,B,{style:l||t.i,data:n});u!==s;)o.push(kr(a[u++]));return dr(t,r,[new rh(o,i.interiorsIndex,i.outlinesIndex)]),t}function jr(t,e,r,n){n=new Wf(n[0],n[1]);var i=t.b&&t.b(r);return t.g?t=new yn(n,t={icon:i,data:r,provider:e}):t=new Qi(n,t={icon:i,data:r,provider:e}),t}function kr(t){for(var e=0,r=t.length,n=[];e<r;)n.push(new I(t[e++],t[e++]));return n}function lr(t){var e=(t=t||{}).tileCacheSize||1024,r=t.resultType,n=t.styleCallback;if(tc(t.min)||(t.min=12),lr.l.constructor.call(this,t),-1===mr.indexOf(r))throw new D(lr,2,"invalid resultType");if(this.a=r,n&&!Ca(n))throw new D(lr,2,"invalid style callback");this.Aa=n,this.W=t.pixelRatio||Se(),this.Lb=A(this.Lb,this),this.O(new Dk(e,A(this.dc,this))),this.createTileInternal=A(4===r||8===r?this.N:this.J,this)}function nr(t){var e=t.yb;return e||(t.v||(t.v=t.s(t.a,t.Aa,t.Lb)),(e=t.yb=new qq(t.v)).ka(t),e.addEventListener(t.i.Ea,A(t.kb,t)),e.yb=!0),e}er.prototype.c=function(){for(var t,e=[],r=!1,n=zk();this.b<this.f;){var i=this.s[this.b];if(r=i.attributes,t=i.layerId||this.a.Cj,i.distance&&(r[this.a.Zo]={nearest:new Wf(i.nearestLat,i.nearestLon),distance:i.distance}),i=i[this.a.Am]){try{var o=Fn(new $n(i))}catch(t){this.i(new x.Error(t.message)),r=!0;break}r[this.a.zm]=o}if((i=this.g[t])||(i=this.g[t]=this.o({layerId:t,columnNames:Object.keys(r)})),r=this.j(i,r),e.push(r),this.b++,(r=this.b===this.f)||zk()-n>=this.a.duration){this.aa(e,r);break}}r?this.g=y:this.m=x.setTimeout(this.c,0)},er.prototype.cancel=function(){x.clearTimeout(this.m),this.b<this.f&&this.i(new x.Error("parsing canceled"))},er.prototype.cancel=er.prototype.cancel,hr.prototype.parse=function(t,e,r){var n,i,o,a,s={},u=[],l=0;for(o=r.length;l<o;l++){var c=r[l],h=c.Rows;if(c=h.length){var f=Object.keys(h[0]).filter(function(t){return"geometry"!==t&&"$HProjGeometry"!==t});for(f=new Wq(h,f),a=0;a<c;a++){var p=h[a];if(i=p[this.f]){if(delete p[this.f],p=f.Bc(a))try{(n=this.a?ir(this,t,e,p,i):jr(this,t,p,i.path)).ka(t),u.push(n)}catch(t){this.c(t.message)}}else this.c("Layer must contain geometries")}}}return s[this.a?"spatials":this.g?"markers":"domMarkers"]=u,s},u(lr,R),t("H.service.extension.TileProvider",lr),lr.prototype.c=!1,lr.prototype.getCapabilities=function(){return lr.l.getCapabilities.call(this)|Cj.CROP_LINES_BY_TILE|Cj.CROP_POLYGONS_BY_TILE},lr.prototype.jb=function(t,e,r,n){return this.c?lr.l.jb.call(this,t,e,r,n):B},lr.prototype.requestTile=lr.prototype.jb,lr.prototype.Lb=function(t){this.dispatchEvent(new td("error",zc(t)?t:t+"",this))},lr.prototype.Wb=function(){return 1===this.a},lr.prototype.providesMarkers=lr.prototype.Wb,lr.prototype.Vb=function(){return 2===this.a},lr.prototype.providesDomMarkers=lr.prototype.Vb,lr.prototype.Jc=function(){return 4===this.a||8===this.a},lr.prototype.providesSpatials=lr.prototype.Jc,lr.prototype.J=function(t,e,r,n){var i=this.getTileKey(t,e,r);i=this.Ob().get(i);var o=2==this.a,a=[],s=nr(this);for(i?i.valid=!0:(delete(t=i=new Lk(t,e,r,y)).j,t.m=n),e=(n=sq(s,i,o?"domMarkers":"markers")).length;e--;)(t=n[e]).aj=i,(o||1===t.Cb().getState())&&a.push(t);return i.data=a,i},lr.prototype.kb=function(t){(t=t.target.aj)&&(t.valid=!1)},lr.prototype.cp=function(t){this.C=!!t},lr.prototype.setTileCanvasRendering=lr.prototype.cp,lr.prototype.C=!0,lr.prototype.N=function(t,e,r,n){var i=nr(this),o=this.getTileKey(t,e,r),a=this.tileSize,s=this.Ob().get(o);return s||(delete(t=s=new Pk(o,t,e,r,a,this.W,r,i)).j,t.m=n),this.C?(n=Sp.pop(a),s.V(n)||Sp.push(n,a)):Vk(s),s},lr.prototype.dc=function(t,e){var r;if(4===this.a||8===this.a){for(r=(t=e.Va()).length;r--;)delete t[r].tf[e.key];e.data&&(Sp.push(e.xg(),this.tileSize),e.yg())}else for(r=(t=e.data).length;r--;)delete t[r].aj},lr.prototype.u=function(){lr.l.u.call(this),nr(this).B()};var or={MARKER:1,DOM_MARKER:2,POLYLINE:4,POLYGON:8};lr.ResultType=or;var mr=[1,2,4,8];function Zq(t,e,r){var n=this,i=e&&e.rowFilter,o=r.resultType;Zq.l.constructor.call(this,r),C(t,pr,Zq,0),Yq(e),i?(r=Ua(e)).rowFilter=i.toString():r=Ua(e),delete r.layer,r.layerId=Ze(e.layerId,e.layer),(new Mf).a("pde","H.service.extension.worker.processor"),t=t.D().clone().F(qr+"."+rr).I({meta:1}),new Pf("pde",{message:[this.uid,0,{tileSize:this.tileSize,projected:!0,onlyOutline:4===o,serverUrl:t.toString(),layerConfigs:[r],horizontalMargin:1}]}).then(function(){n.c=!0,Wj(n)},this.Lb)}u(Zq,lr),t("H.service.extension.platformData.TileProvider",Zq),Zq.prototype.s=function(t,e,r){return(t=new hr(t,e,r)).i=sr,t};var sr=new Ug({strokeColor:"transparent",fillColor:"transparent",lineWidth:0,lineJoin:"round",lineCap:"round"});function tr(t){this.a=t}function pr(t){pr.l.constructor.call(this,pr,t)}Zq.prototype.K=function(t,e,r,n,i){var o,a=this,s=this.getTileKey(t,e,r);s=this.Ob().get(s);var u={cancel:hd},l=!0,c=this.a;if(s&&(4===c||8===c?s.le()||(n(Sp.pop(this.tileSize),null),l=!1):(n(y),l=!1)),l){var h=Qp.setTimeout(function(){(o=new Pf("pde",{message:[a.uid,1,[t,e,r]]})).then(n,i)},500);u.cancel=function(){o?o.cancel():Qp.clearTimeout(h)}}return u},Zq.prototype.requestInternal=Zq.prototype.K,Zq.prototype.u=function(){Zq.l.u.call(this),new Pf("pde",{message:[this.uid,3]})},Zq.ResultType=or,tr.prototype.cancel=function(){for(var t=this.a,e=t.length;e--;)t[e].cancel();t.length=0},u(pr,Vp),t("H.service.extension.platformData.Service",pr),pr.prototype.a=function(){return{subDomain:"s.fleet.ls",path:"1"}},pr.CONFIG_KEY="platformData",pr.prototype.request=function(t,e,r,n,i){return this.T(t,e,r,n,i)},pr.prototype.T=function(t,e,r,n,i){var o="text/plain";if(!t)throw new D(this.request,0,t);if(!e)throw new D(this.request,1,e);if(!n)throw new D(this.request,3,n);if(!i)throw new D(this.request,4,i);return t=this.D().clone().F(t+"."+e).I(r),e===ur.JSON&&(o="application/json"),this.K(t,n,i,o)};var qr="tiles";pr.EntryPoint={DOC_ATTRIBUTES:"doc/attributes",DOC_LAYER:"doc/layer",DOC_LAYERS:"doc/layers",DOC_MAPS:"doc/maps",DOC_INDEXES:"doc/indexes",SEARCH_BBOX:"search/bbox",SEARCH_CORRIDOR:"search/corridor",SEARCH_PROXIMITY:"search/proximity",SEARCH_QUADKEY:"search/quadkey",SERVICE_CONFIGURATION:"serviceconfiguration",STATIC:"static",TILE:"tile",TILES:qr,FILE:"file",INDEX:"index"};var rr="json",ur={TXT:"txt",JSON:rr,HTML:"html",BIN:"bin"};function vr(t,e,r){if(!yc(t))throw new D(r,0,"has invalid type");if(!yc(e))throw new D(r,1,"has invalid type");if(t.length!==e.length||!t.length)throw new D(r,1,"specify one key attribute for each given layer id in the same order")}function wr(t){wr.l.constructor.call(this,wr,t)}function xr(t){var e=yr;if(!t||!zc(t.layerId)||tc(t.rowFilter)&&!Ca(t.rowFilter)||tc(t.rowFilterContext)&&!Da(t.rowFilterContext))throw new D(e,1,tc("invalid layer config")?"invalid layer config":t)}function zr(t){return zc(t)&&/^[A-Z][A-Z0-9_]*$/.test(t)}function Ar(t){for(var e=t&&t.length,r=2<=e&&"WKT"===t[--e]&&"GEOMETRY_ID"===t[--e];r&&e--;)r=zr(t[e]);return r}function Br(t,e){var r,n,i="",o=[];if(e){if(t.geometries&&t.geometries.length)for(i=i+"Meta:\t"+e+"\n"+(n=Object.keys(t.geometries[0].attributes)).join("\t"),i+="\tWKT\n",r=0;r<t.geometries.length;r++){var a=t.geometries[r].attributes;for(s=t.geometries[r].geometry,e=0;e<n.length;e++)o.push(a[n[e]]);i+=o.join("\t"),i+="\t"+s+"\n",o=[]}}else{var s={};if(o=[],t.geometries)for(n=0;n<t.geometries.length;n++)s[(e=t.geometries[n]).layerId]||(s[e.layerId]=[]),s[e.layerId].push(e);for(r in s)o.push({layerId:r,geometries:s[r]});for(r=0;r<o.length;r++)i+=Br(o[r],o[r].layerId)}return i}function yr(t,e,r){var n,i=this,o=e&&e.rowFilter;yr.l.constructor.call(this,r),C(t,Cr,yr,0);var a=r.resultType;if(xr(e),o){var s=Ua(e);s.rowFilter=o.toString()}else s=e;(new Mf).a("cle","H.service.extension.worker.processor");var u=e.layerId;t.request(Dr,Er,{detail_level:"all",layer_id:u},function(e){var r;for(e=e.layers,r=0;r<e.length;r++)if(e[r].layerId===u){s.level=e[r].level;break}n=t.D().clone().F(Fr+"."+Er).I({meta:1}),new Pf("cle",{message:[i.uid,0,{tileSize:i.tileSize,projected:!0,onlyOutline:4===a,serverUrl:n.toString(),layerConfigs:[s],batchTiles:!1,horizontalMargin:1}]}).then(function(){i.c=!0,Wj(i)},i.Lb)},function(t){i.Lb(t.message)})}function Gr(){if(Hr)throw new Xc(Gr)}pr.EntryPointType=ur,pr.prototype.wc=function(t,e){var r=e&&e.resultType;return t=new Zq(this,t,e),1==r||2===r?new Bn(t):new ll(t)},pr.prototype.createTileLayer=pr.prototype.wc,pr.prototype.Jd=function(t,e,r,n){var i,o=[],a=e.layer_id||e.layer_ids;return t=this.request(t,rr,e,function(t){i=new er(t.geometries,r,n,function(t){return new Wq([],t.columnNames,t)},function(t,e){return t.Bc(Xq(t,e))},{Cj:a}),o.push(i)},function(t){n(new x.Error(t))}),o.push(t),new tr(o)},pr.prototype.Mc=function(t,e,r,n,i,o){function a(t,e){e&&s--,n(t,!s)}var s,u=[];for(vr(t,e,this.Mc),fr(this.Mc,3,n,i),C(r,K,this.Mc,2),r={bbox:r.la+","+r.ca+";"+r.na+","+r.ia},o&&Wa(r,o),t=r.layer_id?[r.layer_id]:t,o=0,s=t.length;o<s;o++)r.layer_id=t[o],r.key_attribute=e[o],u.push(this.Jd("search/bbox",r,a,i));return new tr(u)},pr.prototype.searchByBoundingBox=pr.prototype.Mc,pr.prototype.Yb=function(t,e,r,n,i,o,a){if(vr(t,e,this.Yb),C(r,Wf,this.Yb,2,"has invalid type"),!Cc(n))throw new D(this.Yb,3,"has invalid type");return fr(this.Yb,4,i,o),t={layer_ids:t.join(","),key_attributes:e.join(","),proximity:r.lat+","+r.lng+","+n},a&&Wa(t,a),this.Jd("search/proximity",t,i,o)},pr.prototype.searchByProximity=pr.prototype.Yb,pr.prototype.Xb=function(t,e,r,n,i,o,a){var s="";if(vr(t,e,this.Xb),!zc(r)&&!C(r,L))throw new D(this.Xb,1,"has invalid type");if(!Cc(n))throw new D(this.Xb,2,"has invalid type");if(fr(this.Xb,4,i,o),t={layer_ids:t.join(","),key_attributes:e.join(","),radius:n},zc(r))t.route_id=r;else{for(n=r.Y,r=0,e=n.length;r<e;r+=3)s+=n[r]+","+n[r+1],r<e-3&&(s+=";");t.corridor=s}return a&&Wa(t,a),this.Jd("search/corridor",t,i,o)},pr.prototype.searchByCorridor=pr.prototype.Xb,Y.prototype.wn=function(t){return this.Ya(pr,t)},Y.prototype.getPlatformDataService=Y.prototype.wn,u(wr,Vp),t("H.service.extension.geofencing.Service",wr),wr.prototype.a=function(){return{subDomain:"fleet.ls",path:"2"}},wr.CONFIG_KEY="geofencing",wr.prototype.request=function(t,e,r,n){return this.T(t,e,r,n)},wr.prototype.b=function(t){return Error(t.issues&&t.issues.length?t.issues.map(function(t){return t.message}).join(". "):t.message||t.response_code)},wr.prototype.T=function(t,e,r,n){if(!t)throw new D(this.request,0,t);if(!Ca(r))throw new TypeError("onResult must be a function");if(!Ca(n))throw new TypeError("onError must be a function");return t=this.D().clone().F(t+".json").I(e),this.K(t,r,n)},wr.EntryPoint={SEARCH_PROXIMITY:"search/proximity"},Y.prototype.Zm=function(t){return this.Ya(wr,t)},Y.prototype.getGeofencingService=Y.prototype.Zm,t("H.service.extension.customLocation.Permission",{READ:"read",WRITE:"write",EXPORT:"export"}),t("H.service.extension.customLocation.Storage",{READONLY:"readonly",UPDATABLE:"updatable"}),u(yr,lr),t("H.service.extension.customLocation.TileProvider",yr),yr.prototype.s=function(t,e,r){return new hr(t,e,r)},yr.prototype.K=function(t,e,r,n,i){var o,a=this,s=this.getTileKey(t,e,r);s=this.Ob().get(s);var u={cancel:hd},l=!0,c=this.a;if(s&&(4===c||8===c?s.le()||(n(Sp.pop(this.tileSize),null),l=!1):(n(y),l=!1)),l){var h=Qp.setTimeout(function(){(o=new Pf("cle",{message:[a.uid,1,[t,e,r]]})).then(n,i)},500);u.cancel=function(){o?o.cancel():Qp.clearTimeout(h)}}return u},yr.prototype.requestInternal=yr.prototype.K,yr.prototype.u=function(){yr.l.u.call(this),new Pf("cle",{message:[this.uid,3]})},t("H.service.extension.customLocation.Table",Gr);var Hr=!0;function Ir(t,e){var r;Hr=!1;var n=new Gr;Hr=!0,n.c=pc(x.JSON.parse(x.JSON.stringify(t))),t=t.columnNames;var i=mc();for(r=t.length;r--;)i[t[r]]=r;if(n.f=i,n.b=t.length,e){if(e.length%t.length)throw new D(Ir,1,"Invalid number of cells")}else e=[];return n.a=e,n}Gr.prototype.be=function(){return this.c},Gr.prototype.getMeta=Gr.prototype.be,Gr.prototype.ee=function(){return this.a.length/this.b},Gr.prototype.getRowCount=Gr.prototype.ee,Gr.prototype.Bc=function(t){return t<this.a.length/this.b?new Jr(this,t):B},Gr.prototype.getRow=Gr.prototype.Bc,Gr.prototype.Gn=function(){var t,e=this.a.length/this.b,r=new x.Array(e);for(t=0;t<e;t++)r[t]=new Jr(this,t);return r},Gr.prototype.getRows=Gr.prototype.Gn,Gr.prototype.Wg=function(t){var e=this.b,r=this.a,n=r.length/this.b;if(!t||t.length%e)throw new D(this.Wg,0,"Invalid number of cells");return this.a=r.concat(t),n},Gr.prototype.addCells=Gr.prototype.Wg,Gr.prototype.cm=function(){for(var t=this.b,e=this.a,r=this.a.length/this.b;t--;)e.push(y);return this.Bc(r)},Gr.prototype.addRow=Gr.prototype.cm,Gr.prototype.Ua=function(){return this.c.columnNames},Gr.prototype.getColumnNames=Gr.prototype.Ua,Gr.prototype.Ue=function(t){return this.f[t]===B?B:new Kr(this,t)},Gr.prototype.getColumn=Gr.prototype.Ue,Gr.prototype.xa=function(t,e){return this.a[t*this.b+this.f[e]]},Gr.prototype.getCell=Gr.prototype.xa,Gr.prototype.Nc=function(t,e,r){if(e=this.f[e],t>=this.a.length/this.b)throw new D(this.Nc,0,"Row index out of bounds");if(e===B)throw new D(this.Nc,0,"Column unknown");this.a[t*this.b+e]=r},Gr.prototype.setCell=Gr.prototype.Nc,Gr.prototype.concat=function(t){var e,r=arguments.length,n=""+this.Ua(),i=this.a?this.a.slice():[];for(e=0;e<r;e++){var o=arguments[e];if(!(o instanceof Gr))throw new D(this.concat,e);if(""+o.Ua()!==n)throw new D(this.concat,e,"Incompatible columns!");o.a&&(i=i.concat(o.a))}return Ir(this.c,i)},Gr.prototype.concat=Gr.prototype.concat;var Lr=/(\n|\t|\r|")/;function Mr(t,e,r,n,i,o,a,s){var u;for(u=0;u<a;u++){u&&e.push("\t");var l=r[n*i+o[u]];if(u!==s){if(l!==y){if(l=String(l),Lr.test(l))throw new D(t.Xi,0,'Invalid character (\\n, \\r, \\t, or ") in row '+n+" column "+t.c.columnNames[o[u]]);e.push(l)}}else e.push(l)}}function Kr(t,e){this.b=t,this.a=e}function Jr(t,e){this.a=t,this.gi=e}function Nr(t){if(t===B)t="\t";else if(!/^[^"\r\n]$/.test(t))throw new D(Nr,0);this.b=String(t).charCodeAt(0),this.hi=A(this.hi,this),this.A=Or}Gr.prototype.Xi=function(t,e){var r,n=this.b,i=this.Ua(),o=[],a=[],s=this.a,u=-1;for(r=0;r<n;r++)t&&!t.test(i[r])||("WKT"===i[r]&&(u=o.length),o.push(r));if(!(t=o.length))throw new D(this.Xi,1,"No columns filtered");if(Mr(this,a,i,0,n,o,t,u),e){var l=e.length;for(r=0;r<l;r++)a.push("\n"),Mr(this,a,s,i=e[r],n,o,t,u)}else for(l=this.ee(),i=0;i<l;i++)a.push("\n"),Mr(this,a,s,i,n,o,t,u);return a.join("")},Gr.Column=Kr,Kr.prototype.xa=function(t){return this.b.xa(t,this.a)},Kr.prototype.getCell=Kr.prototype.xa,Kr.prototype.Nc=function(t,e){this.b.Nc(t,this.a,e)},Kr.prototype.setCell=Kr.prototype.Nc,Gr.Row=Jr,Jr.prototype.Ua=function(){return this.a.Ua()},Jr.prototype.getColumnNames=Jr.prototype.Ua,Jr.prototype.xa=function(t){return this.a.xa(this.gi,t)},Jr.prototype.getCell=Jr.prototype.xa,Jr.prototype.Nc=function(t,e){this.a.Nc(this.gi,t,e)},Jr.prototype.setCell=Jr.prototype.Nc,Jr.prototype.xd=function(){return this.a},Jr.prototype.getTable=Jr.prototype.xd;var Or=0;function Pr(t,e,r){var n=t.A;if(n!==e)throw 1===n&&(t.A=Or),new Xc(r,"Requires state: "+["READY","PARSE","PAUSE"][e]+" but found "+["READY","PARSE","PAUSE"][n])}function Qr(t,e){var r=[];return t.parse(e,function(t,e,n){return 1>t&&(r[e]=n),0<t}),t.A=Or,r}function Rr(t,e,r){this.c=new $n(t),this.m=e,this.g=!0,this.Nf=this.j=this.b=0,Sr(this),this.a=r,this.f=[],this.i=!1}function Sr(t){var e=t.c.Tb();t.o=!1,(t.aa=34===e)&&t.c.next()}function Tr(t,e){var r=t.c;switch(t.o=!0,e){case t.m:t.b++;break;case 13:r.next(),10!==r.Tb()&&t.a("CR without LF");case 10:t.b=0,t.j++;break;case-1:t.g=!1;break;default:t.a("End of field expected")}return r.next(),-1}function Ur(t,e,r,n){if(n=n||{},!e)throw new D(Ur,1,"has to be a function");if(!r)throw new D(Ur,2,"has to be a function");for(this.c=e,this.g=r,this.a=[],this.i=n.duration||Vr,this.b=A(this.b,this),this.f={},t=t.split("Meta:\t").slice(1),e=0;e<t.length;e++){r=(n=t[e].split("\n"))[0].split("\t")[0],n=n.slice(1).join("\n"),this.Td[r]=new Nr,this.fi[r]=Qr(this.Td[r],n);var i={layerId:r,columnNames:this.fi[r]};this.Th.push(r),this.f[r]=Ir(i),this.Rc[r]=zk(),Wr(this,n,r),this.b(r)}}n=Nr.prototype,n.getState=function(){return this.A},n.abort=function(){Pr(this,2,Nr.prototype.abort),this.A=Or},n.hi=function(t){throw this.A=Or,new D(Nr.prototype.parse,0,"Malformed DSV at row "+this.a.j+" column "+this.a.b+": "+t)},n.parse=function(t,e,r){Pr(this,Or,Nr.prototype.parse),t=t.trim(),this.a=new Rr(t,this.b,this.hi),this.c=e,this.Ok=r||ef,this.A=2,this.resume()},n.Ok=ef,n.resume=function(){var t=this.a,e=[];Pr(this,2,Nr.prototype.resume),this.A=1;do{if(!t.g){this.A=Or;break}if(i>t.b){if(void 0!==r&&r!==i)return void this.a.a("The number of columns must be the same for all rows");var r=i}var n=t.j,i=t.b,o=t.Nf,a=this.Ok(n,i,t);if(t.Nf>o)for(;-1!==t.next(););else{for(;-1!==(o=t.next());)e.push(o);a=String.fromCharCode.apply(y,e),e.length=0}Sr(t),this.c(n,i,a)&&(this.A=t.g?2:Or)}while(1===this.A);2!=this.A&&void 0!==r&&0<i&&r!==i&&this.a.a("The number of columns must be the same for all rows")},n=Rr.prototype,n.Nf=0,n.Tb=function(){if(this.o)var t=-1;else{var e=this.c;if(t=e.Tb(),this.aa)switch(t){case 34:e.next(),34!==(t=e.Tb())&&(t=Tr(this,t));break;case-1:this.a("Closing quotation mark expected")}else switch(t){case 34:this.a("Unexpected quotation mark");case this.m:case 13:case 10:case-1:t=Tr(this,t)}}return t},n.ze=function(){this.i=!0,this.f=[]},n.Ud=function(){var t=this.f.slice();return this.i=!1,this.f=[],t},n.next=function(){var t=this.Tb();return-1!==t&&this.c.next(),this.i&&this.f.push(t),this.Nf++,t};var Vr=100;function Wr(t,e,r){var n=[],i=t.fi[r].length-1,o=t.f[r];try{t.Td[r].parse(e,function(e,a,s){var u=!1;return 0<e&&(n[a]=s,a===i&&(t.a.push(o.Bc(o.Wg(n))),zk()-t.Rc[r]>t.i&&(u=!0))),u},function(t,e,r){if(0<t&&e===i)return Fn(r)})}catch(e){t.g(e)}}function Cr(t){Cr.l.constructor.call(this,Cr,t)}function Xr(t,e,r,n){var i,o=e[t=t===Yr?"changes":"file"],a=zc(o),s=!a&&C(o,Blob);if(!a&&!s)throw new D(n,0,"Invalid "+t+" parameter");if(Zr)i=s?o:nf(o,"text/plain"),(n=new x.FormData).append(t,i,i.name||t+".wkt"),r.method="POST",r.data=n,delete e[t];else if(s)throw new D(n,0,"Sending Blob data is not supported by the browser")}n=Ur.prototype,n.fi={},n.Th=[],n.Td={},n.Rc={},n.Wi={},n.cancel=function(){for(var t in this.Wi)x.clearTimeout(this.Wi[t])},Ur.prototype.cancel=Ur.prototype.cancel,Ur.prototype.b=function(t){var e,r,n=this;this.Wi[t]=x.setTimeout(function(){if(2===n.Td[t].getState())n.Rc[t]=zk(),n.c(n.a,!1),n.a=[],n.Td[t].resume(),n.b(t);else{for(e=!0,r=0;r<n.Th.length;r++)if(n.Td[n.Th[r]].getState()!==Or){e=!1;break}e&&(0<n.a.length&&n.c(n.a,!0),n.a=[])}},0)},u(Cr,Vp),t("H.service.extension.customLocation.Service",Cr),Cr.prototype.a=function(){return{subDomain:"fleet.ls",path:"2"}},Cr.CONFIG_KEY="customLocation",Cr.prototype.wc=function(t,e){var r=e&&e.resultType;return t=new yr(this,t,e),1===r||2===r?new Bn(t):new ll(t)},Cr.prototype.createTileLayer=Cr.prototype.wc;var Zr=x.FormData&&!!x.FormData.prototype.append;Cr.prototype.request=function(t,e,r,n,i){return this.T(t,e,r,n,i)},Cr.prototype.T=function(t,e,r,n,i){var o="text/plain",a=t===$r.LAYERS_UPLOAD||t===$r.LAYERS_MODIFY||t===$r.LAYERS_IMPORT,s=r,u={data:B,method:"GET",headers:this.gf};if(!t)throw new D(this.request,0,t);if(!e)throw new D(this.request,1,e);fr(this.request,3,n,i),a&&(C(r,Object,this.request,2,"Invalid request parameters"),Xr(t,s=Ua(r),u,this.request));var l=this.D().clone().F(t+"."+e).I(s);return e===as.JSON&&(o="application/json"),(t=new rf(o,l.toString(),fe,u)).then(function(t){var e=t.issues;e&&t.error_id&&t.response_code?i(Error(e[0].message)):n(t)},function(t){"error"===t.type||404===t.status?i(Error(t.statusText||"Unable to load data")):t.json().then(function(t){i(Error("["+t.issues[0].message+"] "+l+" request failed"))},function(){i(Error("["+t.statusText+"] "+l+" request failed"))})}),t};var Dr="layers/list",Yr="layers/modify",Fr="tiled/tile",$r={LAYERS_DELETE:"layers/delete",LAYERS_GRANT:"layers/access/grant",LAYERS_LIST:Dr,LAYERS_MODIFY:Yr,LAYERS_UPLOAD:"layers/upload",LAYERS_IMPORT:"layers/import",SEARCH_ALL:"search/all",SEARCH_BBOX:"search/bbox",SEARCH_CORRIDOR:"search/corridor",SEARCH_PROXIMITY:"search/proximity",SEARCH_QUADKEY:"search/quadkey",SEARCH_TILE:Fr};Cr.EntryPoint=$r;var Er="json",as={TXT:"txt",JSON:Er};Cr.EntryPointType=as,Cr.prototype.tb=function(t,e,r){var n=this;return this.request("search/all","txt",{filter:'WKT==""',layer_id:t},function(i){var o=i.replace(/[\r\n]+$/g,"").split("\t");n.request(Dr,Er,{layer_id:t,detail_level:"all"},function(t){(t=t.layers[0]).columnNames=o,e(Ir(t))},r)},r)},Cr.prototype.getLayer=Cr.prototype.tb,Cr.prototype.hk=function(t,e,r,n){var i=e&&e.length,o=-1,a=this;return function s(){return++o<i?a.request("layers/access/grant",Er,{layer_id:t,granted_app_id:e[o].grantedAppId,permissions:e[o].permissions.join(",")},s,n):a.tb(t,r,n)}()},Cr.prototype.grantAccess=Cr.prototype.hk,Cr.prototype.Ej=function(t,e,r){return this.request("layers/delete",Er,{layer_ids:t},e,r)},Cr.prototype.deleteLayer=Cr.prototype.Ej,Cr.prototype.qd=function(t,e,r){function n(){setTimeout(function(){s.tb(o,function(n){setTimeout(function(n){var i=JSON.stringify(n.Ua()),u=t.grants;if(i!==JSON.stringify(a)){var c="Results into different column names on the backend: "+i;setTimeout(function(){s.Ej(o,function(){r(x.Error(c))},function(t){r(x.Error(c+". "+t.message))})},l)}else u&&u.length?s.hk(o,u,e,r):e(n)}.bind(null,n),l)},function(){64e3>u?(u+=l,n()):r(x.Error("Timeout"))})},l),l*=2}var i,o,a,s=this,u=0,l=1e3,c=!t||!zr(o=t.layerId)&&(i="layerId")||!Ar(a=t.columnNames)&&(i="columnNames")?0:Ca(e)?Ca(r)?-1:2:1;if(0<=c)throw new D(s.qd,c,i||arguments[c]);return s.tb(o,function(){r(x.Error("Layer exists already"))},function(){var e={layer_id:o,file:a.join("\t")},i=t.level,u=t.storage;i!==B&&(e.level=i),u!==B&&(e.storage=u),s.request("layers/upload",Er,e,n,r)})},Cr.prototype.createLayer=Cr.prototype.qd,Cr.prototype.Jd=function(t,e,r,n){var i,o=[];return t=this.request(t,Er,e,function(t){t.geometries.length?(t=Br(t,e.layer_id),i=new Ur(t,r,n),o.push(i)):r(ff,!0)},n),o.push(t),new tr(o)},Cr.prototype.Yb=function(t,e,r,n,i,o){if(!yc(t))throw new D(this.Yb,0,"has invalid type");if(C(e,Wf,this.Yb,1,"has invalid type"),!Cc(r))throw new D(this.Yb,2,"has invalid type");return fr(this.Yb,3,n,i),t={layer_ids:t.join(","),proximity:e.lat+","+e.lng+","+r},o&&Wa(t,o),this.Jd("search/proximity",t,n,i)},Cr.prototype.searchByProximity=Cr.prototype.Yb,Cr.prototype.Xb=function(t,e,r,n,i,o){var a="";if(!yc(t))throw new D(this.Xb,0,"has invalid type");if(!zc(e)&&!C(e,L))throw new D(this.Xb,1,"has invalid type");if(!Cc(r))throw new D(this.Xb,2,"has invalid type");if(fr(this.Xb,3,n,i),t={layer_ids:t.join(","),radius:r},zc(e))t.route_id=e;else{var s=e.Y;for(e=0,r=s.length;e<r;e+=3)a+=s[e]+","+s[e+1],e<r-3&&(a+=",");t.corridor=a}return o&&Wa(t,o),this.Jd("search/corridor",t,n,i)},Cr.prototype.searchByCorridor=Cr.prototype.Xb,Cr.prototype.Mc=function(t,e,r,n,i){function o(t,e){e&&a--,r(t,!a)}var a,s=[];if(!yc(t))throw new D(this.Mc,0,"has invalid type");for(C(e,K,this.Mc,1,"has invalid type"),fr(this.Mc,2,r,n),e={bbox:e.la+","+e.ca+";"+e.na+","+e.ia},i&&Wa(e,i),t=e.layer_id?[e.layer_id]:t,i=0,a=t.length;i<a;i++)e.layer_id=t[i],s.push(this.Jd("search/bbox",e,o,n));return new tr(s)},Cr.prototype.searchByBoundingBox=Cr.prototype.Mc,Cr.prototype.Ci=function(t,e,r,n){var i,o=[];if(!zc(t))throw new D(this.Ci,0,"has invalid type");fr(this.Ci,1,e,r);var a={layer_id:t};return n&&Wa(a,n),n=this.request("search/all",Er,a,function(n){n.geometries.length?(n=Br(n,t),i=new Ur(n,e,r),o.push(i)):e(ff,!0)},r),o.push(n),new tr(o)},Cr.prototype.searchAll=Cr.prototype.Ci;var bs={delete:/^GEOMETRY_ID$/,append:/^(?!GEOMETRY_ID$)/};function cs(t,e,r,n,i,o){function a(){n(this,++d===f)}function s(t){i(t,this,++d===f)}var u,l="append"!==e,c={},h=mc(),f=0,p=[],d=0;if(!yc(r))throw new D(o,0,r);for(fr(o,1,n,i),u=r.length;u--;){var v=r[u];if(C(v,Jr)){var g=v.xd().be().layerId,m=v.xa("GEOMETRY_ID");if(l){if(m===y||""===String(m))var _='GEOMETRY_ID must not be null or ""';c[m=g+"_"+m]&&(_="same GEOMETRY_ID for multiple rows"),c[m]=v}else m!==y&&""!==String(m)&&(_='GEOMETRY_ID must be null or ""')}else _="Invalid type";if(_)throw new D(o,0,"- Invalid row at index "+u+", "+_);(m=h[g])||(m=h[g]=[],f++),m.push(v)}for(g in h){for(r=[],u=(m=h[g]).length;u--;)r.push(m[u].gi);p.push(t.request(Yr,Er,{layer_id:g,action:e,changes:m[0].xd().Xi(bs[e]||null,r)},A(a,m),A(s,m)))}return new tr(p)}function ds(t){Dq.l.constructor.call(this,ds,t)}function es(t){es.l.constructor.call(this,es,t)}function fs(t){if(this.g=!!t.toBypassToken,!this.g&&!t.token)throw new D(fs,0,'"token" must be specified');fs.l.constructor.call(this,fs,t),this.j=t.token,this.i={},this.f={}}function js(t,e,r,n,i,o,a){return i={method:i,headers:Object.assign(t.g?{}:{authorization:"Bearer "+t.j},{"Content-Type":"application/geo+json"},t.gf)},o&&(i.data=JSON.stringify(o)),(o=new rf("application/json",(e=hs(t.D().clone().F(e+"/features").I(a||{}))).toString(),fe,i)).then(r,Xp(t,e,n)),o}function is(t,e){return t.g?e:hs(e).I({access_token:t.j})}function hs(t){var e=Object.assign({},t.getQuery());return delete e.apikey,t.Oi(e)}Cr.prototype.uj=function(t,e,r){return cs(this,"append",t,e,r,this.uj)},Cr.prototype.appendRows=Cr.prototype.uj,Cr.prototype.Ql=function(t,e,r){return cs(this,"update",t,e,r,this.Ql)},Cr.prototype.updateRows=Cr.prototype.Ql,Cr.prototype.Fj=function(t,e,r){return cs(this,"delete",t,e,r,this.Fj)},Cr.prototype.deleteRows=Cr.prototype.Fj,Y.prototype.Om=function(t){return this.Ya(Cr,t)},Y.prototype.getCustomLocationService=Y.prototype.Om,u(ds,Vp),t("H.service.extension.customRoute.Service",ds),ds.prototype.a=function(){return{subDomain:"s.fleet.ls",path:"2"}},ds.CONFIG_KEY="customRoute",ds.prototype.b=function(t){return Error(t.issues&&t.issues.length?t.issues.map(function(t){return t.message}).join(". "):t)},ds.prototype.Qd=function(t,e,r){return fr(this.Qd,1,e,r),t=this.D().clone().F("calculateroute.json").I(t),this.K(t,e,r)},ds.prototype.calculateRoute=ds.prototype.Qd,Y.prototype.Pm=function(t){return this.Ya(ds,t)},Y.prototype.getCustomRoutingService=Y.prototype.Pm,u(es,Vp),t("H.service.SearchService",es),es.CONFIG_KEY="search",es.prototype.a=function(){return{subDomain:"search",path:"v1"}},es.prototype.b=function(t){return t=[t.title,t.action,t.cause].filter(function(t){return t}),Error(t.join(". "))},es.prototype.rh=function(t,e,r){return t=this.D().clone().Ma("geocode").F("geocode").I(t),this.K(t,e,r)},es.prototype.geocode=es.prototype.rh,es.prototype.Bi=function(t,e,r){return t=this.D().clone().Ma("revgeocode").F("revgeocode").I(t),this.K(t,e,r)},es.prototype.reverseGeocode=es.prototype.Bi,es.prototype.gm=function(t,e,r){return t=this.D().clone().Ma("autosuggest").F("autosuggest").I(t),this.K(t,e,r)},es.prototype.autosuggest=es.prototype.gm,es.prototype.om=function(t,e,r){return t=this.D().clone().Ma("discover").F("discover").I(t),this.K(t,e,r)},es.prototype.discover=es.prototype.om,es.prototype.so=function(t,e,r){return t=this.D().clone().Ma("lookup").F("lookup").I(t),this.K(t,e,r)},es.prototype.lookup=es.prototype.so,es.prototype.im=function(t,e,r){return t=this.D().clone().Ma("browse").F("browse").I(t),this.K(t,e,r)},es.prototype.browse=es.prototype.im,Y.prototype.In=function(t){return this.Ya(es,t)},Y.prototype.getSearchService=Y.prototype.In,u(fs,Vp),t("H.service.xyz.Service",fs),fs.prototype.a=function(){return{host:"xyz.api.here.com",path:"hub/spaces"}},fs.prototype.b=function(t){return Error(t.errorMessage||t.message)},fs.prototype.Dh=function(t,e,r){return wc(t,"String",this.Dh,0,'"projectId" must be a string'),gs(this.Dh,1,e,r),t=hs(this.D().clone().Md("project-api/projects/"+t)),this.K(t,e,r)},fs.prototype.getProject=fs.prototype.Dh,fs.prototype.ck=function(t,e,r){return gs(this.ck,0,t,e),r=is(this,this.D().clone().I(r||{})),this.K(r,t,e)},fs.prototype.getSpaces=fs.prototype.ck,fs.prototype.eg=function(t,e,r){return wc(t,"String",this.eg,0,'"spaceId" must be a string'),gs(this.eg,1,e,r),t=is(this,this.D().clone().F(t)),this.K(t,e,r)},fs.prototype.getSpace=fs.prototype.eg,fs.prototype.fe=function(t,e,r){return wc(t,"String",this.fe,0,'"spaceId" must be a string'),gs(this.fe,1,e,r),t=is(this,this.D().clone().F(t+"/statistics")),this.K(t,e,r)},fs.prototype.getStatistics=fs.prototype.fe,fs.prototype.$f=function(t,e,r,n,i,o,a){return t=is(this,this.D().clone().F(n+"/tile/web/"+r+"_"+t+"_"+e+".mvtf").I(Object.assign({clip:!0},a))),this.K(t,function(t){return t.arrayBuffer().then(i)},o,"arraybuffer")},fs.prototype.search=function(t,e,r,n){return wc(t,"String",this.search,0,'"spaceId" must be a string'),gs(this.search,1,e,r),t=is(this,this.D().clone().F(t+"/search").I(n||{})),this.K(t,e,r)},fs.prototype.search=fs.prototype.search,fs.prototype.cd=function(t,e,r,n){if(wc(t,"String",this.cd,0,'"spaceId" must be a string'),!Da(e))throw new D(this.cd,1,'"params" must be an object');return gs(this.cd,2,r,n),t=is(this,this.D().clone().F(t+"/features").I(e)),this.K(t,r,n)},fs.prototype.getFeaturesById=fs.prototype.cd,fs.prototype.Zd=function(t,e,r,n){if(wc(t,"String",this.Zd,0,'"spaceId" must be a string'),!Da(e))throw new D(this.cd,1,'"params" must be an object');return gs(this.Zd,2,r,n),t=is(this,this.D().clone().F(t+"/bbox").I(e)),this.K(t,r,n)},fs.prototype.getFeaturesByBoundingBox=fs.prototype.Zd,fs.prototype.ta=function(t){var e=this.i[t];return e||(this.f[t]||this.Re(t),null)},fs.prototype.kd=function(t,e,r,n,i){if(wc(t,"String",this.kd,0,'"spaceId" must be a string'),!Da(e))throw new D(this.kd,1,'"geojsonObject" must be an object');if(gs(this.kd,2,r,n),i&&!Da(i))throw new D(this.kd,4,'"opt_params" must be an object');return js(this,t,r,n,"PUT",e,i)},fs.prototype.putFeatures=fs.prototype.kd,fs.prototype.hd=function(t,e,r,n,i){if(wc(t,"String",this.hd,0,'"spaceId" must be a string'),!Da(e))throw new D(this.hd,1,'"featureCollection" must be an object');if(gs(this.hd,2,r,n),i&&!Da(i))throw new D(this.hd,4,'"opt_params" must be an object');return js(this,t,r,n,"POST",e,i)},fs.prototype.postFeatures=fs.prototype.hd,fs.prototype.sd=function(t,e,r,n){if(wc(t,"String",this.sd,0,'"spaceId" must be a string'),!Da(e))throw new D(this.sd,1,'"params" must be an object');return gs(this.sd,2,r,n),js(this,t,r,n,"DELETE",B,e)},fs.prototype.deleteFeatures=fs.prototype.sd,fs.prototype.Re=function(t){var e=this;this.f[t]=ks,this.eg(t,function(r){e.f[t]=ls,e.i[t]=r.copyright,e.dispatchEvent("copyrightupdate")},function(r){throw e.f[t]=ms,r})},fs.CONFIG_KEY="xyz";var ks=1,ls=2,ms=-1,ps;function gs(t,e,r,n){if(!Ca(r))throw new D(t,e,'"onResult" must be a function');if(!Ca(n))throw new D(t,e+1,'"onError" must be a function')}function ns(t,e,r){var n;if(ns.l.constructor.call(this,r?{min:r.min,max:r.max,engineType:r.engineType}:void 0),C(t,fs,ns,0),!zc(e))throw new D(ns,1,'"spaceId" must be a string');if(this.s=t,this.a=e,this.c={},r&&(["limit","simplificationLevel","tags"].forEach(function(t){t in r&&(this.c[t]=r[t])},this),t=r.parameters))for(n in t)this.c[n]=t[n];this.ac(this.f===Vj.WEBGL?new Th({sources:{xyz:{type:"MVT"}},layers:{xyz:{data:{source:"xyz",layer:this.a},points:{filter:{$geometry:"point"},draw:{points:{collide:!1,order:200,color:"#92CF48",size:[[10,"8px"],[14,"12px"],[18,"16px"]]}}},polygons:{filter:{$geometry:"polygon"},draw:{polygons:{order:201,color:"#E39E3C"},lines:{order:202,color:"#755DA5",width:"1px"}}},lines:{filter:{$geometry:"line"},draw:{lines:{order:203,color:"#000000",width:"2px",join:"round",cap:"round"}}}}}}):new H.map.render.harp.Style({styles:[{layer:this.a,when:["==",["geometry-type"],"Point"],technique:"circles",renderOrder:200,color:"#92CF48",size:["interpolate",["linear"],["zoom"],10,8,14,12,18,16]},{layer:this.a,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:"#E39E3C",renderOrder:201},{layer:this.a,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#755DA5",lineWidth:"1px",renderOrder:202},{layer:this.a,when:["==",["geometry-type"],"LineString"],technique:"solid-line",color:"#000000",lineWidth:"2px",renderOrder:203}]}))}function os(t){var e;if(t)for(this.a={},e=t.length;e--;)this.a[t[e]]=!0;this.Hl={}}Y.prototype.Vn=function(t){return this.Ya(fs,t)},Y.prototype.getXYZService=Y.prototype.Vn,u(ns,R),t("H.service.xyz.Provider",ns),ns.prototype.K=function(t,e,r,n,i){return this.s.$f(t,e,r,this.a,n,i,this.c)},ns.prototype.requestInternal=ns.prototype.K,ns.prototype.ta=function(){return this.s.ta(this.a)},ns.prototype.getCopyrights=ns.prototype.ta,ns.prototype.Ed=df,ns.prototype.providesOMV=ns.prototype.Ed,ns.prototype.ua=function(){return this.ub()},ns.prototype.getStyle=ns.prototype.ua,ns.prototype.rc=function(t){C(t,Th)&&t.b("MVT"),this.ac(t)},ns.prototype.setStyle=ns.prototype.rc,t("H.service.buildInfo",function(){return Ef("H-service","1.30.7","776722f")}),os.prototype.a={},os.prototype.parse=function(t,e,r){var n,i,o,a,s;ps=!1;try{r=Qp.JSON.parse(r)}catch(t){ps=!0}if(r&&(n=r.metadata)){var u={spatials:[]};for(i in n)if((r=!this.a[i]&&(o=qs[i]))&&((a=n[i])||(ps=!0,a=void 0),r=a),r)for(r=a.length;r--;){var l;(l=a[r])||(ps=!0,l=void 0),(s=l)&&o(e,t,this,i,s,u)}}else ps=!0;return ps?void 0:u},os.prototype.parse=os.prototype.parse;var qs={"street labels":function(t,e,r,n,i,o){var a;if((a=i.vertices)||(ps=!0,a=void 0),a){var s,u,l=a.length;if((u=0<l)||(ps=!0,u=void 0),u)for(s=Array(l/2);l;){var c=a[--l];u=a[--l],s[l/2]=new I(u,c)}s=s?{a:[s]}:B,l=+i["font size"]/t.$a(),(a=r.Hl[l])||(rs.lineWidth=l,a=r.Hl[l]=r.Sd.Rj(rs)),ss(t,e,s,!1,a,i,n,o)}delete i.vertices},"city center labels":function(t,e,r,n,i,o){ss(t,e,ts(i,new rh([])),!0,r.Sd,i,n,o)},labels:function(t,e,r,n,i,o){var a;if((a=i["bounding boxes"])||(ps=!0,a=void 0),a){for(var s,u=a.length,l=new rh([]);u--;){var c;(c=a[u])||(ps=!0,c=void 0),(s=c)&&ts(s,l)}ss(t,e,l,!0,r.Sd,i,n,o)}delete i["bounding boxes"]},buildings:function(t,e,r,n,i,o){var a,s,u,l,c=i.id,h=e.zg[c],f=[],p=[];((a=i)||(ps=!0,a=void 0),a&&((s=a.vertices)||(ps=!0,s=void 0),s))&&((l=a.polygons)||(ps=!0,l=void 0),(u=l)&&f.push.apply(f,us(s,u)),(a=a.outlines)||(ps=!0,a=void 0),(u=a)&&p.push.apply(p,us(s,u)));u=f.length,f.push.apply(f,p),p=new rh(f,Td,u),(f=f.length)||(ps=!0,f=void 0),f&&(h?(dr(h,t,[p]),o.spatials.push(h)):(h=ss(t,e,p,!0,r.Sd,i,n,o,c),e.ea(h)))}};qs["transit stops"]=qs.POIs=qs.labels;var vs=["box 2","box 1","annotation box","icon box"];function ts(t,e){for(var r,n,i=vs.length;i--;)if(n=t[r=vs[i]]){var o=n[0],a=n[1],s=n[2];n=n[3],e.a.push([new I(o,a),new I(o+s,a),new I(o+s,a+n),new I(o,a+n)]),delete t[r]}return e}function us(t,e){var r,n,i,o=e.length;if(0<o)for(n=Array(o);o--;)if((r=e[o])||(ps=!0,r=void 0),r){var a=r.length;if(0<a)for(n[o]=i=Array(a);a--;){var s=2*r[a];i[a]=new I(t[s],t[s+1])}}return n||[]}var ws={};function ss(t,e,r,n,i,o,a,s,u){return ws.style=i,n=new $q(e,n,u,ws),r&&dr(n,t,[r]),xs(o),o.category=a,n.setData(o),s.spatials.push(n),n.ka(e),n}os.prototype.Sd=new Ug({strokeColor:"transparent",fillColor:"transparent",lineWidth:0});var rs={};function xs(t){var e,r=!1;switch(typeof t){case"object":if(t instanceof Array)for(e=t.length;e--;)xs(t[e])?r=!0:delete t[e];else if(t)for(e in t)xs(t[e])?r=!0:delete t[e];break;case"number":r=!0;break;default:r=!!t}return r}function ys(t,e,r){r=r||{},e=e||{};var n=r.tileType||"maptile",i=r.scheme||"normal.day";if(R.call(this,{min:0,max:20}),!0===e.pois&&(e.pois="!F"),this.a=e,!(t&&t instanceof zs))throw Error("InvalidArgument: service required");this.C=t,this.v=A(this.v,this),this.C.addEventListener("versionupdate",this.v),this.c=t.D().clone().F(n+"/"+t.Cc()+"/"+i).I(this.N).I(e),this.bc=t.Fh()||null,this.W=r.pixelRatio||r.pixelratio||Se(),this.tileSize=r.tileSize||256,this.tileType=n,this.scheme=i,this.s=new qq(new os(r.categoryFilter)),this.s.ka(this),this.J=A(this.J,this),this.s.addEventListener("update",this.J),R.call(this,{min:0,max:20}),this.O(new Dk(r.tileCacheSize||256,A(this.Aa,this)))}function zs(t){zs.l.constructor.call(this,zs,t),t=Wp(this,t),this.bc=t.shards,(this.Ra=t.ignoreTypes?null:t.type)&&this.D().Ma(this.Ra),this.cc=t.version,this.vi={},this.Xc=new Gp,"newest"===this.cc&&this.ph()}function As(t,e){for(var r={},n=t[e+"s"][e],i=n.length;i--;)r[n[i].id]=n[i];t[e+"s"]=r}function Bs(t,e,r,n,i){1&i&&Cs(t,t,e,r,n,0),2&i&&Cs(t,t,e,r,n,1),4&i&&Cs(t,t,e,r,n,2),8&i&&Cs(t,t,e,r,n,3)}function Cs(t,e,r,n,i,o){for(var a,s,u,l,c=(r+1)*(r+1),h=4*n,f=r+1,p=[{r:0,xm:0,hm:0,Ug:0,next:null}],d=1,v=["r","g","b","a"][o],y=2*r+1;d<y;d++)p[d]={r:0,xm:0,hm:0,Ug:0,next:null},p[d-1].next=p[d];p[2*r].next=p[0];var g=4*(n-1);for(a=0;a<i;a++){var m=a*h,_=t[m+o],b=_*f*(r+2)/2;for(y=_*f,d=0;d<=r;d++)p[d][v]=_;var x=0;for(d=1;d<=r;d++){var w=d<n?m+4*d:m+g;b+=(w=t[w+o])*(f-d),x+=w,p[r+d][v]=w}w=p[0],u=p[f],d=m,l=4*f;var E=m+g;for(_=0;_<n;_++){e[d+o]=b/c,b-=y;var T=_+f<n?d+l:E;if(b+=x+=T=t[T+o],y-=w[v],y+=u[v],x-=u[v],w[v]=T,w=w.next,u=u.next,d+=4,!b)for(;(s=4*(_+f))<h&&0===t[m+o+s];)_++,d+=4}}for(m=(i-1)*h,_=0;_<n;_++){for(b=(a=e[(t=4*_)+o])*f*(r+2)/2,y=a*f,d=0;d<=r;d++)p[d][v]=a;for(x=0,d=1;d<=r;d++)b+=(w=e[(w=d<i?t+d*h:t+m)+o])*(r-d+1),x+=w,p[r+d][v]=w;for(w=p[0],u=p[f],d=t,E=f*h,g=t+m,a=0;a<i;a++)if(e[d+o]=b/c,b-=y,b+=x+=T=e[(T=a+f<i?d+E:g)+o],y-=w[v],y+=u[v],x-=u[v],w[v]=T,w=w.next,u=u.next,d+=h,!b)for(;(s=a+f)<i&&0===e[s*h+o+t];)a++,d+=h}}function Ds(t,e,r){this.f=e=t>>e,this.j=Math.log(e)*Math.LOG2E,this.i=t=document.createElement("CANVAS"),this.a=t.getContext("2d"),this.b=t.width=t.height=3*e;var n=document.createElement("canvas");t=r.a;var i,o=r.b;for(a in e=[],n.width=256,n.height=1,n=n.getContext("2d"),o)o.hasOwnProperty(a)&&e.push({stop:parseFloat(a),value:o[a]});o=e.length,e.sort(this.m),0<e[0].stop&&e.unshift({stop:0,value:e[0].value}),1>e[o-1].stop&&e.push({stop:1,value:e[o-1].value}),o=e.length;var a=n.createLinearGradient(0,0,256,0);for(i=0;i<o;i++){if(!t&&u){var s=u.stop+(e[i].stop-u.stop)/2;a.addColorStop(s,u.value),a.addColorStop(s,e[i].value)}a.addColorStop(e[i].stop,e[i].value);var u=e[i]}n.fillStyle=a,n.fillRect(0,0,256,1),this.c=n.getImageData(0,0,256,1).data,this.g=r.a}function Es(t,e){this.canvas=t,this.size=e}function Fs(t,e,r){this.a=t=Yd(t,0,30),this.Ra=e,this.i=r,this.m=[],this.b=[];do{this.b[t]=[],this.m[t]=new Gs}while(t--);e===Hs?(this.o=Is,this.j=Js):(this.o=Ks,this.j=Ls),this.c=1/0,this.f=-1/0}u(ys,R),t("H.service.metaInfo.TileProvider",ys),ys.prototype.Aa=function(t,e){for(var r,n=(t=e.Va()).length;n--;)delete(r=t[n]).tf[e.key],r.release();e.data&&(Sp.push(e.xg(),this.tileSize),e.yg())},ys.prototype.J=function(){this.dispatchEvent("update")},ys.prototype.K=function(t,e,r,n,i){var o,a=this.c.clone(),s=this.bc,u=this.tileSize,l=this.getTileKey(t,e,r);if((l=this.Ob().get(l))&&!l.le()){n(Sp.pop(this.tileSize),null);var c={cancel:function(){}}}else{s&&a.Ma(s[(r+e+t)%s.length]),a.F(r+"/"+t+"/"+e+"/"+u+"/png8");var h=Qp.setTimeout(function(){(o=new rf("text/plain",a.toString())).then(function(t){n(null,t)},i)},500)}return c||{cancel:function(){o?o.cancel():Qp.clearTimeout(h)}}},ys.prototype.requestInternal=ys.prototype.K,ys.prototype.rd=function(t,e,r,n,i){var o=this.s,a=n||Sp.pop(this.tileSize);if(n)(t=this.Ob().get(this.getTileKey(t,e,r))).V(n);else if(delete(n=t=new Pk(this.yd(t,e,r),t,e,r,this.tileSize,this.W,r,o)).j,n.m=i,t.V(a))for(a=(i=t.Va()).length;a--;)i[a].Dg();else Sp.push(a,this.tileSize);return t},ys.prototype.createTileInternal=ys.prototype.rd,ys.prototype.B=function(){this.s.B(),this.C.removeEventListener("versionupdate",this.v),R.prototype.B.call(this)},ys.prototype.v=function(){var t=this.C;this.c=t.D().clone().F(this.tileType+"/"+t.Cc()+"/"+this.scheme).I(this.N).I(this.a),this.reload(!1)},ys.prototype.N={metadata:"metaonly",mgen:"2"},u(zs,Vp),t("H.service.metaInfo.Service",zs),zs.prototype.a=function(){return{type:"base",version:"newest",subDomain:"maps.ls",path:"maptile/2.1",shards:["1","2","3","4"]}},zs.CONFIG_KEY="metaInfo",zs.prototype.Fh=function(){return this.bc},zs.prototype.ek=function(){return this.Ra},zs.prototype.Cc=function(){return this.cc},zs.prototype.getVersion=zs.prototype.Cc,zs.prototype.Si=function(t){this.cc=t},zs.prototype.ta=function(){return this.Xc},zs.prototype.getCopyrights=zs.prototype.ta,zs.prototype.$i=function(t){var e;if(As(t=t.response,"map"),As(t,"scheme"),As(t,"tiletype"),As(t,"format"),As(t,"resolution"),As(t,"language"),"newest"===this.cc&&"traffic"!==this.Ra)for(e in t.maps)t.maps[e].hash&&t.maps[e].newest&&(this.Si(t.maps[e].hash),this.dispatchEvent("versionupdate"));this.Lh=t,this.dispatchEvent("infoupdate")},zs.prototype.ph=function(){var t=this,e=this.D().clone().F("info").I({output:"json"});this.bc&&e.Ma(this.bc[0]),this.K(e,function(e){t.$i(e)},function(t){throw t})},zs.prototype.xh=function(){return this.Lh},zs.prototype.getInfo=zs.prototype.xh,zs.prototype.Me=function(t,e,r,n,i,o){return new ys(this,n,{tileSize:t,pixelRatio:e,categoryFilter:r,tileType:i,scheme:o})},zs.prototype.createTileProvider=zs.prototype.Me,zs.prototype.wc=function(t,e,r,n,i,o){return new ll(this.Me(t,e,r,n,i,o))},zs.prototype.createTileLayer=zs.prototype.wc,Y.prototype.Wj=function(t){return this.Ya(zs,t)},Y.prototype.getMetaInfoService=Y.prototype.Wj,function(){var t=Y.prototype.createDefaultLayers;Y.prototype.createDefaultLayers=function(e,r,n,i,o,a){var s=t.call(this,e,r,n,i,o,a),u={},l=this.Wj();"object"==typeof e&&(e=(a=e).tileSize,r=a.ppi,n=a.lg,i=a.lg2,o=a.style,a=a.pois),e=e||256;var c=320===r?2:1;if(0>[72,250,320,500].indexOf(+r)){if(r!==B)throw new D(this.Sf,1,r)}else u.ppi=+r;return n&&(u.lg=n),i&&(u.lg2=i),o&&(u.style=o),a&&(u.pois=a),s.raster.normal.metaInfo=l.wc(e,c,["buildings"],u),s}}(),Ds.prototype.m=function(t,e){return t.stop-e.stop};var Ms=Math.log(.5);function Js(t){return this.g?Math.round((t-this.c)/this.g*255):127}function Ls(t){return void 0===this.aa?127:Math.round(255*Math.pow(t,this.aa))}function Ns(t,e,r,n,i){var o,a,s=1<<e;return n=Xd(n,s),!(s=0<=r&&r<s&&(o=t.b[e])&&(a=o[r])&&(s=a[n])||null)&&i&&0<=e&&(s=Ns(t,e-1,r>>1,n>>1,i)),s}function Os(t,e,r,n,i,o){for(var a,s=[];r<=n;r++)for(a=i;a<=o;a++)s.push(Ns(t,e,r,a,!1));return s}function Ps(t,e){var r,n=0,i=0,o=Ns(t,0,0,0,!1);return!0===e.c?e.f:(e.z===t.a?e.f=e.a:(Qs(t,e,function(e){var a=Rs(t,e),s=4-a.length;if(e.z!==t.a){for(r=0;r<a.length;r++)n+=a[r].a,i++;n+=s*o.a,i+=s}}),e.f=n/i),e.c=!0,e.f)}function Qs(t,e,r){e=[e];for(var n,i;0<e.length;)n=Rs(t,i=e.shift()),r(i),e.push.apply(e,n)}function Rs(t,e){var r,n,i,o=[];for(n=0;1>=n;n++)for(i=0;1>=i;i++)(r=Ns(t,e.z+1,2*e.x+n,2*e.y+i,!1))&&o.push(r);return o}function Ks(){this.a=this.b=this.g=0}function Is(){this.a=this.b=this.g=0,this.c=!1}function Gs(){this.f=this.c=1/0,this.a=this.b=-1/0}function Ss(t,e){var r,n=0;if(!Da(t)||Ta(t))throw new D(Ss,0,t);for(r in t){var i=+r;if(n++,!(Cc(i)&&0<=i&&1>=i&&zc(t[r])))throw new D(Ss,0,t)}if(2>n)throw new D(Ss,0,"Specify at least 2 stops");this.b=t,this.a=!!e}Fs.prototype.Ib=function(t){var e,r,n=t.value;void 0===n&&(n=1),n>this.f&&(this.f=n,this.g=this.f-this.c),n<this.c&&(this.c=n,this.g=this.f-this.c);var i=Xi.$c(t).scale(1073741823).floor();n=this.a;var o=i.x>>30-n;for(i=i.y>>30-n,r=this.o;-1<n;){this.b[n][i]||(this.b[n][i]=[]),(e=this.b[n][i][o])||(e=this.b[n][i][o]=new r),e.Ib(t,n);var a=this.m[n];a.f>e.b&&(a.f=e.b),a.a<e.b&&(a.a=e.b),a.c>e.a&&(a.c=e.a),a.b<e.a&&(a.b=e.a),n--,o>>=1,i>>=1}},Fs.prototype.clear=function(){Fs.call(this,this.a,this.Ra,this.i)},Ks.prototype.Ib=function(t,e){this.g++,this.b+=t.value||1,this.a=this.b/Math.pow(2,2*(30-e))},Is.prototype.Ib=function(t){t=t.value,this.b+=void 0!==t?t:1,this.a=this.b/++this.g,this.c=!1},t("H.data.heatmap.Colors",Ss);var Ts=new Ss({0:"#008",.2:"#0b0",.5:"#ff0",.7:"#f00"},!0);function Us(t){var e=t||{},r=+e.sampleDepth;t=+e.coarseness;var n=e.colors,i={min:e.min,max:e.max},o=e.tileSize,a=+e.dataMax;if(e.tileSize&&(i.tileSize=o),R.call(this,i),Xj(this,e.opacity),this.Ra="value"===e.type?Hs:Vs,this.sampleDepth_=Cc(r)?Yd(Math.round(r),1,8):4,this.v=!!e.assumeValues,e=this.max,this.C=Cc(a)?Yd(Math.round(a),this.min,e+this.sampleDepth_):e,t=Cc(t)?Yd(Math.round(t),0,3):1,n&&!C(n,Ss))throw new D(Us,0,"colors");this.a=new Fs(e+this.sampleDepth_,this.Ra,this.C),this.N=new Ds(this.tileSize,t,n||Ts),this.s=A(this.s,this),this.c=A(this.c,this),this.J=new xk(20,this.s)}function Ws(t,e,r,n){var i=document.createElement("canvas"),o=t.tileSize,a=i.getContext("2d");i.width=i.height=o;var s,u,l=t.N,c=t.a,h=t.v,f=t.Ra,p=l.f,d=l.a,v=f===Vs?2:1,y=v;t=Math.min(t.sampleDepth_+v,l.j),v=l.b;var g=c.a;if(h&&f===Hs){for(u=-1;1>=u;u++)for(h=-1;1>=h;h++){var m=(m=Ns(c,n,r+u,e+h,!0))?c.j(Ps(c,m)):128;d.fillStyle="rgba("+m+",128,0,1)",d.fillRect((h+1)*p,(u+1)*p,p,p)}h=p-Math.floor(p/10),u=3,Bs((m=d.getImageData(0,0,v,v)).data,h,v,v,u),d.putImageData(m,0,0)}else d.fillStyle=h?"#080":"#000",d.fillRect(0,0,v,v);for(;y<=t&&n+y<=g;y++){u=p-(h=p>>y);var _=f===Vs?127+Math.floor(128/(1<<t-y)):255;m=2+(1<<y);var b=1<<y,x=e<<y,w=r<<y;for(x=(b=Os(c,n+y,w-1,w+b,x-1,x+b)).length;x--;){w=x%m;var E=x/m<<0;(s=b[x])&&(s=c.j(s.a),d.fillStyle="rgba("+s+","+_+",0,1)",d.fillRect(w*h+u,E*h+u,h,h))}m=d,_=h,b=u,x=p+2*h,h=p+2*h,w=w=3,Bs((E=d.getImageData(b,u,x,h)).data,_,x,h,w),m.putImageData(E,b,u)}for(e=d.getImageData(0,0,v,v),r=l.c,n=l.g,t=0,v=(c=e.data).length;t<v;t+=4)f=c[t],y=c[t+1],4===r.length&&(f=0),c[t]=r[4*f],c[t+1]=r[4*f+1],c[t+2]=r[4*f+2],c[t+3]=r[4*f+3]*(n?y/255:10>y?0:1);return d.putImageData(e,0,0),p=(l=new Es(l.i,p)).size,a.drawImage(l.canvas,p,p,p,p,0,0,o,o),i}Ss.DEFAULT=Ts,u(Us,R),t("H.data.heatmap.Provider",Us),Us.prototype.qc=function(t){Xj(this,t)},Us.prototype.setOpacity=Us.prototype.qc,Us.prototype.dd=function(){return this.j},Us.prototype.getOpacity=Us.prototype.dd,Us.prototype.pf=df,Us.prototype.providesRasters=Us.prototype.pf,Us.prototype.K=function(t,e,r,n,i){var o,a,s=this.v;if(Ns(this.a,0,0,0,!1)){if(!s){var u=Os(this.a,r,e-1,e+1,t-1,t+1);for(o=u.length;o--&&!s;)if(null!==u[o]){s=!0;break}}s&&(a=this.J.push([t,e,r,n,i],this.c))}return s||n(null),a},Us.prototype.requestInternal=Us.prototype.K,Us.prototype.s=function(t,e){t.done(Ws(this,e[0],e[1],e[2]))},Us.prototype.c=function(t,e,r){var n=t.data;t=n[3],n=n[4],r?n():t(e)},Us.prototype.tj=function(t,e){var r;if(!yc(t))throw new D(this.tj,0,t);if(r=t.length){for(;r--;)this.a.Ib(t[r]);var n;r=(t=this.a).m;var i=t.a,o=0;if(t.Ra===Vs){var a=r[t.a].a;for(n=t.a;0<=n&&r[n].a===a;n--)o=n;for(a=r[0].a,n=0;n<=o&&a===r[n].a;n++)i=n;o>t.i&&(o=t.i),a=Math.round(i+(o-i)/2),t.aa=Ms/Math.log(r[a].b)}this.reload(!!e)}},Us.prototype.addData=Us.prototype.tj,Us.prototype.clear=function(){this.a.clear(),this.reload(!0)},Us.prototype.clear=Us.prototype.clear;var Vs=0,Hs=1;function Xs(){}function Ys(){this.a={4:function(t){return["#",t.charAt(1),t.charAt(1),t.charAt(2),t.charAt(2),t.charAt(3),t.charAt(3),"ff"].join("")},5:function(t){return["#",t.charAt(1),t.charAt(1),t.charAt(2),t.charAt(2),t.charAt(3),t.charAt(3),t.charAt(4),t.charAt(4)].join("")},7:function(t){return t+"ff"},9:function(t){return t}},this.b={4:function(t){return[Zs(t.charAt(1)),Zs(t.charAt(2)),Zs(t.charAt(3)),255]},5:function(t){return[Zs(t.charAt(1)),Zs(t.charAt(2)),Zs(t.charAt(3)),Zs(t.charAt(4))]},7:function(t){return[(t=parseInt(t.substring(1),16))>>16&255,t>>8&255,255&t,255]},9:function(t){return[(t=parseInt(t.substring(1),16))>>24&255,t>>16&255,t>>8&255,255&t]}}}function Zs(t){return((t=parseInt(t,16))<<4)+t}function $s(t){return 16>t?"0"+Math.round(t).toString(16):Math.round(t).toString(16)}function at(t,e,r){return/^(#|rgb).*/.test(e)?(r||(r="","#"===e.charAt(0)?r=t.a[e.length]?e:"":"rgb"===e.substr(0,3)&&(r=2<(r=(e=e.match(/\d+(\.\d+)?/g)).length)&&5>r?["#",$s(+e[0]),$s(+e[1]),$s(+e[2]),3<r?$s(255*+e[3]):"ff"].join(""):""),e=r),(t=t.b[e.length](e))[3]=Math.round(t[3]/255*100)/100,t):[0,0,0,255]}function bt(t){for(var e,r=(t=t.attributes).length;r--;)switch(e=t[r],e.name){case"x":this.x=parseFloat(e.value);break;case"y":this.y=parseFloat(e.value);break;case"xunits":this.fd="fraction"===Xs.prototype.Oa(e);break;case"yunits":this.Gc="fraction"===Xs.prototype.Oa(e)}}function ct(t){var e=t.childNodes,r=new Xs;for(t=e.length;t--;){var n=e[t];switch(n.nodeName){case"href":this.href=r.Oa(n)}}}function dt(t){var e;if(t){var r=(t=t.childNodes).length;for(e=new Xs;r--;){var n=t[r];switch(n.nodeName){case"scale":this.scale=e.ag(n);break;case"Icon":this.icon=n=new ct(n);break;case"hotSpot":this.kk=n=new bt(n)}}}}function et(t){for(var e,r=(t=t.childNodes).length,n=new Xs,i=new Ys;r--;)switch(e=t[r],e.nodeName){case"color":this.color=n.Zf(e);break;case"colorMode":this.a=n.Oa(e)}"random"===this.a&&(this.color="#"+i.Ol(this.color,!1))}function ft(t){var e=t.childNodes,r=e.length,n=new Xs;for(this.outline=this.fill=!0,this.Mf=new et(t);r--;)switch(t=e[r],t.nodeName){case"fill":this.fill=n.Wd(t);break;case"outline":this.outline=n.Wd(t)}}function gt(t){var e=t.childNodes,r=e.length,n=new Xs;for(this.Mf=new et(t);r--;)"width"===(t=e[r]).nodeName&&(this.width=n.ag(t))}function ht(t){for(var e,r=(t=t.childNodes).length,n=new Xs;r--;)switch(e=t[r],e.nodeName){case"bgColor":this.bgColor=n.Zf(e);break;case"textColor":this.textColor=n.Zf(e);break;case"text":this.text=n.Oa(e);break;case"displayMode":this.displayMode=n.Oa(e)}}function it(t){var e=t.childNodes,r=e.length;for(this.id=t.getAttribute("id");r--;)switch(t=e[r],t.nodeName){case"IconStyle":this.lk=t=new dt(t);break;case"LineStyle":this.ne=t=new gt(t);break;case"PolyStyle":this.al=t=new ft(t);break;case"BalloonStyle":this.Hf=t=new ht(t)}}function jt(t,e){var r=(t=t.childNodes).length,n=new Xs;for(this.b=e;r--;)switch(e=t[r],e.nodeName){case"key":this.key=n.Oa(e);break;case"styleUrl":this.a=n.Oa(e)}}function kt(t,e){var r=t.childNodes,n=r.length;for(this.b=e,this.id=t.getAttribute("id"),this.a=[];n--;)"Pair"===(t=r[n]).nodeName&&(t=new jt(t,this.b),this.a.push(t))}function lt(){this.a={}}function mt(t,e){var r=t&&t.childNodes||[],n=new Xs;if(!t||!e)throw Error("Node or stylesContainer is not defined");for(this.visibility=!0,this.Qo=t,t=r.length;t--;){var i=r[t];switch(i.nodeName){case"name":this.name=n.Oa(i);break;case"description":this.description=n.Oa(i);break;case"visibility":this.visibility=n.Wd(i);break;case"open":this.open=n.Wd(i);break;case"styleUrl":(this.a=n.Oa(i))&&(i=this.a.substr(1),this.vm=e.Gh(i,!1));break;case"Style":this.yk=i=new it(i)}}}function nt(t){for(var e,r=(t=t.childNodes).length,n=null,i=new Xs;r--;)"coordinates"===(e=t[r]).nodeName&&(n=i.Oa(e));this.a=null,n&&(this.a=i.si(n)||null)}function ot(t){for(var e,r=(t=t.childNodes).length,n=new Xs;r--;)if("coordinates"===(e=t[r]).nodeName){e=n.Oa(e);var i=[],o=new Xs;try{i=o.Yk(e)}catch(t){i=[]}this.a=2>i.length?[]:i}}function pt(t){for(var e=new L,r=t.a?t.a.length:0;r--;)e.Fd(t.a[r]);return e}function qt(){}function rt(t){var e=t.childNodes,r=e.length;for(this.a=new L,this.c=[];r--;){var n=e[r],i=n.nodeName;if("outerBoundaryIs"===i||"innerBoundaryIs"===i){var o=n.childNodes;for(n=o.length;n--;){var a=o[n];if("LinearRing"===a.nodeName){var s=new ot(a);if("outerBoundaryIs"===i){this.a=pt(s);var u=void 0,l=t,c=s.a;s=new Xs;var h=l.querySelector("altitudeMode");if(h&&h.parentNode===l&&!/^\s*clampTo/.test(s.Oa(h))&&c){h=c.length;for(var f=0;f<h&&0!==u;f++){var p=c[f].alt;p?u?p!==u&&(u=0):u=p:u=0}(c=l.querySelector("*|altitudeOffset"))&&c.parentNode===a&&"http://www.google.com/kml/ext/2.2"===c.namespaceURI&&(a=s.ag(c))&&(u+=a),u&&(u=vd(xi,u),(a=l.querySelector("extrude"))&&a.parentNode===l&&s.Wd(a)?this.b=u:this.f=u)}}else this.c.push(pt(s))}}}}}function st(t,e){var r=document.createElement("CANVAS");r.width=1,r.height=1,this.i=t,this.b={},this.f={},this.g=new Ij(r),this.c=e||""}function tt(t,e,r){for(var n,i,o=(e=e.childNodes).length,a={};o--;){var s=e[o];switch(s.nodeName){case"Point":n=new nt(s),i=ut(t,"Marker"),n=new yn(n.a,i),i.ti&&Ce(i.ti,"statechange",A(t.j,t,i.ti,n,i),!1);break;case"LineString":case"LinearRing":n=new ot(s),i=ut(t,"Polyline"),n=new nh(pt(n),i);break;case"Polygon":n=new rt(s),(i=ut(t,"Polygon")).elevation=n.f,i.extrusion=n.b,n=new wi(new O(n.a,n.c),i);break;case"MultiGeometry":n=tt(t,s,n=new Q)}n&&(t.a.name&&(a.name=t.a.name),t.a.description&&(a.description=t.a.description),i&&i.Hf&&(a.balloonStyle=i.Hf),a.kmlNode=t.a.Qo,n.setData(a),r&&r.ea(n))}return r&&(n=r),n}function ut(t,e){var r=t.a,n={visibility:r.visibility},i=new Ys,o=1,a={x:0,y:0,fd:!1,Gc:!1},s=vt(t,r.vm);switch(r.yk&&(s=vt(t,r.yk,s)),e){case"Marker":if(s&&s.lk){if((i=s.lk).scale&&(o=i.scale),i.kk){var u=i.kk;a={x:u.x,y:u.y,fd:u.fd,Gc:u.Gc}}i.icon&&i.icon.href?(e=i.icon.href,wt.test(e)||(e=t.c+e),i=o+"_"+a.x+a.y+a.fd+a.Gc+"_"+e,(u=t.b[i]||t.f[i])||(u=new Ij(e),t.f[i]=u),0===u.getState()?(n.icon=t.g,n.ti=u,n.href=e,n.anchor=a,n.scale=o):1===u.getState()&&(n.icon=u)):1!==o&&(u||(a={x:14,y:4,fd:!1,Gc:!1}),o={size:new Ki((t={w:28*o,h:36*o}).w,t.h),anchor:new I(a.fd?t.w*a.x:a.x*o,a.Gc?t.h*(1-a.y):t.h-a.y*o),hitArea:new Li(Mi.POLYGON,[0*o,16*o,0*o,7*o,8*o,0*o,18*o,0*o,26*o,7*o,26*o,16*o,18*o,34*o,8*o,34*o])},n.icon=new Ij('<svg xmlns="http://www.w3.org/2000/svg" width="28px" height="36px"><path d="M 19 31 C 19 32.7 16.3 34 13 34 C 9.7 34 7 32.7 7 31 C 7 29.3 9.7 28 13 28 C 16.3 28 19 29.3 19 31 Z" fill="#000" fill-opacity=".2"/><path d="M 13 0 C 9.5 0 6.3 1.3 3.8 3.8 C 1.4 7.8 0 9.4 0 12.8 C 0 16.3 1.4 19.5 3.8 21.9 L 13 31 L 22.2 21.9 C 24.6 19.5 25.9 16.3 25.9 12.8 C 25.9 9.4 24.6 6.1 22.1 3.8 C 19.7 1.3 16.5 0 13 0 Z" fill="#fff"/><path d="M 13 2.2 C 6 2.2 2.3 7.2 2.1 12.8 C 2.1 16.1 3.1 18.4 5.2 20.5 L 13 28.2 L 20.8 20.5 C 22.9 18.4 23.8 16.2 23.8 12.8 C 23.6 7.07 20 2.2 13 2.2 Z" fill="#18d"/></svg>',o))}break;case"Polyline":n.style={},s&&s.ne&&(o=s.ne,n.style.strokeColor="rgba("+at(i,o.Mf.color,!0)+")",0<=o.width&&(n.style.lineWidth=o.width));break;case"Polygon":n.style={},s&&(s.ne&&(o=s.ne,n.style.strokeColor="rgba("+at(i,o.Mf.color,!0)+")",0<=o.width&&(n.style.lineWidth=o.width)),s.al&&(o=s.al,n.style.fillColor=o.fill?"rgba("+at(i,o.Mf.color,!0)+")":"rgba(0,0,0,0)",o.outline||(n.style.lineWidth=0)))}return n.Hf=s.Hf,n}function vt(t,e,r){for(var n in r=r||{},e)e.hasOwnProperty(n)&&(r[n]="object"==typeof e[n]?vt(t,e[n],r[n]):e[n]);return r}t("H.data.utils.Dom",Xs),Xs.prototype.Wd=function(t){return!!t&&/^\s*(1|true)\s*$/i.test(this.Oa(t))},Xs.prototype.getBoolean=Xs.prototype.Wd,Xs.prototype.Oa=function(t){var e;try{if(t.nodeType===Node.ATTRIBUTE_NODE)return t.value;var r="",n=0,i=t.childNodes;for(e=i.length;n<e;n++)i[n].nodeType!==Node.COMMENT_NODE&&(r+=i[n].nodeValue.replace(/^\s+|\s+$/g,""))}catch(t){}return r||""},Xs.prototype.getString=Xs.prototype.Oa,Xs.prototype.ag=function(t){return parseFloat(this.Oa(t))||0},Xs.prototype.getFloat=Xs.prototype.ag,Xs.prototype.Yk=function(t){var e,r=t.split(/\s+/),n=r.length,i=!(r&&1==n),o=i?1:3,a=[];for(i||(n=(r=t.split(",")).length),e=0;e<n;e+=o){if(!(t=this.si(i?r[e]:e+3>r.length?null:r.slice(e,e+3))))return[];a.push(t)}return a},Xs.prototype.parseCoords=Xs.prototype.Yk,Xs.prototype.si=function(t){if(!t)return null;var e=t instanceof Array&&0<t.length&&4>t.length?t:t.split(",");t=parseFloat(e[0]);var r=parseFloat(e[1]);return e=parseFloat(e[2]),isNaN(r)||isNaN(t)?null:new Wf(r,t,isNaN(e)?void 0:e)},Xs.prototype.parseCoord=Xs.prototype.si,Xs.prototype.Zf=function(t){return t=this.Oa(t),/^[0-9a-fA-F]{8}$/.test(t)?"#"+t.substr(6,2)+t.substr(4,2)+t.substr(2,2)+t.substr(0,2):"#000000ff"},Xs.prototype.getColor=Xs.prototype.Zf,t("H.data.utils.ColorHelper",Ys),Ys.prototype.Ol=function(t,e){var r="";if(!/^(#|rgb).*/.test(t)){var n;for(r="",n=0;6>n;n++)r+="ABCDEF0123456789".charAt(Math.floor(16*Math.random()));return r+"ff"}for(t=at(this,t,e),e=0;4>e;e++)r+=$s(n=3>e?Math.floor(Math.random()*(t[e]+1)):255*t[e]);return r},Ys.prototype.toRandomRGBA=Ys.prototype.Ol,t("H.data.kml.HotSpot",bt),t("H.data.kml.Icon",ct),t("H.data.kml.IconStyle",dt),t("H.data.kml.ColorStyle",et),t("H.data.kml.PolyStyle",ft),t("H.data.kml.LineStyle",gt),t("H.data.kml.BalloonStyle",ht),t("H.data.kml.Style",it),t("H.data.kml.Pair",jt),jt.prototype.ua=function(){if(this.a){var t="highlight"===this.key;t=this.b.Gh(this.a.substr(1),t)}return t},jt.prototype.getStyle=jt.prototype.ua,t("H.data.kml.StyleMap",kt),kt.prototype.ua=function(t){var e=null;t=t?"highlight":"normal";for(var r=this.a.length;r--;)this.a[r].key===t&&(e=this.a[r].ua());return e},kt.prototype.getStyle=kt.prototype.ua,t("H.data.kml.StyleContainer",lt),lt.prototype.Yg=function(t){t&&t.id&&(this.a["style_"+t.id]=t)},lt.prototype.addStyle=lt.prototype.Yg,lt.prototype.Gh=function(t,e){return(t=this.a["style_"+t])instanceof kt&&(t=t.ua(e)),t},lt.prototype.getStyleById=lt.prototype.Gh,t("H.data.kml.Feature",mt),t("H.data.kml.Point",nt),t("H.data.kml.Line",ot),qt.prototype.f=0,qt.prototype.b=0,u(rt,qt),t("H.data.kml.Polygon",rt),st.prototype.create=function(t){return this.a=new mt(t,this.i),tt(this,t,null)},st.prototype.j=function(t,e,r){var n=r.anchor,i=r.scale;r=i+"_"+n.x+n.y+n.fd+n.Gc+"_"+r.href;var o={};if(1===t.getState()){var a=this.b[r];if(!a){var s=n.x,u=n.y;(a=t.Db())&&(a={w:a.w*i,h:a.h*i},o.size=a),s=n.fd&&a?a.w*s:s*i,u=n.Gc&&a?a.h*(1-u):!n.Gc&&a?a.h-u*i:u*i,o.anchor={x:s,y:u},a=new Ij(t.ad(),o),this.b[r]=a}e.Pc(a)}delete this.f[r]};var wt=/^[^:\/]+:/;function xt(t){uc(this,xt),this.url=t,this.b=[],this.a=y,this.c=A(this.c,this),F.call(this)}u(xt,F),t("H.data.AbstractReader",xt);var yt={ERROR:-1,LOADING:0,VISIT:1,READY:2};function zt(t,e,r,n){zt.l.constructor.call(this,e,t),this.state=r,this.message=n}function At(t){var e=t?t.lastIndexOf("/"):B;this.g=[],xt.call(this,t),0<=e&&(this.i=t.substr(0,e)+"/")}function Ct(t,e,r){r?r.ea(e):(t.a&&t.a.kc().ea(e),t.b.push(e),t.P(yt.VISIT,e))}function Bt(t,e){for(var r,n=t.length,i=[];n--;)(r=t[n]).nodeName===e&&i.push(r);return i}function Dt(t,e){this.b=t,this.a=e}function Et(t){return new Wf(t[1],t[0])}function Gt(t){for(var e,r=Ft(t[0]),n=[],i=1,o=t.length;i<o;i++)e=Ft(t[i]),n.push(e);return new O(r,n)}function Ft(t){for(var e=0,r=t.length,n=new L;e<r;e++)n.Fd(Et(t[e]));return n}function Ht(t,e){e=e||{},this.i=e.style||this.Sd,(this.g=!!e.disableLegacyMode)||window.console.warn("H.data.geojson.Reader: Legacy parser is enabled in GeoJSON Reader. Features like Multi-Geometries, Polygon interiors and GeoJSON feature properties might not work as expected. To maximise compatibility with the remote services it is recommended to set the `disableLegacyMode` flag to true."),xt.call(this,t)}function Jt(t){var e={};if(t.geometry){var r=t.geometry;e.type=r.type,e.properties=t.properties,r.coordinates&&(e.coordinates=r.coordinates),r.geometries&&(e.geometries=r.geometries),t.id&&(e.id=t.id)}return e}function It(t,e){t.a&&t.a.kc().ea(e),t.b.push(e),t.P(yt.VISIT,e)}function Kt(t,e,r){this.f=this.c=r,this.ui=[],this.a=0,this.R=dg(t,e,!0)}function Mt(t){var e;nd.call(this),this.a=[],t?Wa(e={},Nt,t):e=Nt,this.g=e,nd.call(this)}xt.State=yt,xt.prototype.f=yt.READY,xt.prototype.j={am:"statechange"},xt.prototype.tb=function(){this.a||(this.a=new N,this.a.kc().fc(this.b));return new ml(this.a)},xt.prototype.getLayer=xt.prototype.tb,xt.prototype.tn=function(){return this.b.concat([])},xt.prototype.getParsedObjects=xt.prototype.tn,xt.prototype.D=function(){return this.url},xt.prototype.getUrl=xt.prototype.D,xt.prototype.ep=function(t){if(this.f===yt.LOADING||this.f===yt.VISIT)throw Error("InvalidState: state "+this.f);return this.b=[],this.a=y,this.url=t,this},xt.prototype.setUrl=xt.prototype.ep,xt.prototype.getState=function(){return this.f},xt.prototype.getState=xt.prototype.getState,xt.prototype.P=function(t,e,r){this.f=t,this.dispatchEvent(new zt(e||this,this.j.am,t,r||""))},xt.prototype.parse=function(){var t=this;tc(this.url)?(this.P(yt.LOADING),new rf("text/plain",this.url).then(function(e){try{t.c(e)}catch(e){t.P(yt.ERROR,y,e.message)}},function(){t.P(yt.ERROR,y,"Error loading file")})):t.P(yt.ERROR,y,"File url was not set")},xt.prototype.parse=xt.prototype.parse,u(zt,rd),u(At,xt),t("H.data.kml.Reader",At),At.prototype.c=function(t){var e,r=null;if(t&&""!=t.trim()){try{var n=(new DOMParser).parseFromString(t,"text/xml")}catch(t){return void this.P(yt.ERROR,void 0,"Error parsing KML document")}if(n.getElementsByTagName("parsererror").length)this.P(yt.ERROR,void 0,"Error parsing KML document");else if((t=n.childNodes&&"kml"===n.childNodes[0].nodeName?n.childNodes[0]:void 0)&&(e=Bt(t.childNodes,"Document")[0]),e=e||t){n=new lt;for(var i=Bt(e.childNodes,"Style"),o=Bt(e.childNodes,"StyleMap"),a=i.length;a--;)t=new it(i[a]),n.Yg(t);for(a=o.length;a--;)t=new kt(o[a],n),n.Yg(t);for(this.o=n,this.m=new st(this.o,this.i),e=(t=e.childNodes).length;e--;)n=r,"Placemark"===(i=t[e]).nodeName?(i=this.m.create(i))&&Ct(this,i,n):"Folder"===i.nodeName&&(Ct(this,(i={group:new Q,node:i}).group,n),this.g.push(i)),!e&&(n=this.g.shift())&&(t=n.node.childNodes,r=n.group,e=t.length);this.P(yt.READY)}else this.P(yt.ERROR,void 0,"Invalid KML document")}else this.P(yt.ERROR,void 0,"Unable to create objects from the empty data")},Dt.prototype.create=function(t,e){var r=t.coordinates;switch(t.type){case"Point":var n=new yn(Et(r));break;case"LineString":n=new nh(Ft(r));break;case"Polygon":n=new wi(Gt(r));break;case"MultiPoint":var i=0,o=r.length;if(n=[],this.a){for(;i<o;i++)n.push(Et(r[i]));r=new yn(new Ji(n))}else{for(;i<o;i++)n.push(new yn(Et(r[i])));(r=new Q).fc(n)}n=r,o="multiPoint";break;case"MultiLineString":if(i=0,o=r.length,n=[],this.a){for(;i<o;i++)n.push(Ft(r[i]));r=new nh(new mh(n))}else{for(;i<o;i++)n.push(new nh(Ft(r[i])));(r=new Q).fc(n)}n=r,o="multiLineString";break;case"MultiPolygon":if(n=[],i=0,o=r.length,this.a){for(;i<o;i++)n.push(Gt(r[i]));r=new wi(new ui(n))}else{for(;i<o;i++)n.push(new wi(Gt(r[i])));(r=new Q).fc(n)}n=r,o="multiPolygon";break;case"GeometryCollection":r=n=new Q,o=0;for(var a=(i=t.geometries).length;o<a;o++)this.create(i[o],r);o="geometryCollection"}return n&&(r=n,i=t.properties,t=t.id,a={},i&&(this.a?a=i:a.properties=i),o&&!this.a&&(a[o]=!0),t&&r.Qi(t),r.setData(a),this.b(n)),e&&n&&e.ea(n),n},Dt.prototype.create=Dt.prototype.create,u(Ht,xt),t("H.data.geojson.Reader",Ht),Ht.prototype.c=function(t){var e,r;try{var n="string"==typeof t?JSON.parse(t):t;if("object"==typeof n){var i=new Dt(this.i,this.g);switch(n.type){case"FeatureCollection":if(e=n.features){var o=new Q;for(It(this,o),r=0;r<e.length;r++){var a=Jt(e[r]);(a=i.create(a))&&o.ea(a)}}break;case"Feature":a=Jt(n),(a=i.create(a))&&It(this,a);break;default:(a=i.create(n))&&It(this,a)}this.P(yt.READY)}else this.P(yt.ERROR,void 0,"Invalid syntax")}catch(t){this.P(yt.ERROR,void 0,"Parse error. "+t.message)}},Ht.prototype.Po=function(t){this.P(yt.LOADING),this.c(t)},Ht.prototype.parseData=Ht.prototype.Po,Ht.prototype.Sd=function(){},t("H.data.buildInfo",function(){return Ef("H-data","1.30.7","abfe236")}),hg.prototype.Uc=ca(1,function(t,e){this.a.Uc(t,Cc(e)?e:this.c)}),lg.prototype.Uc=ca(0,function(t,e){var r,n=0;if(!t(this)&&e--)for(;3>=n;n++)(r=this[n])&&r.Uc(t,e)}),t("H.clustering.grid.Cluster",Kt),Kt.prototype.Ge=function(t){this.b||(this.b=Zf(t)),this.a+=t.wt||1,this.ui.push(t)},Kt.prototype.Ca=function(){return this.b},Kt.prototype.getPosition=Kt.prototype.Ca,Kt.prototype.Ec=function(){return this.a},Kt.prototype.getWeight=Kt.prototype.Ec,Kt.prototype.Bd=df,Kt.prototype.isCluster=Kt.prototype.Bd,Kt.prototype.Ac=function(){return this.c},Kt.prototype.getMinZoom=Kt.prototype.Ac,Kt.prototype.cg=function(){return this.f},Kt.prototype.getMaxZoom=Kt.prototype.cg,Kt.prototype.G=function(){return this.R},Kt.prototype.getBoundingBox=Kt.prototype.G,Kt.prototype.qh=function(t){this.Se(t)},Kt.prototype.forEachEntry=Kt.prototype.qh,Kt.prototype.Se=function(t){var e=this;if(!Ca(t))throw new D(this.Se,0,t);this.ui.forEach(function(r){t(new Lt(r,e.c+1))})},Kt.prototype.forEachDataPoint=Kt.prototype.Se,u(Mt,nd);var Ot={clusters:[],noisePoints:[]},Nt={projection:Xi,min:0,max:22,eps:32,minWeight:2};function Lt(t,e){this.a=t,this.b=e}function Pt(t){Mt.call(this,t)}function Qt(t){this.a=t;var e=(t=document.createElement("canvas")).getContext("2d"),r=this.a,n=14*r;t.width=n,t.height=n,e.scale(r,r),e.beginPath(),e.strokeStyle="#FFFFFF",e.fillStyle="#1080DD",e.arc(7,7,6,0,2*Math.PI,!1),e.fill(),e.lineWidth=1,e.stroke(),this.f=new Ij(t,{size:{w:14,h:14},anchor:{x:7,y:7}}),this.b={},this.c={}}function Rt(t,e,r){var n,i=document.createElement("canvas"),o=i.getContext("2d"),a=t.a,s=e*a;return i.width=s,i.height=s,o.scale(a,a),a=e+":"+r,(n=t.b[a])?o.putImageData(n,0,0):(e/=2,o.beginPath(),o.strokeStyle="rgba("+r+",0.2)",o.fillStyle="rgba("+r+",1)",o.arc(e,e,e/5*3,0,2*Math.PI,!1),o.fill(),o.lineWidth=e/5*4,o.stroke(),t.b[a]=o.getImageData(0,0,s,s)),i}function St(t){if(Mt.call(this,t),(t=this.g).projection!==Xi)throw new D(St,0,"Other projection than mercator not supported yet");this.m=t.projection,this.f=t.eps,this.v=t.minWeight,this.o=new Yi(this.m),(new Mf).a("cluster","H.clustering.dynamicgrid.worker"),this.i=A(this.i,this),this.j=A(this.j,this)}n=Mt.prototype,n.Oc=function(t){this.a=t,this.b=!0},n.Ib=function(t){this.a.push(t),this.b=!0},n.Gf=function(t){this.a=this.a.concat(t),this.b=!0},n.qf=function(t){this.a=this.a.filter(function(e){return e!==t}),this.b=!0},n.u=function(){Mt.l.u.call(this),this.a=null},n.sl=hd,t("H.clustering.grid.NoisePoint",Lt),Lt.prototype.Ca=function(){return Zf(this.a)},Lt.prototype.getPosition=Lt.prototype.Ca,Lt.prototype.Ec=function(){return this.a.wt},Lt.prototype.getWeight=Lt.prototype.Ec,Lt.prototype.Bd=ef,Lt.prototype.isCluster=Lt.prototype.Bd,Lt.prototype.Ac=function(){return this.b},Lt.prototype.getMinZoom=Lt.prototype.Ac,Lt.prototype.getData=function(){return this.a.data},Lt.prototype.getData=Lt.prototype.getData,u(Pt,Mt),Pt.prototype.Ui=function(t){var e,r=this.g,n=r.min,i=r.max,o=[],a=[];if(this.b){for(e=this.a;n<=i;n++){for(var s,u,l,c,h,f,p,d,v=void 0,y=n,g=e,m=o,_=a,b=r.eps,x=r.projection,w=r.minWeight,E=g.length,T=Math.pow(2,y+8),A=[];d=g[--E];)if(!d.cj){for(p=T,f=(l=x.$c(d).scale(T).floor()).x,h=l.y,u=A.length;u--;)c=(s=A[u]).Ca(),s.bj||(s.bj=x.$c(c).scale(T).floor()),(c=(c=s.bj).Za(l))<p&&(p=c,v=s);v&&v.G().pd(d)||(v=new Kt(x.vg({x:(f-b)/T,y:(h-b)/T}),x.vg({x:(f+b)/T,y:(h+b)/T}),y),A.push(v)),v.Ge(d),v=null}for(E=A.length;E--;)if((u=(s=A[E]).Ec())<w)for(u=(s=s.ui).length;d=s[--u];)_.push(new Lt(d,y)),d.cj=!0;else m.push(s)}for(n=0,i=e.length;n<i;n++)delete e[n].cj;this.b=!1,t({clusters:o,noisePoints:a})}},t("H.clustering.theme.Circular",Qt),Qt.prototype.Im=function(t){var e=t.Ec(),r=this.c[e];if(!r){if(10>e){r=Rt(this,28,"118,209,0");var n={x:11,y:18}}else 25>e?(r=Rt(this,38,"255,105,0"),n={x:13,y:23}):50>e?(r=Rt(this,38,"240,60,0"),n={x:13,y:23}):100>e?(r=Rt(this,38,"181,0,21"),n={x:13,y:23}):1e3>e?(r=Rt(this,48,"181,0,21"),n={x:15,y:28}):(r=Rt(this,66,"181,0,21"),n={x:20,y:38});var i=r.getContext("2d");i.fillStyle="#FFFFFF",i.font="bold 11px Arial",i.fillText(e,n.x,n.y),r=new Ij(r,{size:{w:n=r.width/this.a,h:n},anchor:{x:n/2,y:n/2}}),this.c[e]=r}return(e=new yn(t.Ca(),{icon:r,min:t.Ac(),max:t.cg()})).setData(t),e},Qt.prototype.getClusterPresentation=Qt.prototype.Im,Qt.prototype.qn=function(t){var e=new yn(t.Ca(),{icon:this.f,min:t.Ac()});return e.setData(t),e},Qt.prototype.getNoisePresentation=Qt.prototype.qn,u(St,Mt),St.prototype.sl=function(t,e){this.aa=t,this.s=yd(e)},St.prototype.Ui=function(t,e){var r=this.c,n=this.aa,i=this.s||0,o=!r||!(r.zoom===i&&r.b.oa(n));if(n&&(this.b||o)){if(r&&3>r.pe&&r.cancel(),this.b=!1,(r=this.f)>=128*Dd(2,i))var a=Tt;else{(o=this.o).Qa(i);var s=o.lb(n.Rb());a=o.lb(n.Nb()),s.y-=r,a.y+=r,s=o.lf(s);var u=o.lf(a);a=new K(s.lat,s.lng,u.lat,u.lng),r=o.Sa(r,0).lng+180,a=a.Ic(s.lat,s.lng-r,u.lat,s.lng).Ic(s.lat,u.lng,u.lat,u.lng+r)}for(r=a,a=[],o=(s=this.a).length;o--;)r.pd(s[o])&&a.push(s[o]);0<a.length?(this.c=new Ut(n,i,a,this.f,this.v,this.m!==Xi,t,e),this.c.then(this.i,this.j)):t(Ot)}},St.prototype.i=function(t){Ba(t)||(t=new x.Uint32Array(t)),this.c.g(Vt(this,t))},St.prototype.j=function(t){zc(t)&&this.c.c(t)};var Tt=new K(90,-180,-90,180);function Vt(t,e){for(var r=0,n=e[r++],i=Array(n),o=0,a=[],s=e.length,u=t.c.a,l=t.c.zoom;n--;)i[o++]=new Lt(u[e[r++]],l);for(;r<s;){n=e[r++],o=u[e[r]];var c=t.o,h=t.f;c.Qa(t.c.zoom);var f=c.lb(o);for(o=c.Sa(f.x-h,f.y-h),c=c.Sa(f.x+h,f.y+h),o=new Kt((o=new K(o.lat,o.lng,c.lat,c.lng)).Rb(),o.Nb(),l);n--;)o.Ge(u[e[r++]]);a.push(o)}return{clusters:a,noisePoints:i}}function Ut(t,e,r,n,i,o,a,s){this.b=t,this.zoom=e,this.a=r,this.g=a,this.c=s,a=3*(t=r.length),s=new(x.Float64Array||Array)(a);for(var u;t--;)u=r[t],s[--a]=u.lat,s[--a]=u.lng,s[--a]=u.wt;ee.call(this,"cluster",{message:[s,n,i,e,o]},void 0)}function Wt(t,e,r){this.c=t,this.a=e,this.f=r}function Xt(t,e,r,n){this.c=t,this.a=e,this.j=r,this.o=n,this.g=Ia(this.g,this),this.f=Ia(this.f,this)}function Yt(t,e,r,n,i,o){this.g=e,t&&(this.parent=t,1&e?(r=t[8],i=t[5]):(r=t[7],i=t[8]),2&e?(n=t[9],o=t[6]):(n=t[4],o=t[9])),this[7]=r,this[5]=i,this[8]=(r+i)/2,this[4]=n,this[6]=o,this[9]=(n+o)/2}function Zt(t,e){return t[e]||(++t.oe,t[e]=new Yt(t,e))}function $t(t,e,r,n){var i,o;if(!e(t,n)&&r--)for(++n,i=0;4>i;i++)(o=t[i])&&$t(o,e,r,n)}function au(t){this.b=t||10,this.a=null,bu(this)}function bu(t){t.head=t.a=new Yt(null,NaN,0,0,4294967296,4294967296)}function cu(t,e){var r,n;for(r=0;4>r;r++)(n=e[r])&&(cu(t,n),delete e[r]);delete e.parent,delete e.entries}function du(t,e){var r,n=t.head;if(e){var i=e;if(i!==n)for(n=i;i=i.parent;)(i.entries||1<i.oe)&&(n=i)}else for(;!n.entries&&2>(r=n.oe)&&r;)n=i;t.head=n}function eu(t,e,r,n,i,o,a){var s=e.entries;if(o)if(e.oe)s=eu(t,Zt(e,r>=e[8]|(n>=e[9])<<1),r,n,i,o-1,a);else if(s){var u=Zt(e,(s=s[0])[1]>=e[8]|(s[0]>=e[9])<<1);u.entries=e.entries,u.Je=e.Je,u.Ke=e.Ke,u.Kb=e.Kb,u.a=e.a,u.f=e.f,u.b=e.b,u.c=e.c,delete e.entries,s.node=u,du(t,u),s=eu(t,Zt(e,r>=e[8]|(n>=e[9])<<1),r,n,i,o-1,a)}else o=s=new fu(r,n,i,a),(e.entries||(e.entries=[])).push(o),du(t,e);else s||du(t,e),t=s=new fu(r,n,i,a),(e.entries||(e.entries=[])).push(t);return e.Je+=r*i,e.Ke+=n*i,e.Kb+=i,e.a===B?(e.a=e.b=r,e.f=e.c=n):(r<e.a?e.a=r:r>e.b&&(e.b=r),n<e.f?e.f=n:n>e.c&&(e.c=n)),s}function fu(t,e,r,n){this[0]=e,this[1]=t,this.a=r,this.data=n}function gu(t){Mt.call(this,t),t=this.g,this.j=t.projection,this.o=t.min,this.f=t.max,this.m=t.minWeight,this.c=7-xd(Bd(wd(1,t.eps))/Ld),this.i=new au(wd(this.o,this.f+this.c))}function hu(t,e,r,n,i,o,a){var s,u=e.Kb;if(a&&(a.node.Kb!==u?(o.clusters.push(new Xt(t,a.node,a.depth,r-1)),a=null):i++),a||(u>=t.m?(a={node:e,depth:r},i=r):iu(t,e,i+1,o)),e.oe&&n--)for(r++,u=0;4>u;u++)(s=e[u])&&(hu(t,s,r,n,i,o,a),a=null);a&&o.clusters.push(new Xt(t,a.node,a.depth,t.f+t.c))}function iu(t,e,r,n){var i;if(e=e.entries){var o=e.length;for(n=n.noisePoints,i=0;i<o;i++)n.push(new Wt(t,e[i],r))}else for(i=0;4>i;i++)(o=t[i])&&iu(t,o,r,n)}function ju(t,e,r,n){this.lat=t,this.lng=e,this.wt=r===+r?r:1,this.data=n}function ku(t,e){var r={},n=(e=e||{}).min||0;switch(n={min:n,max:wd(n,e.max||22)},ku.l.constructor.call(this,n),this.kb=e.pixelRatio||Se(),Wa(r,Nt,n,e.clusteringOptions||{}),r.minWeight=wd(Nt.minWeight,r.minWeight),r.strategy){case lu.DYNAMICGRID:if(r.projection!==Xi)throw new D(ku,1,"Unsupported projection");this.a=new St(r);break;case lu.GRID:this.a=new Pt(r);break;default:this.a=new gu(r)}this.a.Oc(t),this.C=e.theme||new Qt(this.kb),this.ma=A(this.ma,this),this.Xa=A(this.Xa,this),mu(this)}St.prototype.u=function(){St.l.u.call(this)},u(Ut,Pf),t("H.clustering.fastgrid.NoisePoint",Wt),Wt.prototype.Ca=function(){return this.b||(this.b=this.c.Sa(this.a[1],this.a[0],1)),this.b},Wt.prototype.getPosition=Wt.prototype.Ca,Wt.prototype.Ec=function(){return this.a.a},Wt.prototype.getWeight=Wt.prototype.Ec,Wt.prototype.Bd=ef,Wt.prototype.isCluster=Wt.prototype.Bd,Wt.prototype.Ac=function(){return this.f-this.c.c},Wt.prototype.getMinZoom=Wt.prototype.Ac,Wt.prototype.getData=function(){return this.a.data},Wt.prototype.getData=Wt.prototype.getData,t("H.clustering.fastgrid.Cluster",Xt),Xt.prototype.Ca=function(){return this.b||(this.b=this.c.Sa(this.a.Je,this.a.Ke,this.a.Kb)),this.b},Xt.prototype.getPosition=Xt.prototype.Ca,Xt.prototype.Ec=function(){return this.a.Kb},Xt.prototype.getWeight=Xt.prototype.Ec,Xt.prototype.Bd=df,Xt.prototype.isCluster=Xt.prototype.Bd,Xt.prototype.Ac=function(){return this.j?this.j-this.c.c:-1/0},Xt.prototype.getMinZoom=Xt.prototype.Ac,Xt.prototype.cg=function(){return this.o-this.c.c},Xt.prototype.getMaxZoom=Xt.prototype.cg,Xt.prototype.G=function(){return this.R||(this.R=dg(this.c.Sa(this.a.a,this.a.f,1),this.c.Sa(this.a.b,this.a.c,1),!0)),this.R},Xt.prototype.getBoundingBox=Xt.prototype.G,Xt.prototype.qh=function(t){this.i=t,this.a.Uc(this.g,Td)},Xt.prototype.forEachEntry=Xt.prototype.qh,Xt.prototype.g=function(t,e){var r,n,i=!1;if(t.Kb>=this.c.m&&t!==this.a&&t.Kb!==this.a.Kb&&(this.i(new Xt(this.c,t,0,e)),i=!0),!i&&(r=t.entries))for(t=r.length,n=0;n<t;n++)this.i(new Wt(this.c,r[n],e));return i},Xt.prototype.Se=function(t){this.m=t,this.a.Uc(this.f,Td)},Xt.prototype.forEachDataPoint=Xt.prototype.Se,Xt.prototype.f=function(t,e){var r;if(t=t.entries){var n=t.length;for(r=0;r<n;r++)this.m(new Wt(this.c,t[r],e))}return!1},n=Yt.prototype,n.oe=0,n.removeChild=function(t){var e=t.g;this[e]===t&&(delete this[e],delete t.parent,--this.oe)},n.Uc=function(t,e){for(var r=0,n=this;n=n.parent;)++r;$t(this,t,e,r)},n.Je=0,n.Ke=0,n.Kb=0,au.prototype.Fc=function(t,e,r,n){var i=this.a;if(!(t>=i[7]&&e>=i[4]&&t<=i[5]&&e<=i[6]))throw Error("Coordinates out of bounds");return eu(this,this.a,t,e,r,this.b,n)},au.prototype.Uc=function(t,e){$t(this.a,t,e===+e?e:this.b,0)},u(gu,Mt),n=gu.prototype,n.Oc=function(t){var e,r=0,n=t.length,i=new I(0,0),o=this.j,a=this.i;for(gu.l.Oc.call(this,t),cu(a,a.a),bu(a);r<n;r++)o.$c(e=t[r],i).scale(4294967296).floor(),a.Fc(i.x,i.y,e.wt,e.data);this.b=!0},n.Ib=function(t){gu.l.Ib.call(this,t),this.Oc(this.a)},n.Gf=function(t){for(var e=t.length,r=gu.l.Ib;e--;)r.call(this,t[e]);this.Oc(this.a)},n.qf=function(t){gu.l.qf.call(this,t),this.Oc(this.a)},n.Sa=function(t,e,r,n){return this.j.Sa(t/r/4294967296,e/r/4294967296,n)},n.Ui=function(t){if(this.b){var e={clusters:[],noisePoints:[]};hu(this,this.i.a,0,this.f+this.c,-1/0,e,null),this.b=!1,t(e)}},n.u=function(){gu.l.u.call(this),this.i=null},t("H.clustering.DataPoint",ju),ju.prototype.vk=NaN,ju.prototype.xk=NaN,u(ku,N),t("H.clustering.Provider",ku),ku.prototype.u=function(){ku.l.u.call(this),this.c.qa(),this.a.B(),this.C=this.N=this.a=null,x.clearTimeout(this.W)};var lu={FASTGRID:0,GRID:1,DYNAMICGRID:2};function mu(t,e,r){t.W&&x.clearTimeout(t.W),e&&t.a.sl(e,r),t.W=x.setTimeout(t.ma,150)}function nu(t){var e=t.N.clusters,r=t.N.noisePoints,n=e.length,i=r.length,o=0<n+i;for(t.c.qa();i--;){var a=r[i];t.c.ea(t.C.getNoisePresentation(a))}for(;n--;)r=e[n],t.c.ea(t.C.getClusterPresentation(r));o&&Wj(t)}function ou(t,e){t:{for(var r=t.length,n="string"==typeof t?t.split(""):t,i=0;i<r;i++)if(i in n&&e.call(void 0,n[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}ku.Strategy=lu,ku.prototype.ma=function(){this.dispatchEvent("start"),this.a.Ui(this.Xa,hd)},ku.prototype.Xa=function(t){this.dispatchEvent("end"),this.N=t,nu(this)},ku.prototype.Oc=function(t){this.a.Oc(t),mu(this)},ku.prototype.setDataPoints=ku.prototype.Oc,ku.prototype.Ib=function(t){this.a.Ib(t),mu(this)},ku.prototype.addDataPoint=ku.prototype.Ib,ku.prototype.Gf=function(t){this.a.Gf(t),mu(this)},ku.prototype.addDataPoints=ku.prototype.Gf,ku.prototype.qf=function(t){this.a.qf(t),mu(this)},ku.prototype.removeDataPoint=ku.prototype.qf,ku.prototype.Ln=function(){return this.C},ku.prototype.getTheme=ku.prototype.Ln,ku.prototype.bp=function(t){this.C=t,this.N&&(this.c.qa(),nu(this))},ku.prototype.setTheme=ku.prototype.bp,ku.prototype.Vb=function(){return!0},ku.prototype.providesDomMarkers=ku.prototype.Vb,ku.prototype.Wb=function(){return!0},ku.prototype.providesMarkers=ku.prototype.Wb,ku.prototype.Jc=function(){return!0},ku.prototype.providesSpatials=ku.prototype.Jc,ku.prototype.nf=function(t,e){mu(this,t,e)},ku.prototype.preprocessData=ku.prototype.nf,t("H.clustering.buildInfo",function(){return Ef("H-clustering","1.30.7","5f44999")});var pu={};function qu(t){var e=t.ownerDocument,r=e.documentElement;e=e.defaultView;var n=t.getBoundingClientRect();return t=n.left,n=n.top,isNaN(e.pageXOffset)?(t+=r.scrollLeft,n+=r.scrollTop):(t+=e.pageXOffset,n+=e.pageYOffset),new I(t,n)}function ru(t,e,r){e=Cc(e)?e+"px":e,r=Cc(r)?r+"px":r,t.style[xf("transform")]="translate("+e+","+r+")"}var su={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",LEFT_TOP:"left-top",LEFT_MIDDLE:"left-middle",LEFT_BOTTOM:"left-bottom",RIGHT_TOP:"right-top",RIGHT_MIDDLE:"right-middle",RIGHT_BOTTOM:"right-bottom",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"};function tu(t,e){var r={},n={};r["top-left"]=uu(e,"div",[vu,wu].join(" ")),r["top-center"]=uu(e,"div",[vu,xu,yu,wu].join(" ")),r["top-right"]=uu(e,"div",[vu,wu].join(" ")),r["left-top"]=uu(e,"div",[vu,zu].join(" ")),r["left-middle"]=uu(e,"div",[vu,Au,Bu,zu].join(" ")),r["left-bottom"]=uu(e,"div",[vu,zu].join(" ")),r["right-top"]=uu(e,"div",[vu,zu].join(" ")),r["right-middle"]=uu(e,"div",[vu,Cu,Bu,zu].join(" ")),r["right-bottom"]=uu(e,"div",[vu,zu].join(" ")),r["bottom-left"]=uu(e,"div",[vu,wu].join(" ")),r["bottom-center"]=uu(e,"div",[vu,Du,yu,wu].join(" ")),r["bottom-right"]=uu(e,"div",[vu,wu].join(" ")),n["top-left"]=uu(e,"div",[xu,Au].join(" ")),n["top-right"]=uu(e,"div",[xu,Cu].join(" ")),n["bottom-left"]=uu(e,"div",[Du,Au].join(" ")),n["bottom-right"]=uu(e,"div",[Du,Cu].join(" ")),Eu(n["top-left"],r["top-left"],r["left-top"]),Eu(n["top-right"],r["top-right"],r["right-top"]),Eu(n["bottom-left"],r["left-bottom"],r["bottom-left"]),Eu(n["bottom-right"],r["right-bottom"],r["bottom-right"]),Eu(t,n["top-left"],n["top-right"],n["bottom-left"],n["bottom-right"],r["top-center"],r["left-middle"],r["right-middle"],r["bottom-center"]),this.a=r}t("H.ui.LayoutAlignment",su);var xu="H_l_top",Du="H_l_bottom",Au="H_l_left",Cu="H_l_right",yu="H_l_center",Bu="H_l_middle",wu="H_l_horizontal",zu="H_l_vertical",vu="H_l_anchor";function Fu(t,e){e?(e=t.offsetWidth,t.style.marginLeft=-Math.round(.5*e)+"px"):(e=t.offsetHeight,t.style.marginTop=-Math.round(.5*e)+"px")}tu.prototype.update=function(){var t=this.a;Fu(t["top-center"],!0),Fu(t["bottom-center"],!0),Fu(t["left-middle"],!1),Fu(t["right-middle"],!1)},tu.prototype.put=function(t,e){t=t?t.L():null;var r=e?this.a[e]:null;t&&r&&(t.parentElement&&t.parentElement.removeChild(t),r.insertBefore(t,/(bottom|right)$/.test(e)||/(center|middle)/.test(e)&&r.childNodes.length%2?r.firstChild:null)),this.update()};var Gu={IMPERIAL:"imperial",METRIC:"metric"};t("H.ui.UnitSystem",Gu);var Hu,Iu=navigator.userAgent,Ju=-1<Iu.indexOf("Android")&&-1<Iu.indexOf("Mozilla/5.0")&&-1<Iu.indexOf("AppleWebKit"),Ku=/AppleWebKit\/([\d.]+)/,Lu=null===Ku.exec(Iu)?null:parseFloat(Ku.exec(Iu)[1]);Hu=Ju&&null!==Lu&&537>Lu;var Mu=globalThis,Nu=document.createElement("T");function Ou(){this.a=this.Gj()}Ou.prototype.Gj=function(){var t=Mu.navigator,e=[];return t&&(t.msPointerEnabled?e.push(Pu):t.pointerEnabled&&e.push(Qu)),1>e.length&&("TouchEvent"in Mu&&e.push(Ru),e.push(Su)),e},Ou.prototype.detectEventSets=Ou.prototype.Gj,Ou.prototype.addEventListener=function(t,e,r,n){for(var i,o=this.a,a=o.length,s=!1;a--;)(i=o[a][e])&&(s=!0,t.addEventListener(i,r,n||!1));s||t.addEventListener(e,r,n||!1)},Ou.prototype.removeEventListener=function(t,e,r,n){for(var i,o=this.a,a=o.length,s=!1;a--;)(i=o[a][e])&&(s=!0,t.removeEventListener(i,r,n||!1));s||t.removeEventListener(e,r,n||!1)};var Qu={start:"pointerdown",end:"pointerup",move:"pointermove",cancel:"pointercancel",over:"pointerover",out:"pointerout",hover:"pointerhover"},Pu={start:"MSPointerDown",end:"MSPointerUp",move:"MSPointerMove",cancel:"MSPointerCancel",over:"MSPointerOver",out:"MSPointerOut",hover:"MSPointerHover"},Ru={start:"touchstart",end:"touchend",move:"touchmove",cancel:"touchcancel"},Su={start:"mousedown",end:"mouseup",move:"mousemove",over:"mouseover",out:"mouseout",hover:"mousehover"};function uu(t,e,r,n){return t=t.createElement(e),r&&(t.className=r),n&&(t.innerHTML=n),t}function Eu(t,e){for(var r=1,n=arguments.length;r<n;r++)t.appendChild(arguments[r])}var Tu=new Ou;function Uu(t,e,r){Tu.addEventListener(t,e,r,void 0)}function Vu(t,e,r){Tu.removeEventListener(t,e,r,void 0)}var Wu=[];t("H.ui.i18n.defaultLocales",Wu);var Xu={},Yu=[];function Zu(t,e){Xu[t]=e,-1===Wu.indexOf(t)&&Wu.push(t),Yu.length?$u(t,e):Yu=Object.keys(e)}function $u(t,e){for(var r,n=Yu,i=n.length;i--;)if(!e[r=n[i]])throw Error("'"+r+"' key missing in translation map for "+t)}function av(t,e){if(!zc(t))throw new TypeError("string locale code required");if(Da(e))$u(t,e);else{if(-1===Wu.indexOf(t))throw Error("Default locale '"+t+"' does nto exist.");e=Xu[t]}this.a=e||{},this.b=t}function Z(t,e){F.call(this),this.Ra=t||"div",this.g=e?e.split(" "):[],this.J=!1,this.g.push("H_el")}function bv(t){(t=t.L())&&t.parentNode&&t.parentNode.removeChild(t)}function cv(t,e,r){Z.call(this,t,e),this.b=r?r.concat():[]}function dv(t){C(t,Oe,dv,1),Z.call(this,"div","H_context_menu_item"),this.b=t,this.f=A(this.f,this),this.a=A(this.a,this),this.b.addEventListener("update",this.a)}function ev(t){C(t,Array,ev,1),cv.call(this,"div","H_context_menu"),this.f=t,this.a=null}function fv(t,e){e=e||{};var r=this;Z.call(this,"div","H_ib H_ib_top"),this.v=A(function(t){r.mc()||(r.close(),t.preventDefault())},this),this.update=A(this.update,this),this.i=A(this.i,this),this.setPosition(t),this.xf(e.content),e.onStateChange&&this.addEventListener("statechange",e.onStateChange),this.P(gv.OPEN)}Zu("nl-NL",{"layers.normal":"Kaartweergave","layers.satellite":"Satelliet","layers.terrain":"Terrein","layer.transit":"Openbaar vervoer","layer.traffic":"Verkeerssituatie","layer.incidents":"Toon verkeersincidenten","layers.choose":"Weergave kiezen",minimap:"Minimap","scale.switchToImperial":"Overgaan naar mijlen","scale.switchToMetric":"Wijzigen naar km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Uitzoomen","zoom.in":"Inzoomen","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Openbaar vervoer","traffic.MISCELLANEOUS":"Diversen","traffic.ACCIDENT":"Ongeval","traffic.OTHER_NEWS":"Meer informatie","traffic.PLANNED_EVENT":"Geplande afzetting","traffic.ROAD_HAZARD":"Gevaar op de weg","traffic.ROAD_CLOSURE":"Rijbaan afgesloten","traffic.WEATHER":"Weer","traffic.CONGESTION":"Verkeersopstopping","traffic.CONSTRUCTION":"Wegwerkzaamheden","traffic.DISABLED_VEHICLE":"Voertuig met pech","traffic.from":"Begintijd:","traffic.until":"Geschatte eindtijd:","distance.measurement":"Measure distance"}),Zu("pt-PT",{"layers.normal":"Vista do mapa","layers.satellite":"Satélite","layers.terrain":"Terreno","layer.transit":"Transportes públicos","layer.traffic":"Condições de trânsito","layer.incidents":"Mostrar incidentes de trânsito","layers.choose":"Escolher vista",minimap:"Minimap","scale.switchToImperial":"Mudar para milhas","scale.switchToMetric":"Mudar para km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Diminuir","zoom.in":"Aumentar","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transportes públicos","traffic.MISCELLANEOUS":"Diversos","traffic.ACCIDENT":"Acidente","traffic.OTHER_NEWS":"Outras notícias","traffic.PLANNED_EVENT":"Evento planeado","traffic.ROAD_HAZARD":"Perigo na estrada","traffic.ROAD_CLOSURE":"Estrada fechada","traffic.WEATHER":"Meteorologia","traffic.CONGESTION":"Congestionamento","traffic.CONSTRUCTION":"Construção","traffic.DISABLED_VEHICLE":"Veículo avariado","traffic.from":"Hora de início:","traffic.until":"Hora de fim prevista:","distance.measurement":"Measure distance"}),Zu("ru-RU",{"layers.normal":"Режим карты","layers.satellite":"Спутниковая","layers.terrain":"Местность","layer.transit":"Общественный транспорт","layer.traffic":"Дорожные условия","layer.incidents":"Показать дорожные события","layers.choose":"Выберите вид",minimap:"Minimap","scale.switchToImperial":"Использовать мили","scale.switchToMetric":"Использовать километры","scale.km":"км","scale.m":"м","scale.mi":"миль","scale.ft":"фут","zoom.out":"Отдалить","zoom.in":"Приблизить","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Общественный транспорт","traffic.MISCELLANEOUS":"Прочее ДТП","traffic.ACCIDENT":"ДТП","traffic.OTHER_NEWS":"Другие новости","traffic.PLANNED_EVENT":"Плановое мероприятие","traffic.ROAD_HAZARD":"Дорожная опасность","traffic.ROAD_CLOSURE":"Дорога закрыта","traffic.WEATHER":"Погода","traffic.CONGESTION":"Пробка","traffic.CONSTRUCTION":"Ремонт","traffic.DISABLED_VEHICLE":"Неисправный автомобиль","traffic.from":"Время начала:","traffic.until":"Ожидаемое время окончания:","distance.measurement":"Измерить расстояние"}),Zu("fi-FI",{"layers.normal":"Karttanäkymä","layers.satellite":"Satelliitti","layers.terrain":"Maasto","layer.transit":"Julkinen liikenne","layer.traffic":"Liikenneolosuhteet","layer.incidents":"Näytä liikennetapahtumat","layers.choose":"Valitse näkymä",minimap:"Minimap","scale.switchToImperial":"Vaihda maileihin","scale.switchToMetric":"Vaihda kilometreihin","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Loitonna","zoom.in":"Lähennä","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Julkinen liikenne","traffic.MISCELLANEOUS":"Erittelemätön syy","traffic.ACCIDENT":"Onnettomuus","traffic.OTHER_NEWS":"Muu tapahtuma","traffic.PLANNED_EVENT":"Suunniteltu tapahtuma","traffic.ROAD_HAZARD":"Vaara tiellä","traffic.ROAD_CLOSURE":"Tie suljettu","traffic.WEATHER":"Sää","traffic.CONGESTION":"Ruuhka","traffic.CONSTRUCTION":"Rakennustyö","traffic.DISABLED_VEHICLE":"Pysähtynyt ajoneuvo","traffic.from":"Alkamisaika:","traffic.until":"Arvioitu päättymisaika:","distance.measurement":"Measure distance"}),Zu("pt-BR",{"layers.normal":"Exibição do mapa","layers.satellite":"Satélite","layers.terrain":"Terreno","layer.transit":"Transporte público","layer.traffic":"Condições do trânsito","layer.incidents":"Mostrar incidentes no trânsito","layers.choose":"Escolher exibição",minimap:"Minimap","scale.switchToImperial":"Mudar para milhas","scale.switchToMetric":"Mudar para km","scale.km":"km","scale.m":"m","scale.mi":"milhas","scale.ft":"pés","zoom.out":"Menos zoom","zoom.in":"Mais zoom","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transporte público","traffic.MISCELLANEOUS":"Miscelânea","traffic.ACCIDENT":"Acidente","traffic.OTHER_NEWS":"Outras notícias","traffic.PLANNED_EVENT":"Evento planejado","traffic.ROAD_HAZARD":"Risco na estrada","traffic.ROAD_CLOSURE":"Estrada fechada","traffic.WEATHER":"Clima","traffic.CONGESTION":"Congestionamento","traffic.CONSTRUCTION":"Construção","traffic.DISABLED_VEHICLE":"Veículo incapacitado","traffic.from":"Hora de início:","traffic.until":"Tempo final estimado:","distance.measurement":"Measure distance"}),Zu("zh-CN",{"layers.normal":"地图视图","layers.satellite":"卫星","layers.terrain":"地形","layer.transit":"公共交通","layer.traffic":"交通情况","layer.incidents":"显示交通事件","layers.choose":"选择视图",minimap:"Minimap","scale.switchToImperial":"切换为「英里」","scale.switchToMetric":"切换为「公里」","scale.km":"公里","scale.m":"米","scale.mi":"英里","scale.ft":"英尺","zoom.out":"缩小","zoom.in":"放大","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"公共交通","traffic.MISCELLANEOUS":"综合事件","traffic.ACCIDENT":"交通意外","traffic.OTHER_NEWS":"其他新闻","traffic.PLANNED_EVENT":"预定事件","traffic.ROAD_HAZARD":"道路危险","traffic.ROAD_CLOSURE":"道路已关闭","traffic.WEATHER":"天气","traffic.CONGESTION":"堵塞","traffic.CONSTRUCTION":"施工","traffic.DISABLED_VEHICLE":"车辆抛锚","traffic.from":"开始时间：","traffic.until":"预计结束时间：","distance.measurement":"Measure distance"}),Zu("es-ES",{"layers.normal":"Mapa","layers.satellite":"Satélite","layers.terrain":"Terreno","layer.transit":"Transporte público","layer.traffic":"Estado del tráfico","layer.incidents":"Mostrar incidentes de tráfico","layers.choose":"Elija una vista",minimap:"Minimap","scale.switchToImperial":"Cambiar a millas","scale.switchToMetric":"Cambiar a km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Alejar","zoom.in":"Acercar","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transporte público","traffic.MISCELLANEOUS":"Varios","traffic.ACCIDENT":"Accidente","traffic.OTHER_NEWS":"Más noticias","traffic.PLANNED_EVENT":"Acto programado","traffic.ROAD_HAZARD":"Riesgo en carretera","traffic.ROAD_CLOSURE":"Carretera cerrada","traffic.WEATHER":"Tiempo","traffic.CONGESTION":"Atasco","traffic.CONSTRUCTION":"Construcción","traffic.DISABLED_VEHICLE":"Vehículo averiado","traffic.from":"Inicio:","traffic.until":"Finalización estimada:","distance.measurement":"Measure distance"}),Zu("fr-FR",{"layers.normal":"Carte","layers.satellite":"Satellite","layers.terrain":"Terrain","layer.transit":"Transports publics","layer.traffic":"Conditions de circulation","layer.incidents":"Afficher les incidents de circulation","layers.choose":"Choisir la vue",minimap:"Minimap","scale.switchToImperial":"Passer en miles","scale.switchToMetric":"Passer en km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom arrière","zoom.in":"Zoom avant","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transports publics","traffic.MISCELLANEOUS":"Divers","traffic.ACCIDENT":"Accident","traffic.OTHER_NEWS":"Autre","traffic.PLANNED_EVENT":"Événement prévu","traffic.ROAD_HAZARD":"Danger routier","traffic.ROAD_CLOSURE":"Chaussée fermée","traffic.WEATHER":"Météo","traffic.CONGESTION":"Embouteillage","traffic.CONSTRUCTION":"Travaux","traffic.DISABLED_VEHICLE":"Véhicule en panne","traffic.from":"Date ou heure de début:","traffic.until":"Date et heure de fin estimées:","distance.measurement":"Measure distance"}),Zu("pl-PL",{"layers.normal":"Widok mapy","layers.satellite":"Satelita","layers.terrain":"Teren","layer.transit":"Transport publiczny","layer.traffic":"Warunki drogowe","layer.incidents":"Pokaż zdarzenia drogowe","layers.choose":"Wybierz widok",minimap:"Minimap","scale.switchToImperial":"Zmień na mile","scale.switchToMetric":"Zmień na km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Oddal","zoom.in":"Przybliż","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transport publiczny","traffic.MISCELLANEOUS":"Inne zdarzenie","traffic.ACCIDENT":"Wypadek","traffic.OTHER_NEWS":"Inne wiadomości","traffic.PLANNED_EVENT":"Zdarzenie planowane","traffic.ROAD_HAZARD":"Niebezpieczeństwo na drodze","traffic.ROAD_CLOSURE":"Jezdnia zamknięta","traffic.WEATHER":"Pogoda","traffic.CONGESTION":"Korek","traffic.CONSTRUCTION":"Budowa","traffic.DISABLED_VEHICLE":"Uszkodzony pojazd","traffic.from":"Data rozpoczęcia:","traffic.until":"Przybliżona data zakończenia:","distance.measurement":"Measure distance"}),Zu("de-DE",{"layers.normal":"Kartenansicht","layers.satellite":"Satellit","layers.terrain":"Gelände","layer.transit":"Öffentliche Verkehrsmittel","layer.traffic":"Verkehrslage","layer.incidents":"Verkehrsstörungen anzeigen","layers.choose":"Ansicht auswählen",minimap:"Minimap","scale.switchToImperial":"Umrechnung in Meilen","scale.switchToMetric":"Umrechnung in Kilometer","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Verkleinern","zoom.in":"Vergrößern","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Öffentliche Verkehrsmittel","traffic.MISCELLANEOUS":"Diverse","traffic.ACCIDENT":"Unfall","traffic.OTHER_NEWS":"Anderes Ereignis","traffic.PLANNED_EVENT":"Geplantes Ereignis","traffic.ROAD_HAZARD":"Verkehrshindernis","traffic.ROAD_CLOSURE":"Fahrbahn gesperrt","traffic.WEATHER":"Wetter","traffic.CONGESTION":"Verkehrsstau","traffic.CONSTRUCTION":"Baustelle","traffic.DISABLED_VEHICLE":"Liegengebliebenes Fahrzeug","traffic.from":"Beginn:","traffic.until":"Voraussichtliches Ende:","distance.measurement":"Measure distance"}),Zu("tr-TR",{"layers.normal":"Harita görünümü","layers.satellite":"Uydu","layers.terrain":"Arazi","layer.transit":"Toplu ulaşım","layer.traffic":"Trafik durumları","layer.incidents":"Trafik olaylarını göster","layers.choose":"Görünüm seç",minimap:"Minimap","scale.switchToImperial":"Mile dönüştür","scale.switchToMetric":"Kilometreye dönüştür","scale.km":"km","scale.m":"m","scale.mi":"mil","scale.ft":"ft","zoom.out":"Uzaklaştır","zoom.in":"Yakınlaştır","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Toplu ulaşım","traffic.MISCELLANEOUS":"Çeşitli","traffic.ACCIDENT":"Kaza","traffic.OTHER_NEWS":"Diğer haberler","traffic.PLANNED_EVENT":"Planlı etkinlik","traffic.ROAD_HAZARD":"Yol tehlikesi","traffic.ROAD_CLOSURE":"Yol kapalı","traffic.WEATHER":"Hava durumu","traffic.CONGESTION":"Yoğunluk","traffic.CONSTRUCTION":"Yol çalışması","traffic.DISABLED_VEHICLE":"Araç arızası","traffic.from":"Başlangıç zamanı:","traffic.until":"Tahmini bitiş zamanı:","distance.measurement":"Measure distance"}),Zu("it-IT",{"layers.normal":"Vista mappa","layers.satellite":"Satellite","layers.terrain":"Terreno","layer.transit":"Mezzi pubblici","layer.traffic":"Condizioni del traffico","layer.incidents":"Mostra incidenti stradali","layers.choose":"Scegli vista",minimap:"Minimap","scale.switchToImperial":"Passa a miglia","scale.switchToMetric":"Passa a km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom indietro","zoom.in":"Zoom avanti","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Mezzi pubblici","traffic.MISCELLANEOUS":"Varie","traffic.ACCIDENT":"Incidente","traffic.OTHER_NEWS":"Altre notizie","traffic.PLANNED_EVENT":"Evento pianificato","traffic.ROAD_HAZARD":"Strada dissestata","traffic.ROAD_CLOSURE":"Strada chiusa","traffic.WEATHER":"Maltempo","traffic.CONGESTION":"Ingorgo","traffic.CONSTRUCTION":"Lavori in corso","traffic.DISABLED_VEHICLE":"Veicolo in panne","traffic.from":"Ora di inizio:","traffic.until":"Ora di fine stimata:","distance.measurement":"Measure distance"}),Zu("en-US",{"layers.normal":"Map view","layers.satellite":"Satellite","layers.terrain":"Terrain","layer.transit":"Public transport","layer.traffic":"Traffic conditions","layer.incidents":"Show traffic incidents","layers.choose":"Choose view",minimap:"Minimap","scale.switchToImperial":"Change to miles","scale.switchToMetric":"Change to km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom out","zoom.in":"Zoom in","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Public transport","traffic.MISCELLANEOUS":"Miscellaneous","traffic.ACCIDENT":"Accident","traffic.OTHER_NEWS":"Other news","traffic.PLANNED_EVENT":"Planned event","traffic.ROAD_HAZARD":"Road hazard","traffic.ROAD_CLOSURE":"Roadway closed","traffic.WEATHER":"Weather","traffic.CONGESTION":"Congestion","traffic.CONSTRUCTION":"Construction","traffic.DISABLED_VEHICLE":"Disabled vehicle","traffic.from":"Start time:","traffic.until":"Estimated end time:","distance.measurement":"Measure distance"}),t("H.ui.i18n.Localization",av),av.prototype.mn=function(){return this.b},av.prototype.getLocale=av.prototype.mn,av.prototype.fn=function(){return Object.keys(this.a)},av.prototype.getKeys=av.prototype.fn,av.prototype.Kh=function(t){return!(!this.a||!this.a[t])},av.prototype.hasKey=av.prototype.Kh,av.prototype.translate=function(t){var e=this.a[t];if(!zc(e))throw Error("Translation missing for key '"+t+"'.");return e},av.prototype.translate=av.prototype.translate,u(Z,F),t("H.ui.base.Element",Z),Z.prototype.V=function(t){if(!t)throw Error("Wrong document object");return this.S=uu(t,this.Ra,this.g.join(" ")),this.renderInternal(this.S,t),this.Da(this.mc(),!0),this.sc(this.ma),this.wb(this.c),this.S},Z.prototype.fa=function(){},Z.prototype.N=function(){},Z.prototype.$=function(){},Z.prototype.renderInternal=Z.prototype.$,Z.prototype.mc=function(){return this.J},Z.prototype.isDisabled=Z.prototype.mc,Z.prototype.Da=function(t,e){return((t=!!t)!==this.J||e)&&((this.J=t)?this.La("H_disabled"):this.qb("H_disabled")),this},Z.prototype.setDisabled=Z.prototype.Da,Z.prototype.O=null,Z.prototype.getData=function(){return this.O},Z.prototype.getData=Z.prototype.getData,Z.prototype.setData=function(t){this.O=t},Z.prototype.setData=Z.prototype.setData,Z.prototype.sc=function(t){var e=this.L();this.ma=t,e&&(t?e.setAttribute("title",t):e.removeAttribute("title"))},Z.prototype.setTooltip=Z.prototype.sc,Z.prototype.S=null,Z.prototype.L=function(){return this.S},Z.prototype.getElement=Z.prototype.L,Z.prototype.c=!0,Z.prototype.wb=function(t){var e=this.L();this.c=t,e&&(e.style.display=t?"":"none")},Z.prototype.setVisibility=Z.prototype.wb,Z.prototype.Dc=function(){return this.c},Z.prototype.getVisibility=Z.prototype.Dc,Z.prototype.La=function(t){var e=this.L();return 0>this.g.indexOf(t)&&this.g.push(t),e&&(e.className=this.g.join(" ")),this},Z.prototype.addClass=Z.prototype.La,Z.prototype.qb=function(t){t=this.g.indexOf(t);var e=this.L();return-1<t&&this.g.splice(t,1),e&&(e.className=this.g.join(" ")),this},Z.prototype.removeClass=Z.prototype.qb,Z.prototype.u=function(){Z.l.u.call(this),bv(this),this.ma=this.O=this.S=null},u(cv,Z),t("H.ui.base.Container",cv),cv.prototype.Da=function(t,e){var r=this.b?this.b.length:0;for(Z.prototype.Da.call(this,t,e);r--;)this.b[r].Da(t,e);return this},cv.prototype.setDisabled=cv.prototype.Da,cv.prototype.Ka=function(t){var e=this.L();return this.b.push(t),e&&(t.V(e.ownerDocument),e.appendChild(t.L())),this},cv.prototype.addChild=cv.prototype.Ka,cv.prototype.vh=function(){return this.b.concat()},cv.prototype.getChildren=cv.prototype.vh,cv.prototype.removeChild=function(t){var e=this.b.indexOf(t),r=this.L();0<=e&&(this.b.splice(e,1),r&&r.removeChild(t.L()))},cv.prototype.removeChild=cv.prototype.removeChild,cv.prototype.qa=function(){var t=this.L();t&&this.b.forEach(function(e){t.removeChild(e.L())}),this.b=[]},cv.prototype.$=function(t,e){for(var r=0,n=this.b.length;r<n;r++)t.appendChild(this.b[r].V(e))},cv.prototype.renderInternal=cv.prototype.$,cv.prototype.u=function(){this.qa(),this.b.forEach(this.W,this),Z.prototype.u.call(this)},cv.prototype.W=function(t){t.B()},u(dv,Z),t("H.ui.context.Item",dv),dv.prototype.f=function(t){var e=this.b,r=e.callback;r&&!e.isDisabled()&&(this.dispatchEvent("click"),r(t))},dv.prototype.$=function(){var t=this,e=this.L();Be(e,"click",this.f),e.addEventListener("keyup",function(e){13==e.keyCode&&t.f(e)}),this.a()},dv.prototype.renderInternal=dv.prototype.$,dv.prototype.a=function(){var t=this.L(),e=this.b;e.callback?(this.La("clickable"),t.setAttribute("tabindex","0")):(this.qb("clickable"),t.removeAttribute("tabindex")),e.isDisabled()?this.La("disabled"):this.qb("disabled"),e=e.getLabel(),Nu.textContent=e,t.innerHTML=Nu.innerHTML.split("\n").join("<br/>")},dv.prototype.u=function(){Z.prototype.u.call(this),this.b.removeEventListener("update",this.a)},u(ev,cv),t("H.ui.context.Menu",ev),ev.prototype.$=function(){cv.prototype.$.apply(this,arguments),this.f.forEach(function(t){t===Pe?t=new Z("div","H_context_menu_item_separator"):(t=new dv(t)).addEventListener("click",this.i.bind(this)),this.Ka(t)},this),Be(this.L(),["mousedown","touchstart","pointerdown","wheel"],function(t){t.stopPropagation()})},ev.prototype.renderInternal=ev.prototype.$,ev.prototype.setPosition=function(t,e){if(this.a){var r=this.L(),n=r.offsetWidth,i=r.offsetHeight,o=this.a,a=o.ya.width;o=o.ya.height,t+n>a&&t>a/2&&(t-=n),e+i>o&&e>o/2&&(e-=i),ru(r,t,e)}},ev.prototype.setPosition=ev.prototype.setPosition,ev.prototype.i=function(){this.a&&this.a.dispatchEvent(new rd("contextmenuclose",this.a))},ev.prototype.Ja=function(t){this.a=t},ev.prototype.setMap=ev.prototype.Ja,u(fv,Z),t("H.ui.InfoBubble",fv),fv.prototype.a=null,fv.prototype.Ca=function(){return this.b},fv.prototype.setPosition=function(t){this.b=Zf(t),this.update()},fv.prototype.setPosition=fv.prototype.setPosition,fv.prototype.Ja=function(t){this.a=t},fv.prototype.$=function(t,e){this.o=uu(e,"div","H_ib_body"),this.tailEl_=uu(e,"div","H_ib_tail"),this.j=uu(e,"div","H_ib_close H_btn",hv),this.f=uu(e,"div","H_ib_content","&nbsp;"),this.o.appendChild(this.j),this.o.appendChild(this.f),Uu(this.j,"start",this.v),this.a.b.addEventListener("sync",this.update),this.a.ya.addEventListener("sync",this.update),this.a.addEventListener("enginechange",this.i),t.appendChild(this.o),t.appendChild(this.tailEl_),this.xf(this.m)},fv.prototype.renderInternal=fv.prototype.$,fv.prototype.i=function(){this.s||(this.s=setTimeout(this.update,0))},fv.prototype.update=function(){var t,e=this.L(),r=this.a,n="none";if(this.s=0,r&&e&&this.getState()===gv.OPEN){if(t=r.Fa(this.b)){var i=t.x;t=t.y,(i>=-(r=r.ya.width)||i<=2*r||t>=-r||t<=2*r)&&(n="",Hu?(e.style.left=i-r+"px",e.style.top=t+"px"):ru(e,i,t))}e.style.display=n,""===n&&(e.style.visibility="visible")}};var gv={OPEN:"open",CLOSED:"closed"};fv.State=gv,fv.prototype.A=gv.OPEN,fv.prototype.getState=function(){return this.A},fv.prototype.getState=fv.prototype.getState,fv.prototype.P=function(t){t!==this.A&&(this.A=t,this.dispatchEvent("statechange")),(t=this.L())&&(this.A===gv.OPEN?(t.style.display="block",t.style.visibility="hidden",this.i()):t.style.display="none")},fv.prototype.setState=fv.prototype.P,fv.prototype.close=function(){this.P(gv.CLOSED)},fv.prototype.close=fv.prototype.close,fv.prototype.open=function(){this.P(gv.OPEN)},fv.prototype.open=fv.prototype.open,fv.prototype.Km=function(){return this.f||null},fv.prototype.getContentElement=fv.prototype.Km,fv.prototype.xf=function(t){if(t){if("string"!=typeof t&&("number"!=typeof t.nodeType||"string"!=typeof t.nodeName))throw Error("InfoBubble content must be a string or HTML node.");this.m=t}else this.m=void 0;this.L()&&(this.m?(this.f.innerHTML="","string"==typeof this.m?this.f.innerHTML=t:"number"==typeof t.nodeType&&"string"==typeof t.nodeName&&this.f.appendChild(t)):this.f.innerHTML="&nbsp;",this.i())},fv.prototype.setContent=fv.prototype.xf,fv.prototype.u=function(){this.close(),this.xf(null),this.j&&Vu(this.j,"end",this.v),this.a&&(this.a.b.removeEventListener("sync",this.update),this.a.ya.removeEventListener("sync",this.update)),Z.prototype.u.call(this)};var hv='<svg version="1.1" class="H_icon" viewBox="0 0 12 12"><path d="m8.12 6 3.66-3.66c.29-.29.29-.76 0-1.05l-1.06-1.06c-.29-.29-.76-.29-1.05 0l-3.66 3.66-3.66-3.66c-.29-.29-.76-.29-1.05 0l-1.06 1.06c-.29.29-.3.76 0 1.05l3.66 3.66-3.66 3.66c-.29.29-.29.76 0 1.05l1.06 1.06c.29.29.76.29 1.05 0l3.66-3.66 3.66 3.66c.29.29.76.29 1.05 0l1.06-1.06c.29-.29.3-.76 0-1.05z"></path></svg>';function iv(t){this.c=t,this.a=this.b=null,this.i=0,this.g=22,this.f=A(this.f,this),(t=this.c.jc()).addEventListener("mapviewchange",this.o,!1,this),(t=t.a).addEventListener("add",this.j,!1,this),t.addEventListener("remove",this.m,!1,this)}function jv(t,e){t.b&&e&&t.b===e.ga()||(t.b&&t.b.removeEventListener("tap",t.f),e?(t.b=e.ga(),t.b.addEventListener("tap",t.f),t.i=t.b.min,t.g=t.b.max):(t.b=null,t.i=0,t.g=22))}function kv(t){return window.H.service&&t.ga()instanceof window.H.service.traffic.incidents.Provider}function lv(t,e){var r=t.L(),n=this;F.call(this),this.a=t,this.i=r.ownerDocument,this.f={},this.c=[],new iv(this),this.S=uu(this.i,"div","H_ui"),this.setDirection(),this.C=A(function(t){this.o.put(t.target,t.target.Vc)},this),this.addEventListener("alignmentchange",this.C),this.J=A(function(){this.Pl()},this),this.addEventListener("toggleunitsystem",this.J),this.S.addEventListener("contextmenu",this.v,!1),this.S.addEventListener("MSHoldVisual",this.v,!1),this.a.addEventListener("contextmenu",this.O,!1,this),this.a.addEventListener("contextmenuclose",this.s,!1,this),this.a.zb(this.B.bind(this)),this.b=null,this.m=-1,this.o=new tu(this.S,this.i),this.g=Gu.METRIC,mv(this,"en-US"),e&&nv(this,e),r.appendChild(this.S),x.setTimeout(function(){n.o.update()},1)}function mv(t,e){if(zc(e))var r=e;else{if(!(e instanceof av))throw Error("The locale parameter must be a string or a H.ui.i18n.Localization object.");r=e.b;var n=e}if(!r)throw Error("No locale was defined.");if(n)t.j=n;else{if(!(0<=Wu.indexOf(r)))throw Error("Locale ["+r+"] is not supported.");t.j=new av(r)}}function nv(t,e){var r,n;e.unitSystem&&t.Jg(e.unitSystem),(n=e.locale)&&mv(t,n),(r=e.zoom)&&t.Od("zoom",new pv(Da(r)?r:null)),(r=e.zoomrectangle)&&t.Od("zoomrectangle",new qv(Da(r)?r:null)),(r=e.mapsettings)&&t.Od("mapsettings",new rv(Da(r)?r:null)),(r=e.scalebar)&&t.Od("scalebar",new sv(Da(r)?r:null)),(r=e.distancemeasurement)&&t.Od("distancemeasurement",new tv(Da(r)?r:null))}function uv(t,e,r){var n,i=e.raster;if(e=e.vector.normal,t===Al.P2D){if(t=[{label:"layers.normal",layer:i.normal.map},{label:"layers.satellite",layer:i.satellite.map},{label:"layers.terrain",layer:i.terrain.map}],r)for(n in i)if(i[n].map===r){var o=n;break}r=[{label:"layer.incidents",layer:i.normal.trafficincidents},{label:"layer.transit",layer:o&&i[o].transit}]}else t=[{label:"layers.normal",layer:e.map},{label:"layers.satellite",layer:i.satellite.map}],r=[{label:"layer.traffic",layer:e.traffic},{label:"layer.incidents",layer:e.trafficincidents}];return{alignment:"bottom-right",baseLayers:t,layers:r}}function wv(t){t=t||{},Z.call(this,"div","H_btn"),this.Qc(t.label||" "),this.sc(t.tooltip||""),this.setData(t.data),this.Da(!!t.disabled),this.P(xv.UP,!0),t.onStateChange&&this.addEventListener("statechange",t.onStateChange),this.f=A(this.f,this),this.b=A(this.b,this)}iv.prototype.o=function(t){var e=t.newValue.zoom;this.a&&t.modifiers&t.ZOOM&&(e<this.i||e>this.g)&&this.a.close()},iv.prototype.j=function(t){kv(t=t.added)&&jv(this,t)},iv.prototype.m=function(t){kv(t.removed)&&(this.a&&this.a.close(),jv(this,null))},iv.prototype.f=function(t){var e;if(t.target&&(e=t.target.getData())&&0===t.currentPointer.button){this.a||(this.a=new fv(t.target.ba()),this.a.La("H_tib"),this.c.sj(this.a)),this.a.setPosition(t.target.ba());var r=e.TRAFFIC_ITEM_TYPE_DESC.replace(" ","_");r=this.c.Ba().Kh("traffic."+r)?this.c.Ba().translate("traffic."+r):e.TRAFFIC_ITEM_DESCRIPTION[e.TRAFFIC_ITEM_DESCRIPTION.length-1].value,this.a.xf('<div class="H_tib_content"><div class="H_rdo_title" dir="auto">{{title}}</div><div class="H_tib_desc" dir="auto"><span>{{desc}}</span><div class="H_tib_time"><span class="H_tib_left">{{traffic.from}}</span><span class="H_tib_right">{{from}}</span><br/><span class="H_tib_left">{{traffic.until}}</span><span class="H_tib_right">{{until}}</span></div></div>'.replace("{{title}}",r).replace("{{desc}}",e.TRAFFIC_ITEM_DESCRIPTION[0].value).replace("{{traffic.from}}",this.c.Ba().translate("traffic.from")).replace("{{traffic.until}}",this.c.Ba().translate("traffic.until")).replace("{{from}}",e.START_TIME).replace("{{until}}",e.END_TIME)),this.a.open()}t.stopPropagation()},u(lv,F),t("H.ui.UI",lv),lv.prototype.v=function(t){for(var e=t.target;e&&!/\bH_ib_content\b/.test(e.className);)e=e.parentNode;e||t.preventDefault()},lv.prototype.L=function(){return this.S},lv.prototype.getElement=lv.prototype.L,lv.prototype.jc=function(){return this.a},lv.prototype.getMap=lv.prototype.jc,lv.prototype.Qn=function(){return this.g},lv.prototype.getUnitSystem=lv.prototype.Qn,lv.prototype.Jg=function(t){var e,r=this.f;if(t!==this.g)for(e in this.g=t,r)r[e]instanceof ov&&r[e].onUnitSystemChange(this.g)},lv.prototype.setUnitSystem=lv.prototype.Jg,lv.prototype.setDirection=function(t){this.S.setAttribute("dir",t||getComputedStyle(this.jc().L()).direction)},lv.prototype.setDirection=lv.prototype.setDirection,lv.prototype.Ba=function(){return this.j},lv.prototype.Pl=function(){this.g===Gu.METRIC?this.Jg(Gu.IMPERIAL):this.Jg(Gu.METRIC)},lv.prototype.toggleUnitSystem=lv.prototype.Pl,lv.prototype.sj=function(t){var e=this.c.length,r=this.S;if(0>this.c.indexOf(t)){t.ka(this),t.Ja(this.a);var n=t.V(this.i);e=0<e?this.c[e-1].L().nextSibling:this.S.firstChild,r.insertBefore(n,e),this.c.push(t)}},lv.prototype.addBubble=lv.prototype.sj,lv.prototype.O=function(t){var e=t.items;this.b&&this.s(),clearTimeout(this.m),this.m=x.setTimeout(function(){e.length&&(this.b=new ev(e),this.S.insertBefore(this.b.V(this.i),this.S.firstChild),this.b.ka(this),this.b.Ja(this.a),this.b.setPosition(t.viewportX,t.viewportY))}.bind(this),0)},lv.prototype.s=function(){this.b&&(this.b.B(),this.b=null)},lv.prototype.Ro=function(t){var e=this.c.indexOf(t);-1<e&&(t.ka(null),t.Ja(null),this.c.splice(e,1),this.S.removeChild(t.L()))},lv.prototype.removeBubble=lv.prototype.Ro,lv.prototype.Gm=function(){return this.c},lv.prototype.getBubbles=lv.prototype.Gm,lv.prototype.Od=function(t,e){if(this.Ve(t))throw Error("A control with name ["+t+"] is already registered.");e.ka(this),e.Ja(this.a),e.Xa=this.j,e.V(this.i),e.onUnitSystemChange(this.g),this.f[t]=e},lv.prototype.addControl=lv.prototype.Od,lv.prototype.To=function(t){var e=this.Ve(t);if(!e)throw Error("Control ["+t+"] not found in this UI's controls.");return e.N(),e.ka(null),e.Ja(null),bv(e),delete this.f[t],e},lv.prototype.removeControl=lv.prototype.To,lv.prototype.Ve=function(t){return this.f[t]},lv.prototype.getControl=lv.prototype.Ve,lv.prototype.u=function(){for(var t in this.f)pu.hasOwnProperty.call(this.f,t)&&this.f[t].B();this.c.forEach(function(t){t.B()}),(t=this.S.parentNode)&&t.removeChild(this.S),F.prototype.u.call(this),this.S=null},lv.prototype.capture=function(t,e,r,n){var i=this.Ve("scalebar"),o=t.getContext("2d"),a=t.width,s=t.height,u=this.a.m,l=5+(u?u.L().childNodes[1].offsetHeight:0);i&&i.Dc()?i.capture(e,function(n){o.drawImage(n,a-n.width-5*e,s-n.height-l*e),r(t)},n):r(t)},lv.prototype.capture=lv.prototype.capture,lv.createDefault=function(t,e,r){var n=t.ic().type;if(r=new lv(t,{unitSystem:Gu.METRIC,zoom:{alignment:"right-bottom"},mapsettings:uv(n,e,t.c),scalebar:{alignment:"bottom-right"},locale:r||"en-US"}),n===Al.P2D){var i=r.Ve("mapsettings"),o=function(){if(i.jc()){var r=uv(n,e,t.c);vv(i,r.baseLayers,r.layers)}};t.addEventListener(t.o.Ff,o),r.zb(function(){t.removeEventListener(t.o.Ff,o)}),i.zb(function(){t.removeEventListener(t.o.Ff,o)})}return r},u(wv,Z),t("H.ui.base.Button",wv),wv.prototype.Da=function(t,e){return t&&this.qb("H_active"),wv.l.Da.call(this,t,e)},wv.prototype.$=function(t){Uu(t,"start",this.f),Uu(t,"end",this.b),Uu(t,"out",this.b),this.Qc(this.Ye(),!0)},wv.prototype.renderInternal=wv.prototype.$,wv.prototype.getState=function(){return this.A},wv.prototype.getState=wv.prototype.getState,wv.prototype.P=function(t,e){return t!==this.A&&(this.A=t,t===xv.DOWN?this.La("H_active"):this.qb("H_active"),e||this.dispatchEvent("statechange")),this},wv.prototype.setState=wv.prototype.P,wv.prototype.Ye=function(){return this.a},wv.prototype.getLabel=wv.prototype.Ye,wv.prototype.Qc=function(t,e){return(e||t!==this.a)&&(this.a=t,(e=this.L())&&(e.innerHTML=t)),this},wv.prototype.setLabel=wv.prototype.Qc,wv.prototype.f=function(t){this.mc()||this.P(xv.DOWN),t.preventDefault()},wv.prototype.b=function(t){this.mc()||this.P(xv.UP),t.preventDefault()},wv.prototype.u=function(){var t=this.L();t&&(Vu(t,"start",this.f),Vu(t,"end",this.b),Vu(t,"out",this.b)),Z.prototype.u.call(this)};var xv={UP:"up",DOWN:"down"};function yv(t){var e;t=t||{},this.f=!!t.vertical,this.W=t.length||"16em",this.a=Cc(e=t.min)?e:0,this.m=wd(this.a,Cc(e=t.max)?e:100),this.za=E(e=t.step)?1:e,this.o=zv(this,Cc(e=t.value)?e:(this.a+this.m)/2),this.sg=A(this.sg,this),this.og=A(this.og,this),this.ug=A(this.ug,this),this.tg=A(this.tg,this),this.b=t.pointerArea,Z.call(this,"div","H_slider"+(this.f?"":" H_l_horizontal"))}function Av(t){t.s||(Uu(t.L(),"start",t.sg),Uu(t.b,"move",t.og),Uu(t.b,"end",t.ug),Uu(t.b,"out",t.tg),t.s=!0)}function Bv(t){t.s&&(Vu(t.L(),"start",t.sg),Vu(t.b,"move",t.og),Vu(t.b,"end",t.ug),Vu(t.b,"out",t.tg),t.s=!1)}function zv(t,e){var r=t.za;return e=Yd(e,t.a,t.m),r?t.a+xd((e-t.a)/r)*r:e}function Cv(t,e){var r=t.C,n=t.f;t.v||(t.v=r["offset"+(n?"Height":"Width")]),0>(e-=qu(r)[n?"y":"x"])&&(e=0),e=(t.m-t.a)*e/t.v,e=zv(t,n?t.m-e:t.a+e),t.o!==e&&(t.Kg(e,!0),t.dispatchEvent(new Ng(t.Kk.nd,e,t.o)))}function Dv(t,e){return(e.touches?e.targetTouches[0]:e)["page"+(t.f?"Y":"X")]}function Ev(t){var e=!1,r=t.type;return-1!==r.indexOf("pointer")||-1!==r.indexOf("touch")?e=!0:C(t,MouseEvent)&&(e=1===t.which||1===t.buttons),e}function Fv(t){var e=t.touches;return e&&1===e.length||C(t,MouseEvent)}wv.State=xv,u(yv,Z),t("H.ui.base.Slider",yv),yv.prototype.Kg=function(t,e){var r=this.f,n=r?"top":"left";return this.i&&!e||(t=Yd(t,this.a,this.m),this.j&&(e=100*(t-this.a)/(this.m-this.a),r=(r?-1:1)*e,this.j.style[n]=r+"%",this.Xa.style[n]=100+r+"%"),this.o=zv(this,t)),this.o},yv.prototype.setValue=yv.prototype.Kg,yv.prototype.Rn=function(){return this.o},yv.prototype.getValue=yv.prototype.Rn,n=yv.prototype,n.sg=function(t){var e=this.f;if(Ev(t)&&Fv(t)){var r=Dv(this,t),n=t.target;n===this.j||n.parentElement===this.j?(this.U=r-qu(this.j)[e?"y":"x"]-this.j.offsetWidth/2,this.L().className="H_slider H_slider_active"+(this.f?"":" H_l_horizontal"),this.i=!0):Cv(this,r),t.preventDefault()}},n.ug=function(){this.i&&(this.L().className="H_slider "+(this.f?"":" H_l_horizontal"),this.i=!1)},n.tg=function(t){this.i&&t.target===this.b&&(this.i=!1)},n.og=function(t){this.i&&Fv(t)&&(Ev(t)?(Cv(this,Dv(this,t)-this.U),t.preventDefault()):this.i=!1)},n.Kk={nd:"change"},n.$=function(t,e){var r=uu(e,"div","H_slider_cont"),n=uu(e,"div","H_slider_knob_cont"),i=uu(e,"div","H_slider_knob"),o=uu(e,"div","H_slider_knob_halo"),a=uu(e,"div","H_slider_track");e=uu(e,"div","H_slider_track H_slider_track_active"),t.appendChild(r),r.appendChild(a),a.appendChild(e),r.appendChild(n),n.appendChild(i),n.appendChild(o),this.C=a,this.Xa=e,this.j=n,this.b||(this.b=t.ownerDocument.body),r.style[this.f?"height":"width"]=this.W,this.Kg(this.o),Av(this)},yv.prototype.renderInternal=yv.prototype.$,yv.prototype.u=function(){Bv(this)},yv.prototype.Da=function(t,e){return t?Bv(this):this.C&&Av(this),Z.prototype.Da.call(this,t,e)},yv.prototype.setDisabled=yv.prototype.Da;var Gv={in:'<svg version="1.1" class="H_icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g><path d="m5 10.6h5.6v-5.6h2.8v5.6h5.6v2.8h-5.6v5.6h-2.8v-5.6h-5.6v-2.8z"></path></g></svg>',out:'<svg version="1.1" class="H_icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><path d="m5 10.6h14v2.8h-14z"/></svg>'};function ov(){cv.call(this,"div","H_ctl"),this.map=null,this.Vc="top-left"}function pv(t){var e=(t=t||{}).slider;ov.call(this),this.o=A(this.o,this),this.i=A(this.i,this),this.a=A(this.a,this),e&&(this.v=A(this.v,this),this.C=e,this.Aa=t.sliderSnaps,this.La("H_zoom_slider")),this.j=new wv({label:Gv.in,onStateChange:this.o}),this.s=new wv({label:Gv.out,onStateChange:this.o}),this.La("H_zoom"),this.La("H_grp"),this.za=!1!==t.fractionalZoom,this.setZoomSpeed(t.zoomSpeed||4),this.Zb(t.alignment||"right-middle")}function Hv(t){t.removeChild(t.f),t.f=null,t.m&&(t.m.removeEventListener("minchange",t.a),t.m.removeEventListener("maxchange",t.a),t.m=null)}u(ov,cv),t("H.ui.Control",ov),ov.prototype.Ja=function(t){this.map=t},ov.prototype.V=function(t){return cv.prototype.V.call(this,t)},ov.prototype.$=function(t,e){cv.prototype.renderInternal.call(this,t,e),this.Zb(this.Vc)},ov.prototype.renderInternal=ov.prototype.$,ov.prototype.kf=function(){},ov.prototype.onUnitSystemChange=ov.prototype.kf,ov.prototype.jc=function(){return this.map},ov.prototype.getMap=ov.prototype.jc,ov.prototype.Ba=function(){return this.Xa},ov.prototype.getLocalization=ov.prototype.Ba,ov.prototype.Bm=function(){return this.Vc},ov.prototype.getAlignment=ov.prototype.Bm,ov.prototype.Zb=function(t){return"string"==typeof t&&su[t.replace("-","_").toUpperCase()]===t&&(this.Vc=t,this.dispatchEvent("alignmentchange")),this},ov.prototype.setAlignment=ov.prototype.Zb,u(pv,ov),t("H.ui.ZoomControl",pv),pv.prototype.Wn=function(){return this.U},pv.prototype.getZoomSpeed=pv.prototype.Wn,pv.prototype.fp=function(t){this.U=t},pv.prototype.setZoomSpeed=pv.prototype.fp,pv.prototype.Ja=function(t){this.map!==t&&(this.map&&this.map.removeEventListener("mapviewchange",this.i),Hv(this)),ov.prototype.Ja.apply(this,arguments),this.map&&(this.a(),t.addEventListener("mapviewchange",this.i),t.addEventListener("baselayerchange",this.a))},pv.prototype.setMap=pv.prototype.Ja,pv.prototype.u=function(){ov.prototype.u.apply(this,arguments),this.map.removeEventListener("baselayerchange",this.a),Hv(this)},pv.prototype.$=function(t,e){ov.prototype.renderInternal.call(this,t,e),this.j.sc(this.Ba().translate("zoom.in")),this.s.sc(this.Ba().translate("zoom.out"))},pv.prototype.renderInternal=pv.prototype.$,pv.prototype.Zb=function(t){var e=this.Vc;return ov.prototype.Zb.call(this,t),e!==t&&this.a(),this},pv.prototype.setAlignment=pv.prototype.Zb,pv.prototype.i=function(){var t=this.map,e=t.vb(),r=t.$a()-1;t=t.c||t.ic().getCapabilities().lookAt.zoom,this.C&&this.f.Kg(e),this.mc()||(this.j.Da(e+r>=t.max),this.s.Da(e<=t.min))},pv.prototype.Da=function(t,e){return pv.l.Da.call(this,t,e),this.i(),this},pv.prototype.setDisabled=pv.prototype.Da,pv.prototype.o=function(t){var e,r=(t=t.target)===this.j?1:-1,n=0<r?Math.ceil:Math.floor,i=this.map,o=this;i&&("down"===t.getState()?(i.b.startControl(),i.b.control(0,0,r*this.U,0,0,0)):i.b.endControl(!0,function(t){e=o.za?t.zoom:n(t.zoom),t.zoom=e}))},pv.prototype.v=function(t){this.map&&this.map.zf(t.newValue)},pv.prototype.a=function(){var t=this.Vc,e=this.jc();if(/^top/g.test(t)||/^bottom/g.test(t)){var r=this.s;t=this.j;var n=!1}else r=this.j,t=this.s,n=!0;if(this.removeChild(r),this.removeChild(t),this.Ka(r),this.C&&e){Hv(this),e=n;var i=(n=(r=this.map)&&r.c)||r.ic().getCapabilities().lookAt.zoom;(this.m=n)&&(n.addEventListener("minchange",this.a),n.addEventListener("maxchange",this.a)),this.f=new yv({step:this.Aa?1:0,vertical:e,min:i.min,max:i.max,value:r.vb(),pointerArea:r.L()}),this.f.addEventListener(this.f.Kk.nd,this.v),this.Ka(this.f)}this.Ka(t)};var Iv={btn:'<svg class="H_icon" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd"><g transform="translate(3 2)"><path d="m18 13v7h-18v-7h2v5h2v-2h2v2h2v-3h2v3h2v-2h2v2h2v-5z"></path><path d="m2.3.3c.7 0 1.3.1 1.8.4s.9.6 1.1 1 .4.9.4 1.4c0 .5-.1 1-.3 1.4s-.57 1-1 1.6-1.3 1.3-2.3 2.2h3.9l-.2 1.7h-6.16v-1.6c1.1-1.1 2-2 2.5-2.6s.9-1 1-1.4.3-.8.3-1.2c0-.4-.1-.7-.3-.9s-.5-.3-.9-.3c-.3 0-.6 0-.9.2s-.5.4-.8.7l-1.3-1c.4-.5.9-.9 1.4-1.2s1.2-.4 1.8-.4zm14.4 9.7h-2.3l-.2-3.8c 0-.9-.1-1.7-.1-2.4 0-.5 0-1 0-1.5l-1.5 6.7h-2.2l-1.6-6.7c.1.8.1 1.6.1 2.3 0 .5 0 1.1 0 1.7l-.2 3.8h-2.2l.7-9.7h2.9l1.5 6.6 1.4-6.6h2.9z"></path></g></g></svg>',point:'<svg height="22" viewBox="0 0 12 12" width="22" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m6 12c3.3 0 6-2.7 6-6s-2.7-6-6-6-6 2.7-6 6 2.7 6 6 6z" fill="#fff"></path><path d="m6 10c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4z" fill="#2ed5c9" stroke="#272c36" stroke-width="2"></path></g></svg>'};function Jv(t){wv.call(this,t),this.j=function(t){t.preventDefault()},this.i=A(function(t){this.mc()||this.toggleState(),t.preventDefault()},this)}function Kv(t,e,r){Qi.call(this,t,{icon:Lv,visibility:r}),Mv(this,e)}function Mv(t,e){t.oo=e,t.S&&(t.S.textContent=e)}u(Jv,wv),t("H.ui.base.PushButton",Jv),Jv.prototype.$=function(t){Uu(t,"start",this.i),Uu(t,"end",this.j),this.Qc(this.Ye(),!0)},Jv.prototype.renderInternal=Jv.prototype.$,Jv.prototype.mp=function(){var t=xv.DOWN;return this.P(this.getState()===t?xv.UP:t),this},Jv.prototype.toggleState=Jv.prototype.mp,Jv.prototype.u=function(){var t=this.L();t&&Vu(t,"start",this.i),wv.prototype.u.call(this)},u(Kv,Qi);var Lv=new Hi(uu(Mu.document,"span","H_dm_label"),{onAttach:function(t,e,r){r.S=t,Mv(r,r.oo)},onDetach:function(t,e,r){delete r.S}});function Nv(t,e){F.call(this),this.f=t,this.a=new Kv(this.N,""),e.push(this.a),this.b=new Q({objects:e,data:this}),this.j=this.j.bind(this)}function Ov(t,e){e&&(t.nextSibling=e,e.previousSibling=t)}function Pv(t,e,r,n){var i=new L,o=[];Ov(t,this),Ov(this,e),i.Fd(t.Ca()),i.Fd(e.Ca()),this.i=new nh(i,{style:r.ne}),this.s=new nh(i,{style:{strokeColor:"transparent",lineWidth:Math.min(100,this.i.ua().lineWidth+2*(n||5))}}),r.c&&(this.o=new nh(i,{style:r.c}),o.push(this.o)),o.push(this.i,this.s),Nv.call(this,r,o),this.O=this.v=-1,(t=this.b).addEventListener("pointermove",this.J,!0,this),t.addEventListener("pointerleave",this.C,!0,this)}function Qv(t,e,r){var n=t.i.ba();n.Bf(3*r,3,[e.lat,e.lng,0]),t.o&&t.o.da(n),t.s.da(n),t.i.da(n)}function Rv(t,e,r){r=e.b(r||0),this.i=new yn(t,{icon:r,zIndex:0}),this.i.draggable=!0,Nv.call(this,e,[this.i]),(t=this.b).addEventListener("dragstart",this.Bo,!0,this),t.addEventListener("drag",this.Co,!0,this),t.addEventListener("dragend",this.Ao,!0,this)}function Sv(t){var e=0;t.nextSibling&&t.previousSibling&&(t.nextSibling.g||t.previousSibling.g?t.nextSibling.g&&!t.previousSibling.g&&(e=2):e=1),e=t.f.b(e),t.i.Pc(e)}function Tv(t,e){this.c=e,this.b=t,this.a={previousSibling:null,nextSibling:null,g:!0},Uv(this,this.a),this.rg=A(this.rg,this)}function Vv(t,e){for(var r=(t=t.a).nextSibling;r!==t;){var n=r,i=r.previousSibling!==t&&e;(n.c=i)?n.j():(n.m&&x.clearTimeout(n.m),n.m=x.setTimeout(n.j,100)),r=r.nextSibling}}function Wv(t,e){var r=e||t.a.nextSibling,n=0,i=0;if(e&&!Xv(t,e))throw new D(t.sf,0,e);for(r instanceof Rv?n=r.Xe():r instanceof Pv&&(n=r.previousSibling.Xe()),e=r;e&&e!==t.a;e=e.nextSibling,i++)e.Ei(n),1==i%2&&(n+=e.Xe())}function Xv(t,e){for(var r=t.a.nextSibling,n=!1;r!==t.a;){if(r===e){n=!0;break}r=r.nextSibling}return n}function Yv(t,e,r){e=new Pv(e,r,t.c),t.b.ea(e.b)}function Uv(t,e){t.a.nextSibling=e,e.previousSibling=t.a}function tv(t){var e,r=(t=t||{}).lineStyle;ov.call(this),this.s=new Jv({label:Iv.btn,onStateChange:A(this.yo,this)}),this.Ka(this.s),(e=t.distanceFormatter)&&(this.Jj=e),r&&(this.wk=r,this.Vk=B),this.Zb(t.alignment||"right-bottom"),this.m={},this.m[0]=t.startIcon,this.m[2]=t.endIcon,this.m[1]=t.stopoverIcon,this.m[3]=t.splitIcon}function Zv(t){var e,r=t.map,n={};t.i||(t.j=new N,t.f=new ml(t.j,{pixelRatio:t.map.$a()}),t.v=e=t.j.kc(),t.v.El(!0),e.addEventListener("dragstart",t.wo,!0,t),e.addEventListener("dragend",t.Af,!0,t),e.addEventListener("pointerenter",t.Af,!0,t),e.addEventListener("pointerleave",t.xo,!0,t),e.addEventListener("tap",t.Lo,!0,t),t.o=$v(t),n.a=A(t.Jj,t),n.b=A(t.Gk,t),n.g=A(t.Zj,t),n.map=t.map,n.f=t.o,n.ne=t.wk,n.c=t.Vk,t.a=new Tv(t.v,n),t.i=!0),t.o&&t.v.ea(t.o),r.addEventListener("tap",t.Sk,!0,t),r.a.add(t.f)}function aw(t){var e=t.map;t.i&&(e.removeEventListener("tap",t.Sk,!0,t),e.rf(t.f),t.a.qa())}function $v(t){function e(){var t=n.Db();return t={anchor:n.ud().clone().scale(o).floor(),size:new Ki(yd(t.w*o),yd(t.h*o)),hitArea:i},new Ij(n.ad(),t)}var r,n=t.Gk(3),i=new Li(Mi.NONE,[]),o=n===t.C?.5:1;if(1===n.getState())var a=e();else a=new Ij("<svg/>",{hitArea:i}),n.addEventListener("statechange",function(){1===n.getState()&&r.Pc(e())});return r=new yn(t.map.fb(),{visibility:!1,icon:a})}function bw(){this.A=cw.CLOSED,cv.call(this,"div","H_overlay")}u(Nv,F),Nv.prototype.g=!1,Nv.prototype.N={lat:0,lng:0},Nv.prototype.Qc=function(t,e){Mv(this.a,t),this.a.da(e)},Nv.prototype.j=function(){this.a.wb(this.c)},u(Pv,Nv),Pv.prototype.Xe=function(){var t=this.i.ba();return t.Qe(0).Za(t.Qe(1))},Pv.prototype.J=function(t){var e=t.currentPointer;t=this.previousSibling.Ca();var r=this.nextSibling.Ca(),n=this.f.f,i=e.viewportX;e=e.viewportY,this.v===i&&this.O===e||(this.v=i,this.O=e,n.da(this.f.g(t,r,{x:i,y:e})),n.wb(!0))},Pv.prototype.C=function(){this.f.f.wb()},Pv.prototype.Ei=function(){this.Qc(this.f.a(this.Xe()),this.i.G().fb())},u(Rv,Nv),n=Rv.prototype,n.Lk=0,n.ii={nd:"change"},n.Xe=function(){return this.Lk},n.Ca=function(){return this.i.ba()},n.Co=function(t){var e=t.currentPointer;t=e.viewportX,e=e.viewportY,this.s===t&&this.v===e||(this.s=t,this.v=e,this.i.da(this.f.map.Wa(t-this.o.x,e-this.o.y)),this.dispatchEvent(new rd(this.ii.nd,this)))},n.Bo=function(t){var e=t.currentPointer,r=e.viewportX;e=e.viewportY;var n=this.f.map.Fa(this.Ca());this.i.ye(1),this.o={x:r-n.x,y:e-n.y},t.stopPropagation()},n.Ao=function(){this.i.ye(0)},n.Ei=function(t){this.Lk=t,this.Qc(this.f.a(t),this.Ca())},t("H.ui.distanceMeasurement.Model",Tv),n=Tv.prototype,n.jg=function(){return this.a.nextSibling===this.a},n.Ge=function(t){var e=this.a.previousSibling,r=this.jg();return t=new Rv(t,this.c,r?0:2),this.b.ea(t.b),Ov(t,this.a),t.addEventListener(t.ii.nd,this.rg),r?Uv(this,t):(Yv(this,e,t),Sv(e),Wv(this,e)),t},n.insertBefore=function(t,e){var r,n=1;if(e){if(!Xv(this,e))throw new D(this.insertBefore,1,e);(r=e.previousSibling.g)&&(n=0),(t=new Rv(t,this.c,n)).addEventListener(t.ii.nd,this.rg),this.b.ea(t.b),r?(Yv(this,t,r=this.a.nextSibling),Uv(this,t),e=t,Sv(r)):(e=(r=e.previousSibling).previousSibling,n=r.nextSibling,this.b.Ia(r.b),Yv(this,e,t),Yv(this,t,n)),Wv(this,e)}else t=this.Ge(t);return t},n.qa=function(){Uv(this,this.a),this.b.qa()},n.sf=function(t){var e=this.a,r=t.previousSibling,n=t.nextSibling;if(!Xv(this,t))throw new D(this.sf,0,t);if(this.b.Ia(t.b),r===e){var i=n;i!==e?(Uv(this,t=i.nextSibling),t.Ei(0),Sv(t),Wv(this,t)):Uv(this,this.a)}else n===e?(Ov(t=(i=r).previousSibling,e),Sv(t)):r&&n&&(Yv(this,r.previousSibling,n.nextSibling),this.b.Gd([n.b,r.b]),Wv(this,r.previousSibling));i&&i!==e&&this.b.Ia(i.b)},n.rg=function(t){var e=(t=t.target).previousSibling,r=t.nextSibling,n=t.Ca();if(!r.g){Qv(r,n,!1);var i=t}e.g||(Qv(e,n,!0),i=e.previousSibling),Wv(this,i)},u(tv,ov),t("H.ui.DistanceMeasurement",tv),n=tv.prototype,n.wk={strokeColor:"rgb(39,44,54)",lineWidth:5},n.Vk={strokeColor:"white",lineWidth:7},n.Jj=function(t){var e="m",r=0;return"metric"===this.U?1e3<=t&&(t/=1e3,e="km",r=1):(e="ft",5280<=(t/=.3048)&&(t/=5280,e="mi",r=1)),t.toFixed(r)+" "+this.Ba().translate("scale."+e)},n.Zj=function(t,e,r){return t=this.map.Fa(t),e=this.map.Fa(e),r=new I(r.x,r.y).Yj(t,e),this.map.Wa(r.x,r.y)},n.$=function(t,e){var r=22*(this.map.ic().type===Vj.P2D?this.map.$a():1),n=r/2;ov.prototype.renderInternal.call(this,t,e),this.U=Gu.METRIC,this.C=new Ij(Iv.point,{anchor:{x:n,y:n},size:{w:r,h:r},hitArea:new Li(Mi.CIRCLE,[n,n,n])}),this.s.sc(this.Ba().translate("distance.measurement"))},tv.prototype.renderInternal=tv.prototype.$,n=tv.prototype,n.Gk=function(t){return this.m[t]||this.C},n.Af=function(){Vv(this.a,!0)},n.wo=function(){Vv(this.a)},n.xo=function(t){"touch"!==t.currentPointer.type&&Vv(this.a)},n.Lo=function(t){var e,r=t.currentPointer,n=t.target.Ha;n&&(n=n.getData())instanceof Nv&&(e=n),n=e,t=(t=t.originalEvent).metaKey||t.altKey,n&&(t&&n instanceof Rv?this.a.sf(n):n instanceof Pv&&(t=n.previousSibling.Ca(),e=n.nextSibling.Ca(),r={x:r.viewportX,y:r.viewportY},this.a.insertBefore(this.Zj(t,e,r),n.nextSibling),this.o.wb()),this.Af())},n.Sk=function(t){var e=t.currentPointer;(t=t.target)!==this.map&&t.getProvider&&t.getProvider()===this.j||(this.a.Ge(this.map.Wa(e.viewportX,e.viewportY)),this.o.wb(),this.Af())},n.yo=function(t){"down"===t.target.getState()?Zv(this):aw(this)},n.kf=function(t){this.U=t,this.i&&(Wv(this.a),this.Af())},tv.prototype.onUnitSystemChange=tv.prototype.kf,tv.prototype.u=function(){aw(this),this.i&&(this.j.B(),this.f.B()),tv.l.u.call(this)},tv.prototype.Ja=function(t){t?this.s.getState()===xv.DOWN&&(this.map=t,Zv(this)):(aw(this),this.i=!1),ov.prototype.Ja.apply(this,arguments)},tv.prototype.setMap=tv.prototype.Ja,u(bw,cv),t("H.ui.base.OverlayPanel",bw),bw.prototype.P=function(t,e){return(t!==this.A||e)&&(this.A=t,t===cw.OPEN?this.La("H_open"):this.qb("H_open")),this},bw.prototype.setState=bw.prototype.P,bw.prototype.getState=function(){return this.A},bw.prototype.getState=bw.prototype.getState,bw.prototype.$k=function(t){var e=t.Vc;t=t.L();var r=this.L(),n=r.style;if(this.qb("H_top"),this.qb("H_middle"),this.qb("H_bottom"),this.qb("H_left"),this.qb("H_center"),this.qb("H_right"),n.bottom=n.top=n.left=n.right=n.margin="",/top/g.test(e)){this.La("H_top"),n.top="0",n.margin="0 12px";var i=-1}else/bottom/g.test(e)?(this.La("H_bottom"),n.bottom="0",n.margin="0 12px",i=1):(this.La("H_middle"),n.top="50%",n.margin="0 12px",n.marginTop=-Math.round(.5*r.offsetHeight)+"px",i=0);/left/g.test(e)?(this.La("H_left"),n.left=t.offsetWidth+"px",n.marginLeft="12px"):/right/g.test(e)?(this.La("H_right"),n.right=t.offsetWidth+"px",n.marginRight="12px"):(this.La("H_center"),n.left="50%",0>i?(n.top=t.offsetHeight+"px",n.marginTop="12px"):0<i&&(n.bottom=t.offsetHeight+"px",n.marginBottom="12px"),n.marginLeft=-Math.round(.5*r.offsetWidth)+"px",t.appendChild(r))},bw.prototype.pointToControl=bw.prototype.$k;var cw={OPEN:"open",CLOSED:"closed"};function dw(t){t=t||{},cv.call(this,"div","H_rdo"),this.i=new Z("div","H_rdo_title"),this.a=new cv("div","H_rdo_buttons"),this.Ka(this.i),this.Ka(this.a),this.j=A(function(t){t.target.getState()===xv.DOWN?(this.ql(t.target,!0),this.dispatchEvent(ew)):t.target.P(xv.DOWN,!0)},this),this.addEventListener("statechange",this.j),this.Ri(t.title||""),t.onActiveButtonChange&&this.addEventListener(ew,t.onActiveButtonChange),t.buttonsOptions&&t.buttonsOptions.forEach(function(t){this.Vg(new Jv(t))},this)}bw.State=cw,u(dw,cv),t("H.ui.base.RadioGroup",dw);var ew="activebuttonchange";function rv(t){t=t||{},ov.call(this),this.i=new bw,new dw,this.a=this.a.bind(this),this.o=this.o.bind(this),this.s=this.s.bind(this),this.Zb(t.alignment||"bottom-right"),vv(this,t.baseLayers,t.layers)}function vv(t,e,r){var n=t.jc();t.f&&t.f.forEach(function(t){var e=t.layer;t=e&&ou(r,function(t){return t.layer===e}),e&&!t&&n.rf(e)}),t.m=yc(e)?e:[],t.f=yc(r)?r:[],t.j&&(t.j.qa(),t.v.qa(),fw(t))}function fw(t){var e=t.Ba();t.m.forEach(function(t,r){this.j.Vg(new Jv({label:gw(e,t.label),data:r,disabled:!t.layer}))},t),t.f.forEach(function(t,r){this.v.Ka(new Jv({label:gw(e,t.label),onStateChange:this.za.bind(this,t.layer),data:r,disabled:!t.layer}))},t),t.U.wb(!(!t.f.length||!t.m.length)),x.setTimeout(function(){this.map&&(this.a(),this.C.Da(!(this.m&&this.m.length||this.f&&this.f.length)))}.bind(t))}function jw(t,e){var r,n,i={},o=e.ga(),a=window.H.service&&window.H.service.omv.Provider;if(a&&e.ga()instanceof a&&o.ua().Pe){var s=o.ua(),u=function(){var t=kw.ground.filter(function(t){return!!s.Eh("layers."+t)}),a=kw.water.filter(function(t){return!!s.Eh("layers."+t)});t.concat(a).length&&(vh(i,s.Pe(t)),vh(i,s.Pe(a,!1,!0)),delete i.global,r=new Th(i,s.hc()),(n=o.o.qd(r)).Qg=e,this.map.Xg(n)),s.removeEventListener(Sh.CHANGE,u)}.bind(t);s.getState()!==Qh.READY?s.addEventListener(Sh.CHANGE,u):u()}}function hw(t){return ou(t.map.a.Na(),function(t){return!!t.Qg})}function iw(t){t=t.map.a.Na();var e=window.H.service&&window.H.service.traffic.flow.Provider;return!!e&&t.some(function(t){return t.ga()instanceof e})}dw.prototype.$=function(t,e){cv.prototype.renderInternal.call(this,t,e),this.Ri(this.f,!0)},dw.prototype.renderInternal=dw.prototype.$,dw.prototype.qa=function(){this.a.qa()},dw.prototype.Ri=function(t,e){return(t!==this.f||e)&&(this.f=t,this.i.L()&&(this.i.L().innerHTML=this.f)),this},dw.prototype.setTitle=dw.prototype.Ri,dw.prototype.Nn=function(){return this.f},dw.prototype.getTitle=dw.prototype.Nn,dw.prototype.Vg=function(t){if(!(t instanceof Jv))throw Error("PushButton expected");return t.ka(this),this.a.Ka(t),this},dw.prototype.addButton=dw.prototype.Vg,dw.prototype.So=function(t){return this.a.removeChild(t),t.ka(null),this},dw.prototype.removeButton=dw.prototype.So,dw.prototype.Yf=function(){return this.a.vh()},dw.prototype.getButtons=dw.prototype.Yf,dw.prototype.ql=function(t,e){for(var r=this.Yf(),n=r.length;n--;)r[n].P(r[n]===t?xv.DOWN:xv.UP,e)},dw.prototype.setActiveButton=dw.prototype.ql,dw.prototype.u=function(){this.removeEventListener("statechange",this.j),this.qa(),cv.prototype.u.call(this)},u(rv,ov),t("H.ui.MapSettingsControl",rv),rv.prototype.fa=function(){var t=this.jc();t&&(t.addEventListener("tap",this.o),(t=t.a).addEventListener("add",this.a),t.addEventListener("remove",this.a),t.addEventListener("set",this.a))},rv.prototype.N=function(){var t=this.jc();t&&(t.removeEventListener("tap",this.o),(t=t.a).removeEventListener("add",this.a),t.removeEventListener("remove",this.a),t.removeEventListener("set",this.a))},rv.prototype.$=function(t,e){var r=this.Ba().translate("layers.choose");ov.prototype.renderInternal.call(this,t,e),this.fa(),this.C=new Jv({tooltip:r,label:'<svg xmlns="http://www.w3.org/2000/svg" class="H_icon" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M6.7,14.6 L4.5,16 L12,20.6 L19.5,16 L17.3,14.6 L19.1,13.5 L23,16 L12,23 L1,16 L4.9,13.5 L6.7,14.6 Z M12,2 L23,9 L12,16 L1,9 L12,2 Z"></path></svg>',onStateChange:A(function(t){t.target.getState()===xv.DOWN?(this.i.P(cw.OPEN),this.i.$k(this)):this.i.P(cw.CLOSED)},this)}),this.j=new dw({title:r,onActiveButtonChange:function(){t:{for(var t=this.j.Yf(),e=t.length;e--;)if(t[e].getState()===xv.DOWN){t=t[e];break t}t=null}t=t.getData(),this.map.Kd(this.m[t].layer),this.s()}.bind(this)}),this.v=new cv("div","H_grp"),this.U=new Z("div","H_separator"),this.Ka(this.C),this.Ka(this.i),this.i.Ka(this.j),this.i.Ka(this.U),this.i.Ka(this.v),fw(this)},rv.prototype.renderInternal=rv.prototype.$,rv.prototype.a=function(){var t=this.map.c,e=this.map.a;this.m.forEach(function(e,r){this.j.Yf()[r].P(xv[e.layer===t?"DOWN":"UP"],!0)},this),this.f.forEach(function(t,r){r=this.v.vh()[r],t.layer?r.P(xv[-1!==e.indexOf(t.layer)?"DOWN":"UP"],!0):r.Da(!0)},this)},rv.prototype.za=function(t,e){e.target.getState()===xv.DOWN?this.map.Xg(t):this.map.rf(t),this.s()},rv.prototype.s=function(){var t;(t=hw(this))&&(t.Qg.ga().ua().hf(t.ga().ua().vd()),this.map.rf(t),t.B(),delete t.Qg);iw(this)&&jw(this,this.map.c)};var kw={water:["water.water-labels"],ground:"road_labels continent_label island_label roads.shields roads.directions truck-restriction.signs places landuse.label".split(" ")};function gw(t,e){return/^layers?/.test(e)&&t.Kh(e)?t.translate(e):e}function qv(t){t=t||{},ov.call(this),this.f=new Jv({label:'<svg xmlns="http://www.w3.org/2000/svg" class="H_icon" viewBox="0 0 24 24"><g transform="translate(1 3)"><path fill-rule="nonzero" d="M5,0 L5,2 L2,2 L2,16 L5,16 L5,18 L2,18 C0.9,18 0,17 0,15.75 L0,2.25 C0,1 0.9,0 2,0 L5,0 Z M17,0 L20,0 C21.1,0 22,1 22,2.25 L22,15.75 C22,17 21.1,18 20,18 L17,18 L17,16 L20,16 L20,2 L17,2 L17,0 Z"></path><rect width="10" height="2" x="6" y="8"></rect><rect width="2" height="10" x="10" y="4"></rect></g></svg>',onStateChange:A(this.zo,this)}),this.Ka(this.f),this.Zb(t.alignment||"right-bottom")}function lw(t,e){if(e=e||{},!(t&&t instanceof ll))throw Error("Base layer is mandatory for overview UI element");ov.call(this),this.f=new Jv({label:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="H_icon"><g fill-rule="evenodd" transform="translate(2 2)"><rect width="9" height="9" x="10" y="10"/><rect class="H_icon_stroke" width="18" height="18" x="1" y="1" fill="none" stroke="#000" stroke-width="2" rx="2"/></g></svg>',onStateChange:A(this.i,this)}),this.Ka(this.f),this.a=new mw(t,e.zoomDelta,e.scaleX,e.scaleY),this.Zb(e.alignment||"right-bottom"),this.Ka(this.a)}function mw(t,e,r,n){this.m=t,"number"==typeof e&&(this.Sl=e),"number"==typeof r&&(this.Wk=r),"number"==typeof n&&(this.Xk=n),cv.call(this,"div","H_overview")}function ow(t){!t.Nd&&nw(t),t.qb("H_overview_active"),t.a.removeEventListener("mapviewchange",t.Vi,!1,t)}function nw(t,e){var r=t.a.ya.element,n=t.L().style,i=r.offsetWidth/t.Wk/10;r=r.offsetHeight/t.Xk/10;var o=t.i.style;e?(n.width=i+"em",n.height=r+"em",o.width=i+"em",o.height=r+"em"):n.width=n.height="0em",t.f.ya.resize()}function sv(t){t=t||{},ov.call(this),this.La("H_scalebar"),this.Zb(t.alignment||"right-bottom"),this.v=150,this.update=A(this.update,this),this.m=this.f=this.a=this.j=null}rv.prototype.o=function(){this.C.P(xv.UP)},rv.prototype.u=function(){rv.l.u.call(this),this.N()},u(qv,ov),t("H.ui.ZoomRectangle",qv),n=qv.prototype,n.zo=function(t){var e=this.map,r=e.ya.element;t.target.getState()===xv.DOWN?(e.addEventListener("dragstart",this.Ik,!0,this),e.addEventListener("drag",this.Jk,!0,this),e.addEventListener("dragend",this.Hk,!0,this),(t=r.ownerDocument.createElement("div")).className="H_zoom_lasso",r.appendChild(t),this.a=t):(e.removeEventListener("dragstart",this.Ik,!0,this),e.removeEventListener("drag",this.Jk,!0,this),e.removeEventListener("dragend",this.Hk,!0,this),r.removeChild(this.a))},n.Ik=function(t){var e=this.a.style,r=t.currentPointer,n=r.viewportX;r=r.viewportY,t.target===this.map&&(t.stopPropagation(),e.width="0px",e.height="0px",e.top=r+"px",e.left=n+"px",e.display="block",this.j=r,this.i=n)},n.Jk=function(t){var e=t.currentPointer,r=e.viewportX,n=e.viewportY;e=this.i;var i=this.j,o=this.a.style;t.target===this.map&&(t.stopPropagation(),t=r-e,r=n-i,o.left=e+(0>t?t:0)+"px",o.top=i+(0>r?r:0)+"px",o.width=Math.abs(t)+"px",o.height=Math.abs(r)+"px")},n.Hk=function(t){var e=this.map,r=t.currentPointer;t.target===this.map&&(t.stopPropagation(),this.a.style.display="none",e.b.$b({bounds:eg([e.Wa(this.i,this.j),e.Wa(r.viewportX,r.viewportY)])},!0))},n.$=function(t,e){ov.prototype.renderInternal.call(this,t,e),this.f.sc(this.Ba().translate("zoom.rectangle"))},qv.prototype.renderInternal=qv.prototype.$,u(lw,ov),t("H.ui.Overview",lw),lw.prototype.Kd=function(t){return this.a.Kd(t),this},lw.prototype.setBaseLayer=lw.prototype.Kd,lw.prototype.i=function(t){t.target.getState()===xv.DOWN?(nw(t=this.a,!0),t.Vi(),t.La("H_overview_active"),t.a.addEventListener("mapviewchange",t.Vi,!1,t)):ow(this.a)},lw.prototype.$=function(t,e){ov.prototype.renderInternal.call(this,t,e),this.f.L().style.float=this.Vc.match("right")?"right":"left",this.a.Ja(this.map),this.f.sc(this.Ba().translate("minimap"))},lw.prototype.renderInternal=lw.prototype.$,lw.prototype.u=function(){this.a.B(),Z.prototype.u.call(this)},u(mw,ov),mw.prototype.Kd=function(t){this.f.Kd(t)},mw.prototype.$=function(t,e){Eu(t,e=uu(e,"div","H_overview_map")),this.i=e},mw.prototype.renderInternal=mw.prototype.$,n=mw.prototype,n.Sl=3,n.Wk=5,n.Xk=5,n.Ja=function(t){this.a=t,this.f=new T(this.i,this.m,{pixelRatio:this.a.$a(),engineType:this.a.ic().type}),this.f.m.L().style.display="none",this.o=this.f.b,this.j=this.a.b},n.Vi=function(t){t&&t.modifiers&t.SIZE&&nw(this,!0),(t=this.j.mb()).zoom=t.zoom-this.Sl,this.o.$b(t)},n.u=function(){mw.l.u.call(this),ow(this),this.f.B(),this.f=this.o=this.j=this.a=this.m=this.i=null},u(sv,ov),t("H.ui.ScaleBar",sv),sv.prototype.$=function(t,e){ov.prototype.renderInternal.call(this,t,e),t.innerHTML='<svg height="12" version="1.1" xmlns="http://www.w3.org/2000/svg"><polyline style="fill:none; stroke:white; stroke-width:4" points="2,2 2,10 98,10 98,2"/><polyline style="fill:none; stroke:black; stroke-width:2" points="2,2 2,10 98,10 98,2"/></svg><div style="padding: 0 0 0 10px"></div>',t.style.direction="ltr",this.j=t.firstChild,e=this.j.childNodes,this.a=e[0],this.f=e[1],this.m=t.lastChild,this.o=Gu.METRIC,this.s=A(function(t){this.mc()||(this.dispatchEvent("toggleunitsystem"),t.preventDefault())},this),this.i=A(function(t){t.preventDefault()},this),Uu(t,"start",this.i),Uu(t,"end",this.s),this.sc(this.Ba().translate("scale.switchToImperial")),this.update()},sv.prototype.renderInternal=sv.prototype.$,sv.prototype.Ja=function(t){this.map&&this.map.removeEventListener("mapviewchange",this.update),t&&t.addEventListener("mapviewchange",this.update),ov.prototype.Ja.apply(this,arguments)},sv.prototype.setMap=sv.prototype.Ja,sv.prototype.capture=function(t,e,r){var n=this.L(),i=n.ownerDocument,o=i.createElement("canvas"),a=o.getContext("2d"),s=i.createElementNS("http://www.w3.org/2000/svg","svg"),u=i.createElementNS("http://www.w3.org/2000/svg","foreignObject"),l=jf(n,i,!1);i=parseFloat(n.offsetWidth)+1;var c=parseFloat(n.offsetHeight),h=i*t;t*=c,o.width=h,o.height=t,s.setAttribute("xmlns","http://www.w3.org/2000/svg"),s.setAttribute("width",h),s.setAttribute("height",t),s.setAttribute("viewBox","0 0 "+i+" "+c),u.setAttribute("width","100%"),u.setAttribute("height","100%"),s.appendChild(u),l.setAttribute("width","100%"),l.setAttribute("height","100%"),l.setAttribute("xmlns","http://www.w3.org/1999/xhtml");var f=window.getComputedStyle(n);"box-shadow display align-items font font-family font-size height text-shadow direction".split(" ").forEach(function(t){l.style.setProperty(t,f.getPropertyValue(t))}),u.appendChild(l),new rf("image",n=$e(s.outerHTML)).then(function(t){a.drawImage(t,0,0),e(o)},r)},sv.prototype.capture=sv.prototype.capture,sv.prototype.kf=function(t){this.o=t,this.sc("imperial"===t?this.Ba().translate("scale.switchToMetric"):this.Ba().translate("scale.switchToImperial")),this.update()},sv.prototype.onUnitSystemChange=sv.prototype.kf,sv.prototype.update=function(){if(this.L()){var t,e=this.v,r=0,n=this.map;if(n){var i=Math.round(.5*n.ya.width),o=Math.round(.5*n.ya.height);(t=n.Wa(i,o))&&(r=Zf(t),n=Zf(n.Wa(i+1,o)),r=100*r.Za(n))}(n=r)&&(this.o===Gu.IMPERIAL?n<pw?(o=n/qw,i=this.Ba().translate("scale.ft")):(o=n/pw,i=this.Ba().translate("scale.mi")):1e3>n?(o=n,i=this.Ba().translate("scale.m")):(o=n/1e3,i=this.Ba().translate("scale.km")),(o=(n=Math.pow(10,Math.floor(Math.log(o)/Math.LN10)))/o*100)<e/5?(n*=5,o*=5):o<e/2?(n*=2,o*=2):o>e&&(n/=2,o/=2),o=Math.round(o),this.j.setAttribute("width",o),this.m.textContent=n+" "+i,this.a.points.getItem(2).x=this.f.points.getItem(2).x=this.a.points.getItem(3).x=this.f.points.getItem(3).x=o-2)}};var pw=1609.344,qw=.3048006,e;t("H.ui.buildInfo",function(){return Ef("H-ui","1.30.7","c2ec5d9")}),H.__bootstrap__='var l,aa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},ca="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function da(a,b){if(b){var c=ca;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&aa(c,a,{configurable:!0,writable:!0,value:b})}}var fa;\nif("function"==typeof Object.setPrototypeOf)fa=Object.setPrototypeOf;else{var ha;a:{var ia={hb:!0},ka={};try{ka.__proto__=ia;ha=ka.hb;break a}catch(a){}ha=!1}fa=ha?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var la=fa;da("Object.setPrototypeOf",function(a){return a||la});var p=this||self;\nfunction ma(a,b,c){a=a.split(".");c=c||p;a[0]in c||"undefined"==typeof c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c[d]&&c[d]!==Object.prototype[d]?c=c[d]:c=c[d]={}:c[d]=b}function na(){}\nfunction oa(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";\nelse if("function"==b&&"undefined"==typeof a.call)return"object";return b}function r(a){return"function"==oa(a)}function qa(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var ra="closure_uid_"+(1E9*Math.random()>>>0),sa=0;function ta(a,b,c){return a.call.apply(a.bind,arguments)}\nfunction ua(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(e,d);return a.apply(b,e)}}return function(){return a.apply(b,arguments)}}function va(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?va=ta:va=ua;return va.apply(null,arguments)}\nfunction wa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();d.push.apply(d,arguments);return a.apply(this,d)}}function t(a,b){ma(a,b,void 0)}function xa(a,b){function c(){}c.prototype=b.prototype;a.W=b.prototype;a.prototype=new c;a.prototype.constructor=a};function x(){}t("H.util.ICache",x);x.prototype.add=function(){};x.prototype.add=x.prototype.add;x.prototype.get=function(){};x.prototype.get=x.prototype.get;x.prototype.sa=function(){};x.prototype.drop=x.prototype.sa;x.prototype.forEach=function(){};x.prototype.forEach=x.prototype.forEach;x.prototype.U=function(){};x.prototype.removeAll=x.prototype.U;x.prototype.ca=function(){};x.prototype.registerOnDrop=x.prototype.ca;x.prototype.qa=function(){};x.prototype.deRegisterOnDrop=x.prototype.qa;function ya(){var a=za,b;for(b in a)return!1;return!0}function Aa(a){var b={},c;for(c in a)b[c]=a[c];return b}var Ba="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ca(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Ba.length;f++)c=Ba[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var y=this;function Da(a){if(Error.captureStackTrace)Error.captureStackTrace(this,Da);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}xa(Da,Error);Da.prototype.name="CustomError";var Ea=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"===typeof a)return"string"!==typeof b||1!=b.length?-1:a.indexOf(b,0);for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};var Fa=va,Ga=String,Ha=y.Object.freeze||function(a){return a},z=[].pop(),Ia=/x/.exec("");function La(a){return Ga(a).split(","!==z?",":" ")}var Ma="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Na(a,b,c,d){if(!(b=a instanceof b)&&c)throw new A(c,d,void 0!==z?void 0:a);return b}function Oa(a,b,c,d){var e;if(!(e="Array"===Pa(a))&&b)throw new A(b,c,d!==z?d:a);return e}\nt("H.lang.isArray",function(a,b,c,d){return Oa(a,b,c,d)});function Qa(a){return"string"===typeof a}t("H.lang.isString",Qa);var Ra=isNaN;function Sa(a){return a===+a}t("H.lang.isNumber",Sa);t("H.lang.isInteger",Number.isInteger?Number.isInteger:function(a){return"number"===typeof a&&0===a%1});function Pa(a){var b=Object[Ma[0]][Ma[6]].call(a).match(/^\\[object (\\w+)\\]$/);return b?b[1]:typeof a}var Ta=[];0>Ta.indexOf(Ta)&&Ta.push(Ta);\nfunction Ua(a,b,c,d){var e="",f=2>arguments.length,g;f&&(b={H:y.H},c="",d=Ta.slice());Va(b,!0,function(h,k){try{if(g=h[k],k=Wa(h,g),!(qa(g)&&g.window===g&&g.self===g||qa(g)&&0<g.nodeType&&r(g.cloneNode))&&qa(g)){if(g===a)return e=c+"."+k,!0;if(0>d.indexOf(g)&&(d.push(g),e=Ua(a,g,c+"."+k,d)))return!0}}catch(m){}});f&&(e=e?e.substr(1).replace("."+Ma[0]+".","#"):"~"+(r(a)?Xa(a)+"()":Pa(a)));return e}\nfunction Wa(a,b){var c=[];Va(a,!1,function(d,e){d[e]===b&&c.push(e)});return c.sort(Ya)[0]}function Ya(a,b){return b.length-a.length}var Za=Object[Ma[0]][Ma[2]];function Va(a,b,c){var d;if(a){for(e in a)if((!b||Za.call(a,e))&&c(a,e,!0))return;for(d=Ma.length;d--;){var e=Ma[d];if((!b||Za.call(a,e))&&c(a,e,!1))break}}}function Xa(a){return(a=/^\\s*function ([^\\( ]+)/.exec(a))?a[1]:"anonymous"}function $a(a,b,c){c[b]="#"+b};function B(a,b,c){this.g=[];b&&this.ca(b);if(c&&!r(c))throw new A(B,2,c);this.b=0;this.filter=c;this.a={};this.f=this.c=null;this.Ia(a)}t("H.util.Cache",B);B.prototype.add=function(a,b,c){var d,e;c=+c;if(!Sa(c)||0>c)throw new A(this.add,2,c);a=String(a);if(e=this.filter?this.filter(a,b,c):!0)(d=this.a[a])?(d.data!==b&&db(this,d),this.b+=c-d.size,d.size=c,d.data=b,eb(this,d)):this.a[a]=fb(this,{id:a,data:b,size:c,A:null,F:null},this.c),gb(this);return e};B.prototype.add=B.prototype.add;\nB.prototype.ca=function(a){if(!r(a))throw new A(this.ca,0,a);this.g.push(a)};B.prototype.registerOnDrop=B.prototype.ca;B.prototype.qa=function(a){this.g=this.g.filter(function(b){return b!==a})};B.prototype.deRegisterOnDrop=B.prototype.qa;B.prototype.get=function(a,b){return(a=b?this.a[a]:eb(this,this.a[a]))&&a.data};B.prototype.get=B.prototype.get;B.prototype.sa=function(a){var b;(b=this.a[a])&&hb(this,b,!0)};B.prototype.drop=B.prototype.sa;\nB.prototype.forEach=function(a,b,c){var d;for(d in this.a){var e=this.a[d];(c?c(d,e.data,e.size):1)&&a.call(b,d,e.data,e.size)}};B.prototype.forEach=B.prototype.forEach;B.prototype.U=function(a){var b;for(b in this.a){var c=this.a[b];(a?a(b,c.data,c.size):1)&&hb(this,this.a[b],!0)}};B.prototype.removeAll=B.prototype.U;B.prototype.Ia=function(a){if(!(0<+a))throw new A(B.prototype.Ia,0,a);this.o=+a;gb(this);return this};B.prototype.setMaxSize=B.prototype.Ia;B.prototype.Bb=function(){return this.o};\nB.prototype.getMaxSize=B.prototype.Bb;B.prototype.xb=function(){return this.b};B.prototype.getCurrentSize=B.prototype.xb;function eb(a,b){b&&(a.c=fb(a,b,a.c));return b}function gb(a){for(;a.b>a.o&&a.f;)hb(a,a.f,!0)}function fb(a,b,c){if(c!==b){(b.A||b.F)&&hb(a,b,!1);if(b.A=c)b.F=c.F,c.F=b;b.F||(a.c=b);b.A||(a.f=b);a.b+=b.size}return b}function hb(a,b,c){var d=b.F,e=b.A;if(d||e||b==a.c&&b==a.f)d?d.A=e:a.c=e,e?e.F=d:a.f=d,a.b-=b.size,c&&(delete a.a[b.id],db(a,b));b.A=b.F=null}\nfunction db(a,b){for(var c=a.g.length;c--;)a.g[c].call(a,b.id,b.data,b.size)};function C(){}t("H.service.extension.dataView.ITable",C);C.prototype.ya=function(){};C.prototype.getMeta=C.prototype.ya;C.prototype.za=function(){};C.prototype.getRowCount=C.prototype.za;C.prototype.ja=function(){};C.prototype.getRow=C.prototype.ja;C.prototype.D=function(){};C.prototype.getColumnNames=C.prototype.D;C.prototype.xa=function(){};C.prototype.getColumn=C.prototype.xa;C.prototype.s=function(){};C.prototype.getCell=C.prototype.s;C.prototype.concat=function(){};C.prototype.concat=C.prototype.concat;function ib(){}t("H.service.extension.dataView.IRow",ib);ib.prototype.D=function(){};ib.prototype.getColumnNames=ib.prototype.D;ib.prototype.s=function(){};ib.prototype.getCell=ib.prototype.s;ib.prototype.Aa=function(){};ib.prototype.getTable=ib.prototype.Aa;function jb(a,b){this.a=a;this.b=b}t("H.service.extension.dataView.ObjRow",jb);jb.prototype.D=function(){return this.a.D()};jb.prototype.getColumnNames=jb.prototype.D;jb.prototype.s=function(a){return this.a.s(this.b,a)};jb.prototype.getCell=jb.prototype.s;jb.prototype.Aa=function(){return this.a};jb.prototype.getTable=jb.prototype.Aa;function kb(){}t("H.service.extension.dataView.IColumn",kb);kb.prototype.s=function(){};kb.prototype.getCell=kb.prototype.s;function lb(a,b){this.b=a;this.a=b}t("H.service.extension.dataView.ObjColumn",lb);lb.prototype.s=function(a){return this.b.s(a,this.a)};lb.prototype.getCell=lb.prototype.s;function A(a,b,c){var d=arguments.length;b=b!==z?+b:b;if(b!==z){var e=(e=/^.*?\\(([^\\)]+)/.exec((""+a).replace(/(\\/\\*([\\s\\S]*?)\\*\\/)|(\\/\\/(.*)$)/gm,"")))?La(e[1].replace(/\\s+/g,"")):[];e.forEach($a);e=e[b]||"#"+b}var f=a?Ua(a):"";d=2<d?Ga(c):"";if(e||d)f+=" (Argument "+(e||"")+(d?" "+d:"")+")";d=Error(f);Object.setPrototypeOf(d,A.prototype);return d}xa(A,Error);t("H.lang.InvalidArgumentError",A);A.prototype.name="InvalidArgumentError";function D(a,b,c){var d;b=b||(a&&a.length?Object.keys(a[0]):z);this.G=a;if(b)for(this.O=b,this.pa=a=Object.create(Ia,void 0),d=b.length;d--;)a[b[d]]=!0;c!==z&&(this.Ca=c)}t("H.service.extension.dataView.ObjTable",D);l=D.prototype;l.Ca=z;l.G=z;l.O=z;l.pa=z;l.ya=function(){return this.Ca};D.prototype.getMeta=D.prototype.ya;D.prototype.za=function(){return this.G?this.G.length:0};D.prototype.getRowCount=D.prototype.za;D.prototype.ja=function(a){var b=this.G;return b&&b[a]?new jb(this,a):z};\nD.prototype.getRow=D.prototype.ja;D.prototype.D=function(){return this.O||mb};D.prototype.getColumnNames=D.prototype.D;D.prototype.xa=function(a){return this.pa[a]?new lb(this,a):z};D.prototype.getColumn=D.prototype.xa;D.prototype.s=function(a,b){var c=this.G;return(a=c&&this.pa[b]&&c[a])&&a[b]};D.prototype.getCell=D.prototype.s;\nD.prototype.concat=function(){var a=arguments.length,b,c=this.O,d=""+this.O,e=(this.G||[]).slice();for(b=0;b<a;b++){var f=arguments[b];if(!(f instanceof D))throw new A(this.concat,b);if(f.G){if(c&&""+f.O!==d)throw new A(this.concat,b,"Incompatible columns!");e=e.concat(f.G)}}return new D(e,this.O,this.Ca)};D.prototype.concat=D.prototype.concat;function E(a,b){this.x=+a;this.y=+b}t("H.math.Point",E);E.prototype.set=E;E.prototype.set=E.prototype.set;E.prototype.clone=function(a){a?(a.x=this.x,a.y=this.y):a=new E(this.x,this.y);return a};E.prototype.clone=E.prototype.clone;E.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};E.prototype.add=E.prototype.add;E.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;return this};E.prototype.sub=E.prototype.sub;E.prototype.scale=function(a,b){this.x*=a;this.y*=void 0===b?a:b;return this};\nE.prototype.scale=E.prototype.scale;E.prototype.round=function(){this.x=nb(this.x);this.y=nb(this.y);return this};E.prototype.round=E.prototype.round;E.prototype.floor=function(){this.x=ob(this.x);this.y=ob(this.y);return this};E.prototype.floor=E.prototype.floor;E.prototype.ceil=function(){this.x=pb(this.x);this.y=pb(this.y);return this};E.prototype.ceil=E.prototype.ceil;E.prototype.I=function(a){return!(!a||this.x!==a.x||this.y!==a.y)};E.prototype.equals=E.prototype.I;\nE.prototype.Cb=function(a,b){var c=b.x-a.x,d=b.y-a.y,e=a;if(c||d){var f=((this.x-a.x)*c+(this.y-a.y)*d)/(c*c+d*d);0>=f?e=a:1<=f?e=b:e=new E(a.x+f*c,a.y+f*d)}return e};E.prototype.getNearest=E.prototype.Cb;E.prototype.ra=function(a){return qb(rb(this.x-a.x,2)+rb(this.y-a.y,2))};E.prototype.distance=E.prototype.ra;E.fromIPoint=function(a){if(!a)throw Error("invalid argument");return a instanceof E?a:new E(a.x,a.y)};var F=Math,sb=F.min,tb=F.max,nb=F.round,ob=F.floor,pb=F.ceil,ub=F.abs,vb=F.log,qb=F.sqrt,rb=F.pow,wb=F.exp,xb=F.sin,yb=F.asin,zb=F.cos,Ab=F.tan,Bb=F.atan,Cb=F.atan2,Db=F.LN2,I=F.PI,Eb=I/2,Gb=I/4,Hb=2*I,Ib=3*I,Jb=I/180,Kb=180/I,Lb=1/0;rb(-2,53);function Mb(a,b){var c;return 0>(c=a%b)===0>b?c:c+b}t("H.math.normalize",function(a,b,c){b-=c=c||0;a-=c;return a-ob(a/b)*b+c});function Nb(a,b,c){return a>c?c:a<b?b:a}t("H.math.clamp",Nb);function Ob(a,b,c){return b<c?a>=b&&a<=c:a>=c&&a<=b}\nfunction Pb(a,b,c,d,e,f){return qb(rb((a-e)*(d-f)-(b-f)*(c-e),2)/(rb(c-e,2)+rb(d-f,2)))}var Qb={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};t("H.math.CoverType",Qb);\nfunction Rb(a,b,c){for(var d=c.length,e=d,f,g,h,k,m=c[0],n=0,q=0,u=0;1!=n&&1<e;){g=c[--e];f=c[--e];k=c[e?e-1:(d+(e-1))%d];h=c[e?e-2:(d+(e-2))%d];if(f>=a&&f<=a&&g>=b&&g<=b||h>=a&&h<=a&&k>=b&&k<=b)n=1;else if(!n&&f===a)h===a&&(g<b&&k>b||g>b&&k<b)||(m<=a&&h>a||m>=a&&h<a)&&(g>=b?++q:++u),n=Ob(b,g,k)&&0>=Pb(a,b,f,g,h,k)?2:0;else if(!n&&Ob(a,f,h)){if(f<a&&h>a||f>a&&h<a)m=g+(a-f)/(h-f)*(k-g),q+=m>b,u+=m<b;n=Ob(b,g,k)&&0>=Pb(a,b,f,g,h,k)?2:0}m=f}!n&&0!==u&&0!==q%2&&(n=3);return n}\nfunction Sb(a,b){return Rb(a.x,a.y,b)!==Qb.NONE}t("H.math.isPointInsidePolygon",Sb);function Tb(a){for(var b=a.length,c=new Float64Array(2*b),d=b&&a[0].x!==z;b--;){var e=a[b],f=b<<1;c[f]=d?e.x:e[0];c[f+1]=d?e.y:e[1]}return c}t("H.math.flatten",Tb);function Ub(a,b,c,d,e,f){var g,h,k=a.length,m,n;if(k)for(g=[];k--;){var q=a[k];var u=q.length;var J=0;for(m=1;m<u;m++)if(n=Vb(q[m-1],q[m],c,b,d,e)){var M=n[0];var v=n[1];J&&J.I(M)?h.push(v):g.push(h=n);J=v;f&&(m=u,k=0)}}else g=a;return g}t("H.math.clipping.clipStrips",Ub);\nfunction Vb(a,b,c,d,e,f){var g=a.x;a=-a.y;var h=b.x;b=-b.y;c=-c;f=-f;if(g>h){if(h>e||g<d)return;var k=g;var m=a;g=h;a=b;h=k;b=m;k=1}else if(g>e||h<d)return;if(a>b){if(b>c||a<f)return;var n=1;a=-a;b=-b;m=f;f=-c;c=-m}else if(a>c||b<f)return;if(g<d){if((a+=(d-g)*(b-a)/(h-g))>c)return;g=d}if(a<f){if((g+=(f-a)*(h-g)/(b-a))>e)return;a=f}h>e&&(b=a+(e-g)*(b-a)/(h-g),h=e);b>c&&(h=g+(c-a)*(h-g)/(b-a),b=c);n&&(a=-a,b=-b);return k?[new E(h,-b),new E(g,-a)]:[new E(g,-a),new E(h,-b)]}\nfunction Wb(a,b,c){a=Xb(a,!0);b=Xb(b,!1);var d,e;var f={};var g=d=1;switch(~~(c||0)){case 1:g=d=0;break;case 2:d=0;g=1;break;case 3:d=1,g=0}c=d;var h=g;if(b&&a){b.ia=Yb(b.x,b.y,null,Zb(b));a.ia=Yb(a.x,a.y,null,Zb(a));for(g=b;g.next;g=g.next)if(!g.C)for(d=a;d.next;d=d.next)if(!d.C){var k=$b(g.next);var m=$b(d.next);if(e=ac(g,k,d,m,f)){e=f.kb;var n=f.lb;var q=f.kc;var u=f.lc;e=Yb(q,u,null,null,null,null,!0,0,0,e);bc(e,g,k);k=Yb(q,u,null,null,null,null,!0,0,0,n);bc(k,d,m);e.Da=k;k.Da=e}}f=Sb(b,cc(a));\nc&&(f=!f);for(g=b;g;g=g.next)g.C&&(g.ta=f,f=!f);f=Sb(a,cc(b));h&&(f=!f);for(d=a;d.next;d=d.next)d.C&&(d.ta=f,f=!f);dc(b);for(dc(a);(a=ec(b))!=b;){for(c=null;!a.na;a=a.Da){for(f=a.ta;;){c=Yb(a.x,a.y,c);c.artificial=a.C||a.Ob;a.na=1;a=f?a.next:a.u;if(!a)break;if(a.C){a.na=1;break}}if(!a)break}c.Xa=J;var J=c}return J}}t("H.math.clipping.clipPolygon",Wb);\nfunction Yb(a,b,c,d,e,f,g,h,k,m){a={x:a,y:b,next:c||null,u:d||null,Xa:e||null,Da:f||null,C:!!g,ta:h||0,na:k||0,alpha:m||0};d&&(a.u.next=a);c&&(a.next.u=a);return a}function $b(a){for(;a&&a.C;)a=a.next;return a}function Zb(a){if(a)for(;a.next;)a=a.next;return a}function ec(a){var b=a;if(b){do b=b.next;while(b!=a&&(!b.C||b.C&&b.na))}return b}function dc(a){var b=Zb(a);b.u.next=a;a.u=b.u}\nfunction ac(a,b,c,d,e){var f,g=b.x-a.x,h=b.y-a.y;var k=d.x-c.x;var m=d.y-c.y;var n=g*m-h*k;if(!n)return 0;k=((c.x-a.x)*m-(c.y-a.y)*k)/n;n=(h*(c.x-a.x)-g*(c.y-a.y))/n;if(0>k||1<k||0>n||1<n)return 0;0===k?f=a:1===k?f=b:0===n?f=c:1===n&&(f=d);if(f)return f.x+=2.480549651603763E-5,f.y+=7.321997314118067E-5,f.ia&&(f.ia.x=f.x,f.ia.y=f.y),ac(a,b,c,d,e);e.kc=a.x+k*g;e.lc=a.y+k*h;e.kb=k;e.lb=n;return 1}function cc(a){for(var b=[];a;)b.push(a.x,a.y),a=a.next;return b}\nfunction bc(a,b,c){for(b=b.next;b!==c&&b.alpha<=a.alpha;)b=b.next;a.next=b;a.u=b.u;a.next.u=a;a.u.next=a}function Xb(a,b){for(var c,d=null,e=0,f=a.length;e<f;e++){c=Yb(a[e].x,a[e].y,d);c.Ob=b;if(c.next=d)d.u=c;d=c}return d};function fc(a,b){var c=[];a&&c.push(Ua(a));1<arguments.length&&c.push(""+b);c=Error(c.join(" "));Object.setPrototypeOf(c,fc.prototype);return c}xa(fc,Error);t("H.lang.IllegalOperationError",fc);fc.prototype.name="IllegalOperationError";function gc(){if(!Qa("STATIC_DB"))throw new A(this.constructor,0);this.o=y.indexedDB||y.jc||y.Rb||y.Sb;if(!this.o)throw new fc(this.constructor,"This browser does not support IndexedDB");this.a=[];this.c=[];this.g=Fa(this.g,this)}var hc,ic;gc.prototype.get=function(a,b,c){var d;if(!Qa(a)&&!Sa(a))throw new A(this.get,0);if(!r(b))throw new A(this.get,1);jc(this,function(e){d=e.get(a);kc(d,b,c)},c);return{cancel:function(){d&&(d.onsuccess=lc)}}};\ngc.prototype.g=function(){var a=this.b.result;a.objectStoreNames.contains("data")||a.createObjectStore("data")};\nfunction mc(a,b,c){if(a.b)a.a?(a.a.push(b),c&&a.c.push(c)):a.f?c&&c(a.f):b(a.b.result);else{a.b=a.o.open(nc+"STATIC_DB",1);a.b.onupgradeneeded=a.g;var d=a.b.onerror=function(){clearTimeout(a.v);a.f=this.error;a.c.forEach(function(e){e(a.f)});a.a=a.c=null};a.v=setTimeout(function(){d.call({error:Error("DbOpenTimeoutError")})},500);a.b.onsuccess=function(){clearTimeout(a.v);a.a?(a.a.forEach(function(e){e(this.result)},this),a.a=a.c=null):(a.b=a.f=null,a.a=[],a.c=[])};a.a.push(b);c&&a.c.push(c)}}\nfunction jc(a,b,c){mc(a,function(d){d=d.transaction(["data"],"readwrite");b(d.objectStore("data"))},c)}function kc(a,b,c){b&&(a.onsuccess=function(){b(this.result)});c&&(a.onerror=function(){c(this.error)})}t("H.util.IndexedDBStorage.getInstance",function(){hc||(hc=new gc);return hc});var nc="H_";\nt("H.util.IndexedDBStorage.isSupported",function(){var a="";if(ic===z)if("file:"===window.location.protocol&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&128<=window.location.href.length)ic=!1;else{try{var b=y.indexedDB||y.jc||y.Rb||y.Sb;a=nc+"TEST_DB";var c=b&&b.open(a,1)}catch(d){}ic=!!c&&null===c.onupgradeneeded;c&&b.deleteDatabase&&b.deleteDatabase(a)}return ic});function K(){0!=oc&&(pc[this[ra]||(this[ra]=++sa)]=this);this.c=this.c;this.a=this.a}var oc=0,pc={};K.prototype.c=!1;K.prototype.B=function(){if(!this.c&&(this.c=!0,this.P(),0!=oc)){var a=this[ra]||(this[ra]=++sa);if(0!=oc&&this.a&&0<this.a.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass\' method.");delete pc[a]}};\nK.prototype.N=function(a,b){this.c?void 0!==b?a.call(b):a():(this.a||(this.a=[]),this.a.push(void 0!==b?va(a,b):a))};K.prototype.P=function(){if(this.a)for(;this.a.length;)this.a.shift()()};function L(a,b){this.type=a;this.currentTarget=this.target=b;this.a=!1;this.Za=!0}L.prototype.stopPropagation=function(){this.a=!0};L.prototype.c=function(){this.Za=!1};t("H.util.Event",L);L.prototype.stopPropagation=L.prototype.stopPropagation;L.prototype.stopPropagation=L.prototype.stopPropagation;L.prototype.CAPTURING_PHASE=1;L.prototype.CAPTURING_PHASE=L.prototype.CAPTURING_PHASE;L.prototype.AT_TARGET=2;L.prototype.AT_TARGET=L.prototype.AT_TARGET;L.prototype.BUBBLING_PHASE=3;L.prototype.BUBBLING_PHASE=L.prototype.BUBBLING_PHASE;L.prototype.eventPhase=0;L.prototype.eventPhase=L.prototype.eventPhase;function qc(a,b,c){qc.W.constructor.call(this,a,c);this.data=b}xa(qc,L);t("H.util.DataEvent",qc);function rc(a,b,c){rc.W.constructor.call(this,a,c);this.message=b}xa(rc,L);t("H.util.ErrorEvent",rc);function sc(a,b){this.c=a;this.f=b;this.b=0;this.a=null}sc.prototype.get=function(){if(0<this.b){this.b--;var a=this.a;this.a=a.next;a.next=null}else a=this.c();return a};function tc(a,b){a.f(b);100>a.b&&(a.b++,b.next=a.a,a.a=b)};function uc(){this.b=this.a=null}var wc=new sc(function(){return new vc},function(a){a.reset()});uc.prototype.add=function(a,b){var c=wc.get();c.set(a,b);this.b?this.b.next=c:this.a=c;this.b=c};function xc(){var a=yc,b=null;a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null);return b}function vc(){this.next=this.b=this.a=null}vc.prototype.set=function(a,b){this.a=a;this.b=b;this.next=null};vc.prototype.reset=function(){this.next=this.b=this.a=null};var Bc=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\\s\\xa0]*([\\s\\S]*?)[\\s\\xa0]*$/.exec(a)[1]};function Cc(a,b){return a<b?-1:a>b?1:0};var Dc;a:{var Ec=p.navigator;if(Ec){var Fc=Ec.userAgent;if(Fc){Dc=Fc;break a}}Dc=""}function Gc(a){return-1!=Dc.indexOf(a)};function Hc(a,b){this.b=a===Ic&&b||"";this.a=Jc}var Jc={},Ic={},Kc=new Hc(Ic,"");function Lc(a,b){this.b=a===Mc&&b||"";this.a=Nc}var Nc={},Mc={};function Oc(){this.a="";this.b=Pc}function Qc(){var a=Rc;if(a instanceof Oc&&a.constructor===Oc&&a.b===Pc)return a.a;oa(a);return"type_error:SafeHtml"}var Pc={};function Sc(a){var b=new Oc;b.a=a;return b}Sc("<!DOCTYPE html>");var Rc=Sc("");Sc("<br>");function Tc(a){var b=new Lc(Mc,Kc instanceof Hc&&Kc.constructor===Hc&&Kc.a===Jc?Kc.b:"type_error:Const");b instanceof Lc&&b.constructor===Lc&&b.a===Nc?b=b.b:(oa(b),b="type_error:TrustedResourceUrl");a.src=b.toString()};function Uc(a){Uc[" "](a);return a}Uc[" "]=na;var Vc=Gc("Opera"),Wc=Gc("Trident")||Gc("MSIE"),Xc=Gc("Edge"),Yc=Gc("Gecko")&&!(-1!=Dc.toLowerCase().indexOf("webkit")&&!Gc("Edge"))&&!(Gc("Trident")||Gc("MSIE"))&&!Gc("Edge"),Zc=-1!=Dc.toLowerCase().indexOf("webkit")&&!Gc("Edge");function $c(){var a=p.document;return a?a.documentMode:void 0}var ad;\na:{var bd="",cd=function(){var a=Dc;if(Yc)return/rv:([^\\);]+)(\\)|;)/.exec(a);if(Xc)return/Edge\\/([\\d\\.]+)/.exec(a);if(Wc)return/\\b(?:MSIE|rv)[: ]([^\\);]+)(\\)|;)/.exec(a);if(Zc)return/WebKit\\/(\\S+)/.exec(a);if(Vc)return/(?:Version)[ \\/]?(\\S+)/.exec(a)}();cd&&(bd=cd?cd[1]:"");if(Wc){var dd=$c();if(null!=dd&&dd>parseFloat(bd)){ad=String(dd);break a}}ad=bd}var ed={},fd;fd=p.document&&Wc?$c():void 0;function gd(a){var b=document;a=String(a);"application/xhtml+xml"===b.contentType&&(a=a.toLowerCase());return b.createElement(a)};function hd(a){p.setTimeout(function(){throw a;},0)}var id;\nfunction jd(){var a=p.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!Gc("Presto")&&(a=function(){var e=gd("IFRAME");e.style.display="none";Tc(e);document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.write(Qc());e.close();var g="callImmediate"+Math.random(),h="file:"==f.location.protocol?"*":f.location.protocol+"//"+f.location.host;e=va(function(k){if(("*"==h||k.origin==h)&&k.data==g)this.port1.onmessage()},\nthis);f.addEventListener("message",e,!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,h)}}});if("undefined"!==typeof a&&!Gc("Trident")&&!Gc("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var e=c.Oa;c.Oa=null;e()}};return function(e){d.next={Oa:e};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in gd("SCRIPT")?function(e){var f=gd("SCRIPT");f.onreadystatechange=function(){f.onreadystatechange=null;\nf.parentNode.removeChild(f);f=null;e();e=null};document.documentElement.appendChild(f)}:function(e){p.setTimeout(e,0)}};function kd(a,b){ld||md();nd||(ld(),nd=!0);yc.add(a,b)}var ld;function md(){if(p.Promise&&p.Promise.resolve){var a=p.Promise.resolve(void 0);ld=function(){a.then(od)}}else ld=function(){var b=od;!r(p.setImmediate)||p.Window&&p.Window.prototype&&!Gc("Edge")&&p.Window.prototype.setImmediate==p.setImmediate?(id||(id=jd()),id(b)):p.setImmediate(b)}}var nd=!1,yc=new uc;function od(){for(var a;a=xc();){try{a.a.call(a.b)}catch(b){hd(b)}tc(wc,a)}nd=!1};function pd(a){this.a=qd;this.v=void 0;this.f=this.b=this.c=null;this.g=this.o=!1;if(a!=na)try{var b=this;a.call(void 0,function(c){rd(b,sd,c)},function(c){rd(b,td,c)})}catch(c){rd(this,td,c)}}var qd=0,sd=2,td=3;function ud(){this.next=this.c=this.b=this.f=this.a=null;this.g=!1}ud.prototype.reset=function(){this.c=this.b=this.f=this.a=null;this.g=!1};var vd=new sc(function(){return new ud},function(a){a.reset()});function wd(a,b,c){var d=vd.get();d.f=a;d.b=b;d.c=c;return d}\nfunction xd(a,b,c){yd(a,b,c,null)||kd(wa(b,a))}function zd(a){return new pd(function(b,c){var d=a.length,e=[];if(d)for(var f=function(m,n){d--;e[m]=n;0==d&&b(e)},g=function(m){c(m)},h=0,k;h<a.length;h++)k=a[h],xd(k,wa(f,h),g);else b(e)})}function Ad(){var a,b,c=new pd(function(d,e){a=d;b=e});return new Bd(c,a,b)}pd.prototype.then=function(a,b,c){return Cd(this,r(a)?a:null,r(b)?b:null,c)};pd.prototype.$goog_Thenable=!0;\npd.prototype.cancel=function(a){if(this.a==qd){var b=new Dd(a);kd(function(){Ed(this,b)},this)}};function Ed(a,b){if(a.a==qd)if(a.c){var c=a.c;if(c.b){for(var d=0,e=null,f=null,g=c.b;g&&(g.g||(d++,g.a==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(c.a==qd&&1==d?Ed(c,b):(f?(d=f,d.next==c.f&&(c.f=d),d.next=d.next.next):Fd(c),Gd(c,e,td,b)))}a.c=null}else rd(a,td,b)}function Hd(a,b){a.b||a.a!=sd&&a.a!=td||Id(a);a.f?a.f.next=b:a.b=b;a.f=b}\nfunction Cd(a,b,c,d){var e=wd(null,null,null);e.a=new pd(function(f,g){e.f=b?function(h){try{var k=b.call(d,h);f(k)}catch(m){g(m)}}:f;e.b=c?function(h){try{var k=c.call(d,h);void 0===k&&h instanceof Dd?g(h):f(k)}catch(m){g(m)}}:g});e.a.c=a;Hd(a,e);return e.a}pd.prototype.Ea=function(a){this.a=qd;rd(this,sd,a)};pd.prototype.Ga=function(a){this.a=qd;rd(this,td,a)};\nfunction rd(a,b,c){a.a==qd&&(a===c&&(b=td,c=new TypeError("Promise cannot resolve to itself")),a.a=1,yd(c,a.Ea,a.Ga,a)||(a.v=c,a.a=b,a.c=null,Id(a),b!=td||c instanceof Dd||Jd(a,c)))}function yd(a,b,c,d){if(a instanceof pd)return Hd(a,wd(b||na,c||null,d)),!0;if(a)try{var e=!!a.$goog_Thenable}catch(g){e=!1}else e=!1;if(e)return a.then(b,c,d),!0;if(qa(a))try{var f=a.then;if(r(f))return Kd(a,f,b,c,d),!0}catch(g){return c.call(d,g),!0}return!1}\nfunction Kd(a,b,c,d,e){function f(k){h||(h=!0,d.call(e,k))}function g(k){h||(h=!0,c.call(e,k))}var h=!1;try{b.call(a,g,f)}catch(k){f(k)}}function Id(a){a.o||(a.o=!0,kd(a.T,a))}function Fd(a){var b=null;a.b&&(b=a.b,a.b=b.next,b.next=null);a.b||(a.f=null);return b}pd.prototype.T=function(){for(var a;a=Fd(this);)Gd(this,a,this.a,this.v);this.o=!1};\nfunction Gd(a,b,c,d){if(c==td&&b.b&&!b.g)for(;a&&a.g;a=a.c)a.g=!1;if(b.a)b.a.c=null,Ld(b,c,d);else try{b.g?b.f.call(b.c):Ld(b,c,d)}catch(e){Md.call(null,e)}tc(vd,b)}function Ld(a,b,c){b==sd?a.f.call(a.c,c):a.b&&a.b.call(a.c,c)}function Jd(a,b){a.g=!0;kd(function(){a.g&&Md.call(null,b)})}var Md=hd;function Dd(a){Da.call(this,a)}xa(Dd,Da);Dd.prototype.name="cancel";function Bd(a,b,c){this.a=a;this.b=b;this.reject=c};function Nd(a,b,c){this.type=a;this.data=b;this.a=Ad();this.Va=Fa(this.Va,this);this.reject=Fa(this.reject,this);this.priority=Od;c!==z&&(this.priority=c);this.b().add(this)}var Od=1,Pd={nc:0,oc:Od,mc:2};l=Nd.prototype;l.then=function(a,b,c){return this.a.a.then(a,b,c)};l.Va=function(a){this.$=3;this.a.b(a)};l.reject=function(a){this.$=5;this.a.reject(a)};l.$=0;\nl.cancel=function(){if(3>this.$){this.c();var a=this.b(),b=this.priority,c=a.a[b].indexOf(this);-1<c?a.a[b].splice(c,1):this.Na&&a.ea.ob(this.Na);this.$=4}};function Qd(a){var b;this.a={};for(b in Pd)this.a[Pd[b]]=[];this.ea=a;this.ea.addEventListener("allocatable",Fa(this.b,this))}t("H.util.JobManager",Qd);var Rd=Object.keys(Pd).map(function(a){return Pd[a]}).sort().reverse();Qd.prototype.add=function(a){Na(a,Nd,this.add,0);this.a[a.priority].push(a);this.b()};Qd.prototype.contains=function(a){return-1<this.a[a.priority].indexOf(a)};\nQd.prototype.b=function(){Rd.forEach(function(a){this.a[a]=this.a[a].filter(function(b){var c;if((c=this.ea.pc(b))!==Ia){var d=Fa(this.ea.ob,this.ea,c,b);b.Na=c;b.then(d,d);b.$=b.qc(c)?1:5}else return!0},this)},this)};function Sd(a,b,c){var d=[],e=arguments.length;a&&d.push(Ua(a));1<e&&(e=2<e&&Oa(c,void 0,void 0,void 0)?" out of ["+c[0]+"..."+c[1]+"]":"",d.push("("+b+e+")"));d=Error(d.join(" "));Object.setPrototypeOf(d,Sd.prototype);return d}xa(Sd,Error);t("H.lang.OutOfRangeError",Sd);Sd.prototype.name="OutOfRangeError";var Td="closure_listenable_"+(1E6*Math.random()|0),Ud=0;function Vd(a,b,c,d,e){this.listener=a;this.proxy=null;this.src=b;this.type=c;this.capture=!!d;this.ka=e;this.key=++Ud;this.V=this.fa=!1}function Wd(a){a.V=!0;a.listener=null;a.proxy=null;a.src=null;a.ka=null};function Xd(a){this.src=a;this.a={};this.b=0}Xd.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.a[f];a||(a=this.a[f]=[],this.b++);var g=Yd(a,b,d,e);-1<g?(b=a[g],c||(b.fa=!1)):(b=new Vd(b,this.src,f,!!d,e),b.fa=c,a.push(b));return b};function Zd(a,b){var c=b.type;if(c in a.a){var d=a.a[c],e=Ea(d,b),f;(f=0<=e)&&Array.prototype.splice.call(d,e,1);f&&(Wd(b),0==a.a[c].length&&(delete a.a[c],a.b--))}}\nXd.prototype.U=function(a){a=a&&a.toString();var b=0,c;for(c in this.a)if(!a||c==a){for(var d=this.a[c],e=0;e<d.length;e++)++b,Wd(d[e]);delete this.a[c];this.b--}return b};function Yd(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.V&&f.listener==b&&f.capture==!!c&&f.ka==d)return e}return-1};var $d;($d=!Wc)||($d=9<=Number(fd));var ae=$d,be;\nif(be=Wc){var ce;if(Object.prototype.hasOwnProperty.call(ed,"9"))ce=ed["9"];else{for(var de=0,ee=Bc(String(ad)).split("."),fe=Bc("9").split("."),ge=Math.max(ee.length,fe.length),he=0;0==de&&he<ge;he++){var ie=ee[he]||"",je=fe[he]||"";do{var ke=/(\\d*)(\\D*)(.*)/.exec(ie)||["","","",""],le=/(\\d*)(\\D*)(.*)/.exec(je)||["","","",""];if(0==ke[0].length&&0==le[0].length)break;de=Cc(0==ke[1].length?0:parseInt(ke[1],10),0==le[1].length?0:parseInt(le[1],10))||Cc(0==ke[2].length,0==le[2].length)||Cc(ke[2],le[2]);\nie=ke[3];je=le[3]}while(0==de)}ce=ed["9"]=0<=de}be=!ce}var me=be,ne=function(){if(!p.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{p.addEventListener("test",na,b),p.removeEventListener("test",na,b)}catch(c){}return a}();function oe(a,b){L.call(this,a?a.type:"");this.relatedTarget=this.currentTarget=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.pointerId=0;this.pointerType="";this.b=null;if(a){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.currentTarget=b;if(b=a.relatedTarget){if(Yc){a:{try{Uc(b.nodeName);var e=!0;break a}catch(f){}e=\n!1}e||(b=null)}}else"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=\na.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType="string"===typeof a.pointerType?a.pointerType:pe[a.pointerType]||"";this.b=a;a.defaultPrevented&&this.c()}}xa(oe,L);var pe={2:"touch",3:"pen",4:"mouse"};oe.prototype.stopPropagation=function(){oe.W.stopPropagation.call(this);this.b.stopPropagation?this.b.stopPropagation():this.b.cancelBubble=!0};\noe.prototype.c=function(){oe.W.c.call(this);var a=this.b;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,me)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var qe="closure_lm_"+(1E6*Math.random()|0),re={},se=0;function te(a,b,c,d,e){if(d&&d.once)ue(a,b,c,d,e);else if("array"==oa(b))for(var f=0;f<b.length;f++)te(a,b[f],c,d,e);else c=ve(c),a&&a[Td]?a.b.add(String(b),c,!1,qa(d)?!!d.capture:!!d,e):we(a,b,c,!1,d,e)}\nfunction we(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=qa(e)?!!e.capture:!!e,h=xe(a);h||(a[qe]=h=new Xd(a));c=h.add(b,c,d,g,f);if(!c.proxy){d=ye();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)ne||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(ze(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");se++}}\nfunction ye(){var a=Ae,b=ae?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b}function ue(a,b,c,d,e){if("array"==oa(b))for(var f=0;f<b.length;f++)ue(a,b[f],c,d,e);else c=ve(c),a&&a[Td]?a.b.add(String(b),c,!0,qa(d)?!!d.capture:!!d,e):we(a,b,c,!0,d,e)}\nfunction Ce(a,b,c,d,e){if("array"==oa(b))for(var f=0;f<b.length;f++)Ce(a,b[f],c,d,e);else(d=qa(d)?!!d.capture:!!d,c=ve(c),a&&a[Td])?(a=a.b,b=String(b).toString(),b in a.a&&(f=a.a[b],c=Yd(f,c,d,e),-1<c&&(Wd(f[c]),Array.prototype.splice.call(f,c,1),0==f.length&&(delete a.a[b],a.b--)))):a&&(a=xe(a))&&(b=a.a[b.toString()],a=-1,b&&(a=Yd(b,c,d,e)),(c=-1<a?b[a]:null)&&De(c))}\nfunction De(a){if("number"!==typeof a&&a&&!a.V){var b=a.src;if(b&&b[Td])Zd(b.b,a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(ze(c),d):b.addListener&&b.removeListener&&b.removeListener(d);se--;(c=xe(b))?(Zd(c,a),0==c.b&&(c.src=null,b[qe]=null)):Wd(a)}}}function ze(a){return a in re?re[a]:re[a]="on"+a}\nfunction Ee(a,b,c,d){var e=!0;if(a=xe(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.V&&(f=Fe(f,d),e=e&&!1!==f)}return e}function Fe(a,b){var c=a.listener,d=a.ka||a.src;a.fa&&De(a);return c.call(d,b)}\nfunction Ae(a,b){if(a.V)return!0;if(!ae){if(!b)a:{b=["window","event"];for(var c=p,d=0;d<b.length;d++)if(c=c[b[d]],null==c){b=null;break a}b=c}d=b;b=new oe(d,this);c=!0;if(!(0>d.keyCode||void 0!=d.returnValue)){a:{var e=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==d.returnValue)d.returnValue=!0}d=[];for(e=b.currentTarget;e;e=e.parentNode)d.push(e);a=a.type;for(e=d.length-1;!b.a&&0<=e;e--){b.currentTarget=d[e];var f=Ee(d[e],a,!0,b);c=c&&f}for(e=0;!b.a&&e<d.length;e++)b.currentTarget=\nd[e],f=Ee(d[e],a,!1,b),c=c&&f}return c}return Fe(a,new oe(b,this))}function xe(a){a=a[qe];return a instanceof Xd?a:null}var Ge="__closure_events_fn_"+(1E9*Math.random()>>>0);function ve(a){if(r(a))return a;a[Ge]||(a[Ge]=function(b){return a.handleEvent(b)});return a[Ge]};function N(){K.call(this);this.b=new Xd(this);this.v=this;this.o=null}xa(N,K);N.prototype[Td]=!0;l=N.prototype;l.K=function(){return this.o};l.Ja=function(a){this.o=a};l.addEventListener=function(a,b,c,d){te(this,a,b,c,d)};l.removeEventListener=function(a,b,c,d){Ce(this,a,b,c,d)};\nl.dispatchEvent=function(a){var b,c=this.K();if(c)for(b=[];c;c=c.K())b.push(c);c=this.v;var d=a.type||a;if("string"===typeof a)a=new L(a,c);else if(a instanceof L)a.target=a.target||c;else{var e=a;a=new L(d,c);Ca(a,e)}e=!0;if(b)for(var f=b.length-1;!a.a&&0<=f;f--){var g=a.currentTarget=b[f];e=g.R(d,!0,a)&&e}a.a||(g=a.currentTarget=c,e=g.R(d,!0,a)&&e,a.a||(e=g.R(d,!1,a)&&e));if(b)for(f=0;!a.a&&f<b.length;f++)g=a.currentTarget=b[f],e=g.R(d,!1,a)&&e;return e};\nl.P=function(){N.W.P.call(this);this.b&&this.b.U(void 0);this.o=null};l.R=function(a,b,c){a=this.b.a[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.V&&f.capture==b){var g=f.listener,h=f.ka||f.src;f.fa&&Zd(this.b,f);d=!1!==g.call(h,c)&&d}}return d&&0!=c.Za};t("H.util.EventTarget",N);N.prototype.Ja=N.prototype.Ja;N.prototype.setParentEventTarget=N.prototype.Ja;N.prototype.K=N.prototype.K;N.prototype.getParentEventTarget=N.prototype.K;N.prototype.addEventListener=N.prototype.addEventListener;N.prototype.addEventListener=N.prototype.addEventListener;N.prototype.removeEventListener=N.prototype.removeEventListener;N.prototype.removeEventListener=N.prototype.removeEventListener;N.prototype.dispatchEvent=N.prototype.dispatchEvent;\nN.prototype.dispatchEvent=N.prototype.dispatchEvent;N.prototype.B=N.prototype.B;N.prototype.dispose=N.prototype.B;N.prototype.N=N.prototype.N;N.prototype.addOnDisposeCallback=N.prototype.N;N.prototype.T=N.prototype.R;\nN.prototype.R=function(a,b,c){var d,e,f=!0;var g=c[c.currentTarget===c.target?"AT_TARGET":b?"CAPTURING_PHASE":(d=!0,"BUBBLING_PHASE")];if(!d||"pointerenter"!==(e=c.type)&&"pointerleave"!==e)c.eventPhase=g,f=N.prototype.T.apply(this,arguments),d&&this.K&&null===this.K()&&delete c.eventPhase;return f};function O(a){a=a||{};var b=a.callback;this.g=a.label;r(b)&&(this.callback=b);this.f=!!a.disabled;O.W.constructor.call(this)}xa(O,N);t("H.util.ContextItem",O);O.prototype.zb=function(){return this.g};O.prototype.getLabel=O.prototype.zb;O.prototype.cc=function(a){this.g!==a&&(this.g=a,this.dispatchEvent("update"));return this};O.prototype.setLabel=O.prototype.cc;O.prototype.Pb=function(){return this.f};O.prototype.isDisabled=O.prototype.Pb;\nO.prototype.bc=function(a){a^this.f&&(this.f=a,this.dispatchEvent("update"));return this};O.prototype.setDisabled=O.prototype.bc;var He=new O;O.SEPARATOR=He;function Ie(){if(y.document){var a=document.createElement("canvas");a.width=a.height=1;a.getContext("2d")}}t("H.util.getPixelRatio",function(){return window.devicePixelRatio||1});Object.create(Ia,void 0);t("H.util.eval",function(a){return eval(a)});t("H.util.provide",function(a){var b=p.$jscomp;if(b&&("function"!=typeof b.wb?0:b.wb()))throw Error("goog.provide cannot be used within a module.");ma(a,void 0)});function Je(){this.A=0}\nJe.prototype.next=function(a){if(9007199254740992===this.A)throw new Sd(a,this.A,[0,9007199254740991]);return this.A++};var Ke=new Je;Fa(Ke.next,Ke);function lc(){}var mb=Ha([]);Ha({});Ie();Ie();function Le(a,b,c){var d=Nb(+a,-90,90);if(b&&Ra(d))throw new A(b,c,a);return d}function Me(a,b,c){var d=+a;if(-180>d||180<d)d=Mb(d+180,360)-180;if(b&&Ra(d))throw new A(b,c,a);return d}function Ne(a,b,c){var d;if(a!==z&&Ra(d=+a)&&b)throw new A(b,c,a);return d}t("H.geo.isDBC",function(a,b){return 0!==(0>a^0>b)&&180<ub(b-a)});function Q(){var a=Q;if(!0===(Na(this,a)&&this.constructor===a))throw new TypeError("Illegal constructor "+Ua(a));}t("H.geo.AbstractGeometry",Q);Q.prototype.getBoundingBox=Q.prototype.Y;Q.prototype.equals=Q.prototype.I;Q.prototype.oa="";Q.prototype.wa="";Q.prototype.toString=function(){return this.eb([this.oa.toUpperCase()," "]).join("")};Q.prototype.toString=Q.prototype.toString;Q.prototype.ec=function(){return{type:this.wa,coordinates:this.cb()}};Q.prototype.toGeoJSON=Q.prototype.ec;\nQ.prototype.ua=function(){return{type:this.oa,coordinates:this.va(),boundingBox:this.Y().ua()}};Q.prototype.forWorkerMessage=Q.prototype.ua;function R(a,b,c){this.lat=Le(a,R,0);this.lng=Me(b,R,1);c!==z&&(this.alt=Ne(c,R,2))}xa(R,Q);t("H.geo.Point",R);R.prototype.I=function(a){return this===a||!!a&&this.lat===a.lat&&this.lng===a.lng&&(this.alt||0)===(a.alt||0)};R.prototype.equals=R.prototype.I;R.prototype.ra=function(a){if(this===a||this.lat===a.lat&&this.lng===a.lng)a=0;else{var b=this.lat*Jb;var c=a.lat*Jb;a=1.274200158E7*yb(sb(1,qb(rb(xb((b-c)/2),2)+zb(b)*zb(c)*rb(xb((this.lng*Jb-a.lng*Jb)/2),2))))}return a};\nR.prototype.distance=R.prototype.ra;\nR.prototype.ic=function(a,b,c){if(c){if(b/=6371000.79){a*=Jb;var d=Jb*this.lat;var e=xb(d);var f=xb(b);var g=zb(b);var h=Jb*this.lng;var k=zb(d);d=yb(k*zb(a)*f+e*g);a=Cb(xb(a)*k*f,g-e*xb(d));a=(h+a+I)%(2*I)-I;k=a*Kb}return b?new R(d*Kb,(k+540)%360-180):this}a=(a%360+360)%360;if(0===(a+90)%180)return d=this.lng+b/(6371000.79*Hb*zb(this.lat*Jb))*(270===a?-360:360),new R(this.lat,(d+540)%360-180);if(b/=6371000.79){a*=Jb;h=this.lat*Jb;e=this.lng*Jb;f=h+b*zb(a);g=f-h;d=vb(Ab(f/2+Gb)/Ab(h/2+Gb));d=Ra(g/\nd)?zb(h):g/d;var m=b*xb(a)/d;ub(f)>Eb&&(f=0<f?I-f:-(I+f))}return b?new R(f*Kb,((e+m+Ib+(ub(h+g)>Eb?I:0))%Hb-I)*Kb):this};R.prototype.walk=R.prototype.ic;R.prototype.Y=function(){return new T(this.lat,this.lng,this.lat,this.lng)};R.prototype.getBoundingBox=R.prototype.Y;function Oe(a,b,c){var d=qa(a)&&!(Ra(a.lat=Le(a.lat))||Ra(a.lng=Me(a.lng))||a.alt!==z&&Ra(a.alt=Ne(a.alt)));if(!d&&b)throw new A(b,c,a);return d}R.validate=Oe;\nfunction Pe(a){if(!a)throw new A(Pe,0,a);return new R(a.lat,a.lng,a.alt)}R.fromIPoint=Pe;l=R.prototype;l.oa="Point";l.eb=function(a){a.push("(",this.lng," ",this.lat,")");return a};l.wa="Point";l.cb=function(){return[this.lng,this.lat,this.alt||0]};l.va=function(){return[this.lat,this.lng,this.alt||0]};var W={};t("H.geo.mercator",W);W.a=function(a){return sb(1,tb(0,.5-vb(Ab(Gb+Eb*a/180))/I/2))};W.b=function(a){return a/360+.5};W.la=function(a,b,c){c?(c.x=W.b(b),c.y=W.a(a)):c=new E(W.b(b),W.a(a));return c};W.latLngToPoint=W.la;W.tb=function(a,b){return W.la(a.lat,a.lng,b)};W.geoToPoint=W.tb;W.f=function(a){return 0>=a?90:1<=a?-90:Kb*(2*Bb(wb(I*(1-2*a)))-Eb)};W.c=function(a){return 360*(1===a?1:Mb(a,1))-180};W.X=function(a,b,c){c?(c.lat=W.f(b),c.lng=W.c(a)):c=new R(W.f(b),W.c(a));return c};\nW.xyToGeo=W.X;W.Wb=function(a,b){return W.X(a.x,a.y,b)};W.pointToGeo=W.Wb;t("H.util.constants.DEFAULT_MIN_ZOOM_LEVEL",0);t("H.util.constants.DEFAULT_MAX_ZOOM_LEVEL",22);function X(a,b){this.projection=a||W;this.b=0;this.a=this.exp=vb(b||256)/Db;Qe(this);this.y=this.x=0}t("H.geo.PixelProjection",X);var Re=ub(24)+ub(-8);X.prototype.Zb=W;X.prototype.projection=X.prototype.Zb;X.prototype.x=0;X.prototype.x=X.prototype.x;X.prototype.y=0;X.prototype.y=X.prototype.y;X.prototype.hc=rb(2,Re);X.prototype.w=X.prototype.hc;X.prototype.Jb=rb(2,Re);X.prototype.h=X.prototype.Jb;\nX.prototype.da=function(a){if(Ra(a))throw new A(this.da,0,a);var b=this.x/this.w;var c=this.y/this.h;this.b=a;this.a=this.exp+a;Qe(this);this.x=b*this.w;this.y=c*this.h};X.prototype.rescale=X.prototype.da;function Qe(a){a.a>Re&&(a.a=Re);a.w=rb(2,a.a);a.h=rb(2,a.a)}X.prototype.Sa=function(){return this.b||0};X.prototype.getZoomScale=X.prototype.Sa;X.prototype.sb=function(a,b){a=this.projection.la(a.lat,a.lng,b);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};X.prototype.geoToPixel=X.prototype.sb;\nX.prototype.Fa=function(a,b){return this.projection.X((a.x+this.x)/this.w,(a.y+this.y)/this.h,b)};X.prototype.pixelToGeo=X.prototype.Fa;X.prototype.X=function(a,b,c){return this.projection.X((a+this.x)/this.w,(b+this.y)/this.h,c)};X.prototype.xyToGeo=X.prototype.X;X.prototype.Ba=function(a,b,c){a=this.projection.la(a,b,c);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};X.prototype.latLngToPixel=X.prototype.Ba;X.prototype.Xb=function(a){return new E(a.x*this.w-this.x,a.y*this.h-this.y)};\nX.prototype.pointToPixel=X.prototype.Xb;t("H.util.Disposable",K);K.prototype.N=K.prototype.N;K.prototype.addOnDisposeCallback=K.prototype.N;t("H.util.dispose",function(a){a&&"function"==typeof a.B&&a.B()});K.prototype.B=K.prototype.B;K.prototype.dispose=K.prototype.B;K.prototype.P=K.prototype.P;function Se(){}t("H.util.ICancelable",Se);Se.prototype.cancel=function(){};Se.prototype.cancel=Se.prototype.cancel;function Te(a,b,c,d){this.key="";this.x=a;this.y=b;this.b=c;this.Z=d;this.a=Ad()}Te.prototype.then=function(a,b,c){return this.a.a.then(a,b,c)};Te.prototype.reject=function(a){this.a.reject(a)};Te.prototype.cancel=function(){this.a.a.cancel()};function Ue(a,b,c,d){if(!a||!b||!c)throw new A(Ue,null,"Must specify name, version and revision parameter");this.name=a;this.version=b;this.revision=c;d&&Ca(this,d)}t("H.util.BuildInfo",Ue);Ue.prototype.toString=function(){var a,b=[];for(a in this)Qa(this[a])&&b.push(this[a]);return b.join(";")};var Ve={};function We(a,b,c,d){if(!a)throw new A(We,1,"Must specify a name parameter");return Ve[a]||(Ve[a]=new Ue(a,b,c,d))}Ue.get=We;function Z(a,b,c,d,e,f){if(a&&b)this.bb(a),this.Ha(b),this.Ka(c),this.ab(e),this.$a(f),this.La(d);else throw Error(\'Parameters "scheme" and "host" must be specified\');}t("H.service.Url",Z);\nfunction Xe(a,b){var c=y.document,d,e=c&&c.createElement("a"),f="";if(c){if(b){var g=(d=c.getElementsByTagName("base")[0])&&d.href;var h=c.head;var k=d||h.appendChild(c.createElement("base"));k.href=b}e.href=a;f=e.href;b&&(d?d.href=g:h.removeChild(k))}else/[\\w]+:\\/\\//.test(a)&&(f=a);g=/(?:(\\w+):\\/\\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\\/[^?#]*)?(\\?[^#]+)?(#.*)?/.exec(f);a=g[1];k=g[4];b=g[5];h=g[6];c=g[7];d=g[8];!g[2]&&k&&/@/.test(k)&&(k=k.split("@")[1]);g=k;h=h&&0<h.length?h.substr(1):\n"";k={};if(c)for(e=/([?&]?([^=&+]+))(=([^&]+))?/g;f=e.exec(c);)k[decodeURIComponent(f[2])]=f[4]?decodeURIComponent(f[4]):void 0;return new Z(a,g,h,k,isNaN(+b)?void 0:+b,d&&0<d.length?d.substr(1):"")}Z.parse=Xe;var Ye=0;Z.prototype.clone=function(){Ye++;var a={},b;for(b in this.a)a[b]=this.a[b];return new Z(this.o,this.f,this.b,a,this.g,this.c)};Z.prototype.clone=Z.prototype.clone;\nZ.prototype.bb=function(a){if(!a||"string"!==typeof a)throw Error(\'The "scheme" parameter must be a non-empty string.\');this.o=a;return this};Z.prototype.setScheme=Z.prototype.bb;Z.prototype.Gb=function(){return this.o};Z.prototype.getScheme=Z.prototype.Gb;Z.prototype.Ha=function(a){if(!a||"string"!==typeof a||"-"===a.charAt(0)||"."===a.charAt(0)||"."===a.charAt(a.length-1))throw Error(\'The "host" parameter is not a valid host name.\');this.f=a;return this};Z.prototype.setHost=Z.prototype.Ha;\nZ.prototype.yb=function(){return this.f};Z.prototype.getHost=Z.prototype.yb;Z.prototype.Ka=function(a){this.b=a||void 0;return this};Z.prototype.setPath=Z.prototype.Ka;Z.prototype.Db=function(){return this.b};Z.prototype.getPath=Z.prototype.Db;Z.prototype.La=function(a){if(a)if("object"==typeof a)this.a=a;else throw Error(\'Parameter "params" must be an object.\');else this.a={};return this};Z.prototype.setQuery=Z.prototype.La;Z.prototype.Kb=function(){return!Ze(this)};Z.prototype.hasQuery=Z.prototype.Kb;\nZ.prototype.getQuery=function(){return this.a};Z.prototype.getQuery=Z.prototype.getQuery;Z.prototype.ab=function(a){if(a&&isNaN(parseInt(a,10)))throw Error(\'Parameter "port" must be a number or undefined\');this.g=+a||void 0;return this};Z.prototype.setPort=Z.prototype.ab;Z.prototype.Eb=function(){return this.g};Z.prototype.getPort=Z.prototype.Eb;Z.prototype.$a=function(a){this.c=a||void 0;return this};Z.prototype.setAnchor=Z.prototype.$a;Z.prototype.ub=function(){return this.c};\nZ.prototype.getAnchor=Z.prototype.ub;Z.prototype.aa=function(a){if("object"!==typeof a)throw Error(\'Parameter "other" must be an object.\');var b=this.a,c;for(c in a)a.hasOwnProperty(c)&&"function"!==typeof a[c]&&(b[c]=a[c]);return this};Z.prototype.mergeQuery=Z.prototype.aa;Z.prototype.ib=function(a){if(!a||"string"!==typeof a)throw Error(\'Parameter "subDomain" must be a non-empty string\');"."===a.substr(a.length-1)&&(a=a.substr(0,a.length-1));return this.Ha(a+"."+this.f)};\nZ.prototype.addSubDomain=Z.prototype.ib;Z.prototype.jb=function(a){if(!a||"string"!==typeof a)throw Error(\'Parameter "subPath" must be a non-empty string\');return this.Ka((this.b?this.b+"/":"")+a)};Z.prototype.addSubPath=Z.prototype.jb;Z.prototype.toString=function(){return[this.o+"://",this.f,this.g?":"+this.g:"",this.b||!Ze(this)||this.c?"/":"",this.b?encodeURI(this.b):"",$e(this),this.c?"#"+encodeURIComponent(this.c):""].join("")};Z.prototype.toString=Z.prototype.toString;\nfunction $e(a){function b(g,h){return encodeURIComponent(g)+(void 0===h?"":"="+encodeURIComponent(h).replace(/[!\'()*]/g,function(k){return"%"+k.charCodeAt(0).toString(16)}))}var c=[],d,e=a.a;for(d in e)if(e.hasOwnProperty(d)&&"function"!==typeof e[d]){var f=a.a[d];Na(f,af)?f.fb.forEach(function(g){c.push(b(d,g))}):c.push(b(d,f))}return 0<c.length?"?"+c.join("&"):""}function Ze(a){var b,c=0;for(b in a.a)if(a.a.hasOwnProperty(b)&&"function"!==typeof a.a[b]&&(c++,0<c))break;return!c}\nfunction af(a){var b;if(!Oa(a,void 0,void 0,void 0))throw new A(af,0,a);for(b=0;b<a.length;b++){var c=a[b];if(!Qa(c)&&!Sa(c))throw new A(af,0,"The array can only contain strings and numbers");}this.fb=a}Z.MultiValueQueryParameter=af;af.prototype.Ib=function(){return this.fb};af.prototype.getValues=af.prototype.Ib;var bf={};function cf(a){try{importScripts.apply(self,arguments)}catch(b){this.postError("invalid_script")}}function df(a){bf[a]=null;this.postMessage(a)}function ef(a,b,c){if(r(b))var d=b;else try{d=self.eval("("+b+")"),r(d)||(d=null)}catch(e){}d?(bf[a]=d,c||this.postMessage(a)):this.postError("invalid_processor")}function ff(a){this.b=a&&a[0];this.a=a&&a[1];this.c=a&&a[2]||[]}ff.prototype.postError=function(a){this.postMessage(a,z,0)};\nff.prototype.postMessage=function(a,b,c){self.postMessage({processor:this.b,taskId:this.a,type:c===z?1:c,data:a},b||z)};function gf(a,b,c){if(!Qa(a))throw new A(gf,0,"InvalidArgument");if(!r(b))throw new A(gf,1,"InvalidArgument");var d=hf++;jf[d]={mimeType:c||kf,mb:b};(new ff(["3",d,[]])).postMessage(a,[],2)}var jf={},hf=0;\nfunction lf(a,b){var c=a;if(jf[this.a]){var d=jf[this.a];var e=d.mb;delete jf[this.a];if(b)e(null,b);else{if(d.mimeType===mf){a=new Uint8Array(a);b=a.byteLength;d="";c=0;for(var f,g,h,k;c<b;)f=a[c++],192>f||(g=a[c++],224>f?f=(f&31)<<6|g&63:(h=a[c++],240>f?f=(f&15)<<12|(g&63)<<6|h&63:(k=a[c++],f=(f&7)<<18|(g&63)<<12|(h&63)<<6|k&63))),65536>f?d+=String.fromCharCode(f):(f-=65536,d+=String.fromCharCode((f>>10)+55296,(f&1023)+56320));c=d}e(c)}}}var kf=0,mf=1;function T(a,b,c,d){nf(this,Le(a,T,0),Me(b,T,1),Le(c,T,2),Me(d,T,3))}xa(T,Q);t("H.geo.Rect",T);T.prototype.oa="Polygon";T.prototype.eb=function(a){var b=this.m,c=this.i,d=this.l,e=this.j;a.push("(","(",c," ",b,",",e," ",b,",",e," ",d,",",c," ",d,",",c," ",b,")",")");return a};T.prototype.I=function(a){return this===a||!!a&&this.m===a.m&&this.i===a.i&&this.l===a.l&&this.j===a.j};T.prototype.equals=T.prototype.I;T.prototype.clone=function(){return new T(this.m,this.i,this.l,this.j)};\nT.prototype.clone=T.prototype.clone;function nf(a,b,c,d,e){a.i=c;a.j=e;b<d&&(c=b,b=d,d=c);a.m=b;a.l=d;a.c=a.a=a.b=null;return a}T.prototype.Ra=function(){this.c||(this.c=new R(this.m,this.i));return this.c};T.prototype.getTopLeft=T.prototype.Ra;T.prototype.Qa=function(){this.a||(this.a=new R(this.l,this.j));return this.a};T.prototype.getBottomRight=T.prototype.Qa;T.prototype.Hb=function(){return this.m};T.prototype.getTop=T.prototype.Hb;T.prototype.vb=function(){return this.l};\nT.prototype.getBottom=T.prototype.vb;T.prototype.Ab=function(){return this.i};T.prototype.getLeft=T.prototype.Ab;T.prototype.Fb=function(){return this.j};T.prototype.getRight=T.prototype.Fb;T.prototype.J=function(){this.b||(this.b=new R(this.l+(this.m-this.l)/2,of(this.i,this.L())));return this.b};T.prototype.getCenter=T.prototype.J;T.prototype.L=function(){return pf(this.i,this.j)};T.prototype.getWidth=T.prototype.L;T.prototype.S=function(){return this.m-this.l};T.prototype.getHeight=T.prototype.S;\nT.prototype.Nb=function(){return this.i>this.j};T.prototype.isCDB=T.prototype.Nb;T.prototype.Qb=function(){return!this.L()&&!this.S()};T.prototype.isEmpty=T.prototype.Qb;T.prototype.Y=function(){return new T(this.m,this.i,this.l,this.j)};T.prototype.getBoundingBox=T.prototype.Y;T.prototype.ga=function(a,b,c){var d=this.J();c||(a=Le(a,this.ga,0),b=Me(b,this.ga,1));b=this.M(a,b,c);a=b.J();return a.lat===d.lat&&a.lng===d.lng&&this.S()===b.S()&&this.L()===b.L()};T.prototype.containsLatLng=T.prototype.ga;\nT.prototype.ha=function(a,b){b||Oe(a,this.ha,0);return this.ga(a.lat,a.lng,b)};T.prototype.containsPoint=T.prototype.ha;T.prototype.Pa=function(a,b){var c=this.J();if(!b&&!Na(a,T))throw new A(this.Pa,0,a);b=this.ma(a,b);a=b.J();return a.lat===c.lat&&a.lng===c.lng&&this.S()===b.S()&&this.L()===b.L()};T.prototype.containsRect=T.prototype.Pa;\nT.prototype.M=function(a,b,c,d){if(!c){if(Ra(a=Le(a)))throw new A(this.M,0,a);if(Ra(b=Me(b)))throw new A(this.M,1,b);}return qf(this.m,this.i,this.l,this.j,a,b,a,b,d)};T.prototype.mergeLatLng=T.prototype.M;T.prototype.Wa=function(a,b,c){b||Oe(a,this.Wa,0);return this.M(a.lat,a.lng,b,c)};T.prototype.mergePoint=T.prototype.Wa;T.prototype.ma=function(a,b,c){if(!b&&!Na(a,T))throw new A(this.ma,0,a);return qf(this.m,this.i,this.l,this.j,a.m,a.i,a.l,a.j,c)};T.prototype.mergeRect=T.prototype.ma;\nT.prototype.ba=function(a,b,c,d,e,f){e||(a=Le(a,this.ba,0),b=Me(b,this.ba,1),c=Le(c,this.ba,2),d=Me(d,this.ba,3));return qf(this.m,this.i,this.l,this.j,a,b,c,d,f)};T.prototype.mergeTopLeftBottomRight=T.prototype.ba;T.prototype.Ua=function(a,b){var c=this.i<=this.j,d=a.i<=a.j,e=this.i<a.j,f=a.i<this.j;if(!b&&!Na(a,T))throw new A(this.Ua,0,a);return this.l<=a.m&&a.l<=this.m&&(!c&&(!d||e||f)||!d&&(e||f)||e&&f)};T.prototype.intersects=T.prototype.Ua;function pf(a,b){a=b-a;return a+(0>a?360:0)}\nfunction of(a,b){a+=b/2;return a-(180<a?360:0)}function qf(a,b,c,d,e,f,g,h,k){c=sb(c,g);a=tb(a,e);e=pf(b,d);var m=of(b,e);g=pf(f,h);var n=of(f,g)-m;n+=0>n-1E-6?360:0;if(180>n-1E-6){m=b;var q=h}else n=360-n,m=f,q=d;n=n+e/2+g/2;360<=n+5E-7?(m=-180,q=180):n-5E-7<e?(m=b,q=d):n-5E-7<g&&(m=f,q=h);return k?nf(k,a,m,c,q):new T(a,m,c,q)}T.merge=qf;function rf(a,b,c){c||(Oe(a,rf,0),Oe(b,rf,1));return new T(a.lat,a.lng,b.lat,b.lng)}T.fromPoints=rf;\nfunction sf(a,b){var c=1,d=a.length,e=null;var f=oa(a);if("array"!=f&&("object"!=f||"number"!=typeof a.length))throw new A(sf,0,a);if(0<d)for(f=a[0],e=rf(f,f,b);c<d;c++)f=a[c],e.M(f.lat,f.lng,b,e);return e}T.coverPoints=sf;function tf(a,b){var c=3,d=a.length,e;if(!(b||a&&null!=a.length))throw new A(tf,0,a);if(0<d)for(e=new T(a[0],a[1],a[0],a[1]);c<d;c+=3)e.M(a[c],a[c+1],b,e);return e}T.coverLatLngAlts=tf;\nfunction uf(a,b){var c=1,d=a.length,e;if(b&&(!a||null==a.length))throw new A(uf,0,a);if(0<d)for(e=new T(a[0].m,a[0].i,a[0].l,a[0].j);c<d;c++)e.ma(a[c],b,e);return e}T.coverRects=uf;\nT.prototype.Ya=function(a,b){var c=this.i,d=this.m,e=this.j,f=this.l,g=this.J().lng;Oe(a,this.Ya,0);var h=a.lat-f-(d-f)/2;var k=a.lng-g;k=180<k||-180>k?-(g+a.lng):k;a=c+(0>k?2*k:0);a=-180>a?360+a:a;e+=0<k?2*k:0;e=180<e?e-360:e;d=0<h?d+2*h:d;90<=d&&(d=90);f=0>h?f+2*h:f;-90>=f&&(f=-90);return b?nf(b,d,a,f,e):new T(d,a,f,e)};T.prototype.resizeToCenter=T.prototype.Ya;T.prototype.wa="Polygon";\nT.prototype.cb=function(){return[[this.i,this.m,0],[this.j,this.m,0],[this.j,this.l,0],[this.i,this.l,0],[this.i,this.m,0]]};T.prototype.ua=function(){return this.va()};T.prototype.va=function(){return[this.m,this.i,this.l,this.j]};function vf(a,b,c,d){var e=!!c,f,g=0,h=0,k=0,m=0,n=0,q,u=-1;var J=y.Float32Array;var M,v=[];if(b){b=La(b);a=La(a);e&&(f=La(c));c=b.length;d=d?1E-7:1E-5;for(M=new J(3*c);g<c;){J=b[g];var G=+J;var Y=+a[g];e&&(q=+f[g]);wf.test(J)?0<=u&&(0<g-u&&v.push(u,g+1),u=-1):0>u&&(u=g);g++;m=M[h++]=m+Y*d;k=M[h++]=k+G*d;e&&(n=M[h]=n+q);h++}0<=u&&1<c-u&&v.push(u,c)}else M=new J(0);return{path:M,outlineIndices:v}}var wf=/^-?0\\d/;\nfunction xf(a,b){for(var c=0,d=a.length/3,e=new y.Array(d),f=0;c<d;)e[c++]=b.Ba(a[f],a[++f]),f+=2;return e};function yf(a,b){b=180/(1<<b);var c=a.lat+90;a=(a.lng+180)%360;var d=0;180==c&&d--;d+=Math.floor(c/b);return[d,Math.floor(a/b)]}var zf=1/Math.pow(10,10);function Af(a,b){var c=[],d=a.Ra();a=a.Qa();var e;180==a.lng&&(a.lng-=zf);d=yf(d,b);a=yf(a,b);for(e=d[0];e>=a[0];e--)for(b=d[1];b<=a[1];b++)c.push(e,b);return c};function Bf(a,b){var c=a.tileSize||256;this.b={};this.v=Xe(a.serverUrl);this.g=b;this.fc=a.layerConfigs||[];this.o=a.projected;this.T=c;this.Ea=!1!==a.batchTiles;this.Ga=a.horizontalMargin||0;this.gc=a.onlyOutline;this.gb=new X(Ia,c);this.f=new X(Ia,c);this.f.da(22-Math.log(c)/Math.LN2+8)}xa(Bf,K);l=Bf.prototype;\nl.ac=function(a,b,c){var d=this.T,e=this.Ga,f={x:a*d-e,y:b*d};d={x:(a+1)*d-1+e,y:(b+1)*d-1};e=this.gb;e.da(c);f=e.Fa(f);d=e.Fa(d);return Cf(this,new T(f.lat,f.lng,d.lat,d.lng),this.fc,{x:a,y:b,z:c})};l.$b=function(a,b,c,d,e){return Cf(this,new T(a,b,c,d),e)};\nfunction Cf(a,b,c,d){var e=Df(c),f=e.length,g={},h,k=a.b,m=[],n=[];for(c=0;c<f;c++){var q=e[c];var u=q.layerId;var J=q.level;g[u]=q.columns;q=Af(b,J);var M=q.length-1;for(h=0;h<M;h+=2){var v=[u,q[h+1],q[h],J].join("_");var G=k[v]||a.g.get(v);G||(G=new Te(q[h+1],q[h],J,u),G.key=v,k[v]=G,n.push(G));m.push(G)}}n.length&&(a.Ea?Ef(a,n):Ff(a,n));return zd(m.map(function(Y){return Y.then(Fa(this.qb,this,Y.Z,Gf(e))).then(Fa(this.Yb,this,Y,d||{})).then(Fa(this.rb,this,g[Y.Z]))},a))}\nl.qb=function(a,b,c){var d=c.Rows,e=d.length,f,g;if(e&&(f=b[a])){b=new D(c.Rows);var h=[];for(g=0;g<e;g++){var k=d[g];f(b.ja(g),a)&&h.push(k)}a={Rows:h};if(c=c.Meta)a.Meta=c}else a=c;return a};function Ff(a,b){function c(k,m,n){n?(delete a.b[k.key],k.reject(n)):Hf(a,k,m)}var d,e=b.length,f=a.v;for(d=0;d<e;d++){var g=b[d];var h=f.clone().aa({tilex:g.x}).aa({tiley:g.y}).aa({level:g.b}).aa({layer:g.Z});new gf(h.toString(),Fa(c,null,g),mf)}}\nfunction Ef(a,b){var c=b.length,d;for(d=0;d<c;d+=15){var e=b.slice(d,d+15);If(a,e)}}function If(a,b){var c=a.v.clone(),d=[],e=[],f=[],g=c.getQuery();b.length&&(b.forEach(function(h){d.push(h.x,h.y);e.push(h.b);f.push(h.Z)}),g.tilexy=d.join(","),g.layers=f.join(","),g.levels=e.join(","),c.La(g),new gf(c.toString(),function(h,k){k?b.forEach(function(m){delete a.b[m.key];m.reject("error")}):Hf(a,b,h)},mf))}\nfunction Hf(a,b,c){var d=b.length,e;if(Oa(b,void 0,void 0,void 0)){var f=c.indexOf("[")+1;for(e=0;e<d;e++){var g=c.indexOf("]},{",f+3)+2;g<f&&(g=c.lastIndexOf("]}"));var h=c.substr(f,g-f);f=g+1;Jf(a,b[e],h)}}else Jf(a,b,c)}function Jf(a,b,c){try{var d=c.length;var e=b.key;delete a.b[e];a.g.add(e,b,2*d);var f=JSON.parse(c);b.a.b(f)}catch(g){b.reject(g.message)}}\nfunction Gf(a){var b={},c,d=a.length;for(c=0;c<d;c++){var e=a[c];if(e.rowFilter){var f=e.layerId;f=f!==z?f:e.layer;b[f]=Fa(e.rowFilter,e.rowFilterContext)}}return b}function Kf(a,b,c,d,e){return e?[new E(a,b),new E(c,b),new E(c,d),new E(a,d),new E(a,b)]:[a,b,c,b,c,d,a,d]}\nl.Yb=function(a,b,c){var d=this.f.Sa()-b.z,e=this.T<<d,f=50<<d,g=b.x*e;b=b.y*e;var h=g+e;e=b+e;var k=g-f,m=b-f,n=h+f;f=e+f;var q,u,J=c.Rows,M=J.length,v,G=/^ADAS/.test(a.Z),Y=this.f,pa=this.gc,S,ab=[],Ja=[],Ka=[],bb=[];for(a=0;a<M;a++){var w=v=J[a];var P=(S=G)?"HPY":"LAT";var U=S?"HPX":"LON";var ea=S?"HPZ":"ZLEVEL";if(w[P]){var V=vf(w[P],w[U],w[ea],S);w.geometry=V;delete w[P];delete w[U];delete w[ea];if(w.INNER_LAT)for(P=w.INNER_LAT.split(";"),V=w.INNER_LON.split(";"),delete w.INNER_LAT,delete w.INNER_LON,\nw.interiors=ea=[],U=P.length,w=0;w<U;w++)ea.push(vf(P[w],V[w],"",S))}if(this.o){S=void 0;U=v;V=Y;P=U.$$projected$$;if(!P){var ba=U.geometry;w=xf(ba.path,V);v=[w];U.$$projected$$=P={Vb:v};U=(ea=U.interiors)?ea.length:0;v.length+=U;S|=Lf(v,w,ba.outlineIndices);if(U)for(P.Lb=1,q=0;q<U;q++)ba=ea[q],w=xf(ba.path,V),v[1+q]=w,S|=Lf(v,w,ba.outlineIndices);S&&(P.Tb=1+U)}w=P;S=w.Vb;v=w.Lb;var zc=w.Tb;V=[];P=U=Lb;var cb=ea=z;w=S[0];if(1===w.length){var Ac=Ac||(Ac=Kf(g,b,h,e,!1));v=w[0];Rb(v.x,v.y,Ac)&&V.push(Mf(w,\ng,b,d))}else{var Be=S.length;for(ba=pa?zc:0;ba<Be&&(pa||!ba||V.length);ba++)if(w=S[ba],ba>=zc){ba===zc&&(P=V.length);var ja=Ub([w],k,m,n,f,!1);Nf(ja,g,b,d,V)}else{var Fb=Fb||(Fb=Kf(k,m,n,f,!0));if(ba>=v)if(ba===v&&(U=V.length),cb)for(q=cb.length;q--;){if(ja=Of(cb[q],w),u=ja.length){for(ea=ea||[];u--;)ea.push(q);Nf(ja,g,b,d,V)}}else ja=Of(Fb,w),Nf(ja,g,b,d,V);else if(ja=Of(Fb,w),Nf(ja,g,b,d,V),1<ja.length&&v<Be)for(cb=[],q=ja.length;q--;)cb[q]=ja[q]}}V.length&&(ab[a]=V,Ja[a]=U,Ka[a]=ea,bb[a]=P)}}return{dc:c,\nnb:ab,Mb:Ja,pb:Ka,Ub:bb}};function Lf(a,b,c){for(var d=c.length,e=0,f,g,h=b.length;e<d;)f=c[e++],g=c[e++],a.push(g-f===h?b:b.slice(f,g));return 0<c.length}function Of(a,b){var c,d=[];if(c=Wb(a,b)){do{a=[];b=c;do a.push(b);while(b=b.next);d.push(a)}while(c=c.Xa)}else Sb(b[0],Tb(a))?d.push(b):Sb(a[0],Tb(b))&&d.push(a);return d}function Nf(a,b,c,d,e){for(var f=0,g=a.length;f<g;f++)e.push(Mf(a[f],b,c,d))}\nfunction Mf(a,b,c,d){var e,f=a.length,g=new Int32Array(2*f),h=0;for(e=0;e<f;e++){var k=a[e];g[h++]=k.x-b>>d;g[h++]=k.y-c>>d}return g}\nl.rb=function(a,b){var c=b.dc,d=b.nb,e=b.Mb,f=b.Ub;b=b.pb;for(var g=[],h,k={Rows:g},m,n=a?a.length:0,q=0,u,J=c.Rows,M=J.length,v;q<M;q+=1)if(d[q]||!this.o){h={};u=J[q];if(n)for(m=0;m<n;m++)u.hasOwnProperty(a[m])&&(h[a[m]]=u[a[m]]);else for(v in u)"$$projected$$"!==v&&(h[v]=u[v]);u.geometry&&(h.geometry=u.geometry);m=void 0;var G,Y=h,pa=d[q],S=e[q],ab=b[q],Ja=f[q],Ka=g;if(pa){var bb=pa.length;if(ab)for(G=S;G--;){if(G){var w={};for(m in Y)w[m]=Y[m]}else w=Y;u=[pa[G]];var P=sb(bb,Ja)-S;for(h=0;h<P;h++)ab[h]===\nG&&u.push(pa[S+h]);P=u.length;if(!G)for(h=Ja;h<bb;h++)u.push(pa[h]);w.$HProjGeometry={paths:u,interiorsIndex:1,outlinesIndex:P};Ka.push(w)}else Y.$HProjGeometry={paths:pa,interiorsIndex:S,outlinesIndex:Ja},Ka.push(Y)}else Ka.push(Y)}c.Meta&&(k.Meta=c.Meta);return k};l.P=function(){var a,b=this.b;for(a in b)b.hasOwnProperty(a)&&(b[a].reject("disposed"),delete b[a])};\nfunction Df(a){for(var b=[],c,d=a.length,e=0;e<d;e++){c=Aa(a[e]);if(c.rowFilter&&(c.rowFilter=eval("("+c.rowFilter+")"),!r(c.rowFilter)))throw Error("Invalid row filter for layer "+c.layerId);b.push(c)}return b};t("H.service.extension.worker.processor",function(a,b,c){function d(h){e.postMessage(h)}var e=this,f=za[a];var g=function(h){e.postError(h.toString())};if(0===b)f||(za[a]=new Bf(c,Pf)),this.postMessage();else if(f)switch(b){case 1:try{f.ac.apply(f,c).then(d,g)}catch(h){this.postError(h.message)}break;case 2:try{f.$b.apply(f,c).then(d,g)}catch(h){this.postError(h.message)}break;case 3:f.B();delete za[a];ya()&&Pf.U();break;default:e.postError("Unsupported command")}});\nvar Pf=new B(26214400),za=Object.create(Ia,void 0);function Qf(a,b,c){var d=a[b];a=a[b+1];this.Ta=[];this.Ma=0;this.b=b;this.a=[a-c,d-c,a+c,d+c]}Qf.prototype.ha=function(a,b){var c=a[b];a=a[b+1];b=this.a;return b[1]<=c&&c<=b[3]&&b[0]<=a&&a<=b[2]};Qf.prototype.J=function(){return this.b};var Rf=new E(0,0);function Sf(a,b,c,d,e){d[e]=b;d[e+1]=a}var Tf=new X;function Uf(a,b,c,d,e){Tf.Ba(a,b,Rf);d[e]=Rf.x;d[e+1]=Rf.y}\nt("H.clustering.dynamicgrid.worker",function(a,b,c,d,e){var f=e?Sf:Uf,g=0;e=!!self.ArrayBuffer;var h=a.byteLength?new Float64Array(a):a,k=h.length/3;a=[];var m=[],n=[],q=e?new Float64Array(2*k):[];k=0;var u=0;for(Tf.da(d);g<h.length;){var J=h[g++];var M=h[g++];var v=h[g++];f(v,M,d,q,u);for(v=a.length;v--;)if(M=a[v],M.ha(q,u)){var G=M;break}G||(G=new Qf(q,u,b),a.push(G));v=u/2;G.Ma+=J||1;G.Ta.push(v);G=null;u+=2}for(v=a.length;v--;)M=a[v],b=M.Ma>=c,f=M.Ta,d=f.length,b?(m.push(d),m=m.concat(f)):\n(k+=d,n=n.concat(f));c=[k].concat(n,m);c=e?(new Uint32Array(c)).buffer:c;this.postMessage(c,[c])});self.addEventListener("message",function(a){a=new ff(a.data);var b=bf[a.b];if(b)try{b.apply(a,a.c)}catch(c){a.postError(c.message)}else a.postError("processor_not_found")});(function(){var a=new ff;var b=function(c,d){ef.apply(a,[c,d,!0])};b("0",cf);b("1",ef);b("2",df);b("3",lf)})();\n',e=function(){var t,r,n;"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope||!(void 0!==module&&module.exports||"undefined"!=typeof window)||(t=e.toString(),r="",n="undefined"!=typeof document&&document.currentScript instanceof HTMLScriptElement?document.currentScript.src:""),function(){function e(t){return i.call(t).slice(8,-1)}var i={}.toString,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==global?global:"undefined"!=typeof self?self:{};function a(t,e){return t(e={exports:{}},e.exports),e.exports}function s(t){return t&&t.Math==Math&&t}function u(t){try{return!!t()}catch(t){return!0}}function l(t){return"object"==typeof t?null!==t:"function"==typeof t}function c(t){return w?x.createElement(t):{}}function h(t){if(!l(t))throw TypeError(String(t)+" is not an object");return t}function f(t,e){if(!l(t))return t;var r,n;if(e&&"function"==typeof(r=t.toString)&&!l(n=r.call(t)))return n;if("function"==typeof(r=t.valueOf)&&!l(n=r.call(t)))return n;if(!e&&"function"==typeof(r=t.toString)&&!l(n=r.call(t)))return n;throw TypeError("Can't convert object to primitive value")}function p(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}function d(t,e){try{k(_,t,e)}catch(r){_[t]=e}return e}function v(t){return"Symbol(".concat(void 0===t?"":t,")_",(++M+O).toString(36))}function y(t){return L[t]||(L[t]=I&&C[t]||(I?C:v)("Symbol."+t))}function g(t){var r,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(r=Object(t),R))?n:P?e(r):"Object"==(i=e(r))&&"function"==typeof r.callee?"Arguments":i}var m="object",_=s(typeof globalThis==m&&globalThis)||s(typeof window==m&&window)||s(typeof self==m&&self)||s(typeof o==m&&o)||Function("return this")(),b=!u(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),x=_.document,w=l(x)&&l(x.createElement),E=!b&&!u(function(){return 7!=Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a}),T=Object.defineProperty,A={f:b?T:function(t,e,r){if(h(t),e=f(e,!0),h(r),E)try{return T(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},k=b?function(t,e,r){return A.f(t,e,p(1,r))}:function(t,e,r){return t[e]=r,t},S=a(function(t){var e="__core-js_shared__",r=_[e]||d(e,{});(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.1.0",mode:"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})}),M=0,O=Math.random(),I=!u(function(){return!String(Symbol())}),L=S("wks"),C=_.Symbol,R=y("toStringTag"),P="Arguments"==e(function(){return arguments}()),N={};function j(t,e){return K.call(t,e)}function D(t){return J[t]||(J[t]=v(t))}N[y("toStringTag")]="z";var z,F,B,U,G,q,V,W,Y="[object z]"!==String(N)?function(){return"[object "+g(this)+"]"}:N.toString,K={}.hasOwnProperty,X=S("native-function-to-string",Function.toString),Z=_.WeakMap,$="function"==typeof Z&&/native code/.test(X.call(Z)),J=S("keys"),Q={},tt=_.WeakMap;V=$?(z=new tt,F=z.get,B=z.has,U=z.set,G=function(t,e){return U.call(z,t,e),e},q=function(t){return F.call(z,t)||{}},function(t){return B.call(z,t)}):(W=D("state"),Q[W]=!0,G=function(t,e){return k(t,W,e),e},q=function(t){return j(t,W)?t[W]:{}},function(t){return j(t,W)});var et={set:G,get:q,has:V,enforce:function(t){return V(t)?q(t):G(t,{})},getterFor:function(t){return function(e){var r;if(!l(e)||(r=q(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return r}}},rt=a(function(t){var e=et.get,r=et.enforce,n=String(X).split("toString");S("inspectSource",function(t){return X.call(t)}),(t.exports=function(t,e,i,o){var a=!!o&&!!o.unsafe,s=!!o&&!!o.enumerable,u=!!o&&!!o.noTargetGet;"function"==typeof i&&("string"!=typeof e||j(i,"name")||k(i,"name",e),r(i).source=n.join("string"==typeof e?e:"")),t!==_?(a?!u&&t[e]&&(s=!0):delete t[e],s?t[e]=i:k(t,e,i)):s?t[e]=i:d(e,i)})(Function.prototype,"toString",function(){return"function"==typeof this&&e(this).source||X.call(this)})}),nt=Object.prototype;function it(t){return isNaN(t=+t)?0:(0<t?vt:dt)(t)}function ot(t){if(null==t)throw TypeError("Can't call method on "+t);return t}function at(t){return bt(ot(t))}function st(t){return 0<t?Et(it(t),9007199254740991):0}function ut(t,e){var r,n=at(t),i=0,o=[];for(r in n)!j(Q,r)&&j(n,r)&&o.push(r);for(;e.length>i;)j(n,r=e[i++])&&(~kt(o,r)||o.push(r));return o}function lt(t,e){var r=Nt[Pt(t)];return r==Dt||r!=jt&&("function"==typeof e?u(e):!!e)}function ct(t,e){var r,n,i,o,a=t.target,s=t.global,u=t.stat,l=s?_:u?_[a]||d(a,{}):(_[a]||{}).prototype;if(l)for(r in e){if(i=e[r],n=t.noTargetGet?(o=Ht(l,r))&&o.value:l[r],!zt(s?r:a+(u?".":"#")+r,t.forced)&&void 0!==n){if(typeof i==typeof n)continue;!function(t,e){for(var r=Ct(e),n=A.f,i=wt.f,o=0;o<r.length;o++){var a=r[o];j(t,a)||n(t,a,i(e,a))}}(i,n)}(t.sham||n&&n.sham)&&k(i,"sham",!0),rt(l,r,i,t)}}Y!==nt.toString&&rt(nt,"toString",Y,{unsafe:!0});var ht,ft,pt,dt=Math.ceil,vt=Math.floor,yt={}.propertyIsEnumerable,gt=Object.getOwnPropertyDescriptor,mt={f:gt&&!yt.call({1:2},1)?function(t){var e=gt(this,t);return!!e&&e.enumerable}:yt},_t="".split,bt=u(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==e(t)?_t.call(t,""):Object(t)}:Object,xt=Object.getOwnPropertyDescriptor,wt={f:b?xt:function(t,e){if(t=at(t),e=f(e,!0),E)try{return xt(t,e)}catch(t){}if(j(t,e))return p(!mt.f.call(t,e),t[e])}},Et=Math.min,Tt=Math.max,At=Math.min,kt=(!1,function(t,e,r){var n,i,o=at(t),a=st(o.length),s=(n=a,(i=it(r))<0?Tt(i+n,0):At(i,n));for(0;s<a;s++)if(s in o&&o[s]===e)return s||0;return-1}),St=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Mt=St.concat("length","prototype"),Ot={f:Object.getOwnPropertyNames||function(t){return ut(t,Mt)}},It={f:Object.getOwnPropertySymbols},Lt=_.Reflect,Ct=Lt&&Lt.ownKeys||function(t){var e=Ot.f(h(t)),r=It.f;return r?e.concat(r(t)):e},Rt=/#|\.prototype\./,Pt=lt.normalize=function(t){return String(t).replace(Rt,".").toLowerCase()},Nt=lt.data={},jt=lt.NATIVE="N",Dt=lt.POLYFILL="P",zt=lt,Ht=wt.f,Ft=!u(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),Bt=D("IE_PROTO"),Ut=Object.prototype,Gt=Ft?Object.getPrototypeOf:function(t){return j(t=Object(ot(t)),Bt)?t[Bt]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Ut:null},qt=y("iterator"),Vt=!1;function Wt(){}[].keys&&("next"in(pt=[].keys())?(ft=Gt(Gt(pt)))!==Object.prototype&&(ht=ft):Vt=!0),null==ht&&(ht={}),j(ht,qt)||k(ht,qt,function(){return this});var Yt={IteratorPrototype:ht,BUGGY_SAFARI_ITERATORS:Vt},Kt=Object.keys||function(t){return ut(t,St)},Xt=b?Object.defineProperties:function(t,e){h(t);for(var r,n=Kt(e),i=n.length,o=0;o<i;)A.f(t,r=n[o++],e[r]);return t},Zt=_.document,$t=Zt&&Zt.documentElement,Jt=D("IE_PROTO"),Qt="prototype",te=function(){var t,e=c("iframe"),r=St.length;for(e.style.display="none",$t.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),te=t.F;r--;)delete te[Qt][St[r]];return te()},ee=Object.create||function(t,e){var r;return null!==t?(Wt[Qt]=h(t),r=new Wt,Wt[Qt]=null,r[Jt]=t):r=te(),void 0===e?r:Xt(r,e)};function re(t,e,r){t&&!j(t=r?t:t.prototype,se)&&ae(t,se,{configurable:!0,value:e})}function ne(){return this}function ie(){return this}function oe(t,e,r,n,i,o,a){var s,u,l;function c(t){if(t===i&&_)return _;if(!pe&&t in g)return g[t];switch(t){case"keys":case de:case ve:return function(){return new r(this,t)}}return function(){return new r(this)}}u=n,l=e+" Iterator",(s=r).prototype=ee(le,{next:p(1,u)}),re(s,l,!1),ue[l]=ne;var h,f,d,v=e+" Iterator",y=!1,g=t.prototype,m=g[he]||g["@@iterator"]||i&&g[i],_=!pe&&m||c(i),b="Array"==e&&g.entries||m;if(b&&(h=Gt(b.call(new t)),fe!==Object.prototype&&h.next&&(Gt(h)!==fe&&(ce?ce(h,fe):"function"!=typeof h[he]&&k(h,he,ie)),re(h,v,!0))),i==de&&m&&m.name!==de&&(y=!0,_=function(){return m.call(this)}),g[he]!==_&&k(g,he,_),ue[e]=_,i)if(f={values:c(de),keys:o?_:c("keys"),entries:c(ve)},a)for(d in f)!pe&&!y&&d in g||rt(g,d,f[d]);else ct({target:e,proto:!0,forced:pe||y},f);return f}Q[Jt]=!0;var ae=A.f,se=y("toStringTag"),ue={},le=Yt.IteratorPrototype,ce=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),e=r instanceof Array}catch(r){}return function(r,n){return function(t,e){if(h(t),!l(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(r,n),e?t.call(r,n):r.__proto__=n,r}}():void 0),he=y("iterator"),fe=Yt.IteratorPrototype,pe=Yt.BUGGY_SAFARI_ITERATORS,de="values",ve="entries",ye="String Iterator",ge=et.set,me=et.getterFor(ye);oe(String,"String",function(t){ge(this,{type:ye,string:String(t),index:0})},function(){var t,e,r,n,i,o,a,s,u=me(this),l=u.string,c=u.index;return c>=l.length?{value:void 0,done:!0}:(e=c,r=!0,o=String(ot(l)),a=it(e),s=o.length,t=a<0||s<=a?r?"":void 0:(n=o.charCodeAt(a))<55296||56319<n||a+1===s||(i=o.charCodeAt(a+1))<56320||57343<i?r?o.charAt(a):n:r?o.slice(a,a+2):i-56320+(n-55296<<10)+65536,u.index+=t.length,{value:t,done:!1})});var _e={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},be=y("unscopables"),xe=Array.prototype;function we(t){xe[be][t]=!0}null==xe[be]&&k(xe,be,ee(null));var Ee="Array Iterator",Te=et.set,Ae=et.getterFor(Ee),ke=oe(Array,"Array",function(t,e){Te(this,{type:Ee,target:at(t),index:0,kind:e})},function(){var t=Ae(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?{value:t.target=void 0,done:!0}:"keys"==r?{value:n,done:!1}:"values"==r?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}},"values");ue.Arguments=ue.Array,we("keys"),we("values"),we("entries");var Se=y("iterator"),Me=y("toStringTag"),Oe=ke.values;for(var Ie in _e){var Le=_[Ie],Ce=Le&&Le.prototype;if(Ce){if(Ce[Se]!==Oe)try{k(Ce,Se,Oe)}catch(o){Ce[Se]=Oe}if(Ce[Me]||k(Ce,Me,Ie),_e[Ie])for(var Re in ke)if(Ce[Re]!==ke[Re])try{k(Ce,Re,ke[Re])}catch(o){Ce[Re]=ke[Re]}}}function Pe(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}function Ne(t,e,r){if(Pe(t),void 0===e)return t;switch(r){case 0:return function(){return t.call(e)};case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}}var je=y("iterator"),De=Array.prototype,ze=y("iterator"),He=a(function(t){var e={};(t.exports=function(t,r,n,i,o){var a,s,u,l,c,f,p=Ne(r,n,i?2:1);if(o)a=t;else{if("function"!=typeof(s=function(t){if(null!=t)return t[ze]||t["@@iterator"]||ue[g(t)]}(t)))throw TypeError("Target is not iterable");if(void 0!==(f=s)&&(ue.Array===f||De[je]===f)){for(u=0,l=st(t.length);u<l;u++)if((i?p(h(c=t[u])[0],c[1]):p(t[u]))===e)return e;return}a=s.call(t)}for(;!(c=a.next()).done;)if(function(t,e,r,n){try{return n?e(h(r)[0],r[1]):e(r)}catch(e){var i=t.return;throw void 0!==i&&h(i.call(t)),e}}(a,p,c.value,i)===e)return e}).BREAK=e}),Fe=y("iterator"),Be=!1;try{var Ue=0;({next:function(){return{done:!!Ue++}},return:function(){Be=!0}})[Fe]=function(){return this}}catch(o){}function Ge(t,e){var r,n=h(t).constructor;return void 0===n||null==(r=h(n)[$e])?e:Pe(r)}function qe(t){var e;or.hasOwnProperty(t)&&(e=or[t],delete or[t],e())}function Ve(t){return function(){qe(t)}}function We(t){qe(t.data)}function Ye(t){_.postMessage(t+"",Je.protocol+"//"+Je.host)}var Ke,Xe,Ze,$e=y("species"),Je=_.location,Qe=_.setImmediate,tr=_.clearImmediate,er=_.process,rr=_.MessageChannel,nr=_.Dispatch,ir=0,or={},ar="onreadystatechange";Qe&&tr||(Qe=function(t){for(var e=[],r=1;r<arguments.length;)e.push(arguments[r++]);return or[++ir]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},Ke(ir),ir},tr=function(t){delete or[t]},"process"==e(er)?Ke=function(t){er.nextTick(Ve(t))}:nr&&nr.now?Ke=function(t){nr.now(Ve(t))}:rr?(Ze=(Xe=new rr).port2,Xe.port1.onmessage=We,Ke=Ne(Ze.postMessage,Ze,1)):!_.addEventListener||"function"!=typeof postMessage||_.importScripts||u(Ye)?Ke=ar in c("script")?function(t){$t.appendChild(c("script"))[ar]=function(){$t.removeChild(this),qe(t)}}:function(t){setTimeout(Ve(t),0)}:(Ke=Ye,_.addEventListener("message",We,!1)));var sr,ur,lr,cr,hr,fr,pr,dr={set:Qe,clear:tr},vr=_.navigator,yr=vr&&vr.userAgent||"",gr=wt.f,mr=dr.set,_r=_.MutationObserver||_.WebKitMutationObserver,br=_.process,xr=_.Promise,wr="process"==e(br),Er=gr(_,"queueMicrotask"),Tr=Er&&Er.value;function Ar(t,e){if(h(t),l(e)&&e.constructor===t)return e;var r=Ur.f(t);return(0,r.resolve)(e),r.promise}function kr(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}function Sr(t){return"function"==typeof t?t:void 0}function Mr(t,e){return arguments.length<2?Sr(Gr[t])||Sr(_[t]):Gr[t]&&Gr[t][e]||_[t]&&_[t][e]}function Or(t){var e;return!(!l(t)||"function"!=typeof(e=t.then))&&e}function Ir(t,e,r){var n;e.notified||(e.notified=!0,n=e.reactions,Br(function(){for(var i=e.value,o=1==e.state,a=0;n.length>a;)!function(r){var n,a,s,u=o?r.ok:r.fail,l=r.resolve,c=r.reject,h=r.domain;try{u?(o||(2===e.rejection&&dn(t,e),e.rejection=1),!0===u?n=i:(h&&h.enter(),n=u(i),h&&(h.exit(),s=!0)),n===r.promise?c(Jr("Promise-chain cycle")):(a=Or(n))?a.call(n,l,c):l(n)):c(i)}catch(r){h&&!s&&h.exit(),c(r)}}(n[a++]);e.reactions=[],e.notified=!1,r&&!e.rejection&&fn(t,e)}))}function Lr(t,e,r){var n,i;un?((n=Qr.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),_.dispatchEvent(n)):n={promise:e,reason:r},(i=_["on"+t])?i(n):t===ln&&function(t,e){var r=_.console;r&&r.error&&(1===arguments.length?r.error(t):r.error(t,e))}("Unhandled promise rejection",r)}function Cr(t,e,r,n){return function(i){t(e,r,i,n)}}function Rr(t,e,r,n){e.done||(e.done=!0,n&&(e=n),e.value=r,e.state=2,Ir(t,e,!0))}Tr||(sr=function(){var t,e;for(wr&&(t=br.domain)&&t.exit();ur;){e=ur.fn,ur=ur.next;try{e()}catch(t){throw ur?cr():lr=void 0,t}}lr=void 0,t&&t.enter()},cr=wr?function(){br.nextTick(sr)}:_r&&!/(iphone|ipod|ipad).*applewebkit/i.test(yr)?(hr=!0,fr=document.createTextNode(""),new _r(sr).observe(fr,{characterData:!0}),function(){fr.data=hr=!hr}):xr&&xr.resolve?(pr=xr.resolve(void 0),function(){pr.then(sr)}):function(){mr.call(_,sr)});var Pr,Nr,jr,Dr,zr,Hr,Fr,Br=Tr||function(t){var e={fn:t,next:void 0};lr&&(lr.next=e),ur||(ur=e,cr()),lr=e},Ur={f:function(t){return new function(t){var e,r;this.promise=new t(function(t,n){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=n}),this.resolve=Pe(e),this.reject=Pe(r)}(t)}},Gr=_,qr=y("species"),Vr="Promise",Wr=dr.set,Yr=y("species"),Kr=et.get,Xr=et.set,Zr=et.getterFor(Vr),$r=_[Vr],Jr=_.TypeError,Qr=_.document,tn=_.process,en=_.fetch,rn=tn&&tn.versions,nn=rn&&rn.v8||"",on=Ur.f,an=on,sn="process"==e(tn),un=!!(Qr&&Qr.createEvent&&_.dispatchEvent),ln="unhandledrejection",cn=zt(Vr,function(){function t(){}var e=$r.resolve(1),r=(e.constructor={})[Yr]=function(e){e(t,t)};return!((sn||"function"==typeof PromiseRejectionEvent)&&e.then(t)instanceof r&&0!==nn.indexOf("6.6")&&-1===yr.indexOf("Chrome/66"))}),hn=cn||!function(t,e){if(!Be)return!1;var r=!1;try{var n={};n[Fe]=function(){return{next:function(){return{done:r=!0}}}},function(t){$r.all(t).catch(function(){})}(n)}catch(t){}return r}(),fn=function(t,e){Wr.call(_,function(){var r,n=e.value;if(pn(e)&&(r=kr(function(){sn?tn.emit("unhandledRejection",n,t):Lr(ln,t,n)}),e.rejection=sn||pn(e)?2:1,r.error))throw r.value})},pn=function(t){return 1!==t.rejection&&!t.parent},dn=function(t,e){Wr.call(_,function(){sn?tn.emit("rejectionHandled",t):Lr("rejectionhandled",t,e.value)})},vn=function(t,e,r,n){if(!e.done){e.done=!0,n&&(e=n);try{if(t===r)throw Jr("Promise can't be resolved itself");var i=Or(r);i?Br(function(){var n={done:!1};try{i.call(r,Cr(vn,t,n,e),Cr(Rr,t,n,e))}catch(r){Rr(t,n,r,e)}}):(e.value=r,e.state=1,Ir(t,e,!1))}catch(r){Rr(t,{done:!1},r,e)}}};function yn(t){return(yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _n(t,e,r){return e&&mn(t.prototype,e),r&&mn(t,r),t}function bn(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xn(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function wn(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?xn(Object(r),!0).forEach(function(e){bn(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xn(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function En(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&An(t,e)}function Tn(t){return(Tn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function An(t,e){return(An=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function kn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function Sn(t,e,r){return(Sn=kn()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&An(i,r.prototype),i}).apply(null,arguments)}function Mn(t){var e="function"==typeof Map?new Map:void 0;return(Mn=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return Sn(t,arguments,Tn(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),An(n,t)})(t)}function On(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function In(t){var e=kn();return function(){var r,n,i=Tn(t);return this,!(n=e?(r=Tn(this).constructor,Reflect.construct(i,arguments,r)):i.apply(this,arguments))||"object"!=typeof n&&"function"!=typeof n?On(this):n}}function Ln(t,e,r){return(Ln="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Tn(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function Cn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}}(t,e)||Pn(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rn(t){return function(t){if(Array.isArray(t))return Nn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Pn(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pn(t,e){if(t){if("string"==typeof t)return Nn(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Nn(t,e):void 0}}function Nn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function jn(t,e){var r;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=Pn(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}cn&&($r=function(t){!function(t,e,r){if(!(t instanceof $r))throw TypeError("Incorrect "+r+" invocation")}(this,0,Vr),Pe(t),Pr.call(this);var e=Kr(this);try{t(Cr(vn,this,e),Cr(Rr,this,e))}catch(t){Rr(this,e,t)}},(Pr=function(){Xr(this,{type:Vr,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=function(t,e,r){for(var n in e)rt(t,n,e[n],void 0);return t}($r.prototype,{then:function(t,e){var r=Zr(this),n=on(Ge(this,$r));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=sn?tn.domain:void 0,r.parent=!0,r.reactions.push(n),0!=r.state&&Ir(this,r,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),Nr=function(){var t=new Pr,e=Kr(t);this.promise=t,this.resolve=Cr(vn,t,e),this.reject=Cr(Rr,t,e)},Ur.f=on=function(t){return t===$r||t===jr?new Nr:an(t)},"function"==typeof en&&ct({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return Ar($r,en.apply(_,arguments))}})),ct({global:!0,wrap:!0,forced:cn},{Promise:$r}),re($r,Vr,!1),Dr=Mr(Vr),zr=A.f,b&&Dr&&!Dr[qr]&&zr(Dr,qr,{configurable:!0,get:function(){return this}}),jr=Gr[Vr],ct({target:Vr,stat:!0,forced:cn},{reject:function(t){var e=on(this);return e.reject.call(void 0,t),e.promise}}),ct({target:Vr,stat:!0,forced:cn},{resolve:function(t){return Ar(this,t)}}),ct({target:Vr,stat:!0,forced:hn},{all:function(t){var e=this,r=on(e),n=r.resolve,i=r.reject,o=kr(function(){var r=Pe(e.resolve),o=[],a=0,s=1;He(t,function(t){var u=a++,l=!1;o.push(void 0),s++,r.call(e,t).then(function(t){l||(l=!0,o[u]=t,--s||n(o))},i)}),--s||n(o)});return o.error&&i(o.value),r.promise},race:function(t){var e=this,r=on(e),n=r.reject,i=kr(function(){var i=Pe(e.resolve);He(t,function(t){i.call(e,t).then(r.resolve,n)})});return i.error&&n(i.value),r.promise}}),ct({target:"Promise",proto:!0,real:!0},{finally:function(t){var e=Ge(this,Mr("Promise")),r="function"==typeof t;return this.then(r?function(r){return Ar(e,t()).then(function(){return r})}:t,r?function(r){return Ar(e,t()).then(function(){throw r})}:t)}}),Gr.Promise,"function"!=typeof Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),r=1;r<arguments.length;r++){var n=arguments[r];if(null!=n)for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}return e}),"function"!=typeof Object.values&&(Object.values=function(t){return Object.keys(t).map(function(e){return t[e]})}),Math.hypot=Math.hypot||function(){for(var t=0,e=arguments.length,r=0;r<e;r++){if(arguments[r]===1/0||arguments[r]===-1/0)return 1/0;t+=arguments[r]*arguments[r]}return Math.sqrt(t)},Math.log2=Math.log2||function(t){return Math.log(t)*Math.LOG2E},"undefined"!=typeof window?("performance"in window==0&&(window.performance={}),Hr=window.performance):"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&("performance"in self==0&&(self.performance={}),Hr=self.performance),Hr&&"function"!=typeof Hr.now&&(Fr=+new Date,Hr.now=function(){return new Date-Fr});var Dn=zn;function zn(t,e){this.x=t,this.y=e}zn.prototype={clone:function(){return new zn(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,r=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),n=e*this.x-r*this.y,i=r*this.x+e*this.y;return this.x=n,this.y=i,this},_rotateAround:function(t,e){var r=Math.cos(t),n=Math.sin(t),i=e.x+r*(this.x-e.x)-n*(this.y-e.y),o=e.y+n*(this.x-e.x)+r*(this.y-e.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},zn.convert=function(t){return t instanceof zn||!Array.isArray(t)?t:new zn(t[0],t[1])};var Hn=Fn;function Fn(t,e,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=i,t.readFields(Bn,this,e)}function Bn(t,e,r){1==t?e.id=r.readVarint():2==t?function(t,e){for(var r=t.readVarint()+t.pos;t.pos<r;){var n=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[n]=i}}(r,e):3==t?e.type=r.readVarint():4==t&&(e._geometry=r.pos)}Fn.types=["Unknown","Point","LineString","Polygon"],Fn.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r,n=t.readVarint()+t.pos,i=1,o=0,a=0,s=0,u=[];t.pos<n;)if(o||(i=7&(r=t.readVarint()),o=r>>3),o--,1===i||2===i)a+=t.readSVarint(),s+=t.readSVarint(),1===i&&(e&&u.push(e),e=[]),e.push(new Dn(a,s));else{if(7!==i)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}return e&&u.push(e),u},Fn.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,n=1,i=0,o=0,a=0,s=1/0,u=-1/0,l=1/0,c=-1/0;t.pos<r;)if(i||(n=7&(e=t.readVarint()),i=e>>3),i--,1===n||2===n)(o+=t.readSVarint())<s&&(s=o),u<o&&(u=o),(a+=t.readSVarint())<l&&(l=a),c<a&&(c=a);else if(7!==n)throw new Error("unknown command "+n);return[s,l,u,c]},Fn.prototype.toGeoJSON=function(t,e,r){var n,i=this.extent*Math.pow(2,r),o=this.extent*t,a=this.extent*e,s=this.loadGeometry(),u=Fn.types[this.type];function l(t){for(var e=0;e<t.length;e++){var r=t[e],n=180-360*(r.y+a)/i;t[e]=[360*(r.x+o)/i-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:for(var c=[],h=0;h<s.length;h++)c[h]=s[h][0];l(s=c);break;case 2:for(h=0;h<s.length;h++)l(s[h]);break;case 3:for(s=function(t){var e=t.length;if(e<=1)return[t];for(var r,n,i=[],o=0;o<e;o++){var a=function(t){for(var e,r,n=0,i=0,o=t.length,a=o-1;i<o;a=i++)e=t[i],n+=((r=t[a]).x-e.x)*(e.y+r.y);return n}(t[o]);0!==a&&(void 0===n&&(n=a<0),n===a<0?(r&&i.push(r),r=[t[o]]):r.push(t[o]))}return r&&i.push(r),i}(s),h=0;h<s.length;h++)for(n=0;n<s[h].length;n++)l(s[h][n])}1===s.length?s=s[0]:u="Multi"+u;var f={type:"Feature",geometry:{type:u,coordinates:s},properties:this.properties};return"id"in this&&(f.id=this.id),f};var Un=Gn;function Gn(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(qn,this,e),this.length=this._features.length}function qn(t,e,r){15===t?e.version=r.readVarint():1===t?e.name=r.readString():5===t?e.extent=r.readVarint():2===t?e._features.push(r.pos):3===t?e._keys.push(r.readString()):4===t&&e._values.push(function(t){for(var e=null,r=t.readVarint()+t.pos;t.pos<r;){var n=t.readVarint()>>3;e=1==n?t.readString():2==n?t.readFloat():3==n?t.readDouble():4==n?t.readVarint64():5==n?t.readVarint():6==n?t.readSVarint():7==n?t.readBoolean():null}return e}(r))}function Vn(t,e,r){var n;3!==t||(n=new Un(r,r.readVarint()+r.pos)).length&&(e[n.name]=n)}Gn.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Hn(this._pbf,e,this.extent,this._keys,this._values)};var Wn,Yn=Hn,Kn=void 0!==global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},Xn={};(function(){var t,e,r="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,r){t!=Array.prototype&&t!=Object.prototype&&(t[e]=r.value)},n="undefined"!=typeof window&&window===this||void 0===Kn||null==Kn?this:Kn;if("function"==typeof Object.setPrototypeOf)t=Object.setPrototypeOf;else{t:{var i={};try{i.__proto__={ea:!0},e=i.ea;break t}catch(t){}e=!1}t=e?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null}var o=t;!function(t,e){if(e){var i=n;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in i||(i[a]={}),i=i[a]}(e=e(o=i[t=t[t.length-1]]))!=o&&null!=e&&r(i,t,{configurable:!0,writable:!0,value:e})}}("Object.setPrototypeOf",function(t){return t||o});var a=this||self;function s(t){var e=yn(t);if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var r=Object.prototype.toString.call(t);if("[object Window]"==r)return"object";if("[object Array]"==r||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==r||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function u(t){return"function"==s(t)}function l(t){var e=yn(t);return"object"==e&&null!=t||"function"==e}function c(t,e){t=t.split(".");var r,n=a;t[0]in n||void 0===n.execScript||n.execScript("var "+t[0]);for(;t.length&&(r=t.shift());)t.length||void 0===e?n=n[r]&&n[r]!==Object.prototype[r]?n[r]:n[r]={}:n[r]=e}function h(t,e){function r(){}r.prototype=e.prototype,t.ua=e.prototype,t.prototype=new r,t.prototype.constructor=t}var f=Math,p=f.min,d=f.max,v=f.round,y=f.floor,g=f.ceil,m=f.abs,_=f.log,b=f.sqrt,x=f.pow,w=f.sin,E=f.asin,T=f.cos,A=f.tan,k=f.atan2,S=f.PI,M=S/2,O=S/4,I=2*S,L=3*S,C=S/180,R=180/S;function P(t,e,r){return r<t?r:t<e?e:t}function N(t,e,r){return e<r?e<=t&&t<=r:r<=t&&t<=e}function j(t,e,r,n,i,o){return b(x((t-i)*(n-o)-(e-o)*(r-i),2)/(x(r-i,2)+x(n-o,2)))}c("H.math.normalize",function(t,e,r){return e-=r=r||0,(t-=r)-y(t/e)*e+r}),c("H.math.clamp",P);var D={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};function z(t,e){var r=t.x;t=t.y;for(var n,i,o,a,s=e.length,u=s,l=e[0],c=0,h=0,f=0;1!=c&&1<u;)i=e[--u],n=e[--u],a=e[u?u-1:(s+(u-1))%s],o=e[u?u-2:(s+(u-2))%s],r<=n&&n<=r&&t<=i&&i<=t||r<=o&&o<=r&&t<=a&&a<=t?c=1:c||n!==r?!c&&N(r,n,o)&&((n<r&&r<o||r<n&&o<r)&&(h+=t<(l=i+(r-n)/(o-n)*(a-i)),f+=l<t),c=N(t,i,a)&&j(r,t,n,i,o,a)<=0?2:0):(o===r&&(i<t&&t<a||t<i&&a<t)||(l<=r&&r<o||r<=l&&o<r)&&(t<=i?++h:++f),c=N(t,i,a)&&j(r,t,n,i,o,a)<=0?2:0),l=n;return c||0===f||0==h%2||(c=3),c!==D.NONE}function H(t,e){this.x=+t,this.y=+e}function F(t,e,r,n,i,o,a,s,u,l){return t={x:t,y:e,next:r||null,s:n||null,ta:i||null,X:o||null,o:!!a,T:s||0,O:u||0,alpha:l||0},n&&(t.s.next=t),r&&(t.next.s=t),t}function B(t){for(;t&&t.o;)t=t.next;return t}function U(t){if(t)for(;t.next;)t=t.next;return t}function G(t){var e=U(t);(e.s.next=t).s=e.s}function q(t){for(var e=[];t;)e.push(t.x,t.y),t=t.next;return e}function V(t,e,r){for(e=e.next;e!==r&&e.alpha<=t.alpha;)e=e.next;t.next=e,t.s=e.s,(t.next.s=t).s.next=t}function W(t,e){for(var r,n=null,i=0,o=t.length;i<o;i++)(r=F(t[i].x,t[i].y,n)).qa=e,(r.next=n)&&(n.s=r),n=r;return n}function Y(t,e,r,n){return(t-=r)*t+(e-=n)*e}c("H.math.CoverType",D),c("H.math.isPointInsidePolygon",z),c("H.math.flatten",function(t){for(var e=t.length,r=new Float64Array(2*e),n=e&&t[0].x!==Z;e--;){var i=t[e],o=e<<1;r[o]=n?i.x:i[0],r[1+o]=n?i.y:i[1]}return r}),c("H.math.Point",H),(H.prototype.set=H).prototype.clone=function(t){return t?(t.x=this.x,t.y=this.y):t=new H(this.x,this.y),t},H.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},H.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},H.prototype.scale=function(t,e){return this.x*=t,this.y*=void 0===e?t:e,this},H.prototype.round=function(){return this.x=v(this.x),this.y=v(this.y),this},H.prototype.floor=function(){return this.x=y(this.x),this.y=y(this.y),this},H.prototype.ceil=function(){return this.x=g(this.x),this.y=g(this.y),this},H.prototype.equals=H.prototype.w=function(t){return!(!t||this.x!==t.x||this.y!==t.y)},H.prototype.getNearest=H.prototype.la=function(t,e){var r,n=e.x-t.x,i=e.y-t.y,o=t;return(n||i)&&(o=(r=((this.x-t.x)*n+(this.y-t.y)*i)/(n*n+i*i))<=0?t:1<=r?e:new H(t.x+r*n,t.y+r*i)),o},H.prototype.distance=H.prototype.R=function(t){return b(x(this.x-t.x,2)+x(this.y-t.y,2))},H.fromIPoint=function(t){if(!t)throw Error("invalid argument");return t instanceof H?t:new H(t.x,t.y)},c("H.math.clipping.clipStrips",function(t,e,r,n,i,o){var a,s,u,l=t.length;if(l)for(a=[];l--;)for(var c,h,f=t[l],p=f.length,d=0,v=1;v<p;v++)(u=function(t,e,r,n,i,o){var a=t.x;t=-t.y;var s=e.x;if(e=-e.y,r=-r,o=-o,s<a){if(i<s||a<n)return;var u=a,l=t;a=s,t=e,s=u,e=l,u=1}else if(i<a||s<n)return;if(e<t){if(r<e||t<o)return;var c=1;t=-t,e=-e,l=o,o=-r,r=-l}else if(r<t||e<o)return;if(a<n){if((t+=(n-a)*(e-t)/(s-a))>r)return;a=n}if(t<o){if((a+=(o-t)*(s-a)/(e-t))>i)return;t=o}return i<s&&(e=t+(i-a)*(e-t)/(s-a),s=i),r<e&&(s=a+(r-t)*(s-a)/(e-t),e=r),c&&(t=-t,e=-e),u?[new H(s,-e),new H(a,-t)]:[new H(a,-t),new H(s,-e)]}(f[v-1],f[v],r,e,n,i))&&(c=u[0],h=u[1],d&&d.w(c)?s.push(h):a.push(s=u),d=h,o&&(v=p,l=0));else a=t;return a}),c("H.math.clipping.clipPolygon",function(t,e,r){var n;t=W(t,!0),e=W(e,!1);var i={},o=n=1;switch(~~(r||0)){case 1:o=n=0;break;case 2:n=0,o=1;break;case 3:n=1,o=0}r=n;var a,s,u,l,c,h,f=o;if(e&&t){for(e.M=F(e.x,e.y,null,U(e)),t.M=F(t.x,t.y,null,U(t)),o=e;o.next;o=o.next)if(!o.o)for(n=t;n.next;n=n.next)n.o||(h=function t(e,r,n,i,o){var a,s=r.x-e.x,u=r.y-e.y,l=i.x-n.x,c=i.y-n.y,h=s*c-u*l;return h?(l=((n.x-e.x)*c-(n.y-e.y)*l)/h,h=(u*(n.x-e.x)-s*(n.y-e.y))/h,l<0||1<l||h<0||1<h?0:(0===l?a=e:1===l?a=r:0===h?a=n:1===h&&(a=i),a?(a.x+=2480549651603763e-20,a.y+=7321997314118067e-20,a.M&&(a.M.x=a.x,a.M.y=a.y),t(e,r,n,i,o)):(o.xa=e.x+l*s,o.ya=e.y+l*u,o.fa=l,o.ga=h,1))):0}(o,a=B(o.next),n,s=B(n.next),i))&&(h=i.fa,u=i.ga,V(h=F(l=i.xa,c=i.ya,null,null,null,null,!0,0,0,h),o,a),V(a=F(l,c,null,null,null,null,!0,0,0,u),n,s),(h.X=a).X=h);for(i=z(e,q(t)),r&&(i=!i),o=e;o;o=o.next)o.o&&(i=!(o.T=i));for(i=z(t,q(e)),f&&(i=!i),n=t;n.next;n=n.next)n.o&&(i=!(n.T=i));for(G(e),G(t);(t=function(t){var e=t;if(e)for(;(e=e.next)!=t&&(!e.o||e.o&&e.O););return e}(e))!=e;){for(r=null;!t.O;t=t.X){for(i=t.T;(r=F(t.x,t.y,r)).artificial=t.o||t.qa,t.O=1,t=i?t.next:t.s;)if(t.o){t.O=1;break}if(!t)break}r.ta=p;var p=r}return p}}),c("H.math.simplifyDP",function(t,e,r){return function t(e,r,n,i,o){var a=0,s=i,u=e[i].x,l=e[i].y,c=e[o].x,h=e[o].y,f=i+1,p=Y(u,l,c,h);if(p)for(;f<o;){var d=e[f++],v=d.x,y=((v-u)*(c-u)+((d=d.y)-l)*(h-l))/p;a<(v=y<0?Y(v,d,u,l):1<y?Y(v,d,c,h):Y(v,d,u+y*(c-u),l+y*(h-l)))&&(a=v,s=f-1)}else for(;f<o;)a<(v=Y(v=(d=e[f++]).x,d=d.y,u,l))&&(a=v,s=f-1);return i=r<=a||0<n&&s-i?(--n,1<s-i?(i=t(e,r,n,i,s)).splice(i.length-1,1):i=[e[i]],1<o-s?i.concat(t(e,r,n,s,o)):i.concat(e.slice(s,o+1))):[e[i],e[o]]}(t,e*e,r||0,0,t.length-1)});var K=this,X=String,Z=[].pop(),$=/x/.exec(""),J="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(t,e){if(1==(t instanceof e&&t.constructor===e))throw new TypeError("Illegal constructor "+it(e))}c("H.lang.isArray",function(t,e,r,n){var i;if(!(i="Array"===rt(t))&&e)throw new lt(e,r,n!==Z?n:t);return i}),c("H.lang.isString",function(t){return"string"==typeof t});var tt=isNaN;function et(t){return t===+t}function rt(t){var e=Object[J[0]][J[6]].call(t).match(/^\[object (\w+)\]$/);return e?e[1]:yn(t)}c("H.lang.isNumber",et),c("H.lang.isInteger",Number.isInteger?Number.isInteger:function(t){return"number"==typeof t&&0==t%1});var nt=[];function it(t,e,r,n){var i,o,a="",s=arguments.length<2;return s&&(e={H:K.H},r="",n=nt.slice()),st(e,!0,function(e,o){try{if(i=e[o],s=i,st(e,!(c=[]),function(t,e){t[e]===s&&c.push(e)}),o=c.sort(ot)[0],!(l(i)&&i.window===i&&i.self===i||l(i)&&0<i.nodeType&&u(i.cloneNode))&&l(i)){if(i===t)return a=r+"."+o,1;if(n.indexOf(i)<0&&(n.push(i),a=it(t,i,r+"."+o,n)))return 1}}catch(e){}var s,c}),s&&(a=a?a.substr(1).replace("."+J[0]+".","#"):"~"+(u(t)?((o=/^\s*function ([^\( ]+)/.exec(o=t))?o[1]:"anonymous")+"()":rt(t))),a}function ot(t,e){return e.length-t.length}nt.indexOf(nt)<0&&nt.push(nt);var at=Object[J[0]][J[2]];function st(t,e,r){var n;if(t){for(i in t)if((!e||at.call(t,i))&&r(t,i,!0))return;for(n=J.length;n--;){var i=J[n];if((!e||at.call(t,i))&&r(t,i,!1))break}}}function ut(t,e,r){r[e]="#"+e}function lt(t,e,r){var n,i,o=arguments.length;return(e=e!==Z?+e:e)!==Z&&((i=n=(i=/^.*?\(([^\)]+)/.exec((""+t).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")))?X(i[1].replace(/\s+/g,"")).split(","!==Z?",":" "):[]).forEach(ut),i=i[e]||"#"+e),n=t?it(t):"",o=2<o?X(r):"",(i||o)&&(n+=" (Argument "+(i||"")+(o?" "+o:"")+")"),o=Error(n),Object.setPrototypeOf(o,lt.prototype),o}function ct(t,e,r){var n=P(+t,-90,90);if(e&&tt(n))throw new lt(e,r,t);return n}function ht(t,e,r){var n,i=+t;if((i<-180||180<i)&&(i=(0==(n=(i+180)%360)<0?n:360+n)-180),e&&tt(i))throw new lt(e,r,t);return i}function ft(t,e,r){var n;if(t!==Z&&tt(n=+t)&&e)throw new lt(e,r,t);return n}function pt(){Q(this,pt)}function dt(t,e,r){this.lat=ct(t,dt,0),this.lng=ht(e,dt,1),r!==Z&&(this.alt=ft(r,dt,2))}function vt(t,e,r){var n=l(t)&&!(tt(t.lat=ct(t.lat))||tt(t.lng=ht(t.lng))||t.alt!==Z&&tt(t.alt=ft(t.alt)));if(!n&&e)throw new lt(e,r,t);return n}function yt(t,e,r,n){gt(this,ct(t,yt,0),ht(e,yt,1),ct(r,yt,2),ht(n,yt,3))}function gt(t,e,r,n,i){return t.f=r,t.g=i,e<n&&(r=e,e=n,n=r),t.i=e,t.h=n,t.m=t.b=t.c=null,t}function mt(t,e){return(t=e-t)+(t<0?360:0)}function _t(t,e){return(t+=e/2)-(180<t?360:0)}function bt(t,e,r,n,i,o,a,s,u){r=p(r,a),t=d(t,i);var l=_t(e,i=mt(e,n)),c=_t(o,a=mt(o,s))-l,h=(c+=c-1e-6<0?360:0)-1e-6<180?(l=e,s):(c=360-c,l=o,n);return 360<=(c=c+i/2+a/2)+5e-7?(l=-180,h=180):c-5e-7<i?(l=e,h=n):c-5e-7<a&&(l=o,h=s),u?gt(u,t,l,r,h):new yt(t,l,r,h)}function xt(t,e,r){return r||(vt(t,xt,0),vt(e,xt,1)),new yt(t.lat,t.lng,e.lat,e.lng)}function wt(t,e,r,n,i,o){Q(this,wt),this.sa=t||10,this.c=this.b=null,this.j=n||0,this.l=i||0,this.m=e||1,this.u=r||1,this.I=!!o,this.flush()}function Et(t,e,r){var n,i;if(t.I&&(n=t.c))for(i=3;0<=i;i--){var o=e[i];if(i%3?o>=n[i]:o<=n[i]){if(!r){t.c=null;break}n[i]=o}}}function Tt(t,e){var r,n=t.a;if(e){var i=e;if(i!==n)for(n=i;i=i.c;)(i.entries||1<i.a)&&(n=i)}else for(;!n.entries&&(r=n.a)<2&&r;)n=i;t.a=n}h(lt,Error),c("H.lang.InvalidArgumentError",lt),lt.prototype.name="InvalidArgumentError",c("H.geo.isDBC",function(t,e){return 0!=(t<0^e<0)&&180<m(e-t)}),c("H.geo.AbstractGeometry",pt),pt.prototype.getBoundingBox=pt.prototype.D,pt.prototype.equals=pt.prototype.w,pt.prototype.a="",pt.prototype.l="",pt.prototype.toString=function(){return this.I([this.a.toUpperCase()," "]).join("")},pt.prototype.toGeoJSON=pt.prototype.va=function(){return{type:this.l,coordinates:this.u()}},pt.prototype.forWorkerMessage=pt.prototype.U=function(){return{type:this.a,coordinates:this.j(),boundingBox:this.D().U()}},h(dt,pt),c("H.geo.Point",dt),dt.prototype.equals=dt.prototype.w=function(t){return this===t||!!t&&this.lat===t.lat&&this.lng===t.lng&&(this.alt||0)===(t.alt||0)},dt.prototype.distance=dt.prototype.R=function(t){var e,r;return this===t||this.lat===t.lat&&this.lng===t.lng?0:(e=this.lat*C,r=t.lat*C,12742001.58*E(p(1,b(x(w((e-r)/2),2)+T(e)*T(r)*x(w((this.lng*C-t.lng*C)/2),2)))))},dt.prototype.walk=dt.prototype.wa=function(t,e,r){var n,i,o,a,s,u,l;return r?((e/=6371000.79)&&(t*=C,s=C*this.lat,n=w(s),i=w(e),o=T(e),a=C*this.lng,u=T(s),s=E(u*T(t)*i+n*o),u=(t=(a+(t=k(w(t)*u*i,o-n*w(s)))+S)%(2*S)-S)*R),e?new dt(s*R,(u+540)%360-180):this):0==(90+(t=(t%360+360)%360))%180?(s=this.lng+e/(6371000.79*I*T(this.lat*C))*(270===t?-360:360),new dt(this.lat,(s+540)%360-180)):((e/=6371000.79)&&(t*=C,a=this.lat*C,n=this.lng*C,o=(i=a+e*T(t))-a,s=_(A(i/2+O)/A(a/2+O)),s=tt(o/s)?T(a):o/s,l=e*w(t)/s,m(i)>M&&(i=0<i?S-i:-(S+i))),e?new dt(i*R,((n+l+L+(m(a+o)>M?S:0))%I-S)*R):this)},dt.prototype.getBoundingBox=dt.prototype.D=function(){return new yt(this.lat,this.lng,this.lat,this.lng)},dt.validate=vt,dt.fromIPoint=function t(e){if(!e)throw new lt(t,0,e);return new dt(e.lat,e.lng,e.alt)},dt.prototype.a="Point",dt.prototype.I=function(t){return t.push("(",this.lng," ",this.lat,")"),t},dt.prototype.l="Point",dt.prototype.u=function(){return[this.lng,this.lat,this.alt||0]},dt.prototype.j=function(){return[this.lat,this.lng,this.alt||0]},h(yt,pt),c("H.geo.Rect",yt),yt.prototype.a="Polygon",yt.prototype.I=function(t){var e=this.i,r=this.f,n=this.h,i=this.g;return t.push("(","(",r," ",e,",",i," ",e,",",i," ",n,",",r," ",n,",",r," ",e,")",")"),t},yt.prototype.equals=yt.prototype.w=function(t){return this===t||!!t&&this.i===t.i&&this.f===t.f&&this.h===t.h&&this.g===t.g},yt.prototype.clone=function(){return new yt(this.i,this.f,this.h,this.g)},yt.prototype.getTopLeft=yt.prototype.W=function(){return this.m||(this.m=new dt(this.i,this.f)),this.m},yt.prototype.getBottomRight=yt.prototype.V=function(){return this.b||(this.b=new dt(this.h,this.g)),this.b},yt.prototype.getTop=yt.prototype.na=function(){return this.i},yt.prototype.getBottom=yt.prototype.ha=function(){return this.h},yt.prototype.getLeft=yt.prototype.ja=function(){return this.f},yt.prototype.getRight=yt.prototype.ma=function(){return this.g},yt.prototype.getCenter=yt.prototype.F=function(){return this.c||(this.c=new dt(this.h+(this.i-this.h)/2,_t(this.f,this.A()))),this.c},yt.prototype.getWidth=yt.prototype.A=function(){return mt(this.f,this.g)},yt.prototype.getHeight=yt.prototype.G=function(){return this.i-this.h},yt.prototype.isCDB=yt.prototype.N=function(){return this.f>this.g},yt.prototype.isEmpty=yt.prototype.ra=function(){return!this.A()&&!this.G()},yt.prototype.getBoundingBox=yt.prototype.D=function(){return new yt(this.i,this.f,this.h,this.g)},yt.prototype.containsLatLng=yt.prototype.L=function(t,e,r){var n=this.F();return r||(t=ct(t,this.L,0),e=ht(e,this.L,1)),(t=(e=this.B(t,e,r)).F()).lat===n.lat&&t.lng===n.lng&&this.G()===e.G()&&this.A()===e.A()},yt.prototype.containsPoint=yt.prototype.$=function(t,e){return e||vt(t,this.$,0),this.L(t.lat,t.lng,e)},yt.prototype.containsRect=yt.prototype.aa=function(t,e){var r=this.F();if(!(e||t instanceof yt))throw new lt(this.aa,0,t);return(t=(e=this.J(t,e)).F()).lat===r.lat&&t.lng===r.lng&&this.G()===e.G()&&this.A()===e.A()},yt.prototype.mergeLatLng=yt.prototype.B=function(t,e,r,n){if(!r){if(tt(t=ct(t)))throw new lt(this.B,0,t);if(tt(e=ht(e)))throw new lt(this.B,1,e)}return bt(this.i,this.f,this.h,this.g,t,e,t,e,n)},yt.prototype.mergePoint=yt.prototype.ca=function(t,e,r){return e||vt(t,this.ca,0),this.B(t.lat,t.lng,e,r)},yt.prototype.mergeRect=yt.prototype.J=function(t,e,r){if(!(e||t instanceof yt))throw new lt(this.J,0,t);return bt(this.i,this.f,this.h,this.g,t.i,t.f,t.h,t.g,r)},yt.prototype.mergeTopLeftBottomRight=yt.prototype.C=function(t,e,r,n,i,o){return i||(t=ct(t,this.C,0),e=ht(e,this.C,1),r=ct(r,this.C,2),n=ht(n,this.C,3)),bt(this.i,this.f,this.h,this.g,t,e,r,n,o)},yt.prototype.intersects=yt.prototype.ba=function(t,e){var r=this.f<=this.g,n=t.f<=t.g,i=this.f<t.g,o=t.f<this.g;if(!(e||t instanceof yt))throw new lt(this.ba,0,t);return this.h<=t.i&&t.h<=this.i&&(!r&&(!n||i||o)||!n&&(i||o)||i&&o)},yt.merge=bt,yt.fromPoints=xt,yt.coverPoints=function t(e,r){var n=1,i=e.length,o=null,a=s(e);if("array"!=a&&("object"!=a||"number"!=typeof e.length))throw new lt(t,0,e);if(0<i)for(o=xt(a=e[0],a,r);n<i;n++)a=e[n],o.B(a.lat,a.lng,r,o);return o},yt.coverLatLngAlts=function t(e,r){var n,i=3,o=e.length;if(!(r||e&&null!=e.length))throw new lt(t,0,e);if(0<o)for(n=new yt(e[0],e[1],e[0],e[1]);i<o;i+=3)n.B(e[i],e[i+1],r,n);return n},yt.coverRects=function t(e,r){var n,i=1,o=e.length;if(r&&(!e||null==e.length))throw new lt(t,0,e);if(0<o)for(n=new yt(e[0].i,e[0].f,e[0].h,e[0].g);i<o;i++)n.J(e[i],r,n);return n},yt.prototype.resizeToCenter=yt.prototype.da=function(t,e){var r=this.f,n=this.i,i=this.g,o=this.h,a=this.F().lng;vt(t,this.da,0);var s=t.lat-o-(n-o)/2,u=t.lng-a;return t=(t=r+((u=180<u||u<-180?-(a+t.lng):u)<0?2*u:0))<-180?360+t:t,i=180<(i+=0<u?2*u:0)?i-360:i,90<=(n=0<s?n+2*s:n)&&(n=90),(o=s<0?o+2*s:o)<=-90&&(o=-90),e?gt(e,n,t,o,i):new yt(n,t,o,i)},yt.prototype.l="Polygon",yt.prototype.u=function(){return[[this.f,this.i,0],[this.g,this.i,0],[this.g,this.h,0],[this.f,this.h,0],[this.f,this.i,0]]},yt.prototype.U=function(){return this.j()},yt.prototype.j=function(){return[this.i,this.f,this.h,this.g]},wt.prototype.remove=function(t){var e,r,n,i,o,a,s=!1;if(t&&(e=t.a)&&e.b===this&&(r=e.entries)&&0<=(n=r.indexOf(t))){for(r.splice(n,1),r=this.a;e;)(i=e.entries)&&i.length||(i&&delete e.entries,e.a||!(o=e.c))?e=$:((n=o)[a=(s=e).j]===s&&(delete n[a],delete s.c,--n.a),r===e&&(r=o),e=o);this.a!==r&&(this.a=r,Tt(this)),Et(this,t,!1),s=!0}return s},wt.prototype.flush=function(){var t=new kt(null,NaN,this.j-this.m,this.l-this.u,this.j+this.m,this.l+this.u);(t.b=this).a=this.b=t,this.c=null},wt.prototype.o=function(t,e,r,n,i,o){var a=[],s=this.a,u=this.b;return t<=s[5]&&e<=s[6]&&(i?r>=s[7]:r>s[7])&&(o?n>=s[4]:n>s[4])&&function t(e,r,n,i,o,a,s,u,l){var c,h=r.entries,f=r[7],p=r[4],d=r[5],v=r[6],y=r[8],g=r[9];if(h){var m=h.length;if(p<o||f<i||s<v||a<d)for(;m--;){p=(f=h[m])[3],d=f[0],v=f[1],o<=f[2]&&i<=v&&(d<s||u&&d==s)&&(p<a||l&&p==a)&&n.push(f)}else for(;m--;)n.push(h[m])}(y<a||l&&a==y)&&(o<g&&(c=r[1])&&t(e,c,n,i,o,a,s,u,l),(g<s||u&&s==g)&&(c=r[3])&&t(e,c,n,i,o,a,s,u,l)),i<y&&(o<g&&(c=r[0])&&t(e,c,n,i,o,a,s,u,l),(g<s||u&&s==g)&&(c=r[2])&&t(e,c,n,i,o,a,s,u,l))}(this,s,a,t,e,r,n,o||n>=u[6],i||r>=u[5]),a};var At=0;function kt(t,e,r,n,i,o){this.j=e,t&&(this.c=t,this.b=t.b,i=1&e?(r=t[8],t[5]):(r=t[7],t[8]),o=2&e?(n=t[9],t[6]):(n=t[4],t[9])),this[7]=r,this[5]=i,this[8]=(r+i)/2,this[4]=n,this[6]=o,this[9]=(n+o)/2}function St(t,e,r,n,i,o){St.ua.constructor.apply(this,arguments)}function Mt(t,e,r,n,i,o,a){var s,u,l=e[8],c=e[9];return a&&(i<l||(s=l<=r))&&(o<c||(u=c<=n))?r=(l=Mt)(t,e=e[s|=u<<1]||(++e.a,e[s]=new kt(e,s)),r,n,i,o,a-1):(n=r=new Ot(r,n,i,o),(e.entries||(e.entries=[])).push(n),n.a=e,Et(t,r,!0),Tt(t,e)),r}function Ot(t,e,r,n){this.id=At++,this[0]=e,this[1]=r,this[2]=n,this[3]=t}function It(t){this.l=new St(+t||10,180,90,0,0,!0),this.j=[],this.m=!1,this.a=this.b=this.c=null}function Lt(t,e,r,n,i,o){if(o)o=new Ot(i,-e,r+360,-n),t.j.push(o),t.m=!0,t.a&&t.a.C(e,r,n,i,!0,t.a);else{var a=-e,s=-n,u=(o=t.l).b,l=u[5],c=u[6];if(!(u[7]<=r&&u[4]<=a&&(i<l||l===i&&l===u.b.b[5])&&(s<c||c===s&&c===u.b.b[6])))throw Error("Coordinates out of bounds");o=Mt(o,o.b,r,a,i,s,o.sa),t.b&&t.b.C(e,r,n,i,!0,t.b)}return t.c=null,o}function Ct(t,e,r,n,i,o,a){var s=(t=t.j).length,u=[];if(s)for(var l=r+360,c=i+360;s--;){var h=t[s];(Rt(h,e,r,n,i,o,a)||Rt(h,e,l,n,c,o,a))&&u.push(h)}return u}function Rt(t,e,r,n,i,o,a){var s=t[3],u=t[0],l=t[1];return t=t[2],(o?u<=n:u<n)&&(a?s<=i:s<i)&&e<=t&&r<=l}function Pt(t,e){var r,n;if(r=e.length){for(var i=t.length,o={};i--;)o[t[i].id]=1;for(;r--;)(n=e[r]).id in o||t.push(n)}}function Nt(){}function jt(t,e,r){if(this.l=[],e&&this.K(e),r&&!u(r))throw new lt(jt,2,r);this.b=0,this.m=r,this.a={},this.j=this.c=null,this.Z(t)}function Dt(t,e){return e&&(t.c=Ht(t,e,t.c)),e}function zt(t){for(;t.b>t.u&&t.j;)Ft(t,t.j,!0)}function Ht(t,e,r){return r!==e&&((e.H||e.v)&&Ft(t,e,!1),(e.H=r)&&(e.v=r.v,r.v=e),e.v||(t.c=e),e.H||(t.j=e),t.b+=e.size),e}function Ft(t,e,r){var n=e.v,i=e.H;(n||i||e==t.c&&e==t.j)&&(n?n.H=i:t.c=i,i?i.v=n:t.j=n,t.b-=e.size,r&&(delete t.a[e.id],Bt(t,e))),e.H=e.v=null}function Bt(t,e){for(var r=t.l.length;r--;)t.l[r].call(t,e.id,e.data,e.size)}kt.prototype.a=0,h(St,wt),c("H.geo.QuadTree",It),It.prototype.N=function(){return this.m},It.prototype.D=function(){var t;if(!this.c){var e,r,n=[];if((a=!this.b)&&(s=(o=this.l).c,o.I&&!s&&((a=o.a).entries||a[0]||a[1]||a[2]||a[3])&&(s=function t(e,r){for(var n,i,o=0,a=3;0<=a;a--){for(var s=a+4,u=0<a%3,l=[],c=r[a],h=e[a],f=h.length;f--;){var p=h[f];if(n=p.entries)for(i=n.length;i--;){var d=n[i][a];(u?c<d:d<c)&&(c=d)}for(i=4;i--;)(n=p[i])&&(u?n[s]>c:n[s]<c)&&l.push(n)}o+=l.length,r[a]=c,e[a]=l}return o&&(r=t(e,r)),r}([s=[a],s,s,s],[a[6],a[7],a[4],a[5]]),o.c=s),a=o=s),a&&(this.b=new yt(-o[0],o[3],-o[2],o[1])),(t=this.b)&&n.push(t),!this.a&&(r=(e=this.j).length)){for(a=360,s=-(o=90),u=0;r--;)var i=e[r],o=p(o,i[0]),a=p(a,i[3]),s=d(s,i[2]),u=d(u,i[1]);this.a=new yt(-o,a,-s,u-360)}(t=this.a)&&n.push(t),(t=n[0])&&(n[1]&&(t=t.J(n[1],!0)),this.c=t)}return this.c},It.prototype.insertBoundingBox=It.prototype.oa=function(t){var e=t.W(),r=t.V();return(t=t.N())?Lt(this,e.lat,r.lng,r.lat,e.lng,t):Lt(this,e.lat,e.lng,r.lat,r.lng,t)},It.prototype.remove=function(t){var e,r;return t.a?(r=this.l.remove(t),this.b=null):(r=0<=(t=(e=this.j).indexOf(t)))&&(e.splice(t,1),this.m=0<e.length,this.a=null),r&&(this.c=null),r},It.prototype.intersectBoundingBox=It.prototype.pa=function(t,e,r){var n=this.l,i=t.W(),o=t.V(),a=-i.lat,s=(i=i.lng,-o.lat);o=o.lng;return!e&&a==s||!r&&i===o?t=[]:t.N()?(Pt(t=n.o(-180,a,o,s,r,e),n.o(i,a,180,s,!1,e)),Pt(t,Ct(this,a,o,s,i+360,e,r))):Pt(t=n.o(i,a,o,s,r,e),Ct(this,a,i,s,o,e,r)),t},c("H.util.ICache",Nt),Nt.prototype.add=function(){},Nt.prototype.get=function(){},Nt.prototype.drop=Nt.prototype.S=function(){},Nt.prototype.forEach=function(){},Nt.prototype.removeAll=Nt.prototype.Y=function(){},Nt.prototype.registerOnDrop=Nt.prototype.K=function(){},Nt.prototype.deRegisterOnDrop=Nt.prototype.P=function(){},c("H.util.Cache",jt),jt.prototype.add=function(t,e,r){var n,i;if(!et(r=+r)||r<0)throw new lt(this.add,2,r);return t=String(t),(i=!this.m||this.m(t,e,r))&&((n=this.a[t])?(n.data!==e&&Bt(this,n),this.b+=r-n.size,n.size=r,n.data=e,Dt(this,n)):this.a[t]=Ht(this,{id:t,data:e,size:r,H:null,v:null},this.c),zt(this)),i},jt.prototype.registerOnDrop=jt.prototype.K=function(t){if(!u(t))throw new lt(this.K,0,t);this.l.push(t)},jt.prototype.deRegisterOnDrop=jt.prototype.P=function(t){this.l=this.l.filter(function(e){return e!==t})},jt.prototype.get=function(t,e){return(t=e?this.a[t]:Dt(this,this.a[t]))&&t.data},jt.prototype.drop=jt.prototype.S=function(t){var e;(e=this.a[t])&&Ft(this,e,!0)},jt.prototype.forEach=function(t,e,r){var n;for(n in this.a){var i=this.a[n];r&&!r(n,i.data,i.size)||t.call(e,n,i.data,i.size)}},jt.prototype.removeAll=jt.prototype.Y=function(t){var e;for(e in this.a){var r=this.a[e];t&&!t(e,r.data,r.size)||Ft(this,this.a[e],!0)}},jt.prototype.setMaxSize=jt.prototype.Z=function(t){if(!(0<+t))throw new lt(jt.prototype.Z,0,t);return this.u=+t,zt(this),this},jt.prototype.getMaxSize=jt.prototype.ka=function(){return this.u},jt.prototype.getCurrentSize=jt.prototype.ia=function(){return this.b}}).call(Xn);var Zn,$n=Wn={};function Jn(t){return Sn(Xn.H.math.Point,Rn(t))}Wn.clipPolygon=function(t,e){var r,n,i,o=[],a=Xn.H.math.clipping.clipPolygon(t.map(Jn),e.map(Jn));if(a)do{for(r=[],n=a;r.push([(i=n).x,i.y]),n=n.next;);o.push(r)}while(a=a.nextPoly);else Wn.isPointInsidePolygon(e[0],t)?o.push(e):Wn.isPointInsidePolygon(t[0],e)&&o.push(t);return o},Wn.isPointInsidePolygon=function(t,e){return Xn.H.math.isPointInsidePolygon({x:t[0],y:t[1]},Xn.H.math.flatten(e))},Wn.clamp=function(t,e,r){return(t-=0)>r?r:t<e?e:t},Wn.splitLegs=function(t,e){var r=[];t.push(t[0]);for(var n=0;n<t.length-1;n++){var i,o=t[n],a=t[n+1];r.push(o),Math.abs(a[0]-o[0])>=e&&(i=[(o[0]+a[0])/2,(o[1]+a[1])/2],r.push(i))}return r.length!==t.length-1?Wn.splitLegs(r,e):r},Wn.getBBox=function(t){var e=1/0,r=1/0,n=-1/0,i=-1/0;return t.forEach(function(t){t[0]<e&&(e=t[0]),t[1]<r&&(r=t[1]),t[0]>n&&(n=t[0]),t[1]>i&&(i=t[1])}),[e,r,n,i]},Wn.getBBoxCenter=function(t){var e=Cn(t,4),r=e[0],n=e[1];return[r+(e[2]-r)/2,n+(e[3]-n)/2]},Wn.getLineLength=function(t,e,r,n){return Math.sqrt(Math.pow(t-r,2)+Math.pow(e-n,2))},Wn.modulo=function(t,e){var r;return(r=t%e)<0==e<0?r:r+e};var Qn=Zn={};Zn.default_source_max_zoom=18,Zn.default_view_max_zoom=20,Zn.tile_size=256,Zn.half_circumference_meters=20037508.342789244,Zn.circumference_meters=2*Zn.half_circumference_meters,Zn.min_zoom_meters_per_pixel=Zn.circumference_meters/Zn.tile_size;var ti=[];Zn.metersPerPixel=function(t){return ti[t]=ti[t]||Zn.min_zoom_meters_per_pixel/Math.pow(2,t),ti[t]};var ei=[];Zn.metersPerTile=function(t){return ei[t]=ei[t]||Zn.circumference_meters/Math.pow(2,t),ei[t]},Zn.tile_scale=4096,Zn.units_per_pixel=Zn.tile_scale/Zn.tile_size,Zn.height_scale=16;var ri=[];Zn.unitsPerMeter=function(t){return ri[t]=ri[t]||Zn.tile_scale/(Zn.tile_size*Zn.metersPerPixel(t)),ri[t]},Zn.metersForTile=function(t){return{x:t.x*Zn.circumference_meters/Math.pow(2,t.z)-Zn.half_circumference_meters,y:-(t.y*Zn.circumference_meters/Math.pow(2,t.z)-Zn.half_circumference_meters)}},Zn.tileForMeters=function(t,e){var r=Cn(t,2),n=r[0],i=r[1];return{x:Math.floor((n+Zn.half_circumference_meters)/(Zn.circumference_meters/Math.pow(2,e))),y:Math.floor((-i+Zn.half_circumference_meters)/(Zn.circumference_meters/Math.pow(2,e))),z:e}},Zn.metersToExactTileCoords=function(t,e){var r=Cn(t,2),n=r[0],i=r[1];return{x:Math.pow(2,e-1)*(1+n/Zn.half_circumference_meters),y:Math.pow(2,e-1)*(1-i/Zn.half_circumference_meters),z:e}},Zn.wrapTile=function(t){var e=t.x,r=t.y,n=t.z,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{x:!0,y:!1},o=(1<<n)-1;return i.x&&(e&=o),i.y&&(r&=o),{x:e,y:r,z:n}},Zn.wrapMeters=function(t){var e=t.x,r=t.y;return{x:$n.modulo(e+Zn.half_circumference_meters,Zn.circumference_meters)-Zn.half_circumference_meters,y:r}},Zn.metersToLatLng=function(t){var e=Cn(t,2),r=e[0],n=e[1];return r/=Zn.half_circumference_meters,n/=Zn.half_circumference_meters,n=(2*Math.atan(Math.exp(n*Math.PI))-Math.PI/2)/Math.PI,[r*=180,n*=180]},Zn.latLngToMeters=function(t){var e=Cn(t,2),r=e[0],n=e[1];n=Math.log(Math.tan(n*Math.PI/360+Math.PI/4))/Math.PI;return n*=Zn.half_circumference_meters,n=Math.min(Math.max(n,-Zn.half_circumference_meters),Zn.half_circumference_meters),[r*=Zn.half_circumference_meters/180,n]},Zn.tileSpaceToMeters=function(t,e,r){var n=Cn(t,2),i=n[0],o=n[1],a=Zn.unitsPerMeter(e);return[i/a+r.x,o/a+r.y]},Zn.tileSpaceToLatlng=function(t,e,r){var n=Zn.unitsPerMeter(e);return Zn.transformGeometry(t,function(t){t[0]=t[0]/n+r.x,t[1]=t[1]/n+r.y;var e=Cn(Zn.metersToLatLng(t),2),i=e[0],o=e[1];t[0]=i,t[1]=o}),t},Zn.copyGeometry=function(t){if(null!=t){var e={type:t.type};return"Point"===t.type?e.coordinates=[t.coordinates[0],t.coordinates[1]]:"LineString"===t.type||"MultiPoint"===t.type?e.coordinates=t.coordinates.map(function(t){return[t[0],t[1]]}):"Polygon"===t.type||"MultiLineString"===t.type?e.coordinates=t.coordinates.map(function(t){return t.map(function(t){return[t[0],t[1]]})}):"MultiPolygon"===t.type&&(e.coordinates=t.coordinates.map(function(t){return t.map(function(t){return t.map(function(t){return[t[0],t[1]]})})})),e}},Zn.transformGeometry=function(t,e){null!=t&&("Point"===t.type?e(t.coordinates):"LineString"===t.type||"MultiPoint"===t.type?t.coordinates.forEach(e):"Polygon"===t.type||"MultiLineString"===t.type?t.coordinates.forEach(function(t){return t.forEach(e)}):"MultiPolygon"===t.type&&t.coordinates.forEach(function(t){t.forEach(function(t){return t.forEach(e)})}))},Zn.boxIntersect=function(t,e){return!(e.sw.x>t.ne.x||e.ne.x<t.sw.x||e.sw.y>t.ne.y||e.ne.y<t.sw.y)},Zn.findBoundingBox=function(t){for(var e=1/0,r=-1/0,n=1/0,i=-1/0,o=t[0].length,a=0;a<o;a++){var s=t[0][a];s[0]<e&&(e=s[0]),s[1]<n&&(n=s[1]),s[0]>r&&(r=s[0]),s[1]>i&&(i=s[1])}return[e,n,r,i]},Zn.geometryType=function(t){return"Polygon"===t||"MultiPolygon"===t?"polygon":"LineString"===t||"MultiLineString"===t?"line":"Point"===t||"MultiPoint"===t?"point":void 0},Zn.centroid=function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(t&&0!==t.length){var r,n=0,i=0,o=0,a=t[0],s=a.length;e&&(r=a[0],a=a.map(function(t){return[t[0]-r[0],t[1]-r[1]]}));for(var u=0,l=s-1;u<s;l=u,u++){var c=a[u],h=a[l],f=c[1]*h[0]-h[1]*c[0];n+=(c[0]+h[0])*f,i+=(c[1]+h[1])*f,o+=3*f}var p=[n/o,i/o];return e&&(p[0]+=r[0],p[1]+=r[1]),p}},Zn.multiCentroid=function(t){for(var e=t.length,r=[0,0],n=0;n<t.length;n++){var i=Zn.centroid(t[n]);r[0]+=i[0],r[1]+=i[1]}return r[0]/=e,r[1]/=e,r},Zn.signedPolygonRingAreaSum=function(t){for(var e=0,r=t.length,n=0;n<r-1;n++){var i=t[n],o=t[n+1];e+=i[0]*o[1]-o[0]*i[1]}return e+(t[r-1][0]*t[0][1]-t[0][0]*t[r-1][1])},Zn.polygonRingArea=function(t){return Math.abs(Zn.signedPolygonRingAreaSum(t))/2},Zn.polygonArea=function(t){if(t)return Zn.polygonRingArea(t[0])},Zn.multiPolygonArea=function(t){for(var e=0,r=0;r<t.length;r++)e+=Zn.polygonArea(t[r]);return e},Zn.ringWinding=function(t){var e=Zn.signedPolygonRingAreaSum(t);return 0<e?"CW":e<0?"CCW":void 0},Zn.getTileBoundingBox=function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=Zn.wrapTile(t,{x:!0}),i=Zn.metersForTile(n),o=Zn.metersPerPixel(n.z),a=Zn.metersToLatLng([i.x-r*o,i.y+r*o]),s=Zn.metersToLatLng([i.x+(e+r)*o,i.y-(e+r)*o]),u=Zn.isLastTile(n);return new Xn.H.geo.Rect(0===t.y?90:$n.clamp(a[1],-90,90),$n.clamp(a[0],-180,180),u.row?-90:$n.clamp(s[1],-90,90),u.column?180:$n.clamp(s[0],-180,180))},Zn.isLastTile=function(t){var e=t.x,r=t.y,n=t.z;return{row:r===Math.pow(2,n)-1,column:e===Math.pow(2,n)-1}};var ni,ii,oi=function(){En(e,Mn(Error));var t=In(e);function e(r){var n;return gn(this,e),(n=t.call(this)).name="MethodNotImplemented",n.message="Method "+r+" must be implemented in subclass",n}return e}(),ai=!1,si=!1;try{window.document!==HTMLDocument&&(si=!0)}catch(o){void 0!==self&&(ai=!0,self.window={document:{}},self.document=self.window.document)}var ui={get is_fake_worker(){return self.is_fake_worker},get is_worker(){return void 0!==ii?ii:ai||self.is_fake_worker},set is_worker(t){ii=t},get is_main(){return void 0!==ni?ni:si&&!self.is_fake_worker},set is_main(t){ni=t},is_native_worker:ai},li={},ci=0,hi={},fi={},pi={};function di(t,e,r){var n=2<arguments.length&&void 0!==r?r:fi,i=[];if("string"==typeof t&&(t=(i=t.split(".")).pop()),ui.is_main&&e&&1===i.length&&"self"===i[0])n=e;else for(var o=0;o<i.length;o++){if(!n[i[o]])return[];n=n[i[o]]}return[t,n]}li.addTarget=function(t,e){ui.is_fake_worker?pi[t]=e:fi[t]=e},li.removeTarget=function(t){delete fi[t],delete pi[t]};var vi=" No object with that name is registered on main thread.",yi=" Object has no method with that name.",gi="_worker_broker_error_not_set_";function mi(t){Array.isArray(t)&&t.filter(function(t){return t.parent&&t.property}).forEach(function(t){return delete t.parent[t.property]})}li.withTransferables=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];if(!(this instanceof li.withTransferables))return Sn(li.withTransferables,e);this.value=e,this.transferables=function t(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[];if(!e)return i;if(Array.isArray(e))e.forEach(function(r,n){return t(r,e,n,i)});else if("object"===yn(e))if(e instanceof ArrayBuffer)i.push({object:e,parent:r,property:n});else if(e.buffer instanceof ArrayBuffer)i.push({object:e.buffer,parent:r,property:n});else for(var o in e)t(e[o],e,o,i);return i}(this.value)},ui.is_main&&(li.postMessage=function(t,e){for(var r=arguments.length,n=new Array(2<r?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];if(Array.isArray(t))return Promise.all(t.map(function(t){return li.postMessage.apply(li,[t,e].concat(Rn(n)))}));var o,a={};"object"===yn(e)&&(e=(a=e).method);var s="main_send";"string"==typeof t?(e=t,n=Array.prototype.slice.call(arguments,1),o=!0,s="worker_send"):t.init&&(o=!0);var u,l=[];if(n&&1===n.length&&n[0]instanceof li.withTransferables&&(l=n[0].transferables,n=n[0].value),u={type:s,message_id:++ci,method:e,message:n},o)return function(t,e){var r=t.type,n=Cn(di(t.method,e,"main_send"===r?pi:fi),2),i=n[0],o=n[1],a="Worker broker could not dispatch message type ".concat(t.method," on target ").concat(t.target,".");if(!o)throw Error(a+vi);var s="function"==typeof o[i]&&o[i];if(!s)throw Error(a+yi);return new Promise(function(e,r){var n;try{n=s.apply(o,t.message)}catch(n){return void r(n)}n instanceof Promise?n.then(function(t){t instanceof li.withTransferables&&(t=t.value[0]),e(t)},function(t){r(t instanceof Error?"".concat(t.message,": ").concat(t.stack):t)}):(n instanceof li.withTransferables&&(n=n.value[0]),e(n))})}(u,t&&t.init?t:void 0);var c=new Promise(function(t,r){hi[ci]={method:e,message:n,resolve:t,reject:r}});return a.stringify&&(u=JSON.stringify(u)),t.postMessage(u,l.map(function(t){return t.object})),mi(l),c},li.addWorker=function(t){if(!(t instanceof Worker))throw Error("Worker broker could not add non-Worker object",t);t.addEventListener("message",function(e){var r="string"==typeof e.data?JSON.parse(e.data):e.data,n=r.message_id;if("worker_reply"===r.type)hi[n]&&(r.error?hi[n].reject(r.error):hi[n].resolve(r.message),delete hi[n]);else if("worker_send"===r.type&&null!=n){var i=Cn(di(r.method),2),o=i[0],a=i[1],s="Worker broker could not dispatch message type ".concat(r.method," on target ").concat(r.target,".");if(!a)throw Error(s+vi);var u="function"==typeof a[o]&&a[o];if(!u)throw Error(s+yi);var l,c=gi;try{l=u.apply(a,r.message)}catch(e){c=e}var h,f=[];l&&"function"==typeof l.then?l.then(function(e){e instanceof li.withTransferables&&(f=e.transferables,e=e.value[0]),h={type:"main_reply",message_id:n,message:e},t.postMessage(h,f.map(function(t){return t.object})),mi(f)},function(e){t.postMessage({type:"main_reply",message_id:n,error:e instanceof Error?"".concat(e.message,": ").concat(e.stack):e})}):(l instanceof li.withTransferables&&(f=l.transferables,l=l.value[0]),h={type:"main_reply",message_id:n,message:l,error:c instanceof Error?"".concat(c.message,": ").concat(c.stack):c},t.postMessage(h,f.map(function(t){return t.object})),mi(f))}})},li.getMessages=function(){return hi},li.getMessageId=function(){return ci}),ui.is_worker&&(li.postMessage=function(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var i={};"object"===yn(t)&&(t=(i=t).method);var o,a=new Promise(function(e,n){hi[ci]={method:t,message:r,resolve:e,reject:n}}),s=[];return r&&1===r.length&&r[0]instanceof li.withTransferables&&(s=r[0].transferables,r=r[0].value),o={type:"worker_send",message_id:ci,method:t,message:r},i.stringify&&(o=JSON.stringify(o)),self.postMessage(o,s.map(function(t){return t.object})),mi(s),ci++,a},self.addEventListener("message",function(t){var e="string"==typeof t.data?JSON.parse(t.data):t.data,r=e.message_id;if("main_reply"===e.type)hi[r]&&(e.hasOwnProperty("error")&&e.error!==gi?hi[r].reject(e.error):hi[r].resolve(e.message),delete hi[r]);else if("main_send"===e.type&&null!=r){var n=Cn(di(e.method),2),i=n[0],o=n[1],a="Worker broker could not dispatch message type ".concat(e.method," on target ").concat(e.target,".");if(!o)throw Error(a+vi);var s,u,l="function"==typeof o[i]&&o[i];if(!l)throw Error(a+yi);try{s=l.apply(o,e.message)}catch(t){u=t}var c,h=[];s instanceof Promise?s.then(function(t){t instanceof li.withTransferables&&(h=t.transferables,t=t.value[0]),c={type:"worker_reply",message_id:r,message:t},self.postMessage(c,h.map(function(t){return t.object})),mi(h)},function(t){self.postMessage({type:"worker_reply",message_id:r,error:t instanceof Error?"".concat(t.message,": ").concat(t.stack):t})}):(s instanceof li.withTransferables&&(h=s.transferables,s=s.value[0]),c={type:"worker_reply",message_id:r,message:s,error:u instanceof Error?"".concat(u.message,": ").concat(u.stack):u},self.postMessage(c,h.map(function(t){return t.object})),mi(h))}}));var _i,bi={silent:-1,error:0,warn:1,info:2,debug:3,trace:4},xi={},wi={};function Ei(t){var e,r="object"===yn(t)?t.level:t;if(bi[r]<=bi[Ei.level]){for(var n=arguments.length,i=new Array(1<n?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];if(ui.is_native_worker)li.postMessage.apply(li,[{method:"_logProxy",stringify:!0},t].concat(i));else{if("object"===yn(t)&&!0===t.once){if(wi[JSON.stringify(i)])return;wi[JSON.stringify(i)]=!0}var a=(xi[e=r]=xi[e]||(console[e]?console[e]:console.log).bind(console),xi[e]);1<i.length?a.apply(void 0,["Tangram [".concat(r,"]: ").concat(i[0])].concat(Rn(i.slice(1)))):a("Tangram [".concat(r,"]: ").concat(i[0]))}}}function Ti(t,e,r){var n,i;return r=r||0,function(){var o=this,a=arguments;function s(){i=0,t.apply(o,a)}clearTimeout(n),i&&r&&Date.now()-i>=r?s():(i=i||Date.now(),n=setTimeout(function(){s()},e))}}Ei.level="info",Ei.workers=null,Ei.setLevel=function(t){Ei.level=t,ui.is_main&&Array.isArray(Ei.workers)&&li.postMessage(Ei.workers,"_logSetLevelProxy",t)},ui.is_main&&(Ei.setWorkers=function(t){Ei.workers=t},Ei.reset=function(){wi={}}),li.addTarget("_logProxy",Ei),li.addTarget("_logSetLevelProxy",Ei.setLevel);var Ai=_i={};li.addTarget("Utils",_i),_i.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},_i.isMicrosoft=function(){return/(Trident\/7.0|Edge[ /](\d+[\.\d]+))/i.test(navigator.userAgent)},_i._requests={},_i._proxy_requests={},_i.io=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:6e4,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"text",n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"GET",i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},o=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,a=6<arguments.length&&void 0!==arguments[6]&&arguments[6];if(ui.is_worker&&_i.isMicrosoft())return Ei("debug","Proxying request for URL to worker",t),o&&(_i._proxy_requests[o]=!0),li.postMessage("Utils.io",t,e,r,n,i,o,!0);var s=new XMLHttpRequest,u=(u=new Promise(function(i,o){s.open(n,t,!0),s.timeout=e,s.responseType=r,s.onload=function(){200===s.status?-1<["text","json"].indexOf(s.responseType)?i(s.responseText):i(s.response):o(Error("Request error with a status of "+s.statusText))},s.onerror=function(t){o(Error("There was a network error"+t.toString()))},s.ontimeout=function(t){o(Error("timeout "+t.toString()))},s.send()})).then(function(t){return o&&delete _i._requests[o],a?li.withTransferables(t):t});return o&&(_i._requests[o]=s),u},_i.cancelRequest=function(t){if(ui.is_worker&&_i._proxy_requests[t])return li.postMessage("Utils.cancelRequest",t);_i._requests[t]?(Ei("trace","Cancelling network request key '".concat(t,"'")),_i._requests[t].abort(),delete _i._requests[t]):Ei("trace","Could not find network request key '".concat(t,"'"))},_i.requestAnimationFramePolyfill=function(){"function"!=typeof window.requestAnimationFrame&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)})},_i.serializeWithFunctions=function(t){return"function"==typeof t?t.toString():JSON.stringify(t,function(t,e){return"function"==typeof e?e.toString():e})},_i.stringsToFunctions=function(t,e){if("string"==typeof t)t=_i.stringToFunction(t,e);else if(null!=t&&"object"===yn(t))for(var r in t)t[r]=_i.stringsToFunctions(t[r],e);return t},_i._use_count=0,_i._function_cache={};var ki,Si,Mi=Ti(function(){Ei("trace","Cleared cached ".concat(Object.keys(_i._function_cache).length," functions (reused ").concat(_i._use_count," times)")),_i._use_count=0,_i._function_cache={}},1e4),Oi=/^\s*function[^(]*\(([^)]*)\)\s*?\{([\s\S]*)\}$/m;function Ii(t){if("string"!=typeof t||-1!==t.search(/^(data|blob):/))return"";var e=t.indexOf("?");-1<e&&(t=t.substr(0,e));var r=t.indexOf("#");return-1<r&&(t=t.substr(0,r)),t.substr(0,t.lastIndexOf("/")+1)||""}function Li(t){return"string"==typeof t&&!(-1<t.search(/^(http|https|data|blob):/)||"//"===t.substr(0,2))}function Ci(t){return void 0===ki&&"function"!=typeof(ki=window.URL&&window.URL.createObjectURL||window.webkitURL&&window.webkitURL.createObjectURL)&&(ki=null,Ei("warn","window.URL.createObjectURL (or vendor prefix) not found, unable to create local blob URLs")),ki?ki(t):t}_i.stringToFunction=function(t,e){var r=t;e&&(r+=e.toString());var n=_i._function_cache[r];if(Mi(),n)return _i._use_count++,n;var i="string"==typeof t&&t.match(Oi);if(i&&2<i.length)try{var o=i[2],a=0<(a=0<i[1].length&&i[1].split(",").map(function(t){return t.trim()}).filter(function(t){return t})).length?a:["context"],s=new Function(a.toString(),"function"==typeof e?e(o):o);return _i._function_cache[r]=s}catch(e){return t}return t},_i.device_pixel_ratio=1,_i.isPowerOf2=function(t){return 0==(t&t-1)},_i.interpolate=function(t,e,r){if(!Array.isArray(e)||!Array.isArray(e[0]))return e;if(e.length<1)return e;var n,i,o,a,s;if(t<=e[0][0])a=e[0][1],"function"==typeof r&&(a=r(a));else if(t>=e[e.length-1][0])a=e[e.length-1][1],"function"==typeof r&&(a=r(a));else for(var u=0;u<e.length-1;u++)if(t>=e[u][0]&&t<e[u+1][0]){if(n=e[u][0],i=e[u+1][0],Array.isArray(e[u][1])){a=[];for(var l=0;l<e[u][1].length;l++)"function"==typeof r?(s=r(e[u][1][l]),o=r(e[u+1][1][l])-s,a[l]=o*(t-n)/(i-n)+s):(o=e[u+1][1][l]-e[u][1][l],a[l]=o*(t-n)/(i-n)+e[u][1][l])}else a="function"==typeof r?(s=r(e[u][1]),(o=r(e[u+1][1])-s)*(t-n)/(i-n)+s):(o=e[u+1][1]-e[u][1])*(t-n)/(i-n)+e[u][1];break}return a},_i.toCSSColor=function(t){return 1===t[3]?"rgb(".concat(t.slice(0,3).map(function(t){return Math.round(255*t)}).join(", "),")"):"rgba(".concat(t.map(function(t,e){return e<3&&Math.round(255*t)||t}).join(", "),")")},_i.pointInTile=function(t){return 0<=t[0]&&t[1]>-Qn.tile_scale&&t[0]<Qn.tile_scale&&t[1]<=0},_i.zoomToTileLevel=function(t){return Math.floor(t)};var Ri=function(){function t(e,r){var n=this;if(gn(this,t),this.config=e,this.sources=r,this.id=e.id,this.name=e.name,this.pad_scale=e.pad_scale||1e-4,this.default_winding=null,this.rasters=[],Array.isArray(e.rasters)&&e.rasters.forEach(function(t){-1===n.rasters.indexOf(t)&&n.rasters.push(t)}),this.preprocess=e.preprocess,"function"==typeof this.preprocess&&this.preprocess.bind(this),this.transform=e.transform,"function"==typeof this.transform)this.transform=this.transform.bind(this);else if("object"===yn(this.transform))for(var i in this.transform)"function"==typeof this.transform[i]&&(this.transform[i]=this.transform[i].bind(this));this.extra_data=e.extra_data,this.scripts=e.scripts,this.max_zoom=null!=e.max_zoom?e.max_zoom:Qn.default_source_max_zoom,this.setTileSize(e.tile_size),this.max_coord_zoom=this.max_zoom+this.zoom_bias,this.min_display_zoom=null!=e.min_display_zoom?e.min_display_zoom:0,this.max_display_zoom=null!=e.max_display_zoom?e.max_display_zoom:null,this._has_volatile_data=!!e.has_volatile_data}return _n(t,[{key:"hasLabeledData",value:function(){return!0}},{key:"_transformTile",value:function(t){if(t.source_data.layers){var e={coords:t.coords},r=[];if("function"==typeof this.transform)r.push(this.transform);else if("object"===yn(this.transform))for(var n=Object.keys(this.transform).sort(),i=0;i<n.length;i++)r.push(this.transform[n[i]]);for(var o=1===Object.keys(t.source_data.layers).length&&t.source_data.layers._default,a=0;a<r.length;a++)o?t.source_data.layers._default=r[a](t.source_data.layers._default,this.extra_data,e):t.source_data.layers=r[a](t.source_data.layers,this.extra_data,e)}}},{key:"_postProcessTile",value:function(t){var e=this;for(var r in this._transformTile(t),t.source_data.layers){var n=t.source_data.layers[r];n&&n.features&&n.features.forEach(function(t){Qn.transformGeometry(t.geometry,function(t){t[1]=-t[1],e.pad_scale&&(t[0]=Math.round(t[0]*(1+e.pad_scale)-Qn.tile_scale*e.pad_scale/2),t[1]=Math.round(t[1]*(1+e.pad_scale)-Qn.tile_scale*e.pad_scale/2))}),e.updateDefaultWinding(t.geometry)})}t.default_winding=this.default_winding||"CCW"}},{key:"load",value:function(t){return t.source_data={},t.source_data.layers={},t.pad_scale=this.pad_scale,t.rasters=Rn(this.rasters),this._load(t)}},{key:"_load",value:function(){throw new oi("_load")}},{key:"setTileSize",value:function(t){this.tile_size=t||256,("number"!=typeof this.tile_size||this.tile_size<256||!Ai.isPowerOf2(this.tile_size))&&(Ei({level:"warn",once:!0},"Data source '".concat(this.name,"': 'tile_size' parameter must be a number that is a power of 2 greater than or equal to 256, but was '").concat(t,"'")),this.tile_size=256),this.zoom_bias=Math.log2(this.tile_size)-8}},{key:"updateDefaultWinding",value:function(t){return null==this.default_winding&&("Polygon"===t.type?this.default_winding=Qn.ringWinding(t.coordinates[0]):"MultiPolygon"===t.type&&(this.default_winding=Qn.ringWinding(t.coordinates[0][0]))),this.default_winding}},{key:"includesTile",value:function(t,e){if(t.z<this.min_display_zoom||null!=this.max_display_zoom&&e>this.max_display_zoom)return!1;for(var r=0;r<this.rasters.length;r++){var n=this.rasters[r];if(this.sources[n]&&this.sources[n]!==this&&!this.sources[n].includesTile(t,t.z))return!1}return!0}},{key:"has_volatile_data",get:function(){return this._has_volatile_data},set:function(t){var e=0<arguments.length&&void 0!==t&&t;this._has_volatile_data=e}}],[{key:"create",value:function(e,r){for(var n in r)if(r[n].config.name===e.name&&t.sameConfig(r[n],{config:e}))return r[n];if(t.types[e.type])return new t.types[e.type](e,r)}},{key:"sameConfig",value:function(t,e){if(!t||!e)return!1;var r=Object.assign({},t.config,{id:null,tiled:null,url:null}),n=Object.assign({},e.config,{id:null,tiled:null,url:null});return JSON.stringify(r)===JSON.stringify(n)}},{key:"coordsToMeters",value:function(t){var e=Cn(Qn.latLngToMeters(t),2),r=e[0],n=e[1];t[0]=r,t[1]=n}},{key:"projectData",value:function(e){for(var r in e.layers)for(var n=e.layers[r].features.length,i=0;i<n;i++){var o=e.layers[r].features[i];Qn.transformGeometry(o.geometry,t.coordsToMeters)}}},{key:"metersToTileUnits",value:function(t,e,r){r[0]=Math.round((r[0]-e.x)*t),r[1]=-1*Math.round((r[1]-e.y)*t)}},{key:"scaleData",value:function(e,r){var n=r.coords.z,i=r.min,o=(r.max,t.metersToTileUnits.bind(this,Qn.unitsPerMeter(n),i));for(var a in e.layers)for(var s=e.layers[a].features.length,u=0;u<s;u++){var l=e.layers[a].features[u];Qn.transformGeometry(l.geometry,o)}}},{key:"register",value:function(e,r){e&&r&&(t.types[r]=e)}}]),t}();Ri.types={};var Pi=0,Ni=function(){En(e,Ri);var t=In(e);function e(r,n){var i;gn(this,e),(i=t.call(this,r,n)).response_type="";var o=Cn(function(t,e){if(!e||0===Object.keys(e).length)return[t,[]];var r=t.indexOf("?"),n=t.indexOf("#"),i="";-1<n&&(i=t.slice(n),t=t.slice(0,n)),-1===r&&(r=t.length,t+="?"),r++;var o="",a=[];for(var s in e)""===function(t,e){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))}(s,t)?o+="".concat(s,"=").concat(e[s],"&"):a.push([s,e[s]]);return[t=t.slice(0,r)+o+t.slice(r)+i,a]}(r.url,r.url_params),2),a=o[0],s=o[1];if(i.url=a,s.forEach(function(t){var e=Cn(t,2),n=e[0],o=e[1];Ei({level:"warn",once:!0},"Data source '".concat(i.name,"': parameter '").concat(n,"' already present in URL '").concat(r.url,"', ")+"skipping value '".concat(n,"=").concat(o,"' specified in 'url_params'"))}),"string"!=typeof i.url)throw Error("Network data source must provide a string `url` property");return i}return _n(e,[{key:"_load",value:function(t){var e=this,r=this.formatUrl(this.url,t),n=t.source_data;return n.url=r,new Promise(function(i,o){n.error=null;var a=Pi+++"-"+r,s=Ai.io(r,6e4,e.response_type,"GET",{},a);n.request_id=a,s.then(function(r){"function"==typeof e.preprocess&&(r=e.preprocess(r)),(r=r instanceof Promise?r:Promise.resolve(r)).then(function(r){e.parseSourceData(t,n,r),e._postProcessTile(t),i(t)})},function(r){n.error=r.stack,e._postProcessTile(t),i(t)})})}},{key:"formatUrl",value:function(){throw new oi("formatUrl")}},{key:"parseSourceData",value:function(){throw new oi("parseSourceData")}}]),e}(),ji=function(){En(e,Ni);var t=In(e);function e(r,n){var i;return gn(this,e),(i=t.call(this,r,n)).tiled=!0,i.parseBounds(r),i.builds_geometry_tiles=!1,i.tms=!0===r.tms,-1<i.url.search("{s}")&&(Array.isArray(r.url_subdomains)&&0<r.url_subdomains.length?(i.url_subdomains=r.url_subdomains,i.next_url_subdomain=0):Ei({level:"warn",once:!0},"Data source '".concat(i.name,"': source URL includes '{s}' subdomain marker ('").concat(i.url,"'), but no subdomains ")+"were specified in 'url_subdomains' parameter")),i}return _n(e,[{key:"parseBounds",value:function(t){var e,r,n,i,o;Array.isArray(t.bounds)&&4===t.bounds.length&&(this.bounds=t.bounds,r=(e=Cn(this.bounds,4))[0],n=e[1],i=e[2],o=e[3],this.bounds_meters={min:Qn.latLngToMeters([r,o]),max:Qn.latLngToMeters([i,n])},this.bounds_tiles={min:{},max:{}})}},{key:"checkBounds",value:function(t){if(this.bounds){t=Qn.wrapTile(t,{x:!0});var e=(e=this.bounds_tiles.min[t.z])||(this.bounds_tiles.min[t.z]=Qn.tileForMeters(this.bounds_meters.min,t.z)),r=(r=this.bounds_tiles.max[t.z])||(this.bounds_tiles.max[t.z]=Qn.tileForMeters(this.bounds_meters.max,t.z));if(t.x<e.x||t.x>r.x||t.y<e.y||t.y>r.y)return!1}return!0}},{key:"includesTile",value:function(t,r){return!!Ln(Tn(e.prototype),"includesTile",this).call(this,t,r)&&!!this.checkBounds(t)}},{key:"formatUrl",value:function(t,e){var r=Qn.wrapTile(e.coords,{x:!0});this.tms&&(r.y=Math.pow(2,r.z)-1-r.y);var n=t.replace("{x}",r.x).replace("{y}",r.y).replace("{z}",r.z);return null!=this.url_subdomains&&(n=n.replace("{s}",this.url_subdomains[this.next_url_subdomain]),this.next_url_subdomain=(this.next_url_subdomain+1)%this.url_subdomains.length),n}},{key:"urlHasTilePattern",value:function(t){return t&&-1<t.search("{x}")&&-1<t.search("{y}")&&-1<t.search("{z}")}}]),e}(),Di=function(){En(e,Ri);var t=In(e);function e(r,n){var i;return gn(this,e),(i=t.call(this,r,n)).target_name="MapsJsSource"+r.uid,i.tiled=!!r.tiled,li.addTarget(i.target_name,On(i)),ui.is_worker&&li.postMessage(i.target_name+".onWorkerInitialized"),ui.is_main&&(i._workers_left=0),i}return _n(e,[{key:"initialize",value:function(t,e,r,n){this._main_initialized||(this.provider=t,this.worker=n,this._workers_left+=r,this._on_update=e,this._main_initialized=!0,this._onProviderUpdate=this._onProviderUpdate.bind(this),t.addEventListener("update",this._onProviderUpdate),this._isReady()&&this.onReady())}},{key:"onWorkerInitialized",value:function(){--this._workers_left,this._isReady()&&this.onReady()}},{key:"onReady",value:function(){}},{key:"_isReady",value:function(){return this._main_initialized&&!this._workers_left}},{key:"_onProviderUpdate",value:function(t){this._isReady()&&this.onProviderUpdate(t)}},{key:"onProviderUpdate",value:function(t){this.dispatchUpdate(void 0,t.data)}},{key:"dispatchUpdate",value:function(t,e){this._on_update(this.name,t,e)}},{key:"dispose",value:function(){li.removeTarget(this.target_name),this.provider.removeEventListener("update",this._onProviderUpdate)}}]),e}(),zi=function(t,e,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,l=u>>1,c=-7,h=r?i-1:0,f=r?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-c)-1,p>>=-c,c+=s;0<c;o=256*o+t[e+h],h+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;0<c;a=256*a+t[e+h],h+=f,c-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=l}return(p?-1:1)*a*Math.pow(2,o-n)},Hi=function(t,e,r,n,i,o){var a,s,u,l=8*o-i-1,c=(1<<l)-1,h=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),2<=(e+=1<=a+h?f/u:f*Math.pow(2,1-h))*u&&(a++,u/=2),c<=a+h?(s=0,a=c):1<=a+h?(s=(e*u-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));8<=i;t[r+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,l+=i;0<l;t[r+p]=255&a,p+=d,a/=256,l-=8);t[r+p-d]|=128*v},Fi=Bi;function Bi(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Bi.Varint=0,Bi.Fixed64=1,Bi.Bytes=2,Bi.Fixed32=5;var Ui=4294967296,Gi=1/Ui;function qi(t){return t.type===Bi.Bytes?t.readVarint()+t.pos:t.pos+1}function Vi(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Wi(t,e,r){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.ceil(Math.log(e)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;t<=i;i--)r.buf[i+n]=r.buf[i]}function Yi(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function Ki(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function Xi(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function Zi(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function $i(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function Ji(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function Qi(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function to(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function eo(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function ro(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function no(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function io(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}Bi.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=7&n,t(i,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=ro(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=io(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=ro(this.buf,this.pos)+ro(this.buf,this.pos+4)*Ui;return this.pos+=8,t},readSFixed64:function(){var t=ro(this.buf,this.pos)+io(this.buf,this.pos+4)*Ui;return this.pos+=8,t},readFloat:function(){var t=zi(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=zi(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e=this.buf,r=e[this.pos++],n=127&r;return r<128?n:(n|=(127&(r=e[this.pos++]))<<7,r<128?n:(n|=(127&(r=e[this.pos++]))<<14,r<128?n:(n|=(127&(r=e[this.pos++]))<<21,r<128?n:function(t,e,r){var n,i,o=r.buf;if(n=(112&(i=o[r.pos++]))>>4,i<128)return Vi(t,n,e);if(n|=(127&(i=o[r.pos++]))<<3,i<128)return Vi(t,n,e);if(n|=(127&(i=o[r.pos++]))<<10,i<128)return Vi(t,n,e);if(n|=(127&(i=o[r.pos++]))<<17,i<128)return Vi(t,n,e);if(n|=(127&(i=o[r.pos++]))<<24,i<128)return Vi(t,n,e);if(n|=(1&(i=o[r.pos++]))<<31,i<128)return Vi(t,n,e);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(r=e[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=function(t,e,r){for(var n,i,o,a="",s=e;s<r;){var u=t[s],l=null,c=239<u?4:223<u?3:191<u?2:1;if(r<s+c)break;1===c?u<128&&(l=u):2===c?128==(192&(n=t[s+1]))&&(l=(31&u)<<6|63&n)<=127&&(l=null):3===c?(n=t[s+1],i=t[s+2],128==(192&n)&&128==(192&i)&&((l=(15&u)<<12|(63&n)<<6|63&i)<=2047||55296<=l&&l<=57343)&&(l=null)):4===c&&(n=t[s+1],i=t[s+2],o=t[s+3],128==(192&n)&&128==(192&i)&&128==(192&o)&&((l=(15&u)<<18|(63&n)<<12|(63&i)<<6|63&o)<=65535||1114112<=l)&&(l=null)),null===l?(l=65533,c=1):65535<l&&(l-=65536,a+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),a+=String.fromCharCode(l),s+=c}return a}(this.buf,this.pos,t);return this.pos=t,e},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){var r=qi(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){var e=qi(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){var e=qi(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){var e=qi(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){var e=qi(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){var e=qi(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){var e=qi(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){var e=qi(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){var e=qi(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Bi.Varint)for(;127<this.buf[this.pos++];);else if(e===Bi.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Bi.Fixed32)this.pos+=4;else{if(e!==Bi.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e,r=this.length||16;r<this.pos+t;)r*=2;r!==this.length&&((e=new Uint8Array(r)).set(this.buf),this.buf=e,this.length=r)},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),no(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),no(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),no(this.buf,-1&t,this.pos),no(this.buf,Math.floor(t*Gi),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),no(this.buf,-1&t,this.pos),no(this.buf,Math.floor(t*Gi),this.pos+4),this.pos+=8},writeVarint:function(t){268435455<(t=+t||0)||t<0?function(t,e){var r,n;if(0<=t?(r=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(r=~(-t%4294967296))?r=r+1|0:n=n+1|(r=0)),0x10000000000000000<=t||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e){e.buf[e.pos++]=127&t|128,t>>>=7,e.buf[e.pos++]=127&t|128,t>>>=7,e.buf[e.pos++]=127&t|128,t>>>=7,e.buf[e.pos++]=127&t|128,t>>>=7,e.buf[e.pos]=127&t}(r,e),function(t,e){var r=(7&t)<<4;e.buf[e.pos++]|=r|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(127<t?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(127<t?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(127<t?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,r){for(var n,i,o=0;o<e.length;o++){if(55295<(n=e.charCodeAt(o))&&n<57344){if(!i){56319<n||o+1===e.length?(t[r++]=239,t[r++]=191,t[r++]=189):i=n;continue}if(n<56320){t[r++]=239,t[r++]=191,t[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(t[r++]=239,t[r++]=191,t[r++]=189,i=null);n<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:(n<65536?t[r++]=n>>12|224:(t[r++]=n>>18|240,t[r++]=n>>12&63|128),t[r++]=n>>6&63|128),t[r++]=63&n|128)}return r}(this.buf,t,this.pos);var r=this.pos-e;128<=r&&Wi(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),Hi(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Hi(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var n=this.pos-r;128<=n&&Wi(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,r){this.writeTag(t,Bi.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){this.writeMessage(t,Yi,e)},writePackedSVarint:function(t,e){this.writeMessage(t,Ki,e)},writePackedBoolean:function(t,e){this.writeMessage(t,$i,e)},writePackedFloat:function(t,e){this.writeMessage(t,Xi,e)},writePackedDouble:function(t,e){this.writeMessage(t,Zi,e)},writePackedFixed32:function(t,e){this.writeMessage(t,Ji,e)},writePackedSFixed32:function(t,e){this.writeMessage(t,Qi,e)},writePackedFixed64:function(t,e){this.writeMessage(t,to,e)},writePackedSFixed64:function(t,e){this.writeMessage(t,eo,e)},writeBytesField:function(t,e){this.writeTag(t,Bi.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Bi.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Bi.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Bi.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Bi.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Bi.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Bi.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Bi.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Bi.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Bi.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}},Yn.prototype.loadGeometry=function(t){var e=this._pbf;e.pos=this._geometry;for(var r,n,i=e.readVarint()+e.pos,o=1,a=0,s=0,u=0,l=[];e.pos<i;)if(a<=0&&(o=7&(n=e.readVarint()),a=n>>3),a--,1===o||2===o)s+=e.readSVarint(),u+=e.readSVarint(),1===o&&(r&&l.push(r),r=[]),r.push([s*t,u*t]);else{if(7!==o)throw new Error("unknown command "+o);r&&r.push(r[0].slice())}return r&&l.push(r),l};var oo={UNKNOWN:0,POINT:1,LINESTRING:2,POLYGON:3};function ao(t){var e=[],r=t&&t.features;if(r)for(var n=0,i=r.length;n<i;n++){var o=r[n],a=o.type,s=void 0;switch(a){case oo.POINT:s={type:"MultiPoint",coordinates:o.geometry.map(function(t){return t.slice()})};break;case oo.LINESTRING:case oo.POLYGON:if(s={type:"MultiLineString",coordinates:o.geometry.map(function(t){return t.map(function(t){return t.slice()})})},a===oo.POLYGON&&null==(s=so(s)))continue;break;default:continue}e.push({id:o.id,type:"Feature",geometry:s,properties:o.tags})}return{type:"FeatureCollection",features:e}}function so(t){for(var e,r=[],n=[],i=0,o=t.coordinates.length;i<o;i++){var a=t.coordinates[i],s=Qn.ringWinding(a);null!=s&&(s===(e=e||s)&&n.length&&(r.push(n),n=[]),n.push(a))}return 0<n.length&&r.push(n),1===r.length?(t.type="Polygon",t.coordinates=r[0]):1<r.length?(t.type="MultiPolygon",t.coordinates=r):t=null,t}var uo={type:"FeatureCollection",features:[]},lo=function(){En(e,Di);var t=In(e);function e(r,n){return gn(this,e),r.tiled=!0,t.call(this,r,n)}return _n(e,[{key:"fetchTile",value:function(t,e,r){return this.provider?this.provider.requestTileAsPromise(t,e,r).then(function(t){return t.data}):Promise.resolve()}},{key:"_load",value:function(t){var e=this,r=Qn.wrapTile(t.coords,{x:!0,y:!0}),n=r.x,i=r.y,o=r.z;return li.postMessage(this.target_name+".fetchTile",n,i,o).then(function(r){var n;return r instanceof ArrayBuffer?(n=new Fi(new Uint8Array(r)),t.source_data.layers=function(t){var e={};for(var r in t.layers){for(var n=t.layers[r],i=[],o=Qn.tile_scale/n.extent,a=0,s=n.length;a<s;a++){var u=n.feature(a),l=Yn.types[u.type],c=u.loadGeometry(o),h=null;switch(l){case"Point":h=function(t){var e=t.coordinates.length;if(1<e){t.type="MultiPoint";for(var r=[],n=0;n<e;n++)r.push(t.coordinates[n][0]);t.coordinates=r}else t.type="Point",t.coordinates=t.coordinates[0][0];return t}({coordinates:c});break;case"LineString":h=1===c.length?{type:l,coordinates:c[0]}:{type:"MultiLineString",coordinates:c};break;case"Polygon":h=so({coordinates:c})}h&&h.coordinates&&i.push({type:"Feature",geometry:h,properties:u.properties})}e[r]={type:"FeatureCollection",features:i}}return e}(new function(t,e){this.layers=t.readFields(Vn,{},e)}(n))):r?t.source_data.error=r:t.source_data.layers={_default:uo},e._postProcessTile(t),t})}},{key:"onReady",value:function(){this.dispatchUpdate()}}]),e}();function co(t){return Math.max(t,0)}function ho(t){return isNaN(t)?0:t}function fo(t){return Array.isArray(t)?t.map(parseFloat).map(ho):ho(parseFloat(t))}function po(t){return Array.isArray(t)?t.map(fo).map(co):co(fo(t))}Ri.register(lo,"MVT"),Ri.register(lo,"OMV");var vo=a(function(t,e){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(t){return(t=Math.round(t))<0?0:255<t?255:t}function i(t){return t<0?0:1<t?1:t}function o(t){return"%"===t[t.length-1]?n(parseFloat(t)/100*255):n(parseInt(t))}function a(t){return"%"===t[t.length-1]?i(parseFloat(t)/100):i(parseFloat(t))}function s(t,e,r){return r<0?r+=1:1<r&&--r,6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}try{e.parseCSSColor=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in r)return r[i].slice();if("#"===i[0])return 4===i.length?0<=(e=parseInt(i.substr(1),16))&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===i.length&&0<=(e=parseInt(i.substr(1),16))&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var u=i.indexOf("("),l=i.indexOf(")");if(-1!==u&&l+1===i.length){var c=i.substr(0,u),h=i.substr(u+1,l-(u+1)).split(","),f=1;switch(c){case"rgba":if(4!==h.length)return null;f=a(h.pop());case"rgb":return 3!==h.length?null:[o(h[0]),o(h[1]),o(h[2]),f];case"hsla":if(4!==h.length)return null;f=a(h.pop());case"hsl":if(3!==h.length)return null;var p=(parseFloat(h[0])%360+360)%360/360,d=a(h[1]),v=a(h[2]),y=v<=.5?v*(d+1):v+d-v*d,g=2*v-y;return[n(255*s(g,y,p+1/3)),n(255*s(g,y,p)),n(255*s(g,y,p-1/3)),f];default:return null}}return null}}catch(t){}}),yo=(vo.parseCSSColor,{});Object.assign(yo,{clampPositive:co,noNaN:ho,parseNumber:fo,parsePositiveNumber:po}),yo.wrapFunction=function(t){return"\n        var feature = context.feature.properties;\n        var global = context.global;\n        var $zoom = context.zoom;\n        var $layer = context.layer;\n        var $source = context.source;\n        var sources = context.sources;\n        var $geometry = context.geometry;\n        var $meters_per_pixel = context.meters_per_pixel;\n\n        var val = (function(){ ".concat(t," }());\n\n        if (typeof val === 'number' && isNaN(val)) {\n            val = null; // convert NaNs to nulls\n        }\n\n        return val;\n    ")},yo.zeroPair=Object.freeze([0,0]),yo.defaults={color:[1,1,1,1],width:1,size:1,extrude:!1,height:20,min_height:0,order:0,z:0,outline:{color:[0,0,0,0],width:0},material:{ambient:1,diffuse:1}},yo.macros={"Style.color.pseudoRandomColor":function(){return[parseInt(feature.id,16)/100%1*.7,parseInt(feature.id,16)/1e4%1*.7,parseInt(feature.id,16)/1e6%1*.7,1]},"Style.color.randomColor":function(){return[.7*Math.random(),.7*Math.random(),.7*Math.random(),1]}},yo.getFeatureParseContext=function(t,e,r,n){return{feature:t,tile:e,global:r,sources:n,zoom:e.style_zoom,geometry:Qn.geometryType(t.geometry.type),meters_per_pixel:e.meters_per_pixel,meters_per_pixel_sq:e.meters_per_pixel_sq,units_per_meter_overzoom:e.units_per_meter_overzoom}};var go={STATIC:0,DYNAMIC:1,ZOOM:2};function mo(t){return"string"==typeof t&&"%"===t[t.length-1]}function _o(t){return"auto"===t}function bo(t){return mo(t)||_o(t)}yo.CACHE_TYPE=go,yo.createPropertyCache=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(null!=t){if(t.value)return{value:t.value,zoom:t.zoom?{}:null,type:t.type};var r={value:t,type:go.STATIC};return Array.isArray(r.value)&&Array.isArray(r.value[0])?(r.zoom={},r.type=go.ZOOM):"function"==typeof r.value&&(r.type=go.DYNAMIC),"function"==typeof e&&(r.zoom?r.value=r.value.map(function(t,r){return[t[0],e(t[1],r)]}):"function"!=typeof r.value&&(r.value=e(r.value,0))),r}},yo.createColorPropertyCache=function(t){return yo.createPropertyCache(t,function(t){return"Style.color.pseudoRandomColor"===t?Ai.stringToFunction(yo.wrapFunction(yo.macros["Style.color.pseudoRandomColor"])):"Style.color.randomColor"===t?yo.macros["Style.color.randomColor"]:t})};var xo="'size' can specify either width or height as derived from aspect ratio, but not both";yo.createPointSizePropertyCache=function(t){var e=null,r=null;if(mo(t))e=[!0];else if(Array.isArray(t))if(Array.isArray(t[0])){if(t.some(function(t){return Array.isArray(t[1])?t[1].some(bo):mo(t[1])})&&(e=t.map(function(t){return Array.isArray(t[1])?t[1].map(mo):mo(t[1])}),(r=t.map(function(t){return Array.isArray(t[1])&&t[1].map(_o)})).some(function(t){return Array.isArray(t)&&t.every(function(t){return t})})))throw xo}else if(t.some(bo)&&(e=[t.map(mo)],(r=[t.map(_o)])[0].every(function(t){return t})))throw xo;return e?((t={value:t}).has_pct=e,t.has_ratio=r,t.sprites={}):t=yo.createPropertyCache(t,po),t},yo.evalCachedPointSizeProperty=function(t,e,r){return t.has_pct||t.has_ratio?e?(t.sprites[e.sprite]||(t.sprites[e.sprite]=yo.createPropertyCache(t.value,function(r,n){return Array.isArray(r)?(r=r.map(function(e,r){return t.has_ratio[n][r]?e:po(e)}).map(function(r,i){return t.has_pct[n][i]?e.css_size[i]*r/100:r}),t.has_ratio[n][0]?r[0]=r[1]*e.aspect:t.has_ratio[n][1]&&(r[1]=r[0]/e.aspect)):(r=po(r),r=t.has_pct[n]?e.css_size.map(function(t){return t*r/100}):[r,r]),r})),yo.evalCachedProperty(t.sprites[e.sprite],r)):void 0:yo.evalCachedProperty(t,r)},yo.evalCachedProperty=function(t,e){if(null!=t)return t.dynamic?t.dynamic(e):t.static?t.static:t.zoom&&t.zoom[e.zoom]?t.zoom[e.zoom]:"function"!=typeof t.value?Array.isArray(t.value)&&Array.isArray(t.value[0])?(t.zoom=t.zoom||{},t.zoom[e.zoom]=Ai.interpolate(e.zoom,t.value),t.zoom[e.zoom]):(t.static=t.value,t.static):(t.dynamic=t.value,t.dynamic(e))},yo.convertUnits=function(t,e){if(null!=t.val)return"px"===t.units?t.val*Qn.metersPerPixel(e.zoom):t.val;if("string"==typeof t)"px"===t.trim().slice(-2)?(t=fo(t),t*=Qn.metersPerPixel(e.zoom)):t=fo(t);else if(Array.isArray(t))return Array.isArray(t[0])?t.map(function(t){return[t[0],yo.convertUnits(t[1],e)]}):t.map(function(t){return yo.convertUnits(t,e)});return t},yo.parseUnits=function(t){var e={val:fo(t)};return 0!==e.val&&"string"==typeof t&&"px"===t.trim().slice(-2)&&(e.units="px"),e},yo.evalCachedDistanceProperty=function(t,e){return t.dynamic?t.dynamic(e):t.zoom&&t.zoom[e.zoom]?t.zoom[e.zoom]:"function"!=typeof t.value?t.zoom?(t.zoom[e.zoom]=Ai.interpolate(e.zoom,t.value,function(t){return yo.convertUnits(t,e)}),t.zoom[e.zoom]):yo.convertUnits(t.value,e):(t.dynamic=t.value,t.dynamic(e))},yo.string_colors={},yo.colorForString=function(t){if(yo.string_colors[t])return yo.string_colors[t];var e=null;return"none"!==t&&((e=vo.parseCSSColor(t))&&4===e.length?(e[0]/=255,e[1]/=255,e[2]/=255):e=yo.defaults.color),yo.string_colors[t]=e},yo.evalCachedColorProperty=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(t.dynamic){var r=t.dynamic(e);return"string"==typeof r&&(r=yo.colorForString(r)),r&&null==r[3]&&(r[3]=1),r}if(t.static)return t.static;if(t.zoom&&t.zoom[e.zoom])return t.zoom[e.zoom];if("function"==typeof t.value){t.dynamic=t.value;var n=t.dynamic(e);return"string"==typeof n&&(n=yo.colorForString(n)),n&&null==n[3]&&(n[3]=1),n}if("string"==typeof t.value)return t.static=yo.colorForString(t.value),t.static;if(t.zoom){if(!t.zoom_preprocessed){for(var i=0;i<t.value.length;i++){var o=t.value[i];o&&"string"==typeof o[1]&&(o[1]=yo.colorForString(o[1]))}t.zoom_preprocessed=!0}return t.zoom[e.zoom]=Ai.interpolate(e.zoom,t.value),t.zoom[e.zoom][3]=t.zoom[e.zoom][3]||1,t.zoom[e.zoom]}return t.static=t.value.map(function(t){return t}),t.static&&null==t.static[3]&&(t.static[3]=1),t.static},yo.parseColor=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("function"==typeof t&&(t=t(e)),"string"==typeof t)t=yo.colorForString(t);else if(Array.isArray(t)&&Array.isArray(t[0])){for(var r=0;r<t.length;r++){var n=t[r];"string"==typeof n[1]&&(n[1]=yo.colorForString(n[1]))}e.zoom&&(t=Ai.interpolate(e.zoom,t))}return Array.isArray(t)?null==(t=t.map(function(t){return t}))[3]&&(t[3]=1):t=[0,0,0,1],t},yo.calculateOrder=function(t,e){return"function"==typeof t?t=t(e):"string"==typeof t&&(t=e.feature.properties[t]?e.feature.properties[t]:po(t)),t},yo.evalProperty=function(t,e){return"function"==typeof t?t(e):t};var wo=function(){function t(e,r){gn(this,t),this.key=e,this.repeat_dist=r,this.repeat_dist_sq=this.repeat_dist*this.repeat_dist,this.positions=[]}return _n(t,[{key:"check",value:function(t){for(var e=t.position,r=0;r<this.positions.length;r++){var n=this.positions[r],i=e[0]-n[0],o=e[1]-n[1],a=i*i+o*o;if(a<this.repeat_dist_sq)return{dist_sq:a,repeat_dist_sq:this.repeat_dist_sq}}}},{key:"add",value:function(t){t&&t.position&&this.positions.push(t.position)}}],[{key:"clear",value:function(t){this.groups[t]={}}},{key:"check",value:function(t,e,r){if(e.repeat_distance&&e.repeat_group&&this.groups[r][e.repeat_group])return this.groups[r][e.repeat_group].check(t)}},{key:"add",value:function(e,r,n){r.repeat_distance&&r.repeat_group&&(null==this.groups[n][r.repeat_group]&&(this.groups[n][r.repeat_group]=new t(r.repeat_group,r.repeat_distance*r.repeat_scale)),this.groups[n][r.repeat_group].add(e))}}]),t}();wo.groups={};var Eo=function(){function t(e,r,n){gn(this,t);var i=this.boxCells=[],o=this.circleCells=[];this.xCellCount=Math.ceil(e/n),this.yCellCount=Math.ceil(r/n);for(var a=0;a<this.xCellCount*this.yCellCount;a++)i.push([]),o.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=r,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}return _n(t,[{key:"keysLength",value:function(){return this.boxKeys.length+this.circleKeys.length}},{key:"insert",value:function(t,e,r,n,i){this._forEachCell(e,r,n,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)}},{key:"insertCircle",value:function(t,e,r,n){this._forEachCell(e-n,r-n,e+n,r+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(r),this.circles.push(n)}},{key:"insertCircleList",value:function(t,e){for(var r=0;r<e.length-2;r+=3)this.insertCircle("".concat(t,"/").concat(r),e[r],e[r+1],e[r+2])}},{key:"_insertBoxCell",value:function(t,e,r,n,i,o){this.boxCells[i].push(o)}},{key:"_insertCircleCell",value:function(t,e,r,n,i,o){this.circleCells[i].push(o)}},{key:"_query",value:function(t,e,r,n,i,o){if(r<0||t>this.width||n<0||e>this.height)return!i&&[];var a=[];if(t<=0&&e<=0&&this.width<=r&&this.height<=n){if(i)return!0;for(var s=0;s<this.boxKeys.length;s++)a.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var u=0;u<this.circleKeys.length;u++){var l=this.circles[3*u],c=this.circles[3*u+1],h=this.circles[3*u+2];a.push({key:this.circleKeys[u],x1:l-h,y1:c-h,x2:l+h,y2:c+h})}return o?a.filter(o):a}var f={hitTest:i,seenUids:{box:{},circle:{}}};return this._forEachCell(t,e,r,n,this._queryCell,a,f,o),i?0<a.length:a}},{key:"_queryCircle",value:function(t,e,r,n,i){var o=t-r,a=t+r,s=e-r,u=e+r;if(a<0||o>this.width||u<0||s>this.height)return!n&&[];var l=[],c={hitTest:n,circle:{x:t,y:e,radius:r},seenUids:{box:{},circle:{}}};return this._forEachCell(o,s,a,u,this._queryCellCircle,l,c,i),n?0<l.length:l}},{key:"query",value:function(t,e,r,n,i){return this._query(t,e,r,n,!1,i)}},{key:"hitTest",value:function(t,e,r,n,i){return this._query(t,e,r,n,!0,i)}},{key:"hitTestCircle",value:function(t,e,r,n){return this._queryCircle(t,e,r,!0,n)}},{key:"hitTestCircleList",value:function(t,e){for(var r=0;r<t.length-2;r+=3)if(this.hitTestCircle(t[r],t[r+1],t[r+2],e))return!0;return!1}},{key:"_queryCell",value:function(t,e,r,n,i,o,a,s){var u=a.seenUids,l=this.boxCells[i];if(null!==l){var c,h=this.bboxes,f=jn(l);try{for(f.s();!(c=f.n()).done;){var p=c.value;if(!u.box[p]){u.box[p]=!0;var d=4*p;if(t<=h[2+d]&&e<=h[3+d]&&r>=h[0+d]&&n>=h[1+d]&&(!s||s(this.boxKeys[p]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[p],x1:h[d],y1:h[1+d],x2:h[2+d],y2:h[3+d]})}}}}catch(t){f.e(t)}finally{f.f()}}var v=this.circleCells[i];if(null!==v){var y,g=this.circles,m=jn(v);try{for(m.s();!(y=m.n()).done;){var _=y.value;if(!u.circle[_]){u.circle[_]=!0;var b=3*_;if(this._circleAndRectCollide(g[b],g[1+b],g[2+b],t,e,r,n)&&(!s||s(this.circleKeys[_]))){if(a.hitTest)return o.push(!0),!0;var x=g[b],w=g[1+b],E=g[2+b];o.push({key:this.circleKeys[_],x1:x-E,y1:w-E,x2:x+E,y2:w+E})}}}}catch(t){m.e(t)}finally{m.f()}}}},{key:"_queryCellCircle",value:function(t,e,r,n,i,o,a,s){var u=a.circle,l=a.seenUids,c=this.boxCells[i];if(null!==c){var h,f=this.bboxes,p=jn(c);try{for(p.s();!(h=p.n()).done;){var d=h.value;if(!l.box[d]){l.box[d]=!0;var v=4*d;if(this._circleAndRectCollide(u.x,u.y,u.radius,f[0+v],f[1+v],f[2+v],f[3+v])&&(!s||s(this.boxKeys[d])))return o.push(!0),!0}}}catch(t){p.e(t)}finally{p.f()}}var y=this.circleCells[i];if(null!==y){var g,m=this.circles,_=jn(y);try{for(_.s();!(g=_.n()).done;){var b=g.value;if(!l.circle[b]){l.circle[b]=!0;var x=3*b;if(this._circlesCollide(m[x],m[1+x],m[2+x],u.x,u.y,u.radius)&&(!s||s(this.circleKeys[b])))return o.push(!0),!0}}}catch(t){_.e(t)}finally{_.f()}}}},{key:"_forEachCell",value:function(t,e,r,n,i,o,a,s){for(var u=this._convertToXCellCoord(t),l=this._convertToYCellCoord(e),c=this._convertToXCellCoord(r),h=this._convertToYCellCoord(n),f=u;f<=c;f++)for(var p=l;p<=h;p++){var d=this.xCellCount*p+f;if(i.call(this,t,e,r,n,d,o,a,s))return}}},{key:"_convertToXCellCoord",value:function(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}},{key:"_convertToYCellCoord",value:function(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}},{key:"_circlesCollide",value:function(t,e,r,n,i,o){var a=n-t,s=i-e,u=r+o;return a*a+s*s<u*u}},{key:"_circleAndRectCollide",value:function(t,e,r,n,i,o,a){var s=(o-n)/2,u=Math.abs(t-(n+s));if(s+r<u)return!1;var l=(a-i)/2,c=Math.abs(e-(i+l));if(l+r<c)return!1;if(u<=s||c<=l)return!0;var h=u-s,f=c-l;return h*h+f*f<=r*r}}]),t}(),To={tiles:{},startTile:function(t,e){var r=1<arguments.length&&void 0!==e?e:{},n=r.apply_repeat_groups,i=void 0===n||n,o=r.return_hidden,a=void 0!==o&&o,s=r.grid_index,u=void 0===s?null:s,l=this.tiles[t]={grid_index:u||new Eo(Qn.tile_scale,Qn.tile_scale,240),objects:{},labels:{},styles:{},repeat:i,return_hidden:a};null==l.complete&&(l.complete=new Promise(function(t,e){l.resolve=t,l.reject=e}))},resetTile:function(t){delete this.tiles[t]},abortTile:function(t){this.tiles[t]&&this.tiles[t].resolve&&this.tiles[t].resolve([]),this.resetTile(t)},addStyle:function(t,e){this.tiles[e].styles[t]=!0},collide:function(t,e,r){var n=this.tiles[r];if(!n)return Promise.resolve([]);for(var i=n.objects,o=0;o<t.length;o++){var a=t[o],s=a.label.layout.priority;i[s]=i[s]||{},i[s][e]=i[s][e]||[],i[s][e].push(a)}return delete n.styles[e],0===Object.keys(n.styles).length&&this.endTile(r),n.complete.then(function(){return n.resolve=null,n.labels[e]||[]})},endTile:function(t){var e=this.tiles[t],r=e.labels;e.repeat&&wo.clear(t);for(var n=Object.keys(e.objects).sort(function(t,e){return t-e}),i=0;i<n.length;i++){var o=e.objects[n[i]];if(o)for(var a in o){var s=o[a];r[a]=r[a]||[];for(var u=0;u<s.length;u++){var l=s[u];this.canBePlaced(l,t,l.linked,e)?l.linked?this.canBePlaced(l.linked,t,l,e)?(l.show=!0,(l.label.breach||l.linked.label.breach)&&(l.label.breach=!0,l.linked.label.breach=!0),r[a].push(l),this.place(l,t,e),this.place(l.linked,t,e)):e.return_hidden&&(l.show=!1,r[a].push(l)):(l.show=!0,r[a].push(l),this.place(l,t,e)):e.return_hidden&&(l.show=!1,r[a].push(l))}}}delete this.tiles[t],e.resolve()},canBePlaced:function(t,e,r,n){var i=2<arguments.length&&void 0!==r?r:null,o=(3<arguments.length&&void 0!==n?n:{}).repeat,a=void 0===o||o,s=t.label,u=t.label.layout;if(null!==s.placed)return s.placed;var l=this.tiles[e].grid_index;if(u.collide&&function(t,e,r,n){var i;if(n&&(i=function(t){return t!==n.id}),!e){if("point"===t.type&&!t.angle){var o=t.getAABB(),a=o.left,s=o.top,u=o.right,l=o.bottom;if(r.hitTest(a,-s,u,-l,i)){if(Array.isArray(t.layout.anchor))for(var c=1;c<t.layout.anchor.length;c++){t.setAnchor(t.layout.anchor[c]);var h=t.getAABB(),f=h.left,p=h.top,d=h.right,v=h.bottom;if(!r.hitTest(f,-p,d,-v,i))return!1}return!0}return!1}var y=t.getBoundingCircles();return r.hitTestCircleList(y,i)}if(e){if("point"===t.type&&!t.isFlat()){var g=t.getScreenSpaceBoundingBox(),m=g.left,_=g.top,b=g.right,x=g.bottom;return r.hitTest(m,_,b,x,i)}var w=t.getBoundingCircles();return r.hitTestCircleList(w,i)}return!1}(s,"main"===e,l,i&&i.label))u.collide&&(s.placed=!1);else{if(!a||!wo.check(s,u,e))return!0;s.placed=!1}return s.placed},place:function(t,e,r){var n=t.label,i=r.repeat,o=void 0===i||i;null===n.placed&&(o&&wo.add(n,n.layout,e),function(t,e,r){var n,i,o,a,s,u,l,c,h,f,p,d,v=t.id;t.placed=!0,e||("point"!==t.type||t.angle?(n=t.getBoundingCircles(),r.insertCircleList(v,n)):(o=(i=t.getAABB()).left,a=i.top,s=i.right,u=i.bottom,r.insert(v,o,-a,s,-u))),e&&("point"!==t.type||t.isFlat()?(l=t.getBoundingCircles(),r.insertCircleList(v,l)):(h=(c=t.getScreenSpaceBoundingBox()).left,f=c.top,p=c.right,d=c.bottom,r.insert(v,h,f,p,d)))}(n,"main"===e,this.tiles[e].grid_index))}},Ao={id:0,queue:[],max_time:20,start_time:null,state:{},ignore_user_moving_view:!1,_ignoreViewMoveWithDebounce:Ti(function(){Ao.ignore_user_moving_view=!0},0,500),add:function(t){t.id=Ao.id++,t.max_time=t.max_time||Ao.max_time,t.pause_factor=t.pause_factor||1;var e=new Promise(function(e,r){t.resolve=e,t.reject=r});return t.promise=e,t.total_elapsed=0,t.stats={calls:0},this.queue.push(t),this.start_time=this.start_time||performance.now(),this.elapsed=performance.now()-this.start_time,this.elapsed<Ao.max_time&&this.process(t),t.promise},remove:function(t){var e=this.queue.indexOf(t);-1<e&&this.queue.splice(e,1)},process:function(t){if(!this.state.user_moving_view||!1!==t.user_moving_view||this.ignore_user_moving_view)return t.pause?(t.pause--,!0):(t.stats.calls++,t.start_time=performance.now(),t.run(t));Ao._ignoreViewMoveWithDebounce()},processAll:function(){this.start_time=this.start_time||performance.now(),this.ignore_user_moving_view&&!this.hasPendingTasks()&&(this.ignore_user_moving_view=!1);for(var t=0;t<this.queue.length;t++){var e=this.queue[t];if(!0!==this.process(e)&&(e.pause||(e.pause=e.elapsed>e.max_time?e.pause_factor:0),e.total_elapsed+=e.elapsed),this.elapsed=performance.now()-this.start_time,this.elapsed>=Ao.max_time){this.start_time=null;break}}},finish:function(t,e){return t.elapsed=performance.now()-t.start_time,t.total_elapsed+=t.elapsed,this.remove(t),t.resolve(e),t.promise},cancel:function(t){var e;t.cancel instanceof Function&&(e=t.cancel(t)),t.resolve(e||{})},shouldContinue:function(t){return t.elapsed=performance.now()-t.start_time,this.elapsed=performance.now()-this.start_time,t.elapsed<t.max_time&&this.elapsed<Ao.max_time},removeForTile:function(t){for(var e=this.queue.length-1;0<=e;e--)this.queue[e].tile_id===t&&(this.cancel(this.queue[e]),this.queue.splice(e,1))},setState:function(t){this.state=t},hasPendingTasks:function(){return!!this.queue.length}};function ko(t){return{coords:t.coords,uid:t.uid,filtering:t.filtering,sprites:t.sprites,url:t.url,element:t.element,data:t.data,width:t.width,height:t.height,density:t.density,repeat:t.repeat,TEXTURE_WRAP_S:t.TEXTURE_WRAP_S,TEXTURE_WRAP_T:t.TEXTURE_WRAP_T,UNPACK_FLIP_Y_WEBGL:t.UNPACK_FLIP_Y_WEBGL,UNPACK_PREMULTIPLY_ALPHA_WEBGL:t.UNPACK_PREMULTIPLY_ALPHA_WEBGL}}var So=function(){function t(e,r,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};gn(this,t),i=ko(i),this.gl=e,this.texture=e.createTexture(),this.texture&&(this.valid=!0),this.manager=n,this.bind(),this.name=r,this.retain_count=0,this.config_type=null,this.loading=null,this.loaded=!1,this.filtering=i.filtering,this.density=i.density||1,this.sprites=i.sprites,this.texcoords={},this.sizes={},this.css_sizes={},this.aspects={},this._byte_length=0,this.setData(1,1,new Uint8Array([0,0,0,0]),{filtering:"nearest"}),this.loaded=!1,this.manager.textures[this.name]&&(this.retain_count=this.manager.textures[this.name].retain_count,this.manager.textures[this.name].retain_count=0,this.manager.textures[this.name].destroy()),(this.manager.textures[this.name]=this).manager.texture_configs[this.name]=JSON.stringify(Object.assign({name:r},i)),this.load(i),Ei("trace","creating Texture ".concat(this.name))}return _n(t,[{key:"destroy",value:function(t){var e=(0<arguments.length&&void 0!==t?t:{}).force;0<this.retain_count&&!e?Ei("error","Texture '".concat(this.name,"': destroying texture with retain count of '").concat(this.retain_count,"'")):this.valid&&(this.gl.deleteTexture(this.texture),this.texture=null,delete this.data,this.data=null,delete this.manager.textures[this.name],delete this.manager.texture_configs[this.name],this.valid=!1,this._byte_length=0,Ei("trace","destroying Texture ".concat(this.name)))}},{key:"retain",value:function(){this.retain_count++}},{key:"release",value:function(){this.retain_count<=0&&Ei("error","Texture '".concat(this.name,"': releasing texture with retain count of '").concat(this.retain_count,"'")),this.retain_count--,this.retain_count<=0&&this.destroy()}},{key:"bind",value:function(t){var e=0<arguments.length&&void 0!==t?t:0;this.valid&&(this.manager.activeUnit!==e&&(this.gl.activeTexture(this.gl.TEXTURE0+e),this.manager.activeUnit=e,this.manager.boundTexture=null),this.manager.boundTexture!==this.texture&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.manager.boundTexture=this.texture))}},{key:"load",value:function(t){var e=this;return t?(this.loading=null,"string"==typeof t.url?(this.config_type="url",this.setUrl(t.url,t)):t.element?(this.config_type="element",this.setElement(t.element,t)):t.data&&t.width&&t.height&&(this.config_type="data",this.setData(t.width,t.height,t.data,t)),this.loading=this.loading&&this.loading.then(function(){return e.calculateSprites(),e})||Promise.resolve(this),this.loading):this.loading||Promise.resolve(this)}},{key:"setUrl",value:function(t,e){var r=this,n=1<arguments.length&&void 0!==e?e:{};if(this.valid)return this.url=t,this.loading=new Promise(function(t,e){var i=new Image;i.onload=function(){try{r.setElement(i,n)}catch(t){r.loaded=!1,Ei("warn","Texture '".concat(r.name,"': failed to load url: '").concat(r.url,"'"),t,n),r.manager.trigger("warning",{message:"Failed to load texture from ".concat(r.url),error:t,texture:n})}r.loaded=!0,t(r)},i.onerror=function(e){r.loaded=!1,Ei("warn","Texture '".concat(r.name,"': failed to load url: '").concat(r.url,"'"),e,n),r.manager.trigger("warning",{message:"Failed to load texture from ".concat(r.url),error:e,texture:n}),t(r)},Ai.isSafari()&&"data:"===r.url.slice(0,5)||(i.crossOrigin="anonymous"),i.src=r.url}),this.loading}},{key:"setData",value:function(t,e,r,n){var i=3<arguments.length&&void 0!==n?n:{};return this.width=t,this.height=e,Array.isArray(r)&&(r=new Uint8Array(r)),this.update(r,i),this.setFiltering(i),this.loaded=!0,this.loading=Promise.resolve(this),this.loading}},{key:"setElement",value:function(t,e){var r,n=t;return"string"==typeof t&&(t=document.querySelector(t)),t instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof HTMLVideoElement?(this.update(t,e),this.setFiltering(e)):(this.loaded=!1,r="the 'element' parameter (`element: ".concat(JSON.stringify(n),"`) must be a CSS "),r+="selector string, or a <canvas>, <image> or <video> object",Ei("warn","Texture '".concat(this.name,"': ").concat(r),e),this.manager.trigger("warning",{message:"Failed to load texture because ".concat(r),texture:e})),this.loaded=!0,this.loading=Promise.resolve(this),this.loading}},{key:"update",value:function(t,e){var r=1<arguments.length&&void 0!==e?e:{};this.valid&&(this.bind(),t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof HTMLImageElement&&t.complete?(this.width=t.width,this.height=t.height,this._byte_length=this.width*this.height*4,this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1!==r.UNPACK_FLIP_Y_WEBGL),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.UNPACK_PREMULTIPLY_ALPHA_WEBGL||!1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t)):(this._byte_length=t?t.byteLength:0,this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t)),this.manager.trigger("update",this))}},{key:"getByteLength",value:function(){return this._byte_length}},{key:"setFiltering",value:function(t){var e,r=0<arguments.length&&void 0!==t?t:{};this.valid&&(r.filtering=r.filtering||"linear",e=this.gl,this.bind(),Ai.isPowerOf2(this.width)&&Ai.isPowerOf2(this.height)?(this.power_of_2=!0,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,r.TEXTURE_WRAP_S||r.repeat&&e.REPEAT||e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,r.TEXTURE_WRAP_T||r.repeat&&e.REPEAT||e.CLAMP_TO_EDGE),"mipmap"===r.filtering?(this.filtering="mipmap",e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.generateMipmap(e.TEXTURE_2D)):"linear"===r.filtering?(this.filtering="linear",e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR)):"nearest"===r.filtering&&(this.filtering="nearest",e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST))):(this.power_of_2=!1,e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),"nearest"===r.filtering?(this.filtering="nearest",e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)):(this.filtering="linear",e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR))),this.manager.trigger("update",this))}},{key:"calculateSprites",value:function(){if(this.sprites)for(var t in this.sprites){var e=this.sprites[t];this.texcoords[t]=this.manager.getTexcoordsForSprite([e[0],e[1]],[e[2],e[3]],[this.width,this.height]),this.sizes[t]=[e[2],e[3]],this.css_sizes[t]=[e[2]/this.density,e[3]/this.density],this.aspects[t]=e[2]/e[3]}}}]),t}();function Mo(t){var e=[];return Object.assign(t,{subscribe:function(t){-1===e.indexOf(t)&&e.push(t)},unsubscribe:function(t){var r=e.indexOf(t);-1<r&&e.splice(r,1)},unsubscribeAll:function(){e=[]},trigger:function(t){for(var r=arguments.length,n=new Array(1<r?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];e.forEach(function(e){if("function"==typeof e[t])try{e[t].apply(e,n)}catch(e){Ei("warn","Caught exception in listener for event '".concat(t,"':"),e)}})},hasSubscribersFor:function(t){var r=!1;return e.forEach(function(e){"function"==typeof e[t]&&(r=!0)}),r}})}var Oo=function(){function t(e){gn(this,t),this.default=t.DEFAULT_TEXTURE_NAME,this.textures={},this.texture_configs={},this.boundTexture=null,this.activeUnit=null,this.scene_id=e,li.addTarget("Texture"+this.scene_id,this),Mo(this)}return _n(t,[{key:"create",value:function(e,r,n){for(var i=t.matchers_,o=0;o<i.length;o++){var a=i[o][0],s=i[o][1];if(s&&s(n))return new a(e,r,this,n)}return new So(e,r,this,n)}},{key:"retain",value:function(t){this.textures[t]&&this.textures[t].retain()}},{key:"release",value:function(t){this.textures[t]&&this.textures[t].release()}},{key:"getRetainCount",value:function(t){if(this.textures[t])return this.textures[t].retain_count}},{key:"getByteLength",value:function(t){if(this.textures[t])return this.textures[t].getByteLength()}},{key:"destroy",value:function(t){var e=this;Object.keys(this.textures).forEach(function(r){var n=e.textures[r];r!==e.default&&n.gl===t&&n.destroy({force:!0})})}},{key:"getSpriteInfo",value:function(t,e){var r=this.textures[t];return r&&{size:r.sizes[e],css_size:r.css_sizes[e],aspect:r.aspects[e],texcoords:r.texcoords[e]}}},{key:"getTexcoordsForSprite",value:function(t,e,r){var n=r[1]-t[1]-e[1];return[t[0]/r[0],n/r[1],(e[0]+t[0])/r[0],(e[1]+n)/r[1]]}},{key:"createFromObject",value:function(t,e){var r=[];if(e)for(var n in e){var i,o=e[n];this.changed(n,o)&&(i=this.create(t,n,o),r.push(i.loading))}return Promise.all(r)}},{key:"createDefault",value:function(t){return this.create(t,this.default)}},{key:"changed",value:function(t,e){var r=this.textures[t];if(r){if("element"===r.config_type||null!=e.element)return!0;if(e=ko(e),this.texture_configs[t]===JSON.stringify(Object.assign({name:t},e)))return!1}return!0}},{key:"getInfo",value:function(t){var e=this;if(t=t||Object.keys(this.textures),Array.isArray(t))return Promise.all(t.map(function(t){return e.getInfo(t)}));var r=this.textures[t];return r?(r.loading||Promise.resolve(r)).then(function(){return{name:r.name,width:r.width,height:r.height,density:r.density,sprites:r.sprites,texcoords:r.texcoords,sizes:r.sizes,css_sizes:r.css_sizes,aspects:r.aspects,filtering:r.filtering,power_of_2:r.power_of_2,valid:r.valid}}):Promise.resolve(null)}},{key:"syncTexturesToWorker",value:function(t){var e=this;return ui.is_main?Promise.all(t.map(function(t){var r=e.textures[t];return r&&r.loading||Promise.resolve()})).then(function(){return e.textures}):li.postMessage("Texture"+this.scene_id+".getInfo",t).then(function(t){return t.forEach(function(t){e.textures[t.name]=t}),e.textures})}},{key:"getMaxTextureSize",value:function(t){return t.getParameter(t.MAX_TEXTURE_SIZE)}}],[{key:"register",value:function(e,r){var n=t.matchers_;if(!(e instanceof Function&&r instanceof Function))throw"Invalid texture constructor or matcher";this.deRegister(e),n.push([e,r])}},{key:"deRegister",value:function(e){for(var r=t.matchers_,n=0;n<r.length;n++)r[n][0]===e&&r.splice(n,1)}}]),t}();Oo.DEFAULT_TEXTURE_NAME="__default",Oo.matchers_=[];var Io={};function Lo(t){return Io[t]||(Io[t]=new Oo(t)),Io[t]}var Co=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Ro=function(t,e,r){var n=new Float64Array(3);return n[0]=t,n[1]=e,n[2]=r,n},Po=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=r[3]*n+r[7]*i+r[11]*o+r[15];return a=a||1,t[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/a,t[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/a,t[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/a,t},No=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],p=e[11],d=e[12],v=e[13],y=e[14],g=e[15],m=r*s-n*a,_=r*u-i*a,b=r*l-o*a,x=n*u-i*s,w=n*l-o*s,E=i*l-o*u,T=c*v-h*d,A=c*y-f*d,k=c*g-p*d,S=h*y-f*v,M=h*g-p*v,O=f*g-p*y,I=m*O-_*M+b*S+x*k-w*A+E*T;return I?(I=1/I,t[0]=(s*O-u*M+l*S)*I,t[1]=(u*k-a*O-l*A)*I,t[2]=(a*M-s*k+l*T)*I,t[3]=(i*M-n*O-o*S)*I,t[4]=(r*O-i*k+o*A)*I,t[5]=(n*k-r*M-o*T)*I,t[6]=(v*E-y*w+g*x)*I,t[7]=(y*b-d*E-g*_)*I,t[8]=(d*w-v*b+g*m)*I,t):null},jo=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=c*a-s*l,f=-c*o+s*u,p=l*o-a*u,d=r*h+n*f+i*p;return d?(d=1/d,t[0]=h*d,t[1]=(-c*n+i*l)*d,t[2]=(s*n-i*a)*d,t[3]=f*d,t[4]=(c*r-i*u)*d,t[5]=(-s*r+i*o)*d,t[6]=p*d,t[7]=(-l*r+n*u)*d,t[8]=(a*r-n*o)*d,t):null},Do=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=e[9],p=e[10],d=e[11],v=e[12],y=e[13],g=e[14],m=e[15],_=r[0],b=r[1],x=r[2],w=r[3];return t[0]=_*n+b*s+x*h+w*v,t[1]=_*i+b*u+x*f+w*y,t[2]=_*o+b*l+x*p+w*g,t[3]=_*a+b*c+x*d+w*m,_=r[4],b=r[5],x=r[6],w=r[7],t[4]=_*n+b*s+x*h+w*v,t[5]=_*i+b*u+x*f+w*y,t[6]=_*o+b*l+x*p+w*g,t[7]=_*a+b*c+x*d+w*m,_=r[8],b=r[9],x=r[10],w=r[11],t[8]=_*n+b*s+x*h+w*v,t[9]=_*i+b*u+x*f+w*y,t[10]=_*o+b*l+x*p+w*g,t[11]=_*a+b*c+x*d+w*m,_=r[12],b=r[13],x=r[14],w=r[15],t[12]=_*n+b*s+x*h+w*v,t[13]=_*i+b*u+x*f+w*y,t[14]=_*o+b*l+x*p+w*g,t[15]=_*a+b*c+x*d+w*m,t},zo=function(t,e,r){var n,i,o,a,s,u,l,c,h,f,p,d,v=r[0],y=r[1],g=r[2];return e===t?(t[12]=e[0]*v+e[4]*y+e[8]*g+e[12],t[13]=e[1]*v+e[5]*y+e[9]*g+e[13],t[14]=e[2]*v+e[6]*y+e[10]*g+e[14],t[15]=e[3]*v+e[7]*y+e[11]*g+e[15]):(n=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=e[9],p=e[10],d=e[11],t[0]=n,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=l,t[7]=c,t[8]=h,t[9]=f,t[10]=p,t[11]=d,t[12]=n*v+s*y+h*g+e[12],t[13]=i*v+u*y+f*g+e[13],t[14]=o*v+l*y+p*g+e[14],t[15]=a*v+c*y+d*g+e[15]),t},Ho=function(t,e,r){var n=r[0],i=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Fo=function(t,e,r,n,i){var o=1/Math.tan(e/2),a=1/(n-i);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+n)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*n*a,t[15]=0,t},Bo=function(t,e,r,n){var i,o,a,s,u,l,c,h,f,p,d=e[0],v=e[1],y=e[2],g=n[0],m=n[1],_=n[2],b=r[0],x=r[1],w=r[2];return Math.abs(d-b)<1e-6&&Math.abs(v-x)<1e-6&&Math.abs(y-w)<1e-6?Co(t):(c=d-b,h=v-x,f=y-w,i=m*(f*=p=1/Math.sqrt(c*c+h*h+f*f))-_*(h*=p),o=_*(c*=p)-g*f,a=g*h-m*c,(p=Math.sqrt(i*i+o*o+a*a))?(i*=p=1/p,o*=p,a*=p):a=o=i=0,s=h*a-f*o,u=f*i-c*a,l=c*o-h*i,(p=Math.sqrt(s*s+u*u+l*l))?(s*=p=1/p,u*=p,l*=p):l=u=s=0,t[0]=i,t[1]=s,t[2]=c,t[3]=0,t[4]=o,t[5]=u,t[6]=h,t[7]=0,t[8]=a,t[9]=l,t[10]=f,t[11]=0,t[12]=-(i*d+o*v+a*y),t[13]=-(s*d+u*v+l*y),t[14]=-(c*d+h*v+f*y),t[15]=1,t)},Uo=Co,Go=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},qo=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],p=e[11],d=e[12],v=e[13],y=e[14],g=e[15],m=r*s-n*a,_=r*u-i*a,b=r*l-o*a,x=n*u-i*s,w=n*l-o*s,E=i*l-o*u,T=c*v-h*d,A=c*y-f*d,k=c*g-p*d,S=h*y-f*v,M=h*g-p*v,O=f*g-p*y,I=m*O-_*M+b*S+x*k-w*A+E*T;return I?(I=1/I,t[0]=(s*O-u*M+l*S)*I,t[1]=(i*M-n*O-o*S)*I,t[2]=(v*E-y*w+g*x)*I,t[3]=(f*w-h*E-p*x)*I,t[4]=(u*k-a*O-l*A)*I,t[5]=(r*O-i*k+o*A)*I,t[6]=(y*b-d*E-g*_)*I,t[7]=(c*E-f*b+p*_)*I,t[8]=(a*M-s*k+l*T)*I,t[9]=(n*k-r*M-o*T)*I,t[10]=(d*w-v*b+g*m)*I,t[11]=(h*b-c*w-p*m)*I,t[12]=(s*A-a*S-u*T)*I,t[13]=(r*S-n*A+i*T)*I,t[14]=(v*_-d*x-y*m)*I,t[15]=(c*x-h*_+f*m)*I,t):null},Vo=function(t,e,r){var n=e[0],i=e[1],o=e[2],a=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,t},Wo=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],a=r*r+n*n+i*i+o*o;return 0<a&&(a=1/Math.sqrt(a),t[0]=r*a,t[1]=n*a,t[2]=i*a,t[3]=o*a),t},Yo=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},Ko=function(){function t(e,r){gn(this,t),this._gl=e,this._requests={},this._pixels=null,this._has_dirty_buffer=!1,this._fbo=this._gl.createFramebuffer(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fbo),this._fbo_size={width:256,height:256};var n=Lo(r).create(this._gl,"selection_fbo",{filtering:"nearest"});n.setData(this._fbo_size.width,this._fbo_size.height,null,{filtering:"nearest"}),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,n.texture,0);var i=this._gl.createRenderbuffer();this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,i),this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_COMPONENT16,this._fbo_size.width,this._fbo_size.height),this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.RENDERBUFFER,i),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)}return _n(t,[{key:"destroy",value:function(){this._gl&&this._fbo&&(this._gl.deleteFramebuffer(this._fbo),this._fbo=null,this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null))}},{key:"bind",value:function(){var e;this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fbo),this._gl.viewport(0,0,this._fbo_size.width,this._fbo_size.height),(e=this._gl).clearColor.apply(e,Rn(t.defaultColor))}},{key:"getFeatureAt",value:function(e,r,n){var i=r.radius,o=r.top_most_only,a=void 0===o||o;!e||e.x<0||e.y<0||1<e.x||1<e.y?n({features:null}):(this.selection_request_id=this.selection_request_id+1||0,this._requests[this.selection_request_id]={id:this.selection_request_id,point:e,radius:i,top_most_only:a,ttl:a?1:t.MAX_PICKING_TRIES,callback:n})}},{key:"hasPendingRequests",value:function(){return 0<Object.keys(this._requests).length}},{key:"clearPendingRequests",value:function(){for(var t in this._requests)this._requests[t].callback(new Error("cleared")),delete this._requests[t];this._pending_deep_request=null}},{key:"read",value:function(t){if(this.hasPendingRequests()){var e=this._gl;for(var r in e.bindFramebuffer(e.FRAMEBUFFER,this._fbo),this._pending_deep_request&&this.processRequest(this._pending_deep_request,t),this._requests)if(this.processRequest(this._requests[r],t))break;e.bindFramebuffer(e.FRAMEBUFFER,null)}}},{key:"processRequest",value:function(e,r){var n,i,o,a=this._gl,s=255,u=e.point,l=e.radius,c=(o=l?(i=Math.min(this._fbo_size.width,this._fbo_size.height),{x:Math.min(Math.ceil(2*l.x*this._fbo_size.width),i),y:Math.min(Math.ceil(2*l.y*this._fbo_size.height),i)}):(l={x:0,y:0},{x:1,y:1})).x*o.y*4;if(null==this._pixels||this._pixels.byteLength<c)this._pixels=new Uint8Array(c);else if(this._pixels.fill instanceof Function)this._pixels.fill(0,0,c);else for(var h=0;h<c;h++)this._pixels[h]=0;a.readPixels(Math.round((u.x-l.x)*this._fbo_size.width),Math.round((1-u.y-l.y)*this._fbo_size.height),o.x,o.y,a.RGBA,a.UNSIGNED_BYTE,this._pixels),e.ttl--;var f=Math.floor(o.x/2),p=Math.floor(o.y/2),d=4*(p*o.x+f),v=this._pixels.slice(d,d+4),y=v[0]+(v[1]<<8)+(v[2]<<16);if(0<y)n=y+(v[3]<<24)>>>0,s=v[3];else if(4<c)for(var g=1/0,m=(d=0,0);m<o.y;m++)for(var _,b=0;b<o.x;b++,d+=4)0<(y=(v=this._pixels.slice(d,d+4))[0]+(v[1]<<8)+(v[2]<<16))&&(_=Math.pow(b-f,2)+Math.pow(m-p,2))<g&&(n=y+(v[3]<<24)>>>0,s=v[3],g=_);if(255!==s){var x=this._getFeatureByKey(n,r);if(e.features||(e.features=[]),!x)return void this._finishRead(e);if(e.features.every(function(t){return t.id!==x.id})&&e.features.push(x),e.ttl)return this._pending_deep_request=e,t._discardColor(v),this._has_dirty_buffer=!0;this._finishRead(e)}else this._finishRead(e)}},{key:"_finishRead",value:function(e){var r=e.features||t.EMPTY_ARRAY;e.top_most_only||(this._pending_deep_request=null,t._resetDiscardedColors()),delete this._requests[e.id],e.callback({features:r})}},{key:"_getFeatureByKey",value:function(t,e){for(var r=null,n=0;n<e.length;n++){var i=e[n];if(i.selection_data&&(r=i.selection_data[t])){r.tile={coords:i.coords};break}}return r}},{key:"setupDiscards",value:function(e){for(var r=t.MAX_PICKING_TRIES;r--;)e.uniform("4fv","u_selection_discard".concat(r),t._discarded_colors[r]||t.defaultColor)}},{key:"has_dirty_buffer",get:function(){return this._has_dirty_buffer},set:function(){this._has_dirty_buffer=!!this._pending_deep_request}}],[{key:"makeEntry",value:function(){this.map_entry++;var t=255&this.map_entry,e=this.map_entry>>8&255,r=this.map_entry>>16&255,n=this.map_prefix;return{key:t+(e<<8)+(r<<16)+(n<<24)>>>0,color:[t/255,e/255,r/255,n/255]}}},{key:"reset",value:function(){this.map_entry=0}},{key:"setPrefix",value:function(t){this.map_prefix=t}},{key:"_discardColor",value:function(t){this._discarded_colors.push([t[0]/255,t[1]/255,t[2]/255,t[3]/255])}},{key:"_resetDiscardedColors",value:function(){this._discarded_colors.length=0}}]),t}();Ko._discarded_colors=[],Ko.map_entry=0,Ko.map_prefix=0,Ko.defaultColor=[0,0,0,1],Ko.MAX_PICKING_TRIES=10,Ko.EMPTY_ARRAY=Object.freeze([]);var Xo={parseUniforms:function(t){var e=[];for(var r in t){var n,i=r,o=t[r];if("number"==typeof o)e.push({type:"float",method:"1f",name:r,value:o,key:i,uniforms:t});else if(Array.isArray(o)){if("number"==typeof o[0])2<=o.length&&o.length<=4?e.push({type:"vec"+o.length,method:o.length+"fv",name:r,value:o,key:i,uniforms:t}):4<o.length&&e.push({type:"float[]",method:"1fv",name:r+"[0]",value:o,key:i,uniforms:t});else if("string"==typeof o[0])for(n=0;n<o.length;n++)e.push({type:"sampler2D",method:"1i",name:r+"["+n+"]",value:o[n],key:n,uniforms:o});else if(Array.isArray(o[0])&&"number"==typeof o[0][0]&&2<=o[0].length&&o[0].length<=4)for(n=0;n<o.length;n++)e.push({type:"vec"+o[0].length,method:o[n].length+"fv",name:r+"["+n+"]",value:o[n],key:n,uniforms:o})}else"boolean"==typeof o?e.push({type:"bool",method:"1i",name:r,value:o,key:i,uniforms:t}):"string"==typeof o&&e.push({type:"sampler2D",method:"1i",name:r,value:o,key:i,uniforms:t})}return e},defineVariable:function(t,e){var r,n;if("number"==typeof e)r="float";else if(Array.isArray(e))"number"==typeof e[0]?2<=e.length&&e.length<=4?r="vec"+e.length:(r="float",n=e.length):"string"==typeof e[0]&&(r="sampler2D",n=e.length);else if("boolean"==typeof e)r="bool";else{if("string"!=typeof e)return;r="sampler2D"}var i="";return i+="".concat(r," ").concat(t),n&&(i+="[".concat(n,"]")),i+";\n"},defineUniform:function(t,e){var r=Xo.defineVariable(t,e);if(r)return"uniform "+r},isUniformDefined:function(t,e){var r=new RegExp("uniform[^;]+(?:{[\\s\\S]*})?[^;]*\\b"+t+"\\b","g");return!!e.match(r)},isSymbolReferenced:function(t,e){var r=new RegExp("\\b"+t+"\\b","g");return 0<=e.search(r)},expandVec3:function(t){var e,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(Array.isArray(t)){if(2!==t.length)return t;e=[].concat(Rn(t),[r]).map(parseFloat)}else e=[t,t,t].map(parseFloat);if(e&&e.every(function(t){return"number"==typeof t&&!isNaN(t)}))return e},expandVec4:function(t){var e,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(Array.isArray(t)){if(3!==t.length)return t;e=[].concat(Rn(t),[r]).map(parseFloat)}else e=[t,t,t,r].map(parseFloat);if(e&&e.every(function(t){return"number"==typeof t&&!isNaN(t)}))return e}},Zo=[];function $o(t,e){var r=Zo.filter(function(e){return e[0]===t})[0];return(r=r&&r[1])||(Zo.push([t,{}]),r=Zo[Zo.length-1][1]),r[e]||(r[e]=t.getExtension(e)),r[e]}function Jo(t){var e,r,n=0;if(0===t.length)return n;for(e=0,r=t.length;e<r;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return n}var Qo=a(function(t){var e="(.|[\\r\\n]|\\n)*?\\*\\/\\n?\\n?",r=/(^|[^\S\n])(?:\/\/)([\s\S]+?)$/gm,n=/(^|[^\S\n])(?:\/\/[^!])([\s\S]+?)$/gm,i=t.exports=function(t,e){return t?i.block(i.line(t,e),e):""};i.block=function(t,r){r=r||{};var n=new RegExp("\\/\\*"+e,"gm");return r.safe&&(n=new RegExp("\\/\\*(?!\\*?\\!)"+e,"gm")),t?t.replace(n,""):""},i.line=function(t,e){var i=r;return(e=e||{}).safe&&(i=n),t?t.replace(i,""):""}}),ta=/^\s*#pragma.*$/gm,ea=/\\\s*\n/gm,ra=function(){function t(e,r,n,i,o){if(gn(this,t),o=o||{},this.textureManager=Lo(i),this.gl=e,this.program=null,this.compiled=!1,this.compiling=!1,this.error=null,!t.polyfills[i]){t.polyfills[i]={};try{this.gl.uniformMatrix3fv(null,!1,new Float64Array(9))}catch(e){t.polyfills[i].uniformMatrix3fv=this.gl.uniformMatrix3fv,this.gl.uniformMatrix3fv=function(e,r,n){t.polyfills[i].uniformMatrix3fv.call(this,e,r,new Float32Array(n))}}try{this.gl.uniformMatrix4fv(null,!1,new Float64Array(16))}catch(e){t.polyfills[i].uniformMatrix4fv=this.gl.uniformMatrix4fv,this.gl.uniformMatrix4fv=function(e,r,n){t.polyfills[i].uniformMatrix4fv.call(this,e,r,new Float32Array(n))}}}this.defines=Object.assign({},o.defines||{}),this.blocks=Object.assign({},o.blocks||{}),this.block_scopes=Object.assign({},o.block_scopes||{}),this.extensions=o.extensions||[],this.dependent_uniforms=o.uniforms,this.uniforms={},this.attribs={},this.vertex_source=r,this.fragment_source=n,this.id=t.id++,this.name=o.name}return _n(t,[{key:"destroy",value:function(){this.gl.useProgram(null),this.gl.deleteProgram(this.program),this.program=null,this.uniforms={},this.attribs={},this.compiled=!1}},{key:"use",value:function(){this.compiled&&(t.current!==this&&this.gl.useProgram(this.program),t.current=this)}},{key:"compile",value:function(){var e=this;if(this.compiling)throw new Error("ShaderProgram.compile(): skipping for ".concat(this.id," (").concat(this.name,") because already compiling"));this.compiling=!0,this.compiled=!1,this.error=null,this.computed_vertex_source=this.vertex_source,this.computed_fragment_source=this.fragment_source;var r,n=this.checkExtensions(),i=this.buildDefineList(),o=this.buildShaderBlockList();for(var a in o){var s,u,l,c=o[a];!c||Array.isArray(c)&&0===c.length||(r=new RegExp("^\\s*#pragma\\s+tangram:\\s+"+a+"\\s*$","m"),s=this.computed_vertex_source.match(r),u=this.computed_fragment_source.match(r),null==s&&null==u||(l="",c.forEach(function(t){var e="".concat(t.scope,", ").concat(t.key,", ").concat(t.num);l+="\n// tangram-block-start: ".concat(e,"\n"),l+=t.source,l+="\n// tangram-block-end: ".concat(e,"\n")}),null!=s&&(this.computed_vertex_source=this.computed_vertex_source.replace(r,l)),null!=u&&(this.computed_fragment_source=this.computed_fragment_source.replace(r,l)),i["TANGRAM_BLOCK_"+a.replace(/[\s-]+/g,"_").toUpperCase()]=!0))}this.computed_vertex_source=this.computed_vertex_source.replace(ta,""),this.computed_fragment_source=this.computed_fragment_source.replace(ta,""),this.ensureUniforms(this.dependent_uniforms);var h=this.gl.getShaderPrecisionFormat(this.gl.FRAGMENT_SHADER,this.gl.HIGH_FLOAT),f=h&&0<h.precision?"precision highp float;\n":"precision mediump float;\n";i.TANGRAM_VERTEX_SHADER=!0,i.TANGRAM_FRAGMENT_SHADER=!1,this.computed_vertex_source=f+t.buildDefineString(i)+this.computed_vertex_source,i.TANGRAM_VERTEX_SHADER=!1,i.TANGRAM_FRAGMENT_SHADER=!0,this.computed_fragment_source=t.buildExtensionString(n)+f+t.buildDefineString(i)+this.computed_fragment_source,this.computed_vertex_source=this.computed_vertex_source.replace(ea,""),this.computed_fragment_source=this.computed_fragment_source.replace(ea,"");try{this.program=t.updateProgram(this.gl,this.program,this.computed_vertex_source,this.computed_fragment_source),this.compiled=!0,this.compiling=!1}catch(n){throw this.program=null,this.compiled=!1,this.compiling=!1,"vertex"!==(this.error=n).type&&"fragment"!==n.type||(this.shader_errors=n.errors,this.shader_errors.forEach(function(t){t.type=n.type,t.block=e.block(n.type,t.line)})),n}this.computed_vertex_source=null,this.computed_fragment_source=null,this.use(),this.refreshUniforms(),this.refreshAttributes()}},{key:"buildDefineList",value:function(){var e,r={};for(e in t.defines)r[e]=t.defines[e];for(e in this.defines)r[e]=this.defines[e];return r}},{key:"buildShaderBlockList",value:function(){var e,r,n={};for(e in t.blocks)n[e]=[],Array.isArray(t.blocks[e])?(r=n[e]).push.apply(r,Rn(t.blocks[e].map(function(t,r){return{key:e,source:t,num:r,scope:"ShaderProgram"}}))):n[e]=[{key:e,source:t.blocks[e],num:0,scope:"ShaderProgram"}];for(e in this.blocks)if(n[e]=n[e]||[],Array.isArray(this.blocks[e]))for(var i=this.block_scopes&&this.block_scopes[e]||[],o=null,a=0,s=0;s<this.blocks[e].length;s++)i[s]!==o&&(o=i[s],a=0),n[e].push({key:e,source:this.blocks[e][s],num:a,scope:o||this.name}),a++;else n[e].push({key:e,source:this.blocks[e],num:0,scope:this.name});return n}},{key:"ensureUniforms",value:function(t){if(t){var e,r=Qo(this.computed_vertex_source),n=Qo(this.computed_fragment_source),i=[],o=[];for(var a in t){var s=Xo.isUniformDefined(a,r),u=Xo.isUniformDefined(a,n);if(!s||!u){if(!(e=Xo.defineUniform(a,t[a])))continue;s||(Ei("trace","Program ".concat(this.name,": ").concat(a," not defined in vertex shader, injecting: '").concat(e,"'")),i.push(e)),u||(Ei("trace","Program ".concat(this.name,": ").concat(a," not defined in fragment shader, injecting: '").concat(e,"'")),o.push(e))}}0<i.length&&(this.computed_vertex_source=i.join("\n")+this.computed_vertex_source),0<o.length&&(this.computed_fragment_source=o.join("\n")+this.computed_fragment_source)}}},{key:"setUniforms",value:function(t,e){var r=!(1<arguments.length&&void 0!==e)||e;if(this.compiled){r&&(this.texture_unit=0);for(var n=Xo.parseUniforms(t),i=0;i<n.length;i++){var o=n[i];"sampler2D"===o.type?this.setTextureUniform(o.name,o.value):this.uniform(o.method,o.name,o.value)}}}},{key:"saveUniforms",value:function(t){var e=t||this.uniforms;for(var r in e){var n=this.uniforms[r];n&&(n.saved_value=n.value)}this.saved_texture_unit=this.texture_unit||0}},{key:"restoreUniforms",value:function(t){var e=t||this.uniforms;for(var r in e){var n=this.uniforms[r];n&&n.saved_value&&(n.value=n.saved_value,this.updateUniform(n))}this.texture_unit=this.saved_texture_unit||0}},{key:"setTextureUniform",value:function(t,e){var r=this.textureManager.textures[e];null!=r?(r.bind(this.texture_unit),this.uniform("1i",t,this.texture_unit),this.texture_unit++):Ei("warn","Cannot find texture '".concat(e,"'"))}},{key:"uniform",value:function(t,e,r){var n;this.compiled&&(this.uniforms[e]=this.uniforms[e]||{},(n=this.uniforms[e]).name=e,void 0===n.location&&(n.location=this.gl.getUniformLocation(this.program,e)),n.method=t,n.value=r,this.updateUniform(n))}},{key:"updateUniform",value:function(t){this.compiled&&t&&null!=t.location&&(this.use(),this.commitUniform(t))}},{key:"commitUniform",value:function(t){var e=t.location,r=t.value;switch(t.method){case"1i":this.gl.uniform1i(e,r);break;case"1f":this.gl.uniform1f(e,r);break;case"2f":this.gl.uniform2f(e,r[0],r[1]);break;case"3f":this.gl.uniform3f(e,r[0],r[1],r[2]);break;case"4f":this.gl.uniform4f(e,r[0],r[1],r[2],r[3]);break;case"1iv":this.gl.uniform1iv(e,r);break;case"3iv":this.gl.uniform3iv(e,r);break;case"1fv":this.gl.uniform1fv(e,r);break;case"2fv":this.gl.uniform2fv(e,r);break;case"3fv":this.gl.uniform3fv(e,r);break;case"4fv":this.gl.uniform4fv(e,r);break;case"Matrix3fv":this.gl.uniformMatrix3fv(e,!1,r);break;case"Matrix4fv":this.gl.uniformMatrix4fv(e,!1,r)}}},{key:"refreshUniforms",value:function(){if(this.compiled)for(var t in this.uniforms){var e=this.uniforms[t];e.location=this.gl.getUniformLocation(this.program,t),this.updateUniform(e)}}},{key:"refreshAttributes",value:function(){this.attribs={}}},{key:"attribute",value:function(t){if(this.compiled){var e=this.attribs[t]=this.attribs[t]||{};return null!=e.location?e:(e.name=t,e.location=this.gl.getAttribLocation(this.program,t),e)}}},{key:"source",value:function(t){return"vertex"===t?this.computed_vertex_source:"fragment"===t?this.computed_fragment_source:void 0}},{key:"lines",value:function(t){var e=this.source(t);return e?e.split("\n"):[]}},{key:"line",value:function(t,e){var r=this.lines(t);if(r)return r[e]}},{key:"block",value:function(t,e){for(var r,n=this.lines(t),i=0;i<e&&i<n.length;i++){var o=n[i],a=o.match(/\/\/ tangram-block-start: ([A-Za-z0-9_-]+), ([A-Za-z0-9_-]+), (\d+)/);a&&1<a.length?r={scope:a[1],name:a[2],num:a[3]}:(a=o.match(/\/\/ tangram-block-end: ([A-Za-z0-9_-]+), ([A-Za-z0-9_-]+), (\d+)/))&&1<a.length&&(r=null),r&&(r.line=null==r.line?-1:r.line+1,r.source=o)}return r}},{key:"checkExtensions",value:function(){var t=this,e=[];return this.extensions.forEach(function(r){var n=$o(t.gl,r),i="TANGRAM_EXTENSION_".concat(r);t.defines[i]=null!=n,n?e.push(r):Ei("debug","Could not enable extension '".concat(r,"'"))}),e}}]),t}();ra.polyfills={},ra.id=0,ra.current=null,ra.defines={},ra.blocks={},ra.reset=function(){ra.programs_by_source={},ra.shaders_by_source={}},ra.reset(),ra.buildDefineString=function(t){var e="";for(var r in t)null!=t[r]&&!1!==t[r]&&("boolean"==typeof t[r]&&!0===t[r]?e+="#define "+r+"\n":"number"==typeof t[r]&&Math.floor(t[r])===t[r]?e+="#define "+r+" "+t[r].toFixed(1)+"\n":e+="#define "+r+" "+t[r]+"\n");return e},ra.buildExtensionString=function(t){var e="";return(t=t||[]).forEach(function(t){e+="#ifdef GL_".concat(t,"\n#extension GL_").concat(t," : enable\n#endif\n")}),e},ra.addBlock=function(t){var e;ra.blocks[t]=ra.blocks[t]||[];for(var r=arguments.length,n=new Array(1<r?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];(e=ra.blocks[t]).push.apply(e,n)},ra.removeBlock=function(t){ra.blocks[t]=[]},ra.replaceBlock=function(t){ra.removeBlock(t);for(var e=arguments.length,r=new Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];ra.addBlock.apply(ra,[t].concat(r))},ra.updateProgram=function(t,e,r,n){var i=Jo(t._tangram_id+"::"+r+"::"+n);if(ra.programs_by_source[i])return Ei("trace","Reusing identical source GL program object"),ra.programs_by_source[i];var o=ra.createShader(t,r,t.VERTEX_SHADER),a=ra.createShader(t,n,t.FRAGMENT_SHADER);if(t.useProgram(null),null!=e)for(var s=t.getAttachedShaders(e),u=0;u<s.length;u++)t.detachShader(e,s[u]);else e=t.createProgram();if(null==o||null==a)return e;if(t.attachShader(e,o),t.attachShader(e,a),t.linkProgram(e),t.getProgramParameter(e,t.LINK_STATUS))return ra.programs_by_source[i]=e;var l=new Error("WebGL program error:\n            VALIDATE_STATUS: ".concat(t.getProgramParameter(e,t.VALIDATE_STATUS),"\n            ERROR: ").concat(t.getError(),"\n            --- Vertex Shader ---\n            ").concat(r,"\n            --- Fragment Shader ---\n            ").concat(n));throw Object.assign(new Error(l),{type:"program"})};var na,ia={disabled:!(ra.createShader=function(t,e,r){var n=Jo(t._tangram_id+"::"+e);if(ra.shaders_by_source[n])return Ei("trace","Reusing identical source GL shader object"),ra.shaders_by_source[n];var i=t.createShader(r);if(t.shaderSource(i,e),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS))return ra.shaders_by_source[n]=i;var o=r===t.VERTEX_SHADER?"vertex":"fragment",a=t.getShaderInfoLog(i),s=function(t){t=String(t);for(var e,r=[];e=t.match(/ERROR\:([^\n]+)/);){t=t.slice(e.index+1);var n=e[1].trim().split(":"),i=n.slice(2).join(":").trim(),o=parseInt(n[0],10),a=parseInt(n[1],10);r.push({message:i,file:o,line:a})}return r}(a);throw Object.assign(new Error(a),{type:o,errors:s})}),bound_vao:[],init:function(t){var e;!0!==this.disabled&&(e=$o(t,"OES_vertex_array_object")),null!=e?Ei("info","Vertex Array Object extension available"):!0!==this.disabled?Ei("warn","Vertex Array Object extension NOT available"):Ei("warn","Vertex Array Object extension force disabled")},create:function(t,e,r){var n={};n.setup=e,n.teardown=r;var i=$o(t,"OES_vertex_array_object");return null!=i&&(n._vao=i.createVertexArrayOES(),i.bindVertexArrayOES(n._vao)),n.setup(!0),n},getCurrentBinding:function(t){var e=this.bound_vao.filter(function(e){return e[0]===t})[0];return e&&e[1]},setCurrentBinding:function(t,e){var r=this.bound_vao,n=r.filter(function(e){return e[0]===t})[0];null==n?r.push([t,e]):n[1]=e},bind:function(t,e){var r,n=$o(t,"OES_vertex_array_object");null!=e?null!=n&&null!=e._vao?(n.bindVertexArrayOES(e._vao),this.setCurrentBinding(t,e)):e.setup(!1):(r=this.getCurrentBinding(t),null!=n?n.bindVertexArrayOES(null):null!=r&&"function"==typeof r.teardown&&r.teardown(),this.setCurrentBinding(t,null))},destroy:function(t,e){var r=$o(t,"OES_vertex_array_object");null!=r&&null!=e&&null!=e._vao&&(r.deleteVertexArrayOES(e._vao),e._vao=null)}},oa=function(){function t(e,r,n,i,o,a){gn(this,t),a=a||{},this.textureManager=Lo(o),this.gl=e,this.vertex_data=r,this.element_data=n,this.vertex_layout=i,this.vertex_buffer=this.gl.createBuffer(),this.buffer_size=this.vertex_data.byteLength,this.draw_mode=a.draw_mode||this.gl.TRIANGLES,this.data_usage=a.data_usage||this.gl.STATIC_DRAW,this.vertices_per_geometry=3,this.uniforms=a.uniforms,this.textures=a.textures,this.retain=a.retain||!1,this.created_at=+new Date,this.fade_in_time=a.fade_in_time||0,this.vertex_count=this.vertex_data.byteLength/this.vertex_layout.stride,this.element_count=0,this.vaos={},this.toggle_element_array=!1,this.element_data?(this.toggle_element_array=!0,this.element_count=this.element_data.length,this.geometry_count=this.element_count/this.vertices_per_geometry,this.element_type=this.element_data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT,this.element_buffer=this.gl.createBuffer(),this.buffer_size+=this.element_data.byteLength,this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.element_buffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.element_data,this.data_usage)):this.geometry_count=this.vertex_count/this.vertices_per_geometry,this.upload(),this.retain||(delete this.vertex_data,delete this.element_data),this.valid=!0}return _n(t,[{key:"render",value:function(t){var e=0<arguments.length&&void 0!==t?t:{};if(!this.valid)return!1;var r=e.program||ra.current;r.use(),this.uniforms&&(r.saveUniforms(this.uniforms),r.setUniforms(this.uniforms,!1));var n=(new Date-this.created_at)/1e3;return r.uniform("1f","u_visible_time",n),this.bind(r),this.toggle_element_array?this.gl.drawElements(this.draw_mode,this.element_count,this.element_type,0):this.gl.drawArrays(this.draw_mode,0,this.vertex_count),ia.bind(this.gl,null),this.uniforms&&r.restoreUniforms(this.uniforms),n<this.fade_in_time}},{key:"bind",value:function(t){var e=this,r=this.vaos[t.id];r?ia.bind(this.gl,r):this.vaos[t.id]=ia.create(this.gl,function(r){e.gl.bindBuffer(e.gl.ARRAY_BUFFER,e.vertex_buffer),e.toggle_element_array&&e.gl.bindBuffer(e.gl.ELEMENT_ARRAY_BUFFER,e.element_buffer),e.vertex_layout.enable(e.gl,t,r)})}},{key:"upload",value:function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertex_buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertex_data,this.data_usage)}},{key:"destroy",value:function(){var t=this;if(!this.valid)return!1;for(var e in this.valid=!1,this.vaos)ia.destroy(this.gl,this.vaos[e]);return this.gl.deleteBuffer(this.vertex_buffer),this.vertex_buffer=null,this.element_buffer&&(this.gl.deleteBuffer(this.element_buffer),this.element_buffer=null),delete this.vertex_data,delete this.element_data,this.textures&&this.textures.forEach(function(e){return t.textureManager.release(e)}),!0}}]),t}(),aa=["emission","ambient","diffuse","specular"],sa=function(){function t(e){var r=this;gn(this,t),e=e||{},aa.forEach(function(t){var n=e[t];null!=n&&(n.texture?r[t]={texture:n.texture,mapping:n.mapping||"spheremap",scale:Xo.expandVec3(null!=n.scale?n.scale:1),amount:Xo.expandVec4(null!=n.amount?n.amount:1)}:"number"==typeof n||Array.isArray(n)?r[t]={amount:Xo.expandVec4(n)}:r[t]="string"==typeof n?{amount:yo.parseColor(n)}:n)}),this.specular&&(this.specular.shininess=e.shininess?parseFloat(e.shininess):.2),null!=e.normal&&(this.normal={texture:e.normal.texture,mapping:e.normal.mapping||"triplanar",scale:Xo.expandVec3(null!=e.normal.scale?e.normal.scale:1),amount:null!=e.normal.amount?e.normal.amount:1})}return _n(t,[{key:"inject",value:function(e){var r=this;aa.forEach(function(t){var n="TANGRAM_MATERIAL_".concat(t.toUpperCase()),i=n+"_TEXTURE";e.defines[n]=null!=r[t],r[t]&&r[t].texture&&(e.defines[i]=!0,e.defines[i+"_"+r[t].mapping.toUpperCase()]=!0,e.defines["TANGRAM_MATERIAL_TEXTURE_".concat(r[t].mapping.toUpperCase())]=!0,e.texcoords=e.texcoords||"uv"===r[t].mapping)}),this.normal&&this.normal.texture&&(e.defines.TANGRAM_MATERIAL_NORMAL_TEXTURE=!0,e.defines["TANGRAM_MATERIAL_NORMAL_TEXTURE_"+this.normal.mapping.toUpperCase()]=!0,e.defines["TANGRAM_MATERIAL_TEXTURE_".concat(this.normal.mapping.toUpperCase())]=!0,e.texcoords=e.texcoords||"uv"===this.normal.mapping),e.replaceShaderBlock(t.block,"/*Defines globals:materiallight_accumulator_**/struct Material{\n#ifdef TANGRAM_MATERIAL_EMISSION\nvec4 emission;\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\nvec3 emissionScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT\nvec4 ambient;\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\nvec3 ambientScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nvec4 diffuse;\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\nvec3 diffuseScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nvec4 specular;float shininess;\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\nvec3 specularScale;\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nvec3 normalScale;float normalAmount;\n#endif\n};uniform Material u_material;Material material;\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\nuniform sampler2D u_material_emission_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\nuniform sampler2D u_material_ambient_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\nuniform sampler2D u_material_diffuse_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\nuniform sampler2D u_material_specular_texture;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nuniform sampler2D u_material_normal_texture;\n#endif\nvec4 light_accumulator_ambient=vec4(vec3(0.0),1.);vec4 light_accumulator_diffuse=vec4(vec3(0.0),1.);\n#ifdef TANGRAM_MATERIAL_SPECULAR\nvec4 light_accumulator_specular=vec4(vec3(0.0),1.);\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_SPHEREMAP\nvec4 getSphereMap(in sampler2D _tex,in vec3 _eyeToPoint,in vec3 _normal,in vec2 _skew){vec3 eye=normalize(_eyeToPoint);eye.xy-=_skew;eye=normalize(eye);vec3 r=reflect(eye,_normal);r.z+=1.0;float m=2.*length(r);vec2 uv=r.xy/m+.5;return texture2D(_tex,uv);}\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_TRIPLANAR\nvec3 getTriPlanarBlend(in vec3 _normal){vec3 blending=abs(_normal);blending=normalize(max(blending,0.00001));float b=(blending.x+blending.y+blending.z);return blending/b;}vec4 getTriPlanar(in sampler2D _tex,in vec3 _pos,in vec3 _normal,in vec3 _scale){vec3 blending=getTriPlanarBlend(_normal);vec4 xaxis=texture2D(_tex,fract(_pos.yz*_scale.x));vec4 yaxis=texture2D(_tex,fract(_pos.xz*_scale.y));vec4 zaxis=texture2D(_tex,fract(_pos.xy*_scale.z));return xaxis*blending.x+yaxis*blending.y+zaxis*blending.z;}\n#endif\n#ifdef TANGRAM_MATERIAL_TEXTURE_PLANAR\nvec4 getPlanar(in sampler2D _tex,in vec3 _pos,in vec2 _scale){return texture2D(_tex,fract(_pos.xy*_scale.x));}\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE\nvoid calculateNormal(inout vec3 _normal){\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_UV\n_normal+=texture2D(u_material_normal_texture,fract(v_texcoord*material.normalScale.xy)).rgb*2.0-1.0;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_PLANAR\nvec3 normalTex=getPlanar(u_material_normal_texture,v_world_position.xyz,material.normalScale.xy).rgb*2.0-1.0;_normal+=normalTex;\n#endif\n#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_TRIPLANAR\nvec3 normalTex=getTriPlanar(u_material_normal_texture,v_world_position.xyz,_normal,material.normalScale).rgb*2.0-1.0;_normal+=normalTex;\n#endif\n_normal=normalize(_normal);}\n#endif\nvoid calculateMaterial(in vec3 _eyeToPoint,inout vec3 _normal){\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_UV\nmaterial.emission*=texture2D(u_material_emission_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_PLANAR\nmaterial.emission*=getPlanar(u_material_emission_texture,v_world_position.xyz,material.emissionScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_TRIPLANAR\nmaterial.emission*=getTriPlanar(u_material_emission_texture,v_world_position.xyz,_normal,material.emissionScale);\n#endif\n#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_SPHEREMAP\nmaterial.emission*=getSphereMap(u_material_emission_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_UV\nmaterial.ambient*=texture2D(u_material_ambient_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_PLANAR\nmaterial.ambient*=getPlanar(u_material_ambient_texture,v_world_position.xyz,material.ambientScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_TRIPLANAR\nmaterial.ambient*=getTriPlanar(u_material_ambient_texture,v_world_position.xyz,_normal,material.ambientScale);\n#endif\n#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_SPHEREMAP\nmaterial.ambient*=getSphereMap(u_material_ambient_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_UV\nmaterial.diffuse*=texture2D(u_material_diffuse_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_PLANAR\nmaterial.diffuse*=getPlanar(u_material_diffuse_texture,v_world_position.xyz,material.diffuseScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_TRIPLANAR\nmaterial.diffuse*=getTriPlanar(u_material_diffuse_texture,v_world_position.xyz,_normal,material.diffuseScale);\n#endif\n#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_SPHEREMAP\nmaterial.diffuse*=getSphereMap(u_material_diffuse_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_UV\nmaterial.specular*=texture2D(u_material_specular_texture,v_texcoord);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_PLANAR\nmaterial.specular*=getPlanar(u_material_specular_texture,v_world_position.xyz,material.specularScale.xy);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_TRIPLANAR\nmaterial.specular*=getTriPlanar(u_material_specular_texture,v_world_position.xyz,_normal,material.specularScale);\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_SPHEREMAP\nmaterial.specular*=getSphereMap(u_material_specular_texture,_eyeToPoint,_normal,u_center_offset);\n#endif\n#endif\n}","Material"),e.addShaderBlock("setup","\nmaterial = u_material;\n","Material")}},{key:"setupProgram",value:function(t){var e=this;aa.forEach(function(r){e[r]&&(e[r].texture?(t.setTextureUniform("u_material_".concat(r,"_texture"),e[r].texture),t.uniform("3fv","u_material.".concat(r,"Scale"),e[r].scale),t.uniform("4fv","u_material.".concat(r),e[r].amount)):e[r].amount&&t.uniform("4fv","u_material.".concat(r),e[r].amount))}),this.specular&&t.uniform("1f","u_material.shininess",this.specular.shininess),this.normal&&this.normal.texture&&(t.setTextureUniform("u_material_normal_texture",this.normal.texture),t.uniform("3fv","u_material.normalScale",this.normal.scale),t.uniform("1f","u_material.normalAmount",this.normal.amount))}}],[{key:"isValid",value:function(t){return null!=t&&(null!=t.emission||null!=t.ambient||null!=t.diffuse||null!=t.specular)}}]),t}();sa.block="material";var ua=na={};na.copy=function(t){for(var e=[],r=t.length,n=0;n<r;n++)e[n]=t[n];return e},na.neg=function(t){for(var e=[],r=t.length,n=0;n<r;n++)e[n]=-t[n];return e},na.add=function(t,e){for(var r=[],n=Math.min(t.length,e.length),i=0;i<n;i++)r[i]=t[i]+e[i];return r},na.sub=function(t,e){for(var r=[],n=Math.min(t.length,e.length),i=0;i<n;i++)r[i]=t[i]-e[i];return r},na.signed_area=function(t,e,r){return(e[0]-t[0])*(r[1]-t[1])-(r[0]-t[0])*(e[1]-t[1])},na.mult=function(t,e){var r,n=[],i=t.length;if("number"==typeof e)for(r=0;r<i;r++)n[r]=t[r]*e;else for(i=Math.min(t.length,e.length),r=0;r<i;r++)n[r]=t[r]*e[r];return n},na.multMatrix=function(t,e){return[t[0][0]*e[0]+t[0][1]*e[1],t[1][0]*e[0]+t[1][1]*e[1]]},na.div=function(t,e){var r=[];if("number"==typeof e)for(i=0;i<t.length;i++)r[i]=t[i]/e;else for(var n=Math.min(t.length,e.length),i=0;i<n;i++)r[i]=t[i]/e[i];return r},na.perp=function(t,e){return[e[1]-t[1],t[0]-e[0]]},na.rot=function(t,e){var r=Math.cos(e),n=Math.sin(e);return[t[0]*r-t[1]*n,t[0]*n+t[1]*r]},na.angle=function(t){var e=Cn(t,2),r=e[0],n=e[1];return Math.atan2(n,r)},na.angleBetween=function(t,e){var r=na.dot(na.normalize(na.copy(t)),na.normalize(na.copy(e)));return 1<r&&(r=1),Math.acos(r)},na.signedAngleBetween=function(t,e){return Math.atan2(t[0]*e[1]-t[1]*e[0],t[0]*e[0]+t[1]*e[1])},na.isEqual=function(t,e){for(var r=t.length,n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0},na.lengthSq=function(t){return 2===t.length?t[0]*t[0]+t[1]*t[1]:3<=t.length?t[0]*t[0]+t[1]*t[1]+t[2]*t[2]:0},na.length=function(t){return Math.sqrt(na.lengthSq(t))},na.normalize=function(t){var e;if(2===t.length){if(1==(e=t[0]*t[0]+t[1]*t[1]))return t;0!==(e=Math.sqrt(e))?(t[0]/=e,t[1]/=e):(t[0]=0,t[1]=0)}else if(3<=t.length){if(1==(e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2]))return t;0!==(e=Math.sqrt(e))?(t[0]/=e,t[1]/=e,t[2]/=e):(t[0]=0,t[1]=0,t[2]=0)}return t},na.cross=function(t,e){return 2===t.length?t[0]*e[1]-t[1]*e[0]:3===t.length?[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]:void 0},na.dot=function(t,e){for(var r=0,n=Math.min(t.length,e.length),i=0;i<n;i++)r+=t[i]*e[i];return r};var la=function(){function t(e,r){gn(this,t),this.name=r.name,this.view=e,null==r.ambient||"number"==typeof r.ambient?this.ambient=Xo.expandVec3(r.ambient||0):this.ambient=yo.parseColor(r.ambient).slice(0,3),null==r.diffuse||"number"==typeof r.diffuse?this.diffuse=Xo.expandVec3(null!=r.diffuse?r.diffuse:1):this.diffuse=yo.parseColor(r.diffuse).slice(0,3),null==r.specular||"number"==typeof r.specular?this.specular=Xo.expandVec3(r.specular||0):this.specular=yo.parseColor(r.specular).slice(0,3)}return _n(t,[{key:"inject",value:function(){var e="\n            uniform ".concat(this.struct_name," u_").concat(this.name,";\n            ").concat(this.struct_name," ").concat(this.name,";\n            "),r="\n            ".concat(this.name," = u_").concat(this.name,";\n\n        ");ra.addBlock(t.block,e),ra.addBlock("setup",r)}},{key:"update",value:function(){}},{key:"setupProgram",value:function(t){t.uniform("3fv","u_".concat(this.name,".ambient"),this.ambient),t.uniform("3fv","u_".concat(this.name,".diffuse"),this.diffuse),t.uniform("3fv","u_".concat(this.name,".specular"),this.specular)}}],[{key:"create",value:function(e,r){if(t.types[r.type])return new t.types[r.type](e,r)}},{key:"setMode",value:function(e,r){!0===e&&(e="fragment"),e=t.enabled&&(null!=e?e:"fragment"),r.defines.TANGRAM_LIGHTING_FRAGMENT="fragment"===e,r.defines.TANGRAM_LIGHTING_VERTEX="vertex"===e}},{key:"inject",value:function(e){if(ra.removeBlock(t.block),t.enabled){var r="";if(e&&0<Object.keys(e).length){var n={};for(var i in e)n[e[i].type]=!0;for(var o in n)t.types[o].inject();for(var a in e)e[a].inject(),r+="calculateLight(".concat(a,", _eyeToPoint, _normal);\n")}var s="\n            vec4 calculateLighting(in vec3 _eyeToPoint, in vec3 _normal, in vec4 _color) {\n\n                // Do initial material calculations over normal, emission, ambient, diffuse and specular values\n                calculateMaterial(_eyeToPoint,_normal);\n\n                // Un roll the loop of individual ligths to calculate\n                ".concat(r,"\n\n                //  Final light intensity calculation\n                vec4 color = vec4(vec3(0.), _color.a); // start with vertex color alpha\n\n                #ifdef TANGRAM_MATERIAL_EMISSION\n                    color.rgb = material.emission.rgb;\n                    color.a *= material.emission.a;\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_AMBIENT\n                    color.rgb += light_accumulator_ambient.rgb * _color.rgb * material.ambient.rgb;\n                    color.a *= material.ambient.a;\n                #else\n                    #ifdef TANGRAM_MATERIAL_DIFFUSE\n                        color.rgb += light_accumulator_ambient.rgb * _color.rgb * material.diffuse.rgb;\n                    #endif\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_DIFFUSE\n                    color.rgb += light_accumulator_diffuse.rgb * _color.rgb * material.diffuse.rgb;\n                    color.a *= material.diffuse.a;\n                #endif\n\n                #ifdef TANGRAM_MATERIAL_SPECULAR\n                    color.rgb += light_accumulator_specular.rgb * material.specular.rgb;\n                    color.a *= material.specular.a;\n                #endif\n\n                // Clamp final color\n                color = clamp(color, 0.0, 1.0);\n\n                return color;\n            }");ra.addBlock(t.block,s)}}}]),t}();la.types={},la.block="lighting",la.enabled=!0;var ca=function(){En(e,la);var t=In(e);function e(r,n){var i;return gn(this,e),(i=t.call(this,r,n)).type="ambient",i.struct_name="AmbientLight",i}return _n(e,[{key:"setupProgram",value:function(t){t.uniform("3fv","u_".concat(this.name,".ambient"),this.ambient)}}],[{key:"inject",value:function(){ra.addBlock(la.block,"/*Expected globals:light_accumulator_**/struct AmbientLight{vec3 ambient;};void calculateLight(in AmbientLight _light,in vec3 _eyeToPoint,in vec3 _normal){light_accumulator_ambient.rgb+=_light.ambient;}")}}]),e}();la.types.ambient=ca;var ha=function(){En(e,la);var t=In(e);function e(r,n){var i,o;return gn(this,e),(i=t.call(this,r,n)).type="directional",i.struct_name="DirectionalLight",n.direction?i._direction=n.direction:(o=Math.sin(60*Math.PI/180),i._direction=[Math.cos(135*Math.PI/180)*o,Math.sin(135*Math.PI/180)*o,-.5]),null==n.ambient&&(i.ambient=Xo.expandVec3(.5)),i.direction=i._direction.map(parseFloat),i._initial_direction=[i.direction[0],i.direction[1],i.direction[2]],i}return _n(e,[{key:"update",value:function(){Po(this.direction,this._initial_direction,this.view.lookAtManipulator.getTransformationMatrix())}},{key:"setupProgram",value:function(t){Ln(Tn(e.prototype),"setupProgram",this).call(this,t),t.uniform("3fv","u_".concat(this.name,".direction"),this.direction)}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction=ua.normalize(ua.copy(t))}}],[{key:"inject",value:function(){ra.addBlock(la.block,"/*Expected globals:materiallight_accumulator_**/struct DirectionalLight{vec3 ambient;vec3 diffuse;vec3 specular;vec3 direction;};void calculateLight(in DirectionalLight _light,in vec3 _eyeToPoint,in vec3 _normal){light_accumulator_ambient.rgb+=_light.ambient;float nDotVP=clamp(dot(_normal,-_light.direction),0.0,1.0);\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(_light.direction,_normal);float eyeDotR=max(dot(normalize(_eyeToPoint),reflectVector),0.0);pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf;\n#endif\n}")}}]),e}();la.types.directional=ha;var fa=function(){En(e,la);var t=In(e);function e(r,n){var i;return gn(this,e),(i=t.call(this,r,n)).type="point",i.struct_name="PointLight",i.position=n.position||[0,0,"100px"],i.position_eye=[],i.origin=n.origin||"ground",i.attenuation=isNaN(parseFloat(n.attenuation))?0:parseFloat(n.attenuation),n.radius?Array.isArray(n.radius)&&2===n.radius.length?i.radius=n.radius:i.radius=[null,n.radius]:i.radius=null,i}return _n(e,[{key:"inject",value:function(){Ln(Tn(e.prototype),"inject",this).call(this),ra.defines.TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT=0!==this.attenuation,ra.defines.TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS=null!=this.radius&&null!=this.radius[0],ra.defines.TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS=null!=this.radius}},{key:"update",value:function(){var t,e,r,n=this.view.lookAtManipulator.getLookAtData().zoom;"world"===this.origin?(e=(t=Cn(Qn.latLngToMeters(this.position),2))[0],r=t[1],this.position_eye[0]=e-this.view.lookAtManipulator.getLookAtData().position[0],this.position_eye[1]=r-this.view.lookAtManipulator.getLookAtData().position[1],this.position_eye[2]=yo.convertUnits(this.position[2],{zoom:n,meters_per_pixel:Qn.metersPerPixel(n)}),this.position_eye[2]=this.position_eye[2]-this.view.lookAtManipulator.getLookAtData().distance):"ground"!==this.origin&&"camera"!==this.origin||(this.position_eye=yo.convertUnits(this.position,{zoom:n,meters_per_pixel:Qn.metersPerPixel(n)}),"ground"===this.origin&&(this.position_eye[2]=this.position_eye[2]-this.view.lookAtManipulator.getLookAtData().distance)),this.position_eye[3]=1}},{key:"setupProgram",value:function(t){Ln(Tn(e.prototype),"setupProgram",this).call(this,t),t.uniform("4fv","u_".concat(this.name,".position"),this.position_eye),ra.defines.TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT&&t.uniform("1f","u_".concat(this.name,".attenuationExponent"),this.attenuation);var r=this.view.lookAtManipulator.getLookAtData().zoom;ra.defines.TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS&&t.uniform("1f","u_".concat(this.name,".innerRadius"),yo.convertUnits(this.radius[0],{zoom:r,meters_per_pixel:Qn.metersPerPixel(r)})),ra.defines.TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS&&t.uniform("1f","u_".concat(this.name,".outerRadius"),yo.convertUnits(this.radius[1],{zoom:r,meters_per_pixel:Qn.metersPerPixel(r)}))}}],[{key:"inject",value:function(){ra.addBlock(la.block,"/*Expected globals:materiallight_accumulator_**/struct PointLight{vec3 ambient;vec3 diffuse;vec3 specular;vec4 position;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat attenuationExponent;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nfloat innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat outerRadius;\n#endif\n};void calculateLight(in PointLight _light,in vec3 _eyeToPoint,in vec3 _normal){float dist=length(_light.position.xyz-_eyeToPoint);vec3 VP=(_light.position.xyz-_eyeToPoint)/dist;float nDotVP=clamp(dot(VP,_normal),0.0,1.0);float attenuation=1.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat Rin=1.0;float e=_light.attenuationExponent;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-(pow(d,e));\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/(pow(d,e)),0.0,1.0);\n#endif\n#else\nfloat Rin=0.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-d*d;\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/d,0.0,1.0);\n#endif\n#else\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat d=clamp(dist/_light.outerRadius,0.0,1.0);attenuation=1.0-d*d;\n#else\nattenuation=1.0;\n#endif\n#endif\n#endif\nlight_accumulator_ambient.rgb+=_light.ambient*attenuation;\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP*attenuation;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(-VP,_normal);float eyeDotR=max(0.0,dot(-normalize(_eyeToPoint),reflectVector));pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf*attenuation;\n#endif\n}")}}]),e}();la.types.point=fa;var pa=function(){En(e,fa);var t=In(e);function e(r,n){var i;return gn(this,e),(i=t.call(this,r,n)).type="spotlight",i.struct_name="SpotLight",i.direction=i._direction=(n.direction||[0,0,-1]).map(parseFloat),i._initial_direction=[i.direction[0],i.direction[1],i.direction[2]],i.exponent=n.exponent?parseFloat(n.exponent):.2,i.angle=n.angle?parseFloat(n.angle):20,i}return _n(e,[{key:"setupProgram",value:function(t){Ln(Tn(e.prototype),"setupProgram",this).call(this,t),t.uniform("3fv","u_".concat(this.name,".direction"),this.direction),t.uniform("1f","u_".concat(this.name,".spotCosCutoff"),Math.cos(3.14159*this.angle/180)),t.uniform("1f","u_".concat(this.name,".spotExponent"),this.exponent)}},{key:"update",value:function(){Ln(Tn(e.prototype),"update",this).call(this),Po(this.direction,this._initial_direction,this.view.lookAtManipulator.getTransformationMatrix())}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction=ua.normalize(ua.copy(t))}}],[{key:"inject",value:function(){ra.addBlock(la.block,"/*Expected globals:materiallight_accumulator_**/struct SpotLight{vec3 ambient;vec3 diffuse;vec3 specular;vec4 position;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat attenuationExponent;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nfloat innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat outerRadius;\n#endif\nvec3 direction;float spotCosCutoff;float spotExponent;};void calculateLight(in SpotLight _light,in vec3 _eyeToPoint,in vec3 _normal){float dist=length(_light.position.xyz-_eyeToPoint);vec3 VP=(_light.position.xyz-_eyeToPoint)/dist;float nDotVP=clamp(dot(_normal,VP),0.0,1.0);float attenuation=1.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT\nfloat Rin=1.0;float e=_light.attenuationExponent;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#endif\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-(pow(d,e));\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/(pow(d,e)),0.0,1.0);\n#endif\n#else\nfloat Rin=0.0;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS\nRin=_light.innerRadius;\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-d*d;\n#else\nfloat d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/d,0.0,1.0);\n#endif\n#else\n#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS\nfloat d=clamp(dist/_light.outerRadius,0.0,1.0);attenuation=1.0-d*d;\n#else\nattenuation=1.0;\n#endif\n#endif\n#endif\nfloat spotAttenuation=0.0;float spotDot=clamp(dot(-VP,_light.direction),0.0,1.0);if(spotDot>=_light.spotCosCutoff){spotAttenuation=pow(spotDot,_light.spotExponent);}light_accumulator_ambient.rgb+=_light.ambient*attenuation*spotAttenuation;\n#ifdef TANGRAM_MATERIAL_DIFFUSE\nlight_accumulator_diffuse.rgb+=_light.diffuse*nDotVP*attenuation*spotAttenuation;\n#endif\n#ifdef TANGRAM_MATERIAL_SPECULAR\nfloat pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(-VP,_normal);float eyeDotR=max(dot(-normalize(_eyeToPoint),reflectVector),0.0);pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf*attenuation*spotAttenuation;\n#endif\n}")}}]),e}();function da(t){for(var e=0;e<(arguments.length<=1?0:arguments.length-1);e++){var r=e+1<1||arguments.length<=e+1?void 0:arguments[e+1];if(r)for(var n in r){var i=r[n];null===i||"object"!==yn(i)||Array.isArray(i)?void 0!==i&&(t[n]=i):null===t[n]||"object"!==yn(t[n])||Array.isArray(t[n])?t[n]=da({},i):t[n]=da(t[n],i)}}return t}la.types.spotlight=pa;var va="#ifdef TANGRAM_FRAGMENT_SHADER\nuniform sampler2D u_raster;uniform vec3 u_raster_offset;\n#define sampleRaster() (texture2D(u_raster, v_modelpos_base_zoom.xy * u_raster_offset.z + u_raster_offset.xy))\n#endif\n",ya={init:function(t){var e=0<arguments.length&&void 0!==t?t:{},r=e.generation,n=e.styles,i=e.sources,o=void 0===i?{}:i,a=e.introspection,s=e.id,u=void 0!==s?s+"/":"";this.scene_id=s,this.textureManager=Lo(s),this.main_thread_target="".concat(u,"Style/").concat(this.name),this.setGeneration(r),this.styles=n,this.sources=o,this.defines=this.hasOwnProperty("defines")&&this.defines||{},this.shaders=this.hasOwnProperty("shaders")&&this.shaders||{},this.introspection=a||!1,this.selection=this.selection||this.introspection||!1,this.compile_setup=!1,this.program=null,this.selection_program=null,this.feature_style={},this.vertex_template=[],this.tile_data={},this.defines.TANGRAM_WORLD_POSITION_WRAP=1e5,this.blend=this.blend||"opaque",this.defines["TANGRAM_BLEND_".concat(this.blend.toUpperCase())]=!0,null==this.blend_order&&(this.blend_order=-1),this.removeShaderBlock("setup"),this.material instanceof sa||(sa.isValid(this.material)||(this.material=yo.defaults.material),this.material=new sa(this.material)),this.material.inject(this),la.setMode(this.lighting,this),this.setupRasters(),this.initialized=!0},destroy:function(){this.program&&(this.program.destroy(),this.program=null),this.selection_program&&(this.selection_program.destroy(),this.selection_program=null),li.removeTarget(this.main_thread_target),this.gl=null,this.initialized=!1},reset:function(){},baseStyle:function(){return this.base||this.name},setGeneration:function(t){this.generation=t,ui.is_main&&li.addTarget(this.main_thread_target,this)},fillVertexTemplate:function(t,e,r,n){var i=n.size,o=void 0===(o=n.offset)?0:o,a=t.index[e];if(void 0!==a)for(var s=0;s<i;++s){var u=r.length>s?r[s]:r;this.vertex_template[a+s+o]=u}else Ei("warn","Style: in style '".concat(this.name,"', no index found in vertex layout for attribute '").concat(e,"'"))},startData:function(t){this.tile_data[t.id]=this.tile_data[t.id]||{meshes:{},uniforms:{},textures:[]}},endData:function(t){var e=this.tile_data[t.id];if(this.tile_data[t.id]=null,e&&0<Object.keys(e.meshes).length){for(var r in e.meshes){var n=e.meshes[r];0!==n.vertex_data.vertex_count?(n.vertex_data.end(),n.vertex_elements=n.vertex_data.element_buffer,n.vertex_data=n.vertex_data.vertex_buffer):delete e.meshes[r]}return t.mesh_data[this.name]=e,this.buildRasterTextures(t,e).then(function(t){return t})}return Promise.resolve(null)},hasDataForTile:function(t){return null!=this.tile_data[t.id]},getTileMesh:function(t,e){var r=this.tile_data[t.id].meshes;return null==r[e.key]&&(r[e.key]={variant:e,vertex_data:this.vertexLayoutForMeshVariant(e).createVertexData()}),r[e.key]},vertexLayoutForMeshVariant:function(){return this.vertex_layout},default_mesh_variant:{key:0},style_mesh_variants:{default:{variants:{0:{variant:{key:0},times_unref:0}}}},addMeshVariantForDraw:function(t,e){this.style_mesh_variants[t]||(this.style_mesh_variants[t]={variants:{}});var r=this.computeVariantForDraw(e);return this.style_mesh_variants[t].variants[r.key]={variant:r,times_unref:0},this.style_mesh_variants[t].variants[r.key].variant},getMeshVariantTypeForDraw:function(t){return this.getMeshVariantType(this.base,t)},getMeshVariantType:function(t,e){void 0===t&&(t="default");var r=this.style_mesh_variants[t];if(void 0===e.variantKey||!r||!r.variants[e.variantKey])return this.addMeshVariantForDraw(t,e);var n=e.variantKey,i=r.variants[n];return i.times_unref=0,i.variant},updateMeshVariantTypeCache:function(t){for(var e in this.style_mesh_variants){var r=this.style_mesh_variants[e].variants;for(var n in r){var i=r[n];i.times_unref++,i.times_unref>t&&("default"!==e||0!=+n)&&(delete r[n],0===Object.keys(r).length&&delete this.style_mesh_variants[e])}}},computeVariantForDraw:function(){return this.default_mesh_variant},addFeature:function(t,e,r){var n=r.tile;this.tile_data[n.id]||this.startData(n);var i,o,a,s,u=this.parseFeature(t,e,r);u&&(i="lines"===this.base?this.getMeshVariantTypeForDraw(e):this.getMeshVariantTypeForDraw(u),a=(o=this.getTileMesh(n,i)).vertex_data.offset,s=o.vertex_data.vertex_count,0<this.buildGeometry(t.geometry,u,o,r)?t.generation=this.generation:o.vertex_data.vertex_count>s&&(o.vertex_data.vertex_buffer.fill(0,a,o.vertex_data.offset),o.vertex_data.vertex_count=s,o.vertex_data.offset=a))},buildGeometry:function(t,e,r,n){var i;return"Polygon"===t.type?i=this.buildPolygons([t.coordinates],e,r,n):"MultiPolygon"===t.type?i=this.buildPolygons(t.coordinates,e,r,n):"LineString"===t.type?i=this.buildLines([t.coordinates],e,r,n):"MultiLineString"===t.type?i=this.buildLines(t.coordinates,e,r,n):"Point"===t.type?i=this.buildPoints([t.coordinates],e,r,n):"MultiPoint"===t.type&&(i=this.buildPoints(t.coordinates,e,r,n)),i},parseFeature:function(t,e,r){try{var n,i,o,a=this.feature_style;if(a.order=this.parseOrder(e.order,r),null==a.order&&"overlay"!==this.blend){var s="Layer '".concat(e.layers.join(", "),"', draw group '").concat(e.group,"': ");return s+="'order' parameter is required unless blend mode is 'overlay'",null!=e.order&&(s+="; 'order' was set to a dynamic value (e.g. string tied to feature property, ",s+="or JS function), but evaluated to null for one or more features"),void Ei({level:"warn",once:!0},s)}if(!(a=this._parseFeature(t,e,r)))return;return this.selection?a.interactive=yo.evalProperty(this.introspection||e.interactive,r):a.interactive=!1,!0===a.interactive?(i=(n=Ko.makeEntry()).color,o=n.key,a.selection_color=i,r.tile.selection_data||(r.tile.selection_data={}),r.tile.selection_data[o]={id:t.id||o,properties:t.properties,source_name:r.source,source_layer:r.layer,layers:r.layers}):a.selection_color=Ko.defaultColor,a}catch(e){Ei("error","Style.parseFeature: style parsing error",t,a,e.stack)}},_parseFeature:function(){return this.feature_style},preprocess:function(t,e){if(!t.preprocessed){if(this.draw)for(var r in this.draw){var n=this.draw[r];"object"!==yn(n)||Array.isArray(n)?null==t[r]&&(t[r]=n):t[r]=da({},n,t[r])}var i=e||"";if(!(t=this._preprocess(t,i)))return;t.preprocessed=!0}return t},_preprocess:function(t){return t},parseOrder:function(t,e){return"number"!=typeof t?yo.calculateOrder(t,e):t},scaleOrder:function(t){return 2*t},parseColor:function(t,e){return t?yo.evalCachedColorProperty(t,e):this.shaders.blocks.color||this.shaders.blocks.filter?yo.defaults.color:void 0},buildPolygons:function(){return 0},buildLines:function(){return 0},buildPoints:function(){return 0},setGL:function(t){this.gl=t,this.max_texture_size=this.textureManager.getMaxTextureSize(this.gl)},makeMesh:function(t,e,r){var n=2<arguments.length&&void 0!==r?r:{},i=this.vertexLayoutForMeshVariant(n.variant);return new oa(this.gl,t,e,i,this.scene_id,n)},render:function(t){return t.render()},getProgram:function(t){var e=0<arguments.length&&void 0!==t?t:"program";this.compileSetup();var r=this[e];if(r&&!r.error){if(!r.compiled)try{r.compile()}catch(t){Ei("error","Style: error compiling program for style '".concat(this.name,"' (program key '").concat(e,"')"),this,t.stack)}return r}},compileSetup:function(){if(!this.compile_setup){if(!this.gl)throw new Error("style.compile(): skipping for ".concat(this.name," because no GL context"));var t,e=this.buildDefineList();this.selection&&((t=Object.assign({},e)).TANGRAM_FEATURE_SELECTION=!0);var r=this.shaders&&this.shaders.blocks,n=this.shaders&&this.shaders.block_scopes,i=Object.assign({},this.shaders&&this.shaders.uniforms);for(var o in i)null==i[o]&&Ei({level:"warn",once:!0},"Style '".concat(this.name,"' has invalid uniform '").concat(o,"': uniform values must be non-null"));var a=this.shaders&&this.shaders.extensions;"string"==typeof a&&(a=[a]),this.program=new ra(this.gl,this.vertex_shader_src,this.fragment_shader_src,this.scene_id,{name:this.name,defines:e,uniforms:i,blocks:r,block_scopes:n,extensions:a}),this.selection?this.selection_program=new ra(this.gl,this.vertex_shader_src,this.crop_by_tile?"\n#pragma tangram: utils\n#ifdef TANGRAM_FEATURE_SELECTION\nuniform float u_meters_per_pixel;varying vec4 v_selection_color;varying vec4 v_local_space_position;\n#endif\nvoid main(void){\n#ifdef TANGRAM_FEATURE_SELECTION\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}else{gl_FragColor=v_selection_color;}\n#else\ngl_FragColor=vec4(0.,0.,0.,1.);\n#endif\n}":"\n#ifdef TANGRAM_FEATURE_SELECTION\nvarying vec4 v_selection_color;\n#endif\nvoid main(void){\n#ifdef TANGRAM_FEATURE_SELECTION\ngl_FragColor=v_selection_color;\n#else\ngl_FragColor=vec4(0.,0.,0.,1.);\n#endif\n}",this.scene_id,{name:this.name+" (selection)",defines:t,uniforms:i,blocks:r,block_scopes:n,extensions:a}):this.selection_program=null,this.compile_setup=!0}},addShaderBlock:function(t,e,r){var n=2<arguments.length&&void 0!==r?r:null;this.shaders.blocks=this.shaders.blocks||{},this.shaders.blocks[t]=this.shaders.blocks[t]||[],this.shaders.blocks[t].push(e),this.shaders.block_scopes=this.shaders.block_scopes||{},this.shaders.block_scopes[t]=this.shaders.block_scopes[t]||[],this.shaders.block_scopes[t].push(n)},removeShaderBlock:function(t){this.shaders.blocks&&(this.shaders.blocks[t]=null)},replaceShaderBlock:function(t,e,r){var n=2<arguments.length&&void 0!==r?r:null;this.removeShaderBlock(t),this.addShaderBlock(t,e,n)},buildDefineList:function(){var t={};if(null!=this.defines)for(var e in this.defines)t[e]=this.defines[e];if(null!=this.shaders&&null!=this.shaders.defines)for(e in this.shaders.defines)t[e]=this.shaders.defines[e];return t},hasRasters:function(){return-1<["color","normal","custom"].indexOf(this.raster)},setupRasters:function(){if(!ui.is_main)return!1;if(!this.hasRasters())return!1;"color"===this.raster?this.defines.TANGRAM_RASTER_TEXTURE_COLOR=!0:"normal"===this.raster&&(this.defines.TANGRAM_RASTER_TEXTURE_NORMAL=!0);var t=!1;for(var e in this.sources)if(this.sources[e]instanceof xa){t=!0;break}return!!t&&(this.defines.TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING=!0,this.replaceShaderBlock("raster",va,"Raster"),!0)},buildRasterTextures:function(t,e){var r=this;if(!this.hasRasters())return Promise.resolve(e);var n={};return t.rasters.map(function(t){return r.sources[t]}).filter(function(t){return t}).forEach(function(e,r){var i;e instanceof xa&&(i=e.tileTexture(t),n[i.url]=i)}),0===Object.keys(n).length?Promise.resolve(e):li.postMessage(this.main_thread_target+".loadTextures",n).then(function(r){if(!r||r.length<1)return Ei("trace","Missing texture info for tile ".concat(t.key)),null;if(r.some(function(t){return!t.loaded}))return null;e.uniforms=e.uniforms||{},e.textures=e.textures||[];var i,o,a=r[0].name,s=n[a].coords;return e.uniforms.u_raster=a,e.textures.push(a),t.coords.z>s.z?(i=t.coords.z-s.z,o=Math.pow(2,i),e.uniforms.u_raster_offset=[(t.coords.x%o+o)%o/o,(o-1-t.coords.y%o)/o,1/o]):e.uniforms.u_raster_offset=[0,0,1],e})},loadTextures:function(t){var e=this;return this.textureManager.createFromObject(this.gl,t).then(function(){return Promise.all(Object.keys(t).map(function(t){return e.textureManager.textures[t]&&e.textureManager.textures[t].load()}).filter(function(t){return t}))}).then(function(t){return t.forEach(function(t){return t.retain()}),t.map(function(t){return{name:t.name,width:t.width,height:t.height,loaded:t.loaded}})})},setup:function(){this.setUniforms(),this.material.setupProgram(ra.current)},setUniforms:function(){var t=ra.current;t&&t.setUniforms(this.shaders&&this.shaders.uniforms,!0)},render_states:{opaque:{depth_test:!0,depth_write:!0},translucent:{depth_test:!0,depth_write:!0},add:{depth_test:!0,depth_write:!1},multiply:{depth_test:!0,depth_write:!1},inlay:{depth_test:!0,depth_write:!1},overlay:{depth_test:!1,depth_write:!1}},default_blend_orders:{opaque:0,add:1,multiply:2,inlay:3,translucent:4,overlay:5},sortByBlendOrderWithinLayers:function(t){var e=[],r={};for(var n in t.forEach(function(t){var e=parseInt(t.name,10)||0;r[e]||(r[e]=[]),r[e].push(t)}),r)e.push.apply(e,Rn(r[n].sort(ya.blendOrderSort)));return e},blendOrderSort:function(t,e){return"opaque"===t.blend||"opaque"===e.blend?"opaque"===t.blend&&"opaque"===e.blend?t.name<e.name?-1:1:"opaque"===t.blend?-1:1:t.blend_order<e.blend_order||!(t.blend_order>e.blend_order)&&(ya.default_blend_orders[t.blend]<ya.default_blend_orders[e.blend]||!(ya.default_blend_orders[t.blend]>ya.default_blend_orders[e.blend])&&t.name<e.name)?-1:1}},ga=0,ma=0,_a=function(){function t(e){var r=e.coords,n=e.style_zoom,i=e.source,o=e.worker,a=e.view,s=e.sceneId;gn(this,t),this.textureManager=Lo(s),this.id=ga++,this.worker=o,this.view=a,this.source=i,this.generation=null,this.valid=!0,this.proxy_for=null,this.proxy_depth=0,this.proxied_as=null,this.fade_in=!0,this.loading=!1,this.loaded=!1,this.built=!1,this.labeled=!1,this.error=null,this.style_zoom=n,this.coords=t.normalizedCoordinate(r,this.source,this.style_zoom),this.key=t.key(this.coords,this.source,this.style_zoom),this.overzoom=Math.max(this.style_zoom-this.coords.z,0),this.overzoom2=Math.pow(2,this.overzoom),this.min=Qn.metersForTile(this.coords),this.max=Qn.metersForTile({x:this.coords.x+1,y:this.coords.y+1,z:this.coords.z}),this.span={x:this.max.x-this.min.x,y:this.max.y-this.min.y},this.bounds={sw:{x:this.min.x,y:this.max.y},ne:{x:this.max.x,y:this.min.y}},this.center_dist=0,this.meters_per_pixel=Qn.metersPerPixel(this.style_zoom),this.meters_per_pixel_sq=this.meters_per_pixel*this.meters_per_pixel,this.units_per_pixel=Qn.units_per_pixel/this.overzoom2,this.units_per_meter_overzoom=Qn.unitsPerMeter(this.coords.z)*this.overzoom2,this.meshes={},this.new_mesh_styles=[]}return _n(t,[{key:"freeResources",value:function(){for(var t in this.meshes)this.meshes[t].forEach(function(t){return t.destroy()});this.meshes={}}},{key:"destroy",value:function(){Ao.removeForTile(this.id),this.workerMessage("self.removeTile",this.id),this.freeResources(),this.worker=null,this.valid=!1}},{key:"buildAsMessage",value:function(){return{id:this.id,key:this.key,source:this.source.name,coords:this.coords,min:this.min,max:this.max,units_per_pixel:this.units_per_pixel,meters_per_pixel:this.meters_per_pixel,meters_per_pixel_sq:this.meters_per_pixel_sq,units_per_meter_overzoom:this.units_per_meter_overzoom,style_zoom:this.style_zoom,overzoom:this.overzoom,overzoom2:this.overzoom2,generation:this.generation}}},{key:"workerMessage",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return li.postMessage.apply(li,[this.worker].concat(e))}},{key:"build",value:function(t,e){var r=(1<arguments.length&&void 0!==e?e:{}).fade_in,n=void 0===r||r;return this.generation=t,this.fade_in=n,this.loaded||(this.loading=!0,this.built=!1,this.labeled=!1),this.workerMessage("self.buildTile",{tile:this.buildAsMessage()})}},{key:"buildMeshes",value:function(t,e){if(!this.error){this.build_id=ma++;var r={},n=this.mesh_data;if(n)for(var i in n){for(var o in n[i].meshes){var a=n[i].meshes[o];if(a.vertex_data){if(!t[i]){Ei("warn","Could not create mesh because style '".concat(i,"' not found, for tile ").concat(this.key,", aborting tile"));break}var s=Object.assign({},n[i]);s.uniforms=Object.assign({},s.uniforms,a.uniforms),s.variant=a.variant,a.textures&&(s.textures=a.textures),a.labels&&(s.retain=!0);var u=t[i].makeMesh(a.vertex_data,a.vertex_elements,s);u.variant=s.variant,u.labels=a.labels,r[i]=r[i]||[],r[i].push(u),null==u.variant.order&&(u.variant.order=r[i].length-1)}}r[i]&&r[i].sort(function(t,e){var r=t.variant.order,n=e.variant.order;return null!=r&&(null==n||r<n)?-1:1})}for(var l in delete this.mesh_data,r)this.meshes[l]&&this.meshes[l].forEach(function(t){return t.destroy()}),this.meshes[l]=r[l],this.new_mesh_styles.push(l);if(e.done){for(var c in this.meshes)-1===this.new_mesh_styles.indexOf(c)&&(this.meshes[c].forEach(function(t){return t.destroy()}),delete this.meshes[c]);this.new_mesh_styles=[]}}}},{key:"setProxyFor",value:function(t){t?(this.proxy_for=this.proxy_for||[],this.proxy_for.push(t),this.proxy_depth=1,t.proxied_as=t.style_zoom>this.style_zoom?"child":"parent"):(this.proxy_for=null,this.proxy_depth=0)}},{key:"isProxy",value:function(){return null!=this.proxy_for}},{key:"shouldProxyForStyle",value:function(t){return!this.proxy_for||this.proxy_for.some(function(e){return null==e.meshes[t]})}},{key:"setupProgram",value:function(t,e){var r=t.model,n=t.model32;e.uniform("4fv","u_tile_origin",[this.min.x,this.min.y,this.style_zoom,this.coords.z]),e.uniform("1f","u_tile_proxy_depth",this.proxy_depth),Uo(r),zo(r,r,Ro(this.min.x,this.min.y,0)),Ho(r,r,Ro(this.span.x/Qn.tile_scale,-1*this.span.y/Qn.tile_scale,1)),Go(n,r),e.uniform("Matrix4fv","u_model",n),e.uniform("1i","u_tile_fade_in",this.fade_in&&"child"!==this.proxied_as)}},{key:"merge",value:function(t){return this.loading=t.loading,this.loaded=t.loaded,this.generation=t.generation,this.error=t.error,this.mesh_data=t.mesh_data,this.selection_data?Object.assign(this.selection_data,t.selection_data):this.selection_data=t.selection_data,this}}],[{key:"coord",value:function(e){return{x:e.x,y:e.y,z:e.z,key:t.coordKey(e)}}},{key:"coordKey",value:function(t){return t.x+"/"+t.y+"/"+t.z}},{key:"key",value:function(t,e,r){if(!(t.y<0||t.y>=1<<t.z||t.z<0))return[e.name,r,t.x,t.y,t.z].join("/")}},{key:"normalizedKey",value:function(e,r,n){return t.key(t.normalizedCoordinate(e,r,n),r,n)}},{key:"normalizedCoordinate",value:function(e,r){return r.zoom_bias&&(e=t.coordinateAtZoom(e,Math.max(0,e.z-r.zoom_bias))),t.coordinateWithMaxZoom(e,r.max_zoom)}},{key:"coordinateAtZoom",value:function(e,r){var n,i=e.x,o=e.y,a=e.z;return a!==r&&(n=Math.pow(2,a-r),i=Math.floor(i/n),o=Math.floor(o/n),a=r),t.coord({x:i,y:o,z:a})}},{key:"coordinateWithMaxZoom",value:function(e,r){var n=e.x,i=e.y,o=e.z;return void 0!==r&&r<o?t.coordinateAtZoom({x:n,y:i,z:o},r):t.coord({x:n,y:i,z:o})}},{key:"childrenForCoordinate",value:function(e){var r=e.x,n=e.y,i=e.z,o=e.key;return t.coord_children[o]||(i++,r*=2,n*=2,t.coord_children[o]=[t.coord({x:r,y:n,z:i}),t.coord({x:r+1,y:n,z:i}),t.coord({x:r,y:n+1,z:i}),t.coord({x:r+1,y:n+1,z:i})]),t.coord_children[o]}},{key:"isDescendant",value:function(e,r){if(r.z>e.z){var n=t.coordinateAtZoom(r,e.z),i=n.x,o=n.y;return e.x===i&&e.y===o}return!1}},{key:"cancel",value:function(e){e&&(e.canceled=!0,e.source_data&&e.source_data.request_id&&(Ai.cancelRequest(e.source_data.request_id),e.source_data.request_id=null),t.abortBuild(e))}},{key:"buildGeometry",value:function(e,r){var n=r.scene_id,i=r.layers,o=r.styles,a=r.global,s=r.sources,u=r.meshVariantMaxLife,l=e.source_data;for(var c in To.startTile(e.id,{apply_repeat_groups:!0}),i){var h=i[c];if(h&&h.config_data){if(h.config_data.source===e.source)for(var f=t._getDataForSource(l,h.config_data,c),p=0;p<f.length;p++){var d=f[p],v=d.geom;if(v)for(var y=0;y<v.features.length;y++){var g=v.features[y];if(null!=g.geometry){var m=yo.getFeatureParseContext(g,e,a,s);m.winding=e.default_winding,m.source=e.source,m.layer=d.layer;var _=h.buildDrawGroups(m,!0);if(_)for(var b in _){var x=_[b],w=x.style||b,E=o[w];E?null!=(x=E.preprocess(x,e.source))&&!1!==x.visible&&(m.layers=x.layers,E.addFeature(g,x,m)):Ei("warn","Style '".concat(w,"' not found, skipping layer '").concat(c,"':"),x,g)}}}}}else Ei("warn","Layer ".concat(c," was defined without a geometry data source and will not be rendered."))}var T=t._stylesForTile(e,o);t._sendStyleGroups(e,T,{scene_id:n,meshVariantMaxLife:u},function(t){return t.collision?"collision":"non-collision"})}},{key:"_stylesForTile",value:function(t,e){var r=[];for(var n in e)e[n].hasDataForTile(t)&&r.push(e[n]);return r}},{key:"_sendStyleGroups",value:function(e,r,n,i){var o=n.scene_id,a=n.meshVariantMaxLife,s={};r.forEach(function(t){var e=i(t);s[e]=s[e]||[],s[e].push(t)}),0<Object.keys(s).length?function(){var r={start:!0};for(var n in e.mesh_data={},s)!function(n){var i=s[n];Promise.all(i.map(function(t){return t.endData(e)})).then(function(){Ei("trace","Finished style group '".concat(n,"' for tile ").concat(e.key)),s[n]=[],Object.keys(s).every(function(t){return 0===s[t].length})&&(r.done=!0),li.postMessage("TileManager_".concat(o,".buildTileStylesCompleted"),li.withTransferables({tile:t.slice(e,["mesh_data","selection_data"]),progress:r})),r.start=null,e.mesh_data={},e.selection_data={},r.done&&To.resetTile(e.id)},function(t){Ei("error","Error for style group '".concat(n,"' for tile ").concat(e.key),t)})}(n);ya.updateMeshVariantTypeCache(a)}():(li.postMessage("TileManager_".concat(o,".buildTileStylesCompleted"),li.withTransferables({tile:t.slice(e),progress:{start:!0,done:!0}})),To.resetTile(e.id))}},{key:"_getDataForSource",value:function(t,e,r){var n=2<arguments.length&&void 0!==r?r:null,i=[];return null!=e&&null!=t&&null!=t.layers&&(!e.layer&&t.layers._default||"string"==typeof e.layer&&!t.layers[e.layer]&&new RegExp("^\\d+_"+e.layer+"$").test(n)&&t.layers._default?i.push({geom:t.layers._default}):!e.layer&&n?i.push({layer:n,geom:t.layers[n]}):"string"==typeof e.layer?i.push({layer:e.layer,geom:t.layers[e.layer]}):Array.isArray(e.layer)&&e.layer.forEach(function(e){t.layers[e]&&t.layers[e].features&&i.push({layer:e,geom:t.layers[e]})})),i}},{key:"abortBuild",value:function(t,e){if(Ao.removeForTile(t.id),To.abortTile(t.id),t.mesh_data)for(var r in t.mesh_data){var n=t.mesh_data[r].textures;n&&n.forEach(function(r){var n=Lo(e).textures[r];n&&(Ei("trace","releasing texture ".concat(r," for tile ").concat(t.key)),n.release())})}}},{key:"slice",value:function(t,e){var r=["id","key","loading","loaded","generation","error","debug"];Array.isArray(e)&&r.push.apply(r,Rn(e));for(var n={},i=0;i<r.length;i++){var o=r[i];n[o]=t[o]}return n}}]),t}();_a.coord_children={};var ba,xa=function(){En(e,ji);var t=In(e);function e(r,n){var i;return gn(this,e),-1===(i=t.call(this,r,n)).rasters.indexOf(i.name)&&i.rasters.unshift(i.name),i.filtering=r.filtering,i.textures={},i}return _n(e,[{key:"load",value:function(t){t.source_data={},t.source_data.layers={},t.pad_scale=this.pad_scale,t.rasters=Rn(this.rasters);var e=Qn.tile_scale;return t.source_data.layers={_default:{type:"FeatureCollection",features:[{geometry:{type:"Polygon",coordinates:[[[0,0],[e,0],[e,-e],[0,-e],[0,0]]]},properties:{}}]}},t.default_winding="CW",Promise.resolve(t)}},{key:"tileTexture",value:function(t){var e,r,n=t.coords.key;return this.textures[n]||(e=_a.coordinateWithMaxZoom(t.coords,this.max_zoom),r=this.formatUrl(this.url,{coords:e}),this.textures[n]={url:r,filtering:this.filtering,coords:e}),this.textures[n]}}]),e}();Ri.register(xa,"Raster");var wa=ba={};function Ea(t,e,r,n){var i={id:void 0===t?null:t,type:e,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,r=t.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)Ta(t,e);else if("Polygon"===r||"MultiLineString"===r)for(var n=0;n<e.length;n++)Ta(t,e[n]);else if("MultiPolygon"===r)for(n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++)Ta(t,e[n][i])}(i),i}function Ta(t,e){for(var r=0;r<e.length;r+=3)t.minX=Math.min(t.minX,e[r]),t.minY=Math.min(t.minY,e[r+1]),t.maxX=Math.max(t.maxX,e[r]),t.maxY=Math.max(t.maxY,e[r+1])}function Aa(t,e){var r=[];if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)ka(r,t.features[n],e,n);else"Feature"===t.type?ka(r,t,e):ka(r,{geometry:t},e);return r}function ka(t,e,r,n){if(e.geometry){var i=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],u=e.id;if(r.promoteId?u=e.properties[r.promoteId]:r.generateId&&(u=n||0),"Point"===o)Sa(i,s);else if("MultiPoint"===o)for(var l=0;l<i.length;l++)Sa(i[l],s);else if("LineString"===o)Ma(i,s,a,!1);else if("MultiLineString"===o){if(r.lineMetrics){for(l=0;l<i.length;l++)s=[],Ma(i[l],s,a,!1),t.push(Ea(u,"LineString",s,e.properties));return}Oa(i,s,a,!1)}else if("Polygon"===o)Oa(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"!==o)throw new Error("Input data is not a valid GeoJSON object.");for(l=0;l<e.geometry.geometries.length;l++)ka(t,{id:u,geometry:e.geometry.geometries[l],properties:e.properties},r,n);return}for(l=0;l<i.length;l++){var c=[];Oa(i[l],c,a,!0),s.push(c)}}t.push(Ea(u,o,s,e.properties))}}function Sa(t,e){e.push(Ia(t[0])),e.push(La(t[1])),e.push(0)}function Ma(t,e,r,n){for(var i,o,a=0,s=0;s<t.length;s++){var u=Ia(t[s][0]),l=La(t[s][1]);e.push(u),e.push(l),e.push(0),0<s&&(a+=n?(i*l-u*o)/2:Math.sqrt(Math.pow(u-i,2)+Math.pow(l-o,2))),i=u,o=l}var c=e.length-3;e[2]=1,function t(e,r,n,i){for(var o,a=i,s=n-r>>1,u=n-r,l=e[r],c=e[r+1],h=e[n],f=e[n+1],p=r+3;p<n;p+=3){var d,v=function(t,e,r,n,i,o){var a,s=h-r,u=f-n;return 0===s&&0===u||(1<(a=((t-r)*s+(e-n)*u)/(s*s+u*u))?(r=h,n=f):0<a&&(r+=s*a,n+=u*a)),(s=t-r)*s+(u=e-n)*u}(e[p],e[p+1],l,c);a<v?(o=p,a=v):v!==a||(d=Math.abs(p-s))<u&&(o=p,u=d)}i<a&&(3<o-r&&t(e,r,o,i),e[o+2]=a,3<n-o&&t(e,o,n,i))}(e,0,c,r),e[2+c]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function Oa(t,e,r,n){for(var i=0;i<t.length;i++){var o=[];Ma(t[i],o,r,n),e.push(o)}}function Ia(t){return t/360+.5}function La(t){var e=Math.sin(t*Math.PI/180),r=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return r<0?0:1<r?1:r}function Ca(t,e,r,n,i,o,a,s){if(n/=e,(r/=e)<=o&&a<n)return t;if(a<r||n<=o)return null;for(var u=[],l=0;l<t.length;l++){var c=t[l],h=c.geometry,f=c.type,p=0===i?c.minX:c.minY,d=0===i?c.maxX:c.maxY;if(r<=p&&d<n)u.push(c);else if(!(d<r||n<=p)){var v=[];if("Point"===f||"MultiPoint"===f)!function(t,e,r,n,i){for(var o=0;o<t.length;o+=3){var a=t[o+i];r<=a&&a<=n&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}(h,v,r,n,i);else if("LineString"===f)Ra(h,v,r,n,i,!1,s.lineMetrics);else if("MultiLineString"===f)Na(h,v,r,n,i,!1);else if("Polygon"===f)Na(h,v,r,n,i,!0);else if("MultiPolygon"===f)for(var y=0;y<h.length;y++){var g=[];Na(h[y],g,r,n,i,!0),g.length&&v.push(g)}if(v.length){if(s.lineMetrics&&"LineString"===f){for(y=0;y<v.length;y++)u.push(Ea(c.id,f,v[y],c.tags));continue}"LineString"!==f&&"MultiLineString"!==f||(1===v.length?(f="LineString",v=v[0]):f="MultiLineString"),"Point"!==f&&"MultiPoint"!==f||(f=3===v.length?"Point":"MultiPoint"),u.push(Ea(c.id,f,v,c.tags))}}}return u.length?u:null}function Ra(t,e,r,n,i,o,a){for(var s,u,l=Pa(t),c=0===i?Da:za,h=t.start,f=0;f<t.length-3;f+=3){var p=t[f],d=t[f+1],v=t[f+2],y=t[f+3],g=t[f+4],m=0===i?p:d,_=0===i?y:g,b=!1;a&&(s=Math.sqrt(Math.pow(p-y,2)+Math.pow(d-g,2))),m<r?r<_&&(u=c(l,p,d,y,g,r),a&&(l.start=h+s*u)):n<m?_<n&&(u=c(l,p,d,y,g,n),a&&(l.start=h+s*u)):ja(l,p,d,v),_<r&&r<=m&&(u=c(l,p,d,y,g,r),b=!0),n<_&&m<=n&&(u=c(l,p,d,y,g,n),b=!0),!o&&b&&(a&&(l.end=h+s*u),e.push(l),l=Pa(t)),a&&(h+=s)}var x=t.length-3;p=t[x],d=t[x+1],v=t[x+2];r<=(m=0===i?p:d)&&m<=n&&ja(l,p,d,v),x=l.length-3,o&&3<=x&&(l[x]!==l[0]||l[x+1]!==l[1])&&ja(l,l[0],l[1],l[2]),l.length&&e.push(l)}function Pa(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function Na(t,e,r,n,i,o){for(var a=0;a<t.length;a++)Ra(t[a],e,r,n,i,o,!1)}function ja(t,e,r,n){t.push(e),t.push(r),t.push(n)}function Da(t,e,r,n,i,o){var a=(o-e)/(n-e);return t.push(o),t.push(r+(i-r)*a),t.push(1),a}function za(t,e,r,n,i,o){var a=(o-r)/(i-r);return t.push(e+(n-e)*a),t.push(o),t.push(1),a}function Ha(t,e){var r=e.buffer/e.extent,n=t,i=Ca(t,1,-1-r,r,0,-1,2,e),o=Ca(t,1,1-r,2+r,0,-1,2,e);return(i||o)&&(n=Ca(t,1,-r,1+r,0,-1,2,e)||[],i&&(n=Fa(i,1).concat(n)),o&&(n=n.concat(Fa(o,-1)))),n}function Fa(t,e){for(var r=[],n=0;n<t.length;n++){var i,o=t[n],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)i=Ba(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){i=[];for(var s=0;s<o.geometry.length;s++)i.push(Ba(o.geometry[s],e))}else if("MultiPolygon"===a)for(i=[],s=0;s<o.geometry.length;s++){for(var u=[],l=0;l<o.geometry[s].length;l++)u.push(Ba(o.geometry[s][l],e));i.push(u)}r.push(Ea(o.id,a,i,o.tags))}return r}function Ba(t,e){var r=[];r.size=t.size,void 0!==t.start&&(r.start=t.start,r.end=t.end);for(var n=0;n<t.length;n+=3)r.push(t[n]+e,t[n+1],t[n+2]);return r}function Ua(t,e){if(t.transformed)return t;for(var r,n=1<<t.z,i=t.x,o=t.y,a=0;a<t.features.length;a++){var s=t.features[a],u=s.geometry,l=s.type;if(s.geometry=[],1===l)for(r=0;r<u.length;r+=2)s.geometry.push(Ga(u[r],u[r+1],e,n,i,o));else for(r=0;r<u.length;r++){for(var c=[],h=0;h<u[r].length;h+=2)c.push(Ga(u[r][h],u[r][h+1],e,n,i,o));s.geometry.push(c)}}return t.transformed=!0,t}function Ga(t,e,r,n,i,o){return[Math.round(r*(t*n-i)),Math.round(r*(e*n-o))]}function qa(t,e,r,n,i){for(var o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,function(t,e,r,n){var i=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)Va(a,i,t,r,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)Va(a,i[s],t,r,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var u=0;u<i.length;u++){var l=i[u];for(s=0;s<l.length;s++)Va(a,l[s],t,r,!0,0===s)}if(a.length){var c=e.tags||null;if("LineString"===o&&n.lineMetrics){for(var h in c={},e.tags)c[h]=e.tags[h];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var f={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==e.id&&(f.id=e.id),t.features.push(f)}}(a,t[s],o,i);var u=t[s].minX,l=t[s].minY,c=t[s].maxX,h=t[s].maxY;u<a.minX&&(a.minX=u),l<a.minY&&(a.minY=l),c>a.maxX&&(a.maxX=c),h>a.maxY&&(a.maxY=h)}return a}function Va(t,e,r,n,i,o){var a=n*n;if(0<n&&e.size<(i?a:n))r.numPoints+=e.length/3;else{for(var s=[],u=0;u<e.length;u+=3)(0===n||e[u+2]>a)&&(r.numSimplified++,s.push(e[u]),s.push(e[u+1])),r.numPoints++;i&&function(t,e){for(var r=0,n=0,i=t.length,o=i-2;n<i;o=n,n+=2)r+=(t[n]-t[o])*(t[n+1]+t[o+1]);if(0<r===e)for(n=0,i=t.length;n<i/2;n+=2){var a=t[n],s=t[n+1];t[n]=t[i-2-n],t[n+1]=t[i-1-n],t[i-2-n]=a,t[i-1-n]=s}}(s,o),t.push(s)}}var Wa={maxZoom:14,tolerance:3,extent:4096,buffer:64,lineMetrics:!(ba.deepClone=function(t){return Array.isArray(t)?t.map(ba.deepClone):t}),promoteId:null,generateId:!1};function Ya(t,e,r,n,i){var o=Object.assign({},Wa,i),a=Aa(t,o),s=function(t){var e,r=2,n=-1,i=1,o=0,a=jn(t);try{for(a.s();!(e=a.n()).done;){var s=e.value;s.minX<r&&(r=s.minX),s.maxX>n&&(n=s.maxX),s.minY<i&&(i=s.minY),s.maxY>o&&(o=s.maxY)}}catch(t){a.e(t)}finally{a.f()}return{minX:r,maxX:n,minY:i,maxY:o}}(a=Ha(a,o)),u=s.minX,l=s.minY,c=s.maxX,h=s.maxY,f=1<<e,p=o.buffer/o.extent,d=1+p;return Ua(qa(a=Ca(a=Ca(a,f,r-p,r+d,0,u,c,o)||[],f,n-p,n+d,1,l,h,o)||[],e,r,n,o),o.extent)}function Ka(t,e){this.items=[],this.algorithm=t;var r=void 0===(e=e||{}).sort||e.sort;this.sort=r}Ka.prototype={addItem:function(t){this.items.push(t)},normalizeCoordinates:function(){var t=this.items,e=1/0,r=1/0;t.forEach(function(t){var n=t;e=Math.min(e,n.x),r=Math.min(r,n.y)}),t.forEach(function(t){var n=t;n.x-=e,n.y-=r})},getStats:function(){var t=this.items.map(function(t){return t}),e=t.map(function(t){return t.x}),r=t.map(function(t){return t.y}),n=t.map(function(t){return t.x+t.width}),i=t.map(function(t){return t.y+t.height});return{minX:Math.max.apply(Math,e),minY:Math.max.apply(Math,r),maxX:Math.max.apply(Math,n),maxY:Math.max.apply(Math,i)}},getItems:function(){return this.items},processItems:function(){var t=this.items;return this.sort&&(t=this.algorithm.sort(t)),t=this.algorithm.placeItems(t),this.items=t},exportItems:function(){return this.processItems(),this.normalizeCoordinates(),this.items},export:function(){var t=this.exportItems(),e=this.getStats();return{height:e.maxY,width:e.maxX,items:t}}};var Xa=Ka,Za=[],$a=[],Ja="undefined"!=typeof Uint8Array?Uint8Array:Array,Qa=!1;function ts(){Qa=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,r=t.length;e<r;++e)Za[e]=t[e],$a[t.charCodeAt(e)]=e;$a["-".charCodeAt(0)]=62,$a["_".charCodeAt(0)]=63}function es(t,e,r){for(var n,i,o=[],a=e;a<r;a+=3)n=(t[a]<<16)+(t[a+1]<<8)+t[a+2],o.push(Za[(i=n)>>18&63]+Za[i>>12&63]+Za[i>>6&63]+Za[63&i]);return o.join("")}function rs(t){var e;Qa||ts();for(var r=t.length,n=r%3,i="",o=[],a=0,s=r-n;a<s;a+=16383)o.push(es(t,a,s<a+16383?s:a+16383));return 1==n?(e=t[r-1],i+=Za[e>>2],i+=Za[e<<4&63],i+="=="):2==n&&(e=(t[r-2]<<8)+t[r-1],i+=Za[e>>10],i+=Za[e>>4&63],i+=Za[e<<2&63],i+="="),o.push(i),o.join("")}function ns(t,e,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,l=u>>1,c=-7,h=r?i-1:0,f=r?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-c)-1,p>>=-c,c+=s;0<c;o=256*o+t[e+h],h+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;0<c;a=256*a+t[e+h],h+=f,c-=8);if(0===o)o=1-l;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),o-=l}return(p?-1:1)*a*Math.pow(2,o-n)}function is(t,e,r,n,i,o){var a,s,u,l=8*o-i-1,c=(1<<l)-1,h=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,v=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),2<=(e+=1<=a+h?f/u:f*Math.pow(2,1-h))*u&&(a++,u/=2),c<=a+h?(s=0,a=c):1<=a+h?(s=(e*u-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));8<=i;t[r+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,l+=i;0<l;t[r+p]=255&a,p+=d,a/=256,l-=8);t[r+p-d]|=128*v}var os={}.toString,as=Array.isArray||function(t){return"[object Array]"==os.call(t)};cs.TYPED_ARRAY_SUPPORT=void 0===Kn.TYPED_ARRAY_SUPPORT||Kn.TYPED_ARRAY_SUPPORT;var ss=us();function us(){return cs.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function ls(t,e){if(us()<e)throw new RangeError("Invalid typed array length");return cs.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=cs.prototype:(null===t&&(t=new cs(e)),t.length=e),t}function cs(t,e,r){if(!(cs.TYPED_ARRAY_SUPPORT||this instanceof cs))return new cs(t,e,r);if("number"!=typeof t)return hs(this,t,e,r);if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return ps(this,t)}function hs(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n),cs.TYPED_ARRAY_SUPPORT?(t=e).__proto__=cs.prototype:t=ds(t,e),t}(t,e,r,n):"string"==typeof e?function(t,e,r){if("string"==typeof r&&""!==r||(r="utf8"),!cs.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|gs(e,r),i=(t=ls(t,n)).write(e,r);return i!==n&&(t=t.slice(0,i)),t}(t,e,r):function(t,e){if(ys(e)){var r=0|vs(e.length);return 0===(t=ls(t,r)).length?t:(e.copy(t,0,0,r),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?ls(t,0):ds(t,e);if("Buffer"===e.type&&as(e.data))return ds(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function fs(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function ps(t,e){if(fs(e),t=ls(t,e<0?0:0|vs(e)),!cs.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function ds(t,e){var r=e.length<0?0:0|vs(e.length);t=ls(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function vs(t){if(t>=us())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+us().toString(16)+" bytes");return 0|t}function ys(t){return null!=t&&t._isBuffer}function gs(t,e){if(ys(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return Rs(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Ps(t).length;default:if(n)return Rs(t).length;e=(""+e).toLowerCase(),n=!0}}function ms(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function _s(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=cs.from(e,n)),ys(e))return 0===e.length?-1:bs(t,e,r,n,i);if("number"==typeof e)return e&=255,cs.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):bs(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function bs(t,e,r,n,i){var o=1,a=t.length,s=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;a/=o=2,s/=2,r/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i)for(var l=-1,c=r;c<a;c++)if(u(t,c)===u(e,-1===l?0:c-l)){if(-1===l&&(l=c),c-l+1===s)return l*o}else-1!==l&&(c-=c-l),l=-1;else for(a<r+s&&(r=a-s),c=r;0<=c;c--){for(var h=!0,f=0;f<s;f++)if(u(t,c+f)!==u(e,f)){h=!1;break}if(h)return c}return-1}function xs(t,e,r,n){return Ns(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function ws(t,e,r,n){return Ns(function(t,e){for(var r,n,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)n=(r=t.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function Es(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o,a,s,u,l=t[i],c=null,h=239<l?4:223<l?3:191<l?2:1;if(i+h<=r)switch(h){case 1:l<128&&(c=l);break;case 2:128==(192&(o=t[i+1]))&&127<(u=(31&l)<<6|63&o)&&(c=u);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&2047<(u=(15&l)<<12|(63&o)<<6|63&a)&&(u<55296||57343<u)&&(c=u);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&65535<(u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)&&u<1114112&&(c=u)}null===c?(c=65533,h=1):65535<c&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=h}return function(t){var e=t.length;if(e<=Ts)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=Ts));return r}(n)}cs.poolSize=8192,cs._augment=function(t){return t.__proto__=cs.prototype,t},cs.from=function(t,e,r){return hs(null,t,e,r)},cs.TYPED_ARRAY_SUPPORT&&(cs.prototype.__proto__=Uint8Array.prototype,cs.__proto__=Uint8Array),cs.alloc=function(t,e,r){return n=null,o=e,a=r,fs(i=t),i<=0||void 0===o?ls(n,i):"string"==typeof a?ls(n,i).fill(o,a):ls(n,i).fill(o);var n,i,o,a},cs.allocUnsafe=function(t){return ps(null,t)},cs.allocUnsafeSlow=function(t){return ps(null,t)},cs.isBuffer=js,cs.compare=function(t,e){if(!ys(t)||!ys(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},cs.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},cs.concat=function(t,e){if(!as(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return cs.alloc(0);if(void 0===e)for(i=e=0;i<t.length;++i)e+=t[i].length;for(var r=cs.allocUnsafe(e),n=0,i=0;i<t.length;++i){var o=t[i];if(!ys(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,n),n+=o.length}return r},cs.byteLength=gs,cs.prototype._isBuffer=!0,cs.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)ms(this,e,e+1);return this},cs.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)ms(this,e,e+3),ms(this,e+1,e+2);return this},cs.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)ms(this,e,e+7),ms(this,e+1,e+6),ms(this,e+2,e+5),ms(this,e+3,e+4);return this},cs.prototype.toString=function(){var t=0|this.length;return 0==t?"":0===arguments.length?Es(this,0,t):function(t,e,r){var n,i,o,a=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t=t||"utf8";;)switch(t){case"hex":return function(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||n<r)&&(r=n);for(var i="",o=e;o<r;++o)i+=function(t){return t<16?"0"+t.toString(16):t.toString(16)}(t[o]);return i}(this,e,r);case"utf8":case"utf-8":return Es(this,e,r);case"ascii":return function(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}(this,e,r);case"latin1":case"binary":return function(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}(this,e,r);case"base64":return n=this,o=r,0===(i=e)&&o===n.length?rs(n):rs(n.slice(i,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}(this,e,r);default:if(a)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),a=!0}}.apply(this,arguments)},cs.prototype.equals=function(t){if(!ys(t))throw new TypeError("Argument must be a Buffer");return this===t||0===cs.compare(this,t)},cs.prototype.inspect=function(){var t="";return 0<this.length&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(t+=" ... ")),"<Buffer "+t+">"},cs.prototype.compare=function(t,e,r,n,i){if(!ys(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(i<=n&&r<=e)return 0;if(i<=n)return-1;if(r<=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(e>>>=0),s=Math.min(o,a),u=this.slice(n,i),l=t.slice(e,r),c=0;c<s;++c)if(u[c]!==l[c]){o=u[c],a=l[c];break}return o<a?-1:a<o?1:0},cs.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},cs.prototype.indexOf=function(t,e,r){return _s(this,t,e,r,!0)},cs.prototype.lastIndexOf=function(t,e,r){return _s(this,t,e,r,!1)},cs.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||i<r)&&(r=i),0<t.length&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");for(var o,a,s,u,l,c,h=!1;;)switch(n=n||"utf8"){case"hex":return function(t,e,r,n){r=Number(r)||0;var i=t.length-r;(!n||i<(n=Number(n)))&&(n=i);var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");o/2<n&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[r+a]=s}return a}(this,t,e,r);case"utf8":case"utf-8":return l=e,c=r,Ns(Rs(t,(u=this).length-l),u,l,c);case"ascii":return xs(this,t,e,r);case"latin1":case"binary":return xs(this,t,e,r);case"base64":return o=this,a=e,s=r,Ns(Ps(t),o,a,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ws(this,t,e,r);default:if(h)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),h=!0}},cs.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Ts=4096;function As(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(r<t+e)throw new RangeError("Trying to access beyond buffer length")}function ks(t,e,r,n,i,o){if(!ys(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<e||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function Ss(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-r,2);i<o;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function Ms(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-r,4);i<o;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function Os(t,e,r,n){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Is(t,e,r,n,i){return i||Os(t,0,r,4),is(t,e,r,n,23,4),r+4}function Ls(t,e,r,n,i){return i||Os(t,0,r,8),is(t,e,r,n,52,8),r+8}cs.prototype.slice=function(t,e){var r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),e<t&&(e=t),cs.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=cs.prototype;else for(var n=e-t,i=new cs(n,void 0),o=0;o<n;++o)i[o]=this[o+t];return i},cs.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||As(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},cs.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||As(t,e,this.length);for(var n=this[t+--e],i=1;0<e&&(i*=256);)n+=this[t+--e]*i;return n},cs.prototype.readUInt8=function(t,e){return e||As(t,1,this.length),this[t]},cs.prototype.readUInt16LE=function(t,e){return e||As(t,2,this.length),this[t]|this[t+1]<<8},cs.prototype.readUInt16BE=function(t,e){return e||As(t,2,this.length),this[t]<<8|this[t+1]},cs.prototype.readUInt32LE=function(t,e){return e||As(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},cs.prototype.readUInt32BE=function(t,e){return e||As(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},cs.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||As(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return(i*=128)<=n&&(n-=Math.pow(2,8*e)),n},cs.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||As(t,e,this.length);for(var n=e,i=1,o=this[t+--n];0<n&&(i*=256);)o+=this[t+--n]*i;return(i*=128)<=o&&(o-=Math.pow(2,8*e)),o},cs.prototype.readInt8=function(t,e){return e||As(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},cs.prototype.readInt16LE=function(t,e){e||As(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},cs.prototype.readInt16BE=function(t,e){e||As(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},cs.prototype.readInt32LE=function(t,e){return e||As(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},cs.prototype.readInt32BE=function(t,e){return e||As(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},cs.prototype.readFloatLE=function(t,e){return e||As(t,4,this.length),ns(this,t,!0,23,4)},cs.prototype.readFloatBE=function(t,e){return e||As(t,4,this.length),ns(this,t,!1,23,4)},cs.prototype.readDoubleLE=function(t,e){return e||As(t,8,this.length),ns(this,t,!0,52,8)},cs.prototype.readDoubleBE=function(t,e){return e||As(t,8,this.length),ns(this,t,!1,52,8)},cs.prototype.writeUIntLE=function(t,e,r,n){t=+t,e|=0,r|=0,n||ks(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},cs.prototype.writeUIntBE=function(t,e,r,n){t=+t,e|=0,r|=0,n||ks(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[e+i]=255&t;0<=--i&&(o*=256);)this[e+i]=t/o&255;return e+r},cs.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||ks(this,t,e,1,255,0),cs.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},cs.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||ks(this,t,e,2,65535,0),cs.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Ss(this,t,e,!0),e+2},cs.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||ks(this,t,e,2,65535,0),cs.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Ss(this,t,e,!1),e+2},cs.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||ks(this,t,e,4,4294967295,0),cs.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):Ms(this,t,e,!0),e+4},cs.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||ks(this,t,e,4,4294967295,0),cs.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Ms(this,t,e,!1),e+4},cs.prototype.writeIntLE=function(t,e,r,n){var i;t=+t,e|=0,n||ks(this,t,e,r,(i=Math.pow(2,8*r-1))-1,-i);var o=0,a=1,s=0;for(this[e]=255&t;++o<r&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+r},cs.prototype.writeIntBE=function(t,e,r,n){var i;t=+t,e|=0,n||ks(this,t,e,r,(i=Math.pow(2,8*r-1))-1,-i);var o=r-1,a=1,s=0;for(this[e+o]=255&t;0<=--o&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+r},cs.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||ks(this,t,e,1,127,-128),cs.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},cs.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||ks(this,t,e,2,32767,-32768),cs.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Ss(this,t,e,!0),e+2},cs.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||ks(this,t,e,2,32767,-32768),cs.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Ss(this,t,e,!1),e+2},cs.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||ks(this,t,e,4,2147483647,-2147483648),cs.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):Ms(this,t,e,!0),e+4},cs.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||ks(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),cs.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Ms(this,t,e,!1),e+4},cs.prototype.writeFloatLE=function(t,e,r){return Is(this,t,e,!0,r)},cs.prototype.writeFloatBE=function(t,e,r){return Is(this,t,e,!1,r)},cs.prototype.writeDoubleLE=function(t,e,r){return Ls(this,t,e,!0,r)},cs.prototype.writeDoubleBE=function(t,e,r){return Ls(this,t,e,!1,r)},cs.prototype.copy=function(t,e,r,n){if(r=r||0,n||0===n||(n=this.length),e>=t.length&&(e=t.length),e=e||0,0<n&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i,o=n-r;if(this===t&&r<e&&e<n)for(i=o-1;0<=i;--i)t[i+e]=this[i+r];else if(o<1e3||!cs.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+o),e);return o},cs.prototype.fill=function(t,e,r,n){if("string"==typeof t){var i;if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1!==t.length||(i=t.charCodeAt(0))<256&&(t=i),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!cs.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;if(e>>>=0,r=void 0===r?this.length:r>>>0,"number"==typeof(t=t||0))for(s=e;s<r;++s)this[s]=t;else for(var o=ys(t)?t:Rs(new cs(t,n).toString()),a=o.length,s=0;s<r-e;++s)this[s+e]=o[s%a];return this};var Cs=/[^+\/0-9A-Za-z-_]/g;function Rs(t,e){var r;e=e||1/0;for(var n=t.length,i=null,o=[],a=0;a<n;++a){if(55295<(r=t.charCodeAt(a))&&r<57344){if(!i){if(56319<r){-1<(e-=3)&&o.push(239,191,189);continue}if(a+1===n){-1<(e-=3)&&o.push(239,191,189);continue}i=r;continue}if(r<56320){-1<(e-=3)&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&-1<(e-=3)&&o.push(239,191,189);if(i=null,r<128){if(--e<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function Ps(t){return function(t){var e,r,n,i;Qa||ts();var o=t.length;if(0<o%4)throw new Error("Invalid string. Length must be a multiple of 4");n="="===t[o-2]?2:"="===t[o-1]?1:0,i=new Ja(3*o/4-n),e=0<n?o-4:o;for(var a=0,s=0;s<e;s+=4,0)r=$a[t.charCodeAt(s)]<<18|$a[t.charCodeAt(s+1)]<<12|$a[t.charCodeAt(s+2)]<<6|$a[t.charCodeAt(s+3)],i[a++]=r>>16&255,i[a++]=r>>8&255,i[a++]=255&r;return 2==n?(r=$a[t.charCodeAt(s)]<<2|$a[t.charCodeAt(s+1)]>>4,i[a++]=255&r):1==n&&(r=$a[t.charCodeAt(s)]<<10|$a[t.charCodeAt(s+1)]<<4|$a[t.charCodeAt(s+2)]>>2,i[a++]=r>>8&255,i[a++]=255&r),i}(function(t){var e;if((t=((e=t).trim?e.trim():e.replace(/^\s+|\s+$/g,"")).replace(Cs,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Ns(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function js(t){return null!=t&&(!!t._isBuffer||Ds(t)||"function"==typeof(e=t).readFloatLE&&"function"==typeof e.slice&&Ds(e.slice(0,0)));var e}function Ds(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var zs=Object.freeze({INSPECT_MAX_BYTES:50,kMaxLength:ss,Buffer:cs,SlowBuffer:function(t){return+t!=t&&(t=0),cs.alloc(+t)},isBuffer:js});Kn.setTimeout,Kn.clearTimeout,Kn.performance;var Hs="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){function r(){}t.super_=e,r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t};function Fs(t,e){var r={seen:[],stylize:Us};return 3<=arguments.length&&(r.depth=arguments[2]),4<=arguments.length&&(r.colors=arguments[3]),Ws(e)?r.showHidden=e:e&&function(t,e){if(e&&$s(e))for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]]}(r,e),Xs(r.showHidden)&&(r.showHidden=!1),Xs(r.depth)&&(r.depth=2),Xs(r.colors)&&(r.colors=!1),Xs(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=Bs),Gs(r,t,r.depth)}function Bs(t,e){var r=Fs.styles[e];return r?"["+Fs.colors[r][0]+"m"+t+"["+Fs.colors[r][1]+"m":t}function Us(t,e){return t}function Gs(t,e,r){if(t.customInspect&&e&&tu(e.inspect)&&e.inspect!==Fs&&(!e.constructor||e.constructor.prototype!==e)){var n=e.inspect(r,t);return Ks(n)||(n=Gs(t,n,r)),n}var i=function(t,e){if(Xs(e))return t.stylize("undefined","undefined");if(Ks(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}return"number"==typeof e?t.stylize(""+e,"number"):Ws(e)?t.stylize(""+e,"boolean"):Ys(e)?t.stylize("null","null"):void 0}(t,e);if(i)return i;var o,a=Object.keys(e),s=(o={},a.forEach(function(t,e){o[t]=!0}),o);if(t.showHidden&&(a=Object.getOwnPropertyNames(e)),Qs(e)&&(0<=a.indexOf("message")||0<=a.indexOf("description")))return qs(e);if(0===a.length){if(tu(e)){var u=e.name?": "+e.name:"";return t.stylize("[Function"+u+"]","special")}if(Zs(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(Js(e))return t.stylize(Date.prototype.toString.call(e),"date");if(Qs(e))return qs(e)}var l,c,h="",f=!1,p=["{","}"];return l=e,Array.isArray(l)&&(f=!0,p=["[","]"]),tu(e)&&(h=" [Function"+(e.name?": "+e.name:"")+"]"),Zs(e)&&(h=" "+RegExp.prototype.toString.call(e)),Js(e)&&(h=" "+Date.prototype.toUTCString.call(e)),Qs(e)&&(h=" "+qs(e)),0!==a.length||f&&0!=e.length?r<0?Zs(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),c=f?function(t,e,r,n,i){for(var o=[],a=0,s=e.length;a<s;++a)nu(e,String(a))?o.push(Vs(t,e,r,n,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(Vs(t,e,r,n,i,!0))}),o}(t,e,r,s,a):a.map(function(n){return Vs(t,e,r,s,n,f)}),t.seen.pop(),function(t,e,r){return 60<t.reduce(function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)?r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}(c,h,p)):p[0]+h+p[1]}function qs(t){return"["+Error.prototype.toString.call(t)+"]"}function Vs(t,e,r,n,i,o){var a,s,u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]};if(u.get?s=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(s=t.stylize("[Setter]","special")),nu(n,i)||(a="["+i+"]"),s||(t.seen.indexOf(u.value)<0?-1<(s=Ys(r)?Gs(t,u.value,null):Gs(t,u.value,r-1)).indexOf("\n")&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n")):s=t.stylize("[Circular]","special")),Xs(a)){if(o&&i.match(/^\d+$/))return s;a=(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.stylize(a,"string"))}return a+": "+s}function Ws(t){return"boolean"==typeof t}function Ys(t){return null===t}function Ks(t){return"string"==typeof t}function Xs(t){return void 0===t}function Zs(t){return $s(t)&&"[object RegExp]"===ru(t)}function $s(t){return"object"==typeof t&&null!==t}function Js(t){return $s(t)&&"[object Date]"===ru(t)}function Qs(t){return $s(t)&&("[object Error]"===ru(t)||t instanceof Error)}function tu(t){return"function"==typeof t}function eu(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t}function ru(t){return Object.prototype.toString.call(t)}function nu(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function iu(t,e){if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0}Fs.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Fs.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var ou,au=Object.prototype.hasOwnProperty,su=Object.keys||function(t){var e=[];for(var r in t)au.call(t,r)&&e.push(r);return e},uu=Array.prototype.slice;function lu(){return void 0!==ou?ou:ou="foo"===function(){}.name}function cu(t){return Object.prototype.toString.call(t)}function hu(t){if(!js(t)&&"function"==typeof Kn.ArrayBuffer){if("function"==typeof ArrayBuffer.isView)return ArrayBuffer.isView(t);if(t)return t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer)}}function fu(t,e){t||mu(t,!0,e,"==",_u)}var pu=/\s*function\s+([^\(\s]*)\s*/;function du(t){if(tu(t)){if(lu())return t.name;var e=t.toString().match(pu);return e&&e[1]}}function vu(t){var e;this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=yu(gu((e=this).actual),128)+" "+e.operator+" "+yu(gu(e.expected),128),this.generatedMessage=!0);var r,n,i,o,a,s=t.stackStartFunction||mu;Error.captureStackTrace?Error.captureStackTrace(this,s):(r=new Error).stack&&(a=r.stack,n=du(s),0<=(i=a.indexOf("\n"+n))&&(o=a.indexOf("\n",i+1),a=a.substring(o+1)),this.stack=a)}function yu(t,e){return"string"!=typeof t||t.length<e?t:t.slice(0,e)}function gu(t){if(lu()||!tu(t))return Fs(t);var e=du(t);return"[Function"+(e?": "+e:"")+"]"}function mu(t,e,r,n,i){throw new vu({message:r,actual:t,expected:e,operator:n,stackStartFunction:i})}function _u(t,e){t||mu(t,!0,e,"==",_u)}function bu(t,e,r,n){if(t===e)return!0;if(js(t)&&js(e))return 0===iu(t,e);if(Js(t)&&Js(e))return t.getTime()===e.getTime();if(Zs(t)&&Zs(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(hu(t)&&hu(e)&&cu(t)===cu(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===iu(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(js(t)!==js(e))return!1;var i=(n=n||{actual:[],expected:[]}).actual.indexOf(t);return-1!==i&&i===n.expected.indexOf(e)||(n.actual.push(t),n.expected.push(e),function(t,e,r,n){if(null==t||null==e)return!1;if(eu(t)||eu(e))return t===e;if(r&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=xu(t),o=xu(e);if(i&&!o||!i&&o)return!1;if(i)return bu(t=uu.call(t),e=uu.call(e),r);var a,s,u=su(t),l=su(e);if(u.length!==l.length)return!1;for(u.sort(),l.sort(),s=u.length-1;0<=s;s--)if(u[s]!==l[s])return!1;for(s=u.length-1;0<=s;s--)if(!bu(t[a=u[s]],e[a],r,n))return!1;return!0}(t,e,r,n))}return r?t===e:t==e}function xu(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function wu(t,e){if(t&&e){if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return 1}catch(t){}if(!Error.isPrototypeOf(e))return!0===e.call({},t)}}function Eu(t,e,r,n){var i;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(n=r,r=null),i=function(t){var e;try{t()}catch(t){e=t}return e}(e),n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:"."),t&&!i&&mu(i,r,"Missing expected exception"+n);var o="string"==typeof n,a=!t&&i&&!r;if((!t&&Qs(i)&&o&&wu(i,r)||a)&&mu(i,r,"Got unwanted exception"+n),t&&i&&r&&!wu(i,r)||!t&&i)throw i}function Tu(){}Hs(fu.AssertionError=vu,Error),fu.fail=mu,fu.ok=_u,fu.equal=function t(e,r,n){e!=r&&mu(e,r,n,"==",t)},fu.notEqual=function t(e,r,n){e==r&&mu(e,r,n,"!=",t)},fu.deepEqual=function t(e,r,n){bu(e,r,!1)||mu(e,r,n,"deepEqual",t)},fu.deepStrictEqual=function t(e,r,n){bu(e,r,!0)||mu(e,r,n,"deepStrictEqual",t)},fu.notDeepEqual=function t(e,r,n){bu(e,r,!1)&&mu(e,r,n,"notDeepEqual",t)},fu.notDeepStrictEqual=function t(e,r,n){bu(e,r,!0)&&mu(e,r,n,"notDeepStrictEqual",t)},fu.strictEqual=function t(e,r,n){e!==r&&mu(e,r,n,"===",t)},fu.notStrictEqual=function t(e,r,n){e===r&&mu(e,r,n,"!==",t)},fu.throws=function(t,e,r){Eu(!0,t,e,r)},fu.doesNotThrow=function(t,e,r){Eu(!1,t,e,r)},fu.ifError=function(t){if(t)throw t};var Au={sort:function(t){return t.sort(function(t,e){return Math.sqrt(Math.pow(t.height,2)+Math.pow(t.width,2))-Math.sqrt(Math.pow(e.height,2)+Math.pow(e.width,2))}),t},placeItems:function(t){var e=0,r=0;return t.forEach(function(t){t.x=e,t.y=r,e+=t.width,r+=t.height}),t}},ku={sort:function(t){return t.sort(function(t,e){return Math.sqrt(Math.pow(t.height,2)+Math.pow(t.width,2))-Math.sqrt(Math.pow(e.height,2)+Math.pow(e.width,2))}),t},placeItems:function(t){var e=0,r=0;return t.forEach(function(t){var n=t.width;t.x=e-n,t.y=r,e-=n,r+=t.height}),t}};Tu.prototype={fit:function(t){var e,r,n,i,o=t.length,a=0<o?t[0].width:0,s=0<o?t[0].height:0;for(this.root={x:0,y:0,width:a,height:s},e=0;e<o;e++)n=t[e],i=(r=this.findNode(this.root,n.width,n.height))?this.splitNode(r,n.width,n.height):this.growNode(n.width,n.height),n.x=i.x,n.y=i.y},findNode:function(t,e,r){return t.used?this.findNode(t.right,e,r)||this.findNode(t.down,e,r):e<=t.width&&r<=t.height?t:null},splitNode:function(t,e,r){return t.used=!0,t.down={x:t.x,y:t.y+r,width:t.width,height:t.height-r},t.right={x:t.x+e,y:t.y,width:t.width-e,height:r},t},growNode:function(t,e){var r=t<=this.root.width,n=e<=this.root.height,i=n&&this.root.height>=this.root.width+t,o=r&&this.root.width>=this.root.height+e;return i?this.growRight(t,e):o?this.growDown(t,e):n?this.growRight(t,e):r?this.growDown(t,e):null},growRight:function(t,e){var r;return this.root={used:!0,x:0,y:0,width:this.root.width+t,height:this.root.height,down:this.root,right:{x:this.root.width,y:0,width:t,height:this.root.height}},(r=this.findNode(this.root,t,e))?this.splitNode(r,t,e):null},growDown:function(t,e){var r;return this.root={used:!0,x:0,y:0,width:this.root.width,height:this.root.height+e,down:{x:0,y:this.root.height,width:this.root.width,height:e},right:this.root},(r=this.findNode(this.root,t,e))?this.splitNode(r,t,e):null}};var Su=Tu,Mu={sort:function(t){return t},placeItems:function(t){return function(t,e){e=e||{};var r=new Su,n=e.inPlace||!1,i=(i=t.map(function(t){return n?t:{width:t.width,height:t.height,item:t}})).sort(function(t,e){return e.width*e.height-t.width*t.height});r.fit(i);var o={width:i.reduce(function(t,e){return Math.max(t,e.x+e.width)},0),height:i.reduce(function(t,e){return Math.max(t,e.y+e.height)},0)};n||(o.items=i)}(t,{inPlace:!0}),t}},Ou={};function Iu(t,e){var r=t||"top-down";return"string"==typeof r&&fu(r=Ou[t],"Sorry, the '"+t+"' algorithm could not be loaded."),new Xa(r,e)}function Lu(t,e){Ou[t]=e}Iu.PackingSmith=Xa,Iu.addAlgorithm=Lu,Iu.algorithms=Ou,Lu("top-down",{sort:function(t){return t.sort(function(t,e){return t.height-e.height}),t},placeItems:function(t){var e=0;return t.forEach(function(t){t.x=0,t.y=e,e+=t.height}),t}}),Lu("left-right",{sort:function(t){return t.sort(function(t,e){return t.width-e.width}),t},placeItems:function(t){var e=0;return t.forEach(function(t){t.x=e,t.y=0,e+=t.width}),t}}),Lu("diagonal",Au),Lu("alt-diagonal",ku),Lu("binary-tree",Mu);var Cu=Iu;function Ru(t){var e;try{t.getContext("2d").getImageData(0,0,1,1)}catch(t){e=t.message}return e}function Pu(t,e,r){var n;return t instanceof HTMLImageElement&&((n=t.ownerDocument.createElement("canvas")).width=e,n.height=r,n.getContext("2d").drawImage(t,0,0,e,r),t=n),t}var Nu=Qn.metersToLatLng([Qn.half_circumference_meters,Qn.half_circumference_meters]),ju=Math.log(Qn.tile_size)/Math.LN2,Du=function(){En(e,Di);var t=In(e);function e(r,n){var i;return gn(this,e),i=t.call(this,r,n),ui.is_worker&&(i._quad_tree=new Xn.H.geo.QuadTree,i._marker_quad_tree=new Xn.H.geo.QuadTree,i._tree_entries_by_object_id={},i._groups_by_id={},i._layersCache=new Xn.H.util.Cache(100)),ui.is_main&&(i._objects_by_id={},i._commands=[],i._sendCommands=Ti(i._sendCommands,100,200),i.dispatchUpdate=i.dispatchUpdate.bind(On(i))),i}return _n(e,[{key:"hasLabeledData",value:function(){return!1}},{key:"onReady",value:function(){this._synced_at=this.provider.getInvalidations().getMark();var t,e,r=this.provider.getRootGroup(),n=r.getObjects(!0),i=[];for(n.push(r),t=n.length;t--;)e=n[t],this._isObjectSupported(e)&&this._shouldBeStored(e)&&(this._objects_by_id[e.getId()]=e,i.push(e.forWorkerMessage()));var o=[{method_name:"addObjects",arguments:[i]}];this._sendImmediateCommands(o)}},{key:"onProviderUpdate",value:function(t){var e,r,n,i,o=t.target,a=t.currentTarget.getInvalidations(o.type);this._isObjectSupported(o)&&(e=this._synced_at,r=o.getId(),a.isRemove(e)?(delete this._objects_by_id[r],this._commands.push({method_name:"removeObjectsByIds",arguments:[[r],!0]})):a.isAdd(e)?this._shouldBeStored(o)&&(this._objects_by_id[r]=o,this._commands.push({method_name:"addObjects",arguments:[[o.forWorkerMessage()]]})):a.isSpatial(e)||a.isZOrder(e)?this._shouldBeStored(o)&&(n=[{method_name:"removeObjectsByIds",arguments:[[r],!0]},{method_name:"addObjects",arguments:[[(this._objects_by_id[r]=o).forWorkerMessage()]]}],this.has_volatile_data&&!this.hasPendingCommands()?this._sendImmediateCommands(n):this._commands.push(n[0],n[1])):a.isVisual(e)?this._shouldBeStored(o)&&(i={method_name:"updateObjectProperties",arguments:[(this._objects_by_id[r]=o).forWorkerMessage()]},this.has_volatile_data&&!this.hasPendingCommands()?this._sendImmediateCommands([i]):this._commands.push(i)):a.isVolatility(e)&&(delete this._objects_by_id[r],this._commands.push({method_name:"removeObjectsByIds",arguments:[[r],!0]}),this._shouldBeStored(o)&&(this._objects_by_id[r]=o,this._commands.push({method_name:"addObjects",arguments:[[o.forWorkerMessage()]]}))),this._commands.length&&this._sendCommands()),this._synced_at=a.getMark()}},{key:"_shouldBeStored",value:function(t){return 16===t.type||(!t.getIcon||1===t.getIcon().getState())&&this._hasSameVolatility(t)}},{key:"_hasSameVolatility",value:function(t){return t.getVolatility(!0)===this.has_volatile_data}},{key:"hasPendingCommands",value:function(){return 0<this._commands.length}},{key:"_sendCommands",value:function(){this._sendImmediateCommands(this._commands),this._commands=[]}},{key:"_sendImmediateCommands",value:function(t){t.length&&li.postMessage(this.worker,this.target_name+".executeCommands",t).then(this.dispatchUpdate)}},{key:"_isObjectSupported",value:function(t){return t.forWorkerMessage&&8!==t.type}},{key:"getSyncedAt",value:function(){return this._synced_at}},{key:"getMapObjectById",value:function(t){return this._objects_by_id[t]}},{key:"getIconBitmapByObjectId",value:function(t,e){var r=this.getMapObjectById(t);if(r){var n=r.getIcon();if(n.uid===e&&1===n.getState()){var i=n.getSize();return Pu(n.getBitmap(),i.w,i.h)}}}},{key:"_getRastersForMarkers",value:function(t){for(var e={},r=Cu("binary-tree"),n=0;n<t.length;n++){var i=t[n],o=i.properties.icon;e[o.id]||(r.addItem({width:o.size.w,height:o.size.h,meta:{objectId:i.id,id:o.id}}),e[o.id]=!0)}return r.export()}},{key:"fetchFeaturesForTile",value:function(t){var r=[],n=[],i=[],o=[],a=[],s=this._marker_quad_tree.intersectBoundingBox(Qn.getTileBoundingBox(t.coords,this.tile_size));t.source_data.error=null;for(var u=0;u<s.length;u++){var l={id:s[u].$feature$.id,properties:Object.assign({},s[u].$feature$.properties),geometry:{type:s[u].$feature$.geometry.type,coordinates:wa.deepClone(s[u].$feature$.geometry.coordinates)}};r.push(l)}s=this._quad_tree.intersectBoundingBox(Qn.getTileBoundingBox(t.coords,this.tile_size,100));for(var c=0;c<s.length;c++){var h,f={id:s[c].$feature$.id,properties:Object.assign({},s[c].$feature$.properties),geometry:{type:s[c].$feature$.geometry.type,coordinates:wa.deepClone(s[c].$feature$.geometry.coordinates)}};f.properties.overlay?n.push(f):f.geometry.type.includes("LineString")?i.push(f):f.geometry.type.includes("Polygon")&&(o.push(f),h={id:f.id,properties:f.properties,geometry:{type:f.geometry.type,coordinates:wa.deepClone(f.geometry.coordinates)}},a.push(h))}r.sort(e._compareZInfo),o.sort(e._compareZInfo),n.sort(e._compareZInfo);var p=this.has_volatile_data?4096:0;a.sort(e._compareZInfo);for(var d=0;d<a.length;d++)a[d].properties.effectiveZIdx=p++;i.sort(e._compareZInfo);for(var v=0;v<i.length;v++)i[v].properties.effectiveZIdx=p++;t.source_data.layers.markers={type:"FeatureCollection",features:r},t.source_data.layers.polylines={type:"FeatureCollection",features:i},t.source_data.layers.polygons={type:"FeatureCollection",features:o},t.source_data.layers.outlines={type:"FeatureCollection",features:a},t.source_data.layers.overlays={type:"FeatureCollection",features:n}}},{key:"tileTexture",value:function(t){var e=t.source_data.layers.overlays;if(e){var r=this.name+"_"+t.coords.key,n=_a.coordinateWithMaxZoom(t.coords,this.max_zoom),i=e.features[0].properties.overlays_config;return{name:r,filtering:this.filtering,coords:n,width:Qn.tile_size,height:Qn.tile_size,overlays_config:i,source:this.name}}}},{key:"_load",value:function(t){var e=Qn.wrapTile(t.coords,{x:!0}),r=e.z,n=e.x,i=e.y,o="".concat(r,"_").concat(n,"_").concat(i),a=this._layersCache.get(o),s=!1;if(a)t.source_data.layers=a;else{this.fetchFeaturesForTile(t);var u={maxZoom:this.max_zoom,tolerance:1.5,extent:Qn.tile_scale},l=t.source_data.layers.overlays;l.features.length&&delete t.source_data.layers.overlays;var c=t.source_data.layers.markers;for(var h in c.features.length&&delete t.source_data.layers.markers,t.source_data.layers){var f,p=t.source_data.layers[h];p.features.length&&(u.buffer=h.includes("lines")?100*Qn.units_per_pixel:0,f=Ya(p,r,n,i,u),t.source_data.layers[h]=ao(f))}t.source_data.layers.overlays=this._processOverlays(t,l);for(var d=t.source_data.layers.overlays.features.length;d--;)if(!t.source_data.layers.overlays.features[d].id){s=!0,this._layersCache.drop(o);break}t.source_data.layers.markers=this._processMarkers(t,c),this._postProcessTile(t),s||this._layersCache.add(o,t.source_data.layers,1)}return t.rasters=this._getRastersForMarkers(t.source_data.layers.markers.features),Promise.resolve(t)}},{key:"_processMarkers",value:function(t,e){var r=e.features.length;if(r){for(var n=Qn.unitsPerMeter(t.coords.z),i=Qn.wrapTile(t.coords,{x:!0}),o=Qn.metersForTile(i),a=Qn.isLastTile(i),s=Qn.wrapMeters(t.min),u=Qn.wrapMeters(t.max),l=function(e){Ri.coordsToMeters(e);var r=Cn(e,2),i=r[0],l=r[1],c=i>=s.x&&(a.column||i<u.x)&&l>=u.y&&(a.row||!t.coords.y||l<s.y);return Ri.metersToTileUnits(n,o,e),c},c=[],h=0;h<r;h++){var f,p=e.features[h].geometry,d=!1;"Point"===p.type?l(f=p.coordinates)?p.coordinates=f:d=!0:"MultiPoint"===p.type&&(p.coordinates=p.coordinates.filter(l),0===p.coordinates.length&&(d=!0)),d||c.push(e.features[h])}e.features=c}return e}},{key:"_processOverlays",value:function(t,e){var r=this;if(!e.features.length)return e;var n={coords:t.coords,min:Qn.metersForTile(Qn.wrapTile(t.coords,{x:!0}))},i={coords:t.coords,source_data:{layers:{_default:{type:"FeatureCollection",features:e.features}}}},o=Math.pow(2,t.coords.z+ju);Di.projectData(i.source_data),Di.scaleData(i.source_data,n);var a=e.features.map(function(t){var e=t.geometry.coordinates[0],r=e[0],n=e[5===e.length?2:3],i=Math.floor(r[0]/Qn.tile_scale*Qn.tile_size),a=Math.floor(r[1]/Qn.tile_scale*Qn.tile_size),s=Math.floor(n[0]/Qn.tile_scale*Qn.tile_size),u=Math.floor(n[1]/Qn.tile_scale*Qn.tile_size)-a,l=s<=i,c=l?o-(i-s):s-i,h=[];return i<=Qn.tile_size&&h.push([i,a,c,u]),l&&0<s&&h.push([i-o,a,c,u]),{id:t.id,properties:t.properties,texcoords:h}}).filter(function(e){return r._isVisible(e.properties)&&r.isInMinMaxRange(e.properties,t.style_zoom)}),s=Qn.tile_scale;return t.pad_scale=this.pad_scale,t.default_winding="CW",e.features=a.length?[{geometry:{type:"Polygon",coordinates:[[[0,0],[s,0],[s,s],[0,s],[0,0]]]},properties:{overlays_config:a}}]:a,e}},{key:"executeCommands",value:function(t){for(var e,r=t.length<10,n=0;n<t.length;n++){var i=t[n];i.arguments.push(r);var o=this[i.method_name].apply(this,i.arguments);r&&(o&&e?e.mergeRect(o,!0,e):o&&(e=o))}return e?e.forWorkerMessage():void 0}},{key:"_getClampedGeoRectForFeature",value:function(t){var e=t.geometry.boundingBox;return new Xn.H.geo.Rect($n.clamp(e[0],-Nu[1],Nu[1]),e[1],$n.clamp(e[2],-Nu[1],Nu[1]),e[3])}},{key:"addObjects",value:function(t,r){for(var n,i=1<arguments.length&&void 0!==r&&r,o=0;o<t.length;o++){var a,s,u,l=t[o];"Group"===l.type?(l.$children_ids$={},this._groups_by_id[l.id]=l):(e._preprocessGeometry(l.geometry),a=this._getClampedGeoRectForFeature(l),i&&(n?n.mergeRect(a,!0,n):n=a),(u=(s=-1!==l.geometry.type.indexOf("Point")?this._marker_quad_tree:this._quad_tree).insertBoundingBox(a)).$tree=s,u.$feature$=l,this._tree_entries_by_object_id[l.id]=u)}for(var c=0;c<t.length;c++){var h=t[c];h.properties.parent&&(this._groups_by_id[h.properties.parent].$children_ids$[h.id]=h.id),h.properties.ref={effectiveVisibility:this._isVisible(h.properties),zInfo:this._getZInfo([],h)}}return this._layersCache.removeAll(),n}},{key:"removeObjectsByIds",value:function(t,e,r){for(var n,i=2<arguments.length&&void 0!==r&&r,o=0;o<t.length;o++){var a,s=t[o],u=void 0,l=void 0;(u=this._tree_entries_by_object_id[s])?(i&&(a=this._getClampedGeoRectForFeature(u.$feature$),n?n.mergeRect(a,!0,n):n=a),delete this._groups_by_id[u.$feature$.properties.parent].$children_ids$[s],u.$tree.remove(u),delete this._tree_entries_by_object_id[s]):(l=this._groups_by_id[s])&&(l.properties.parent&&delete this._groups_by_id[l.properties.parent].$children_ids$[s],e&&this.removeObjectsByIds(Object.keys(l.$children_ids$),!0),delete this._groups_by_id[s])}return this._layersCache.removeAll(),n}},{key:"updateObjectProperties",value:function(t,e){var r,n=1<arguments.length&&void 0!==e&&e;return"Group"===t.type?(da(this._groups_by_id[t.id].properties,t.properties),this._groups_by_id[t.id].properties.ref.effectiveVisibility=this._isVisible(t.properties)):(this._tree_entries_by_object_id[t.id]||this.addObjects([t]),da(this._tree_entries_by_object_id[t.id].$feature$.properties,t.properties),this._tree_entries_by_object_id[t.id].$feature$.properties.ref.effectiveVisibility=this._isVisible(t.properties),n&&(r=this._getClampedGeoRectForFeature(t))),r}},{key:"_getZInfo",value:function(t,e){var r=e.properties.zIdx,n=e.properties.sIdx;return t[0]|=void 0!==r,t.splice(1,0,r||0,n<0?e.id:n),0===e.properties.parent?t:this._getZInfo(t,this._groups_by_id[e.properties.parent])}},{key:"_isVisible",value:function(t){var e=t.visible,r=!t.parent||this._isVisible(this._groups_by_id[t.parent].properties);return e&&r}},{key:"isInMinMaxRange",value:function(t,e){var r=t.min<=e&&t.max>=e,n=!t.parent||this.isInMinMaxRange(this._groups_by_id[t.parent].properties,e);return r&&n}},{key:"dispose",value:function(){this._commands=[],Ln(Tn(e.prototype),"dispose",this).call(this)}}],[{key:"_compareZInfo",value:function(t,e){for(var r,n=t.properties.ref.zInfo,i=e.properties.ref.zInfo,o=n.length,a=i.length,s=Math.min(o,a),u=1;u<s;u++)if(r=n[u]-i[u])return r;return o-a}},{key:"_preprocessGeometry",value:function(t){var r=t.type;t.coordinates="Point"===r?e._processPointCoordinates(t.coordinates):"MultiPoint"===r?t.coordinates.map(e._processPointCoordinates):"LineString"===r?e._processLineStringCoordinates(t.coordinates):"MultiLineString"===r?t.coordinates.map(e._processLineStringCoordinates):"Polygon"===r?t.coordinates.map(e._processPolygonCoordinates):"MultiPolygon"===r?t.coordinates.map(e._processMultiPolygonCoordinates):[]}},{key:"_processPointCoordinates",value:function(t){return[t[1],t[0],t[2]]}},{key:"_processLineStringCoordinates",value:function(t){return e._latLngAltArrayToLineString(t,!1)}},{key:"_processPolygonCoordinates",value:function(t){return e._latLngAltArrayToLineString(t,!0)}},{key:"_processMultiPolygonCoordinates",value:function(t){return t.map(e._processPolygonCoordinates)}},{key:"_latLngAltArrayToLineString",value:function(t,e){for(var r=[],n=t.length,i=0;i<n;i+=3)r.push([t[i+1],t[i]]);return e&&r.push([t[1],t[0]]),r}}]),e}();Di.register(Du,"ObjectSource");var zu=function(){function t(){gn(this,t),this._map={}}return _n(t,[{key:"set",value:function(t,e,r){var n;this._map[t]?this._map[t].accumulator.add(r):((n=new Set).add(r),this._map[t]={value:e,accumulator:n})}},{key:"get",value:function(t){return this._map[t]&&this._map[t].value}},{key:"delete",value:function(t,e){var r=this._map[t];r&&r.accumulator&&(r.accumulator.delete(e),0===r.accumulator.size&&delete this._map[t])}}]),t}(),Hu=function(){En(e,Di);var t=In(e);function e(r,n){var i;return gn(this,e),i=t.call(this,r,n),ui.is_worker||(i._icons=new zu),i}return _n(e,[{key:"onProviderUpdate",value:function(t){t.target instanceof H.map.provider.Tile?this.dispatchUpdate(t.target,t.data):this.dispatchUpdate(void 0,t.data)}},{key:"onReady",value:function(){var t=this.provider;t.setTileCanvasRendering&&t.setTileCanvasRendering(!1),t.providesMarkers()&&(this._onCacheDrop=this._onCacheDrop.bind(this),t.getCache().registerOnDrop(this._onCacheDrop)),this.dispatchUpdate()}},{key:"dispose",value:function(){Ln(Tn(e.prototype),"dispose",this).call(this);var t=this.provider;t.providesMarkers()&&t.getCache().deRegisterOnDrop(this._onCacheDrop)}},{key:"_onCacheDrop",value:function(t,e){this.provider.cacheFilter(t)&&this._deleteIcons(t,e.data)}},{key:"_deleteIcons",value:function(t,e){for(var r=0,n=e.length;r<n;r++){var i=e[r].getIcon();this._icons.delete(i.uid,t)}}},{key:"getIconBitmapByObjectId",value:function(t,e){var r=this._icons.get(e);return r&&r.getBitmap()}},{key:"requestMarkerTile",value:function(t){var e=this;return new Promise(function(r,n){e.provider?e.provider.requestTileAsPromise(t.x,t.y,t.z,!1).then(function(t){var n,i,o=[];if(t.data)for(i=(n=t.data).length;i--;){var a=n[i],s=a.getIcon();e._icons.set(s.uid,s,t.key),o.push(a.forWorkerMessage())}r(o)}):r([])})}},{key:"requestSpatialTile",value:function(t){var e=this;return new Promise(function(r,n){e.provider?e.provider.requestTileAsPromise(t.x,t.y,t.z,!1).then(function(t){var e,n=[];if(t.getObjects){e=t.getObjects();for(var i=0;i<e.length;i++){var o=e[i];n.push({id:o.getId(),geometries:o.getGeometriesForTile(t),isClosed:o.isClosed(),style:o.getStyle().forWorkerMessage()})}}r(n)}):r([])})}},{key:"_pointToArray",value:function(t){var e=Qn.tile_scale/this.tile_size;return[t.x*e,t.y*e]}},{key:"_getGeoJsonMultiPolygon",value:function(t){for(var e=t.geometries,r=e.length,n=[],i={coordinates:n,type:"MultiPolygon"},o=0;o<r;o++){var a=e[o],s=a.paths,u=s.length,l=a.interiorsIndex,c=a.outlinesIndex,h=Math.min(l,c,u),f=void 0,p=void 0;for(p=0;p<h;p++)f=[s[p].map(this._pointToArray,this)],n.push(f);if(1===h)for(h=Math.min(c,u),p=l;p<h;p++)f.push(s[p].map(this._pointToArray,this))}return i}},{key:"_getGeoJsonMultiLineString",value:function(t,e){for(var r=1<arguments.length&&void 0!==e&&e,n={coordinates:[],type:"MultiLineString"},i=t.geometries,o=0;o<i.length;o++)for(var a=i[o],s=r?a.outlinesIndex:0,u=r?a.paths.length:Math.min(a.interiorsIndex,a.outlinesIndex,a.paths.length),l=s;l<u;l++){var c=a.paths[l].map(this._pointToArray,this);n.coordinates.push(c)}return n}},{key:"_getGeoJsonGeometry",value:function(t,e){var r=1===e?this._getGeoJsonMultiPolygon(t):this._getGeoJsonMultiLineString(t,3===e);return r.coordinates.length?r:null}},{key:"_load",value:function(t){var e=this;return new Promise(function(r,n){var i=li.postMessage(e.target_name+".requestMarkerTile",t.coords).then(e._prepareTileData.bind(e,t)),o=new Promise(function(r,n){li.postMessage(e.target_name+".requestSpatialTile",t.coords).then(function(n){for(var i=[],o=[],a=[],s=0;s<n.length;s++){var u,l=n[s],c=void 0,h=l.isClosed?(c=o,1):(c=i,2),f=e._getGeoJsonGeometry(l,h);f&&(u={id:l.id,type:"Feature",properties:{height:0,style:l.style},geometry:f},2===h&&(u.properties.effectiveZIdx=i.length),c.push(u));var p=e._getGeoJsonGeometry(l,3);p&&a.push({id:l.id,type:"Feature",properties:{height:0,style:l.style,effectiveZIdx:a.length},geometry:p})}t.source_data.layers.polylines={type:"FeatureCollection",features:i},t.source_data.layers.polygons={type:"FeatureCollection",features:o},t.source_data.layers.outlines={type:"FeatureCollection",features:a},r(t)})});Promise.all([i,o]).then(function(n){e._postProcessTile(t),r(t)})})}},{key:"_prepareTileData",value:function(t,e){var r=Qn.wrapTile(t.coords,{x:!0,y:!0}),n=Qn.metersForTile(r);t.source_data.layers={markers:{features:e,type:"FeatureCollection"}};var i={coords:r,min:n},o=t.source_data,a=Cu("binary-tree"),s={};for(var u in o.layers)for(var l=o.layers[u].features.length,c=0;c<l;c++){var h=o.layers[u].features[c],f=h.properties.icon;s[f.id]||(a.addItem({width:f.size.w,height:f.size.h,meta:{objectId:h.id,id:f.id}}),s[f.id]=!0),Qn.transformGeometry(h.geometry,function(t){var e=t[0];t[0]=t[1],t[1]=e})}return t.rasters=a.export(),Di.projectData(t.source_data),Di.scaleData(t.source_data,i),t}}]),e}();Di.register(Hu,"ObjectTileSource");var Fu=function(){En(e,xa);var t=In(e);function e(r,n){var i;return gn(this,e),(i=t.call(this,r,n)).uid_=r.uid,i}return _n(e,[{key:"initialize",value:function(t,e){this.provider=t,this._on_update=e,this._onProviderUpdate=this._onProviderUpdate.bind(this),t.addEventListener("update",this._onProviderUpdate)}},{key:"_onProviderUpdate",value:function(){this._on_update(this.name)}},{key:"tileTexture",value:function(t){return Object.assign(Ln(Tn(e.prototype),"tileTexture",this).call(this,t),{uid:this.uid_,url:this.uid_+"_"+t.coords.key,coords:t.coords})}},{key:"dispose",value:function(){this.provider.removeEventListener("update",this._onProviderUpdate)}}]),e}();function Bu(t,e){var r=(e=this.options=function(t,e){for(var r in e)t[r]=e[r];return t}(Object.create(this.options),e)).debug;if(r&&console.time("preprocess data"),e.maxZoom<0||24<e.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=Aa(t,e);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=Ha(n,e)).length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Uu(t,e,r){return 32*((1<<t)*r+e)+t}Ri.register(Fu,"RemoteRasterTileSource"),Bu.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Bu.prototype.splitTile=function(t,e,r,n,i,o,a){for(var s=[t,e,r,n],u=this.options,l=u.debug;s.length;){n=s.pop(),r=s.pop(),e=s.pop(),t=s.pop();var c,h,f,p,d,v,y,g,m,_,b,x=1<<e,w=Uu(e,r,n),E=this.tiles[w];if(E||(1<l&&console.time("creation"),E=this.tiles[w]=qa(t,e,r,n,u),this.tileCoords.push({z:e,x:r,y:n}),l&&(1<l&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,r,n,E.numFeatures,E.numPoints,E.numSimplified),console.timeEnd("creation")),c="z"+e,this.stats[c]=(this.stats[c]||0)+1,this.total++)),E.source=t,i){if(e===u.maxZoom||e===i)continue;var T=1<<i-e;if(r!==Math.floor(o/T)||n!==Math.floor(a/T))continue}else if(e===u.indexMaxZoom||E.numPoints<=u.indexMaxPoints)continue;E.source=null,0!==t.length&&(1<l&&console.time("clipping"),f=.5-(h=.5*u.buffer/u.extent),d=1+h,m=v=y=g=null,_=Ca(t,x,r-h,r+(p=.5+h),0,E.minX,E.maxX,u),b=Ca(t,x,r+f,r+d,0,E.minX,E.maxX,u),t=null,_&&(m=Ca(_,x,n-h,n+p,1,E.minY,E.maxY,u),v=Ca(_,x,n+f,n+d,1,E.minY,E.maxY,u),_=null),b&&(y=Ca(b,x,n-h,n+p,1,E.minY,E.maxY,u),g=Ca(b,x,n+f,n+d,1,E.minY,E.maxY,u),b=null),1<l&&console.timeEnd("clipping"),s.push(m||[],e+1,2*r,2*n),s.push(v||[],e+1,2*r,2*n+1),s.push(y||[],e+1,2*r+1,2*n),s.push(g||[],e+1,2*r+1,2*n+1))}},Bu.prototype.getTile=function(t,e,r){var n=this.options,i=n.extent,o=n.debug;if(t<0||24<t)return null;var a=1<<t,s=Uu(t,e=(e%a+a)%a,r);if(this.tiles[s])return Ua(this.tiles[s],i);1<o&&console.log("drilling down to z%d-%d-%d",t,e,r);for(var u,l=t,c=e,h=r;!u&&0<l;)l--,c=Math.floor(c/2),h=Math.floor(h/2),u=this.tiles[Uu(l,c,h)];return u&&u.source?(1<o&&console.log("found parent tile z%d-%d-%d",l,c,h),1<o&&console.time("drilling down"),this.splitTile(u.source,l,c,h,t,e,r),1<o&&console.timeEnd("drilling down"),this.tiles[s]?Ua(this.tiles[s],i):null):null};var Gu={type:"FeatureCollection",features:[]},qu=function(){En(e,Di);var t=In(e);function e(r,n){return gn(this,e),r.tiled=!0,r.url="",t.call(this,r,n)}return _n(e,[{key:"fetchTile",value:function(t,e,r){return this.provider?this.provider.requestTileAsPromise(t,e,r).then(function(t){return t.data}):Promise.resolve(Gu)}},{key:"_load",value:function(t){var e=this,r=Qn.wrapTile(t.coords,{x:!0,y:!0}),n={indexMaxZoom:0,maxZoom:this.max_zoom,tolerance:1.5,extent:Qn.tile_scale};return li.postMessage(this.target_name+".fetchTile",r.x,r.y,r.z).then(function(i){for(var o in t.source_data.layers="FeatureCollection"===i.type?{_default:i}:i,t.source_data.layers){var a=new Bu(t.source_data.layers[o],n).getTile(r.z,r.x,r.y);t.source_data.layers[o]=ao(a)}return e._postProcessTile(t),t})}},{key:"onReady",value:function(){this.dispatchUpdate()}}]),e}();Ri.register(qu,"GeoJSONTileSource");var Vu,Wu={layers:{_default:{type:"FeatureCollection",features:[{type:"Point",geometry:{}}]}}},Yu=function(){En(e,Ri);var t=In(e);function e(r,n){return gn(this,e),r.max_zoom=0,t.call(this,r,n)}return _n(e,[{key:"load",value:function(t){return t.source_data="0/0/0"===t.coords.key?Wu:void 0,Promise.resolve(t)}}]),e}();Ri.register(Yu,"SkyBox");var Ku,Xu=Vu={draw_label_collision_boxes:!1,draw_label_texture_boxes:!1,suppress_label_fade_in:!1,suppress_snap_animation:!1,show_hidden_labels:!1,layer_stats:!1};function Zu(t,e){var r={};return e.forEach(function(e){return r[e]=t[e]}),r}var $u,Ju=Ku={},Qu=0;Ku.getContext=function(t,e){var r=!1;null==t&&((t=document.createElement("canvas")).style.position="absolute",t.style.top=0,t.style.left=0,t.style.zIndex=-1,document.body.appendChild(t),r=!0);var n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e);if(!n)throw new Error("Couldn't create WebGL context.");return n._tangram_id=Qu++,r?(Ku.resize(n,window.innerWidth,window.innerHeight,e.device_pixel_ratio),window.addEventListener("resize",function(){Ku.resize(n,window.innerWidth,window.innerHeight,e.device_pixel_ratio)})):Ku.resize(n,parseFloat(t.style.width),parseFloat(t.style.height),e.device_pixel_ratio),n},Ku.resize=function(t,e,r,n){t.canvas.style.width=e+"px",t.canvas.style.height=r+"px",t.canvas.width=Math.round(e*n),t.canvas.height=Math.round(r*n),t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,t.canvas.width,t.canvas.height)};var tl=$u={};$u.BYTE=5120,$u.UNSIGNED_BYTE=5121,$u.SHORT=5122,$u.UNSIGNED_SHORT=5123,$u.INT=5124,$u.UNSIGNED_INT=5125,$u.FLOAT=5126;var el,rl=Math.pow(2,16)-1,nl=1024,il=!1,ol=function(){function t(e){gn(this,t),this.size_=e||nl,this.position_=0,this.ArrayType_=Uint16Array,this.buffer_=new this.ArrayType_(this.size_),this.overflows_=!1}return _n(t,[{key:"push",value:function(t){if(!this.overflows_||il){if(rl<t){if(this.overflows_=!0,!il)return;this.ArrayType_===Uint16Array&&(this.ArrayType_=Uint32Array,this.buffer_=new this.ArrayType_(this.buffer_))}this.position_===this.size_&&this.expand_(),this.buffer_[this.position_]=t,this.position_+=1}}},{key:"end",value:function(){if(0===this.position_)return!1;var t=this.buffer_,e=this.position_;return this.buffer_=new this.ArrayType_(this.size_),this.position_=0,this.overflows_=!1,t.subarray(0,e)}},{key:"expand_",value:function(){this.size_=this.size_<<1;var t=new this.ArrayType_(this.size_);t.set(this.buffer_),this.buffer_=t}}]),t}();ol.setElementIndexUint=function(t){il=t};var al=(bn(el={},tl.FLOAT,Float32Array),bn(el,tl.BYTE,Int8Array),bn(el,tl.UNSIGNED_BYTE,Uint8Array),bn(el,tl.INT,Int32Array),bn(el,tl.UNSIGNED_INT,Uint32Array),bn(el,tl.SHORT,Int16Array),bn(el,tl.UNSIGNED_SHORT,Uint16Array),el),sl=function(){function t(e){var r=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).prealloc,n=void 0===r?500:r;gn(this,t),this.vertex_layout=e,this.vertex_elements=new ol,this.stride=this.vertex_layout.stride,0<t.array_pool.length?(this.vertex_buffer=t.array_pool.pop(),this.byte_length=this.vertex_buffer.byteLength,this.size=Math.floor(this.byte_length/this.stride),Ei("trace","VertexData: reused buffer of bytes ".concat(this.byte_length,", ").concat(this.size," vertices"))):(this.size=n,this.byte_length=this.stride*this.size,this.vertex_buffer=new Uint8Array(this.byte_length)),this.offset=0,this.vertex_count=0,this.realloc_count=0,this.setBufferViews(),this.setAddVertexFunction()}return _n(t,[{key:"setBufferViews",value:function(){var t=this;this.views={},this.views[tl.UNSIGNED_BYTE]=this.vertex_buffer,this.vertex_layout.dynamic_attribs.forEach(function(e){var r;null==t.views[e.type]&&(r=al[e.type],t.views[e.type]=new r(t.vertex_buffer.buffer))})}},{key:"checkBufferSize",value:function(){var e;this.offset+this.stride>this.byte_length&&(this.size=Math.floor(1.5*this.size),this.size-=this.size%4,this.byte_length=this.stride*this.size,(e=new Uint8Array(this.byte_length)).set(this.vertex_buffer),t.array_pool.push(this.vertex_buffer),this.vertex_buffer=e,this.setBufferViews(),this.realloc_count++)}},{key:"setAddVertexFunction",value:function(){this.vertexLayoutAddVertex=this.vertex_layout.getAddVertexFunction()}},{key:"addVertex",value:function(t){this.checkBufferSize(),this.vertexLayoutAddVertex(t,this.views,this.offset),this.offset+=this.stride,this.vertex_count++}},{key:"end",value:function(){return this.vertex_buffer=this.vertex_buffer.subarray(0,this.offset),this.element_buffer=this.vertex_elements.end(),Ei("trace","VertexData: ".concat(this.size," vertices total, realloc count ").concat(this.realloc_count)),this}}]),t}();sl.array_pool=[];var ul=function(){function t(e){gn(this,t),this.attribs=e,this.dynamic_attribs=this.attribs.filter(function(t){return!t.static}),this.components=[],this.index={},this.offset={};for(var r=this.stride=0,n=0,i=0;i<this.attribs.length;i++){var o=this.attribs[i];if(null==o.static){o.offset=this.stride,o.byte_size=o.size;var a=0;switch(o.type){case tl.FLOAT:case tl.INT:case tl.UNSIGNED_INT:o.byte_size*=4,a=2;break;case tl.SHORT:case tl.UNSIGNED_SHORT:o.byte_size*=2,a=1}3&o.byte_size&&(o.byte_size+=4-(3&o.byte_size)),this.stride+=o.byte_size;for(var s=o.offset>>a,u=0;u<o.size;u++)this.components.push({type:o.type,shift:a,offset:s++,index:n++});this.index[o.name]=r,r+=o.size,this.offset[o.name]=o.offset}else o.static=Array.isArray(o.static)?o.static:[o.static],o.method="vertexAttrib".concat(o.static.length,"fv")}}return _n(t,[{key:"enable",value:function(e,r,n){for(var i,o,a=0;a<this.attribs.length;a++)i=this.attribs[a],-1!==(o=r.attribute(i.name).location)&&(null==i.static?(t.enabled_attribs[o]&&!n||e.enableVertexAttribArray(o),e.vertexAttribPointer(o,i.size,i.type,i.normalized,this.stride,i.offset),t.enabled_attribs[o]=r):e[i.method]instanceof Function&&(e.enableVertexAttribArray(o),e[i.method](o,i.static),e.disableVertexAttribArray(o),delete t.enabled_attribs[o]));for(o in t.enabled_attribs)this.disableUnusedAttribute(e,o,r)}},{key:"disableUnusedAttribute",value:function(e,r,n){t.enabled_attribs[r]!==n&&(e.disableVertexAttribArray(r),delete t.enabled_attribs[r])}},{key:"createVertexData",value:function(){return new sl(this)}},{key:"getAddVertexFunction",value:function(){return null==this.addVertex&&this.createAddVertexFunction(),this.addVertex}},{key:"createAddVertexFunction",value:function(){var e=Jo(JSON.stringify(this.attribs));if(null==t.add_vertex_funcs[e]){var r,n=["var t, o;"],i=Rn(this.components);i.sort(function(t,e){return t.type!==e.type?t.type-e.type:t.index-e.index});for(var o=0;o<i.length;o++){var a=i[o];r!==a.type&&(n.push("t = vs[".concat(a.type,"];")),n.push("o = off".concat(a.shift?" >> "+a.shift:"",";")),r=a.type),n.push("t[o + ".concat(a.offset,"] = v[").concat(a.index,"];"))}n=n.join("\n");var s=new Function("v","vs","off",n);t.add_vertex_funcs[e]=s}this.addVertex=t.add_vertex_funcs[e]}}]),t}();ul.enabled_attribs={},ul.add_vertex_funcs={};var ll=[{x:0,y:0},{x:Qn.tile_scale,y:-Qn.tile_scale}],cl=[0,0,1,1];function hl(t,e,r){var n=ll[0],i=ll[1];return t[0]<=n.x+r&&e[0]<=n.x+r||t[0]>=i.x-r&&e[0]>=i.x-r||t[1]>=n.y-r&&e[1]>=n.y-r||t[1]<=i.y+r&&e[1]<=i.y+r}function fl(t,e){e=e||0;var r=ll[0],n=ll[1];return t[0]<=r.x+e||t[0]>=n.x-e||t[1]>=r.y-e||t[1]<=n.y+e}var pl=dl;function dl(t,e,r){r=r||2;var n,i,o,a,s,u,l,c=e&&e.length,h=c?e[0]*r:t.length,f=vl(t,0,h,r,!0),p=[];if(!f)return p;if(c&&(f=function(t,e,r,n){var i,o,a,s=[];for(i=0,o=e.length;i<o;i++)(a=vl(t,e[i]*n,i<o-1?e[i+1]*n:t.length,n,!1))===a.next&&(a.steiner=!0),s.push(function(t){for(var e=t,r=t;e.x<r.x&&(r=e),(e=e.next)!==t;);return r}(a));for(s.sort(gl),i=0;i<s.length;i++)!function(t,e){var r;(e=function(t,e){var r,n=e,i=t.x,o=t.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&a<s){if((a=s)===i){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!r)return null;if(i===a)return r.prev;var u,l=r,c=r.x,h=r.y,f=1/0;for(n=r.next;n!==l;)i>=n.x&&n.x>=c&&_l(o<h?i:a,o,c,h,o<h?a:i,o,n.x,n.y)&&((u=Math.abs(o-n.y)/(i-n.x))<f||u===f&&n.x>r.x)&&El(n,t)&&(r=n,f=u),n=n.next;return r}(t,e))&&yl(r=Tl(e,t),r.next)}(s[i],r),r=yl(r,r.next);return r}(t,e,f,r)),t.length>80*r){n=o=t[0],i=a=t[1];for(var d=r;d<h;d+=r)(s=t[d])<n&&(n=s),(u=t[d+1])<i&&(i=u),o<s&&(o=s),a<u&&(a=u);l=Math.max(o-n,a-i)}return function t(e,r,n,i,o,a,s){if(e){!s&&a&&function(t,e,r,n){for(var i=t;null===i.z&&(i.z=ml(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,(i=i.next)!==t;);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,r,n,i,o,a,s,u,l=1;do{for(r=t,o=t=null,a=0;r;){for(a++,n=r,e=s=0;e<l&&(s++,n=n.nextZ);e++);for(u=l;0<s||0<u&&n;)0!==s&&(0===u||!n||r.z<=n.z)?(r=(i=r).nextZ,s--):(n=(i=n).nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;r=n}o.nextZ=null,l*=2}while(1<a)}(i)}(e,i,o,a);for(var u,l,c=e;e.prev!==e.next;)if(u=e.prev,l=e.next,a?function(t,e,r,n){var i=t.prev,o=t,a=t.next;if(0<=bl(i,o,a))return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,l=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,c=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=ml(s,u,e,r,n),f=ml(l,c,e,r,n),p=t.nextZ;p&&p.z<=f;){if(p!==t.prev&&p!==t.next&&_l(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=bl(p.prev,p,p.next))return!1;p=p.nextZ}for(p=t.prevZ;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&_l(i.x,i.y,o.x,o.y,a.x,a.y,p.x,p.y)&&0<=bl(p.prev,p,p.next))return!1;p=p.prevZ}return!0}(e,i,o,a):function(t){var e=t.prev,r=t,n=t.next;if(0<=bl(e,r,n))return!1;for(var i=t.next.next;i!==t.prev;){if(_l(e.x,e.y,r.x,r.y,n.x,n.y,i.x,i.y)&&0<=bl(i.prev,i,i.next))return!1;i=i.next}return!0}(e))r.push(u.i/n),r.push(e.i/n),r.push(l.i/n),kl(e),e=l.next,c=l.next;else if((e=l)===c){s?1===s?t(e=function(t,e,r){var n=t;do{var i=n.prev,o=n.next.next;!xl(i,o)&&wl(i,n,n.next,o)&&El(i,o)&&El(o,i)&&(e.push(i.i/r),e.push(n.i/r),e.push(o.i/r),kl(n),kl(n.next),n=t=o),n=n.next}while(n!==t);return n}(e,r,n),r,n,i,o,a,2):2===s&&function(e,r,n,i,o,a){var s=e;do{for(var u=s.next.next;u!==s.prev;){if(s.i!==u.i&&function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&wl(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&El(t,e)&&El(e,t)&&function(t,e){for(var r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;r.y>o!=r.next.y>o&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),(r=r.next)!==t;);return n}(t,e)}(s,u)){var l=Tl(s,u);return s=yl(s,s.next),l=yl(l,l.next),t(s,r,n,i,o,a),t(l,r,n,i,o,a)}u=u.next}s=s.next}while(s!==e)}(e,r,n,i,o,a):t(yl(e),r,n,i,o,a,1);break}}}(f,p,r,n,i,l),p}function vl(t,e,r,n,i){var o,a;if(i===0<Ml(t,e,r,n))for(o=e;o<r;o+=n)a=Al(o,t[o],t[o+1],a);else for(o=r-n;e<=o;o-=n)a=Al(o,t[o],t[o+1],a);return a&&xl(a,a.next)&&(kl(a),a=a.next),a}function yl(t,e){if(!t)return t;e=e||t;var r,n=t;do{if(r=!1,n.steiner||!xl(n,n.next)&&0!==bl(n.prev,n,n.next))n=n.next;else{if(kl(n),(n=e=n.prev)===n.next)return null;r=!0}}while(r||n!==e);return e}function gl(t,e){return t.x-e.x}function ml(t,e,r,n,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)/i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)/i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function _l(t,e,r,n,i,o,a,s){return 0<=(i-a)*(e-s)-(t-a)*(o-s)&&0<=(t-a)*(n-s)-(r-a)*(e-s)&&0<=(r-a)*(o-s)-(i-a)*(n-s)}function bl(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function xl(t,e){return t.x===e.x&&t.y===e.y}function wl(t,e,r,n){return xl(t,e)&&xl(r,n)||xl(t,n)&&xl(r,e)||0<bl(t,e,r)!=0<bl(t,e,n)&&0<bl(r,n,t)!=0<bl(r,n,e)}function El(t,e){return bl(t.prev,t,t.next)<0?0<=bl(t,e,t.next)&&0<=bl(t,t.prev,e):bl(t,e,t.prev)<0||bl(t,t.next,e)<0}function Tl(t,e){var r=new Sl(t.i,t.x,t.y),n=new Sl(e.i,e.x,e.y),i=t.next,o=e.prev;return(t.next=e).prev=t,(r.next=i).prev=r,(n.next=r).prev=n,(o.next=n).prev=o,n}function Al(t,e,r,n){var i=new Sl(t,e,r);return n?(i.next=n.next,(i.prev=n).next.prev=i,n.next=i):(i.prev=i).next=i,i}function kl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Sl(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ml(t,e,r,n){for(var i=0,o=e,a=r-n;o<r;o+=n)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}dl.deviation=function(t,e,r,n){var i=e&&e.length,o=i?e[0]*r:t.length,a=Math.abs(Ml(t,0,o,r));if(i)for(var s=0,u=e.length;s<u;s++){var l=e[s]*r,c=s<u-1?e[s+1]*r:t.length;a-=Math.abs(Ml(t,l,c,r))}var h=0;for(s=0;s<n.length;s+=3){var f=n[s]*r,p=n[s+1]*r,d=n[s+2]*r;h+=Math.abs((t[f]-t[d])*(t[1+p]-t[1+f])-(t[f]-t[p])*(t[1+d]-t[1+f]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},dl.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)r.vertices.push(t[i][o][a]);0<i&&(n+=t[i-1].length,r.holes.push(n))}return r};var Ol=[0,0,1];function Il(t,e,r,n){var i,o,a,s,u,l=n.texcoord_index,c=n.texcoord_scale,h=n.texcoord_normalize,f=e.vertex_elements;l&&(h=h||1,o=(i=Cn(c||cl,4))[0],a=i[1],s=i[2],u=i[3]);for(var p,d=0,v=t.length,y=0;y<v;y++){var g,m,_,b,x,w=e.vertex_count,E=t[y];l&&(m=(g=Cn(Qn.findBoundingBox(E),4))[0],_=g[1],b=(s-o)/(g[2]-m),x=(u-a)/(g[3]-_));for(var T=0;T<E.length;T++)for(var A=E[T],k=0;k<A.length;k++){var S=A[k];r[0]=S[0],r[1]=S[1],l&&(r[l+0]=((S[0]-m)*b+o)*h,r[l+1]=((S[1]-_)*x+a)*h),e.addVertex(r)}for(var M=(p=pl.flatten(E),pl(p.vertices,p.holes,p.dimensions)),O=0;O<M.length;O++)f.push(w+M[O]);d+=M.length/3}return d}var Ll="uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;attribute vec4 a_position;attribute vec4 a_color;\n#ifdef TANGRAM_NORMAL_ATTRIBUTE\nattribute vec3 a_normal;\n#define TANGRAM_NORMAL a_normal\n#else\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#endif\n#ifdef TANGRAM_EXTRUDE_LINES\nattribute vec2 a_extrude;attribute vec2 a_offset;attribute vec2 a_scaling;uniform float u_v_scale_adjust;\n#endif\nvarying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#if defined(TANGRAM_TEXTURE_COORDS) || defined(TANGRAM_EXTRUDE_LINES)\nattribute vec2 a_texcoord;varying vec2 v_texcoord;\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#define UNPACK_SCALING(x) (x / 1024.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\nvoid main(){\n#pragma tangram: setup\n#ifdef TANGRAM_TEXTURE_COORDS\nv_texcoord=a_texcoord;\n#ifdef TANGRAM_EXTRUDE_LINES\nv_texcoord.y*=u_v_scale_adjust;\n#endif\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nv_modelpos_base_zoom=modelPositionBaseZoom();\n#endif\nvec4 position=vec4(a_position.xy,a_position.z/TANGRAM_HEIGHT_SCALE,1.);\n#ifdef TANGRAM_EXTRUDE_LINES\nvec2 extrude=a_extrude.xy;vec2 offset=a_offset.xy;float dz=clamp(u_map_position.z-u_tile_origin.z,0.,4.);dz+=step(1.,dz)*(1.-dz)+mix(0.,2.,clamp((dz-2.)/2.,0.,1.));float mdz=(dz-0.5)*2.;extrude-=extrude*UNPACK_SCALING(a_scaling.x)*mdz;float dwdz=UNPACK_SCALING(a_scaling.y);float sdwdz=sign(step(0.,dwdz)-0.5);offset-=offset*abs(dwdz)*((1.-step(0.,sdwdz))-(dz*-sdwdz));float ssz=exp2(-dz-(u_tile_origin.z-u_tile_origin.w));extrude*=ssz;offset*=ssz;\n#ifdef TANGRAM_BLOCK_WIDTH\nfloat width=1.;\n#pragma tangram: width\nextrude*=width;\n#endif\nposition.xy+=extrude+offset;\n#endif\nv_world_position=wrapWorldPosition(u_model*position);v_local_space_position=position;position=u_modelView*position;\n#pragma tangram: position\nv_position=position;v_normal=normalize(u_normalMatrix*TANGRAM_NORMAL);v_color=a_color;\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvec3 normal=v_normal;\n#pragma tangram: normal\nv_lighting=calculateLighting(position.xyz-u_eye,normal,vec4(1.));\n#endif\ncameraProjection(position);applyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);\n#if defined(SNAP_TO_PIXEL_GRID)\nsnapToPixelGrid(position);\n#endif\ngl_Position=position;}",Cl="uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_EXTRUDE_LINES\nuniform bool u_has_line_texture;uniform sampler2D u_texture;uniform float u_texture_ratio;uniform vec4 u_dash_background_color;\n#endif\n#define TANGRAM_NORMAL v_normal\n#if defined(TANGRAM_TEXTURE_COORDS) || defined(TANGRAM_EXTRUDE_LINES)\nvarying vec2 v_texcoord;\n#endif\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\n#pragma tangram: utils\nvoid main(void){\n#pragma tangram: setup\nvec4 color=v_color;vec3 normal=TANGRAM_NORMAL;\n#ifdef TANGRAM_CROP_BY_TILE\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}\n#endif\n#ifdef TANGRAM_RASTER_TEXTURE_COLOR\ncolor*=sampleRaster();\n#endif\n#ifdef TANGRAM_EXTRUDE_LINES\nif(u_has_line_texture){vec2 _line_st=vec2(v_texcoord.x,fract(v_texcoord.y/u_texture_ratio));vec4 _line_color=texture2D(u_texture,_line_st);if(_line_color.a<TANGRAM_ALPHA_TEST){\n#if !defined(TANGRAM_BLEND_OVERLAY) && !defined(TANGRAM_BLEND_INLAY)\nif(u_dash_background_color.a==0.){discard;}color=u_dash_background_color;\n#else\ncolor=vec4(u_dash_background_color.rgb,color.a*step(TANGRAM_EPSILON,u_dash_background_color.a));\n#endif\n}else{color*=_line_color;}}\n#endif\n#ifdef TANGRAM_RASTER_TEXTURE_NORMAL\nnormal=normalize(sampleRaster().rgb*2.-1.);\n#endif\n#if defined(TANGRAM_LIGHTING_FRAGMENT) && defined(TANGRAM_MATERIAL_NORMAL_TEXTURE)\ncalculateNormal(normal);\n#endif\n#if !defined(TANGRAM_LIGHTING_VERTEX)\n#pragma tangram: normal\n#endif\n#pragma tangram: color\n#if defined(TANGRAM_LIGHTING_FRAGMENT)\ncolor=calculateLighting(v_position.xyz-u_eye,normal,color);\n#elif defined(TANGRAM_LIGHTING_VERTEX)\ncolor*=v_lighting;\n#endif\n#pragma tangram: filter\ngl_FragColor=color;}",Rl=Object.create(ya);Object.assign(Rl,{name:"polygons",built_in:!0,vertex_shader_src:Ll,fragment_shader_src:Cl,selection:!0,init:function(){ya.init.apply(this,arguments),this.defines.TANGRAM_NORMAL_ATTRIBUTE=!0,this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.texcoords&&(this.defines.TANGRAM_TEXTURE_COORDS=!0)},vertexLayoutForMeshVariant:function(){var t;return this.vertex_layout||(t=[{name:"a_position",size:4,type:tl.SHORT,normalized:!1},{name:"a_normal",size:3,type:tl.BYTE,normalized:!0},{name:"a_color",size:4,type:tl.UNSIGNED_BYTE,normalized:!0},{name:"a_selection_color",size:4,type:tl.UNSIGNED_BYTE,normalized:!0}],this.texcoords&&t.push({name:"a_texcoord",size:2,type:tl.UNSIGNED_SHORT,normalized:!0}),this.vertex_layout=new ul(t)),this.vertex_layout},_parseFeature:function(t,e,r){var n=this.feature_style;return n.color=this.parseColor(e.color,r),n.color?(n.z=e.z&&yo.evalCachedDistanceProperty(e.z,r)||yo.defaults.z,n.z*=Qn.height_scale,n.extrude=yo.evalProperty(e.extrude,r),n.extrude&&(!0===n.extrude?(n.height=void 0!==t.properties.height?t.properties.height:yo.defaults.height,n.min_height=void 0!==t.properties.min_height?t.properties.min_height:yo.defaults.min_height):"number"==typeof n.extrude?(n.height=n.extrude,n.min_height=0):Array.isArray(n.extrude)&&(n.min_height=n.extrude[0],n.height=n.extrude[1]),n.height*=Qn.height_scale,n.min_height*=Qn.height_scale),n.tile_edges=e.tile_edges,n):null},_preprocess:function(t){return t.color=yo.createColorPropertyCache(t.color),t.z=yo.createPropertyCache(t.z,yo.parseUnits),t},makeVertexTemplate:function(t){var e=0;return this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=t.z||0,this.vertex_template[e++]=this.scaleOrder(t.order),this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=127,this.vertex_template[e++]=255*t.color[0],this.vertex_template[e++]=255*t.color[1],this.vertex_template[e++]=255*t.color[2],this.vertex_template[e++]=255*t.color[3],this.selection&&(this.vertex_template[e++]=255*t.selection_color[0],this.vertex_template[e++]=255*t.selection_color[1],this.vertex_template[e++]=255*t.selection_color[2],this.vertex_template[e++]=255*t.selection_color[3]),this.texcoords&&(this.vertex_template[e++]=0,this.vertex_template[e++]=0),this.vertex_template},buildPolygons:function(t,e,r,n){var i=this.makeVertexTemplate(e),o={texcoord_index:this.vertex_layout.index.a_texcoord,texcoord_normalize:65535,remove_tile_edges:!e.tile_edges,tile_edge_tolerance:Qn.tile_scale*n.tile.pad_scale*4,winding:n.winding};return e.extrude&&e.height?function(t,e,r,n,i,o,a,s,u){var l=u.remove_tile_edges,c=u.tile_edge_tolerance,h=u.texcoord_index,f=u.texcoord_scale,p=u.texcoord_normalize,d=u.winding,v=e+(n||0),y=e+r;o[2]=y;var g,m,_,b,x,w,E=Il(t,i,o,{texcoord_index:h,texcoord_scale:f,texcoord_normalize:p}),T=i.vertex_elements,A=i.vertex_count;h&&(p=p||1,m=(g=Cn(f||cl,4))[0],_=g[1],b=g[2],w=[[m,x=g[3]],[m,_],[b,_],[b,x]]);for(var k=t.length,S=0;S<k;S++)for(var M=t[S],O=0;O<M.length;O++)for(var I=M[O],L=0;L<I.length-1;L++)if(!l||!hl(I[L],I[L+1],c)){var C,R=void 0,P=[[I[C="CCW"===d?(R=L)+1:(R=L+1,L)][0],I[C][1],y],[I[C][0],I[C][1],v],[I[R][0],I[R][1],v],[I[R][0],I[R][1],y]],N=ua.normalize([I[C][0]-I[R][0],I[C][1]-I[R][1],0]),j=ua.cross(Ol,N);o[a+0]=127*j[0],o[a+1]=127*j[1],o[a+2]=127*j[2];for(var D=0;D<P.length;D++)o[0]=P[D][0],o[1]=P[D][1],o[2]=P[D][2],h&&(o[h+0]=w[D][0]*p,o[h+1]=w[D][1]*p),i.addVertex(o);T.push(A+0),T.push(A+1),T.push(A+2),T.push(A+2),T.push(A+3),T.push(A+0),A+=4,E+=2}return E}(t,e.z,e.height,e.min_height,r.vertex_data,i,this.vertex_layout.index.a_normal,0,o):Il(t,r.vertex_data,i,o)}});var Pl=[0,0],Nl={butt:0,square:1,round:2},jl={miter:0,bevel:1,round:2},Dl={MITER_LIMIT:3,TEXCOORD_NORMALIZE:1,TEXCOORD_RATIO:1,MIN_FAN_WIDTH:5},zl=Qn.tile_scale,Hl=[0,0],Fl=[1,0],Bl=[.5,0];function Ul(t,e){if(!(t.length<2)){var r,n,i=e.join_type,o=e.cap_type,a=e.closed_polygon,s=e.remove_tile_edges,u=e.tile_edge_tolerance,l=e.v_scale,c=e.miter_len_sq,h=e.crop_by_tile,f=null!=e.texcoord_index,p=0;if(a&&i===jl.miter){var d=function(t){if(fl(t[0]))return 0;for(var e=0;e<t.length;e++)if(fl(t[t.length-1-e]))return t.length-1-e;return 0}(t);if(0!==d){var v=function(t,e){for(var r=[],n=0;n<t.length;n++){var i=(n+e)%t.length;0!=i&&r.push(t[i])}return r.push(r[0]),r}(t,d);return e.extra_lines=e.extra_lines||[],void e.extra_lines.push(v)}}var y=0,g=t.length-1,m=0;for(E=t[y],T=t[y+1];ua.isEqual(E,T);)if(E=T,T=t[++y+1],m++,y===t.length-1)return;for(;ua.isEqual(t[g],t[g-1]);)if(m++,0==--g)return;if(!(t.length<2+m))if(n=ua.normalize(ua.perp(E,T)),s&&hl(E,T,u)){var _=Gl(t,y,u);_&&(e.extra_lines=e.extra_lines||[],e.extra_lines.push(_))}else{a?function(t,e,r,n,i){void 0===n||fl(t)&&!i.crop_by_tile?(Kl(t,r,r,1,0,i,1),Kl(t,r,r,0,0,i,-1)):n===jl.miter?Vl(0,t,e,r,i.miter_len_sq,!0,i):Wl(n,0,t,e,r,!0,i)}(E,r=ua.normalize(ua.perp(t[g-1],E)),n,i,e):(!h&&fl(E)||($l(E,p,n,o,!0,e),f&&o!==Nl.butt&&(p+=.5*l*e.texcoord_width)),Kl(E,n,n,1,p,e,1),Kl(E,n,n,0,p,e,-1)),f&&(p+=l*ua.length(ua.sub(T,E)));for(var b=y+1;b<g;b++){var x=b,w=b+1,E=t[x],T=t[w];if(!ua.isEqual(E,T)){if(s&&hl(E,T,u)){Kl(E,n,n,1,p,e,1),Kl(E,n,n,0,p,e,-1),Yl(1,e);var A=Gl(t,x+1,u);return void(A&&(e.extra_lines=e.extra_lines||[],e.extra_lines.push(A)))}r=n,n=ua.normalize(ua.perp(E,T)),i===jl.miter?Vl(p,E,r,n,c,!1,e):Wl(i,p,E,r,n,!1,e),f&&(p+=l*ua.length(ua.sub(T,E)))}}E=T,r=n,a?function(t,e,r,n,i,o){var a;fl(t)&&!o.crop_by_tile?(Kl(t,e,e,1,i,o,1),Kl(t,e,e,0,i,o,-1)):(a=ql(e,r),n===jl.miter&&ua.lengthSq(a)>o.miter_len_sq&&(n=jl.bevel),n===jl.miter?(Kl(t,a,e,1,i,o,1),Kl(t,a,e,0,i,o,-1)):(Kl(t,e,e,1,i,o,1),Kl(t,e,e,0,i,o,-1))),Yl(1,o)}(E,r,n=ua.normalize(ua.perp(E,t[1])),i,p,e):(Kl(E,r,n,1,p,e,1),Kl(E,r,n,0,p,e,-1),Yl(1,e),!h&&fl(E)||$l(E,p,r,o,!1,e))}}}function Gl(t,e,r){for(var n=e;t[n+1]&&hl(t[n],t[n+1],r);)n++;return 2<=t.length-n&&t.slice(n)}function ql(t,e){var r=ua.normalize(ua.add(t,e)),n=2/(1+Math.abs(ua.dot(t,r)));return ua.mult(r,n*n)}function Vl(t,e,r,n,i,o,a){var s=ql(r,n);ua.lengthSq(s)>i?Wl(jl.bevel,t,e,r,n,o,a):(Kl(e,s,s,1,t,a,1),Kl(e,s,s,0,t,a,-1),o||Yl(1,a))}function Wl(t,e,r,n,i,o,a){var s=ql(n,i),u=0<i[0]*n[1]-i[1]*n[0];null!=a.texcoord_index&&(Hl[1]=e,Fl[1]=e),u?(Kl(r,s,s,1,e,a,1),Kl(r,n,s,0,e,a,-1),o||Yl(1,a),Zl(r,ua.neg(n),s,ua.neg(i),s,Hl,Fl,Hl,!1,t===jl.bevel,a),Kl(r,s,s,1,e,a,1),Kl(r,i,s,0,e,a,-1)):(Kl(r,n,s,1,e,a,1),Kl(r,s,s,0,e,a,-1),o||Yl(1,a),Zl(r,n,ua.neg(s),i,s,Fl,Hl,Fl,!1,t===jl.bevel,a),Kl(r,i,s,1,e,a,1),Kl(r,s,s,0,e,a,-1))}function Yl(t,e){for(var r=e.vertex_data.vertex_elements,n=e.vertex_data.vertex_count-2*t-2,i=0;i<t;i++)r.push(n+2*i+2),r.push(n+2*i+1),r.push(n+2*i),r.push(n+2*i+2),r.push(n+2*i+3),r.push(n+2*i+1),e.geom_count+=2}function Kl(t,e,r,n,i,o,a){var s=o.vertex_template,u=o.vertex_data;s[0]=t[0],s[1]=t[1];var l=o.half_width*a;s[o.extrude_index+0]=e[0]*l,s[o.extrude_index+1]=e[1]*l,o.offset&&(s[o.offset_index+0]=r[0]*o.offset,s[o.offset_index+1]=r[1]*o.offset),null!=o.texcoord_index&&(s[o.texcoord_index+0]=n*o.texcoord_normalize,s[o.texcoord_index+1]=i*o.texcoord_normalize),u.addVertex(s)}var Xl=[0,0];function Zl(t,e,r,n,i,o,a,s,u,l,c){for(var h=e[0]*n[1]-e[1]*n[0],f=ua.dot(e,n),p=Math.atan2(h,f);p>=Math.PI;)p-=2*Math.PI;if(l)d=1;else{var d=function(t,e){t<0&&(t=-t);var r=e>2*Dl.MIN_FAN_WIDTH?Math.log2(e/Dl.MIN_FAN_WIDTH):1;return Math.ceil(t/Math.PI*r)}(p,c.half_width);if(d<1)return}var v=c.vertex_data.vertex_count,y=c.vertex_data.vertex_elements;Kl(t,r,i,a[0],a[1],c,1),Kl(t,e,i,o[0],o[1],c,1);var g,m,_=e,b=null!=c.texcoord_index;b&&(u?g=ua.sub(o,a):(Xl=ua.copy(o),m=ua.div(ua.sub(s,o),d)));for(var x,w=p/d,E=p<0?-1:1,T=0<h?(x=2,1):(x=1,2),A=0;A<d;A++)0===A&&p<0&&(_=ua.neg(_)),_=ua.rot(_,w),b&&(u?(g=ua.rot(g,w),Xl[0]=g[0]+a[0],Xl[1]=g[1]*c.texcoord_width*c.v_scale+a[1]):Xl=ua.add(Xl,m)),Kl(t,_,i,Xl[0],Xl[1],c,E),y.push(v+A+x),y.push(v),y.push(v+A+T)}function $l(t,e,r,n,i,o){var a,s=ua.neg(r),u=null!=o.texcoord_index;switch(n){case Nl.square:i?(a=[r[1],-r[0]],Kl(t,ua.add(r,a),r,1,e,o,1),Kl(t,ua.add(s,a),r,0,e,o,1),u&&(e+=.5*o.texcoord_width*o.v_scale),Kl(t,r,r,1,e,o,1),Kl(t,s,r,0,e,o,1)):(a=[-r[1],r[0]],Kl(t,r,r,1,e,o,1),Kl(t,s,r,0,e,o,1),u&&(e+=.5*o.texcoord_width*o.v_scale),Kl(t,ua.add(r,a),r,1,e,o,1),Kl(t,ua.add(s,a),r,0,e,o,1)),Yl(1,o);break;case Nl.round:var l,c,h=Hl,f=Fl,p=Bl;i?(l=r,c=s,u&&(e+=.5*o.texcoord_width*o.v_scale,h=Fl,f=Hl,p=Bl)):(l=s,c=r),u&&(Hl[1]=e,Fl[1]=e,Bl[1]=e),Zl(t,l,Pl,c,r,h,p,f,!0,!1,o);break;case Nl.butt:return}}var Jl=[255,255,255,255],Ql=[0,0,0,0],tc=Object.create(ya);function ec(t){var e=t.vertex_data.vertex_elements,r=t.vertex_data.vertex_count-4;e.push(2+r),e.push(1+r),e.push(r),e.push(2+r),e.push(3+r),e.push(1+r),t.geom_count+=2}tc.vertex_layouts=[[],[]],tc.dash_textures={},Object.assign(tc,{name:"lines",built_in:!0,vertex_shader_src:Ll,fragment_shader_src:Cl,selection:!0,init:function(){ya.init.apply(this,arguments),this.styles=this.styles||{},this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_EXTRUDE_LINES=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.defines.TANGRAM_TEXTURE_COORDS=!0,this.outline_feature_style={},this.inline_feature_style=this.feature_style},calcDistance:function(t,e){return t&&yo.evalCachedDistanceProperty(t,e)||0},calcDistanceNextZoom:function(t,e){e.zoom++;var r=this.calcDistance(t,e);return e.zoom--,r},calcWidth:function(t,e,r){var n=this.calcDistance(t.width,r);if(!(n<0)){var i,o=t.next_width?this.calcDistanceNextZoom(t.next_width,r):n/2;return!(0===n&&0===o||o<0)&&(e.width_unscaled=n,e.next_width_unscaled=o,t.next_width?(i=.5*(n+(o*=2)),e.width=i*r.units_per_meter_overzoom,e.width_scale=1-o/i):(e.width=n*r.units_per_meter_overzoom,e.width_scale=0),t.texcoords&&(t.inline_texcoord_width?e.texcoord_width=t.inline_texcoord_width:e.texcoord_width=(e.width_unscaled||e.next_width_unscaled)*r.units_per_meter_overzoom/r.tile.overzoom2),!0)}},calcOffset:function(t,e,r){var n,i;t.offset_precalc?(e.offset=t.offset_precalc,e.offset_scale=t.offset_scale_precalc):t.offset?(n=this.calcDistance(t.offset,r),t.next_offset?(i=2*this.calcDistanceNextZoom(t.next_offset,r),Math.abs(n)>=Math.abs(i)?(e.offset=n*r.units_per_meter_overzoom,e.offset_scale=0!==n?1-i/n:0):(e.offset=i*r.units_per_meter_overzoom,e.offset_scale=0!=i?-1*(1-n/i):0)):(e.offset=n*r.units_per_meter_overzoom,e.offset_scale=0)):(e.offset=0,e.offset_scale=0),yo.evalProperty(t.offset_reverse,r)&&(e.offset*=-1)},_parseFeature:function(t,e,r){var n,i,o=this.feature_style;if(!1!==this.calcWidth(e,o,r)&&(this.calcOffset(e,o,r),o.color=this.parseColor(e.color,r),o.color))return o.variantKey=e.variantKey,o.z=e.z&&yo.evalCachedDistanceProperty(e.z||0,r)||yo.defaults.z,o.height=t.properties.height||yo.defaults.height,o.extrude=yo.evalProperty(e.extrude,r),o.extrude&&("number"==typeof o.extrude?o.height=o.extrude:Array.isArray(o.extrude)&&(o.height=o.extrude[1])),o.extrude&&o.height&&(o.z+=o.height),o.z*=Qn.height_scale,o.height*=Qn.height_scale,o.cap=yo.evalProperty(e.cap,r),o.join=yo.evalProperty(e.join,r),o.miter_limit=yo.evalProperty(e.miter_limit,r),o.tile_edges=e.tile_edges,o.outline=o.outline||{width:{},next_width:{},preprocessed:!0},e.outline&&!1!==e.outline.visible&&e.outline.color&&e.outline.width?(n=2*this.calcDistance(e.outline.width,r),i=2*this.calcDistanceNextZoom(e.outline.next_width,r),0==n&&0==i||n<0||i<0?(o.outline.width.value=null,o.outline.next_width.value=null,o.outline.color=null,o.outline.inline_texcoord_width=null,o.outline.texcoords=!1):(o.outline.width.value=n+o.width_unscaled,o.outline.next_width.value=i+o.next_width_unscaled,o.outline.inline_texcoord_width=o.texcoord_width,o.outline.offset_precalc=o.offset,o.outline.offset_scale_precalc=o.offset_scale,o.outline.color=e.outline.color,o.outline.cap=e.outline.cap,o.outline.join=e.outline.join,o.outline.miter_limit=e.outline.miter_limit,o.outline.texcoords=e.outline.texcoords,o.outline.style=e.outline.style,o.outline.variantKey=e.outline.variantKey,e.outline.order?o.outline.order=this.parseOrder(e.outline.order,r):o.outline.order=o.order,o.outline.order>o.order&&(o.outline.order=o.order),o.outline.order-=.5,o.outline.variant_order=0)):(o.outline.width.value=null,o.outline.next_width.value=null,o.outline.color=null,o.outline.inline_texcoord_width=null),o},_preprocess:function(t,e){var r,n=this.sources[e]?this.sources[e].config.uid:"";return t.color=yo.createColorPropertyCache(t.color),t.width=yo.createPropertyCache(t.width,yo.parseUnits),t.width&&t.width.type!==yo.CACHE_TYPE.STATIC&&(t.next_width=yo.createPropertyCache(t.width,yo.parseUnits)),t.offset=t.offset&&yo.createPropertyCache(t.offset,yo.parseUnits),t.offset&&t.offset.type!==yo.CACHE_TYPE.STATIC&&(t.next_offset=yo.createPropertyCache(t.offset,yo.parseUnits)),t.z=yo.createPropertyCache(t.z,yo.parseUnits),t.dash=void 0!==t.dash?t.dash:this.dash,t.dash_key=t.dash&&this.dashTextureKey(t.dash,n),t.dash_background_color=void 0!==t.dash_background_color?t.dash_background_color:this.dash_background_color,t.dash_background_color=t.dash_background_color&&yo.parseColor(t.dash_background_color),t.texture_merged=t.dash_key||(void 0!==t.texture?t.texture:this.texture),t.texcoords=this.texcoords||t.texture_merged?1:0,this.addMeshVariantForDraw(this.base,t),t.outline&&(t.outline.style=t.outline.style||this.name,t.outline.color=yo.createColorPropertyCache(t.outline.color),t.outline.width=yo.createPropertyCache(t.outline.width,yo.parseUnits),t.outline.next_width=yo.createPropertyCache(t.outline.width,yo.parseUnits),t.outline.cap=t.outline.cap||t.cap,t.outline.join=t.outline.join||t.join,t.outline.miter_limit=t.outline.miter_limit||t.miter_limit,t.outline.offset=t.offset,(r=this.styles[t.outline.style])?(t.outline.dash=void 0!==t.outline.dash?t.outline.dash:r.dash,t.outline.texture=void 0!==t.outline.texture?t.outline.texture:r.texture,null!=t.outline.dash?(t.outline.dash_key=t.outline.dash&&this.dashTextureKey(t.outline.dash,n),t.outline.texture_merged=t.outline.dash_key):null===t.outline.dash||null!=t.outline.texture?(t.outline.dash_key=null,t.outline.texture_merged=t.outline.texture):(t.outline.dash=t.dash,t.outline.dash_key=t.outline.dash&&this.dashTextureKey(t.outline.dash,n),t.outline.texture_merged=t.outline.dash_key),t.outline.dash_background_color=void 0!==t.outline.dash_background_color?t.outline.dash_background_color:r.dash_background_color,t.outline.dash_background_color=void 0!==t.outline.dash_background_color?t.outline.dash_background_color:t.dash_background_color,t.outline.dash_background_color=t.outline.dash_background_color&&yo.parseColor(t.outline.dash_background_color),t.outline.texcoords=r.texcoords||t.outline.texture_merged?1:0,this.addMeshVariantForDraw(this.base,t.outline)):(Ei({level:"warn",once:!0},"Layer '".concat(t.layers[t.layers.length-1],"': ")+"line 'outline' specifies non-existent draw style '".concat(t.outline.style,"' (or maybe the style is ")+"defined but is missing a 'base' or has another error), skipping outlines in layer"),t.outline=null)),t},dashTextureKey:function(t,e){return"__dash_"+e+"_"+this.scene_id+"_"+JSON.stringify(t)},getDashTexture:function(t,e){var r,n=this.dashTextureKey(t,this.sources[e].config.uid);null==tc.dash_textures[n]&&(tc.dash_textures[n]=!0,r=function(t,e){var r=1<arguments.length&&void 0!==e?e:{},n=r.dash_color||Jl,i=r.background_color||Ql,o=t,a=r.scale||1;o.length%2==1&&Array.prototype.push.apply(o,o);for(var s=!0,u=[],l=0;l<o.length;l++){for(var c=Math.floor(o[l]*a),h=0;h<c;h++)Array.prototype.push.apply(u,s?n:i);s=!s}return{pixels:u=new Uint8Array(u),length:u.length/4}}(t,{scale:20}),this.textureManager.create(this.gl,n,{data:r.pixels,height:r.length,width:1,filtering:"nearest"}))},endData:function(t){var e=this;return ya.endData.call(this,t).then(function(r){if(r){r.uniforms.u_has_line_texture=!1,r.uniforms.u_texture=e.textureManager.default,r.uniforms.u_v_scale_adjust=Qn.tile_scale;var n=[];for(var i in r.meshes)!function(i){var o,a,s=r.meshes[i].variant;s.texture&&((o=r.meshes[i].uniforms=r.meshes[i].uniforms||{}).u_has_line_texture=!0,o.u_texture=s.texture,o.u_texture_ratio=1,s.dash&&(o.u_v_scale_adjust=20*Qn.tile_scale,o.u_dash_background_color=s.dash_background_color||[0,0,0,0]),s.dash_key&&null==tc.dash_textures[s.dash_key]&&(tc.dash_textures[s.dash_key]=!0,li.postMessage(e.main_thread_target+".getDashTexture",s.dash,t.source)),null==e.textureManager.textures[s.texture]?n.push(e.textureManager.syncTexturesToWorker([s.texture]).then(function(t){var e=t[s.texture];e&&(o.u_texture_ratio=e.height/e.width)})):(a=e.textureManager.textures[s.texture],o.u_texture_ratio=a.height/a.width))}(i);return t.mesh_data[e.name]=r,Promise.all(n).then(function(){return r})}return r})},computeVariantForDraw:function(t){var e=t.offset?1:0;return t.dash_key&&(e+=t.dash_key,t.dash_background_color&&(e+=t.dash_background_color)),t.texture_merged&&(e+=t.texture_merged),e=Jo(e+="/"+t.texcoords),{key:t.variantKey=e,order:t.variant_order,offset:t.offset?1:0,texcoords:t.texcoords,texture:t.texture_merged,dash:t.dash,dash_key:t.dash_key,dash_background_color:t.dash_background_color}},vertexLayoutForMeshVariant:function(t){var e;return null==tc.vertex_layouts[t.key]&&(e=[{name:"a_position",size:4,type:tl.SHORT,normalized:!1},{name:"a_extrude",size:2,type:tl.SHORT,normalized:!1},{name:"a_offset",size:2,type:tl.SHORT,normalized:!1,static:t.offset?null:[0,0]},{name:"a_scaling",size:2,type:tl.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:tl.UNSIGNED_SHORT,normalized:!0,static:t.texcoords?null:[0,0]},{name:"a_color",size:4,type:tl.UNSIGNED_BYTE,normalized:!0},{name:"a_selection_color",size:4,type:tl.UNSIGNED_BYTE,normalized:!0}],tc.vertex_layouts[t.key]=new ul(e)),tc.vertex_layouts[t.key]},makeVertexTemplate:function(t,e){var r=0;return this.vertex_template[r++]=0,this.vertex_template[r++]=0,this.vertex_template[r++]=t.z||0,this.vertex_template[r++]=this.scaleOrder(t.order),this.vertex_template[r++]=0,this.vertex_template[r++]=0,e.variant.offset&&(this.vertex_template[r++]=0,this.vertex_template[r++]=0),this.vertex_template[r++]=1024*t.width_scale,this.vertex_template[r++]=1024*t.offset_scale,e.variant.texcoords&&(this.vertex_template[r++]=0,this.vertex_template[r++]=0),this.vertex_template[r++]=255*t.color[0],this.vertex_template[r++]=255*t.color[1],this.vertex_template[r++]=255*t.color[2],this.vertex_template[r++]=255*t.color[3],this.selection&&(this.vertex_template[r++]=255*t.selection_color[0],this.vertex_template[r++]=255*t.selection_color[1],this.vertex_template[r++]=255*t.selection_color[2],this.vertex_template[r++]=255*t.selection_color[3]),this.vertex_template},buildLines:function(t,e,r,n,i){var o;this.feature_style=this.outline_feature_style,!e.outline||null==e.outline.color||null==e.outline.width.value||(o=this.styles[e.outline.style])&&o.addFeature(n.feature,e.outline,n),this.feature_style=this.inline_feature_style;var a=r.vertex_data,s=a.vertex_layout,u=this.makeVertexTemplate(e,r);return function(t,e,r,n,i){var o,a,s=i.closed_polygon,u=i.remove_tile_edges,l=i.tile_edge_tolerance,c=i.texcoord_index,h=i.texcoord_width,f=i.texcoord_ratio,p=i.texcoord_normalize,d=i.extrude_index,v=i.offset_index,y=i.join,g=i.cap,m=i.miter_limit,_=i.offset,b=i.crop_by_tile,x=g?Nl[g]:Nl.butt,w=y?jl[y]:jl.miter;w===jl.miter&&(o=(m=m||Dl.MITER_LIMIT)*m),c&&(p=p||Dl.TEXCOORD_NORMALIZE,a=1/(h*(f=f||Dl.TEXCOORD_RATIO)*zl));for(var E={closed_polygon:s,remove_tile_edges:u,tile_edge_tolerance:l,miter_len_sq:o,join_type:w,cap_type:x,vertex_data:r,vertex_template:n,half_width:e/2,extrude_index:d,offset_index:v,v_scale:a,texcoord_index:c,texcoord_width:h,texcoord_normalize:p,offset:_,geom_count:0,crop_by_tile:b},T=0;T<t.length;T++)Ul(t[T],E);if(E.extra_lines)for(var A=0;A<E.extra_lines.length;A++)Ul(E.extra_lines[A],E);return E.geom_count}(t,e.width,a,u,{cap:e.cap,join:e.join,miter_limit:e.miter_limit,extrude_index:s.index.a_extrude,offset_index:s.index.a_offset,texcoord_index:s.index.a_texcoord,texcoord_width:e.texcoord_width,texcoord_normalize:65535,closed_polygon:i&&i.closed_polygon,remove_tile_edges:!e.tile_edges&&i&&i.remove_tile_edges,tile_edge_tolerance:Qn.tile_scale*n.tile.pad_scale*2,offset:e.offset,crop_by_tile:this.crop_by_tile})},buildPolygons:function(t,e,r,n){for(var i=0,o=0;o<t.length;o++)i+=this.buildLines(t[o],e,r,n,{closed_polygon:!0,remove_tile_edges:!this.crop_by_tile});return i}});var rc=[[1,1],[1,-1],[-1,1],[-1,-1]];function nc(t,e,r,n,i,o,a){var s,u=e.vertex_template,l=e.vertex_data;ic(e,"a_position",t),ic(e,"a_width",e.half_width),e.vertex_layout_index.a_barycentric&&((s=[0,0,0])[r%3]=1,ic(e,"a_barycentric",s)),ic(e,"a_tangents",a[0].concat(a[1])),ic(e,"a_segment",n),ic(e,"a_texcoord",rc[r%4]),ic(e,"a_length",i),ic(e,"a_closed",e.closed?1:0),ic(e,"a_angles",o),l.addVertex(u)}function ic(t,e,r){var n=r.length,i=t.vertex_template,o=t.vertex_layout_index[e],a=0;if(n)for(;a!==n;)i[o+a]=r[a],a++;else i[o+a]=r}function oc(t,e){for(var r=t.reduce(function(t,e){return t+e}),n=0,i=[],o=0,a=t.length;o<=a;o+=2){var s=Math.max(1e-4,t[o%a]),u=Math.max(1e-4,t[(o+1)%a]);i.push(n,n+s),n+=s+u}for(var l=new Uint8Array(4*e),c=0,h=0;h<e;h++)!function(t){var n=r*h/(e-1),o=function(t){for(var e=t[0],r=0,n=1,i=t.length;n<i;n++)t[n]<e&&(e=t[r=n]);return r}(i.map(function(t){return Math.abs(t-n)})),a=void 0,s=void 0,u=o%2==0?(a=n<=i[o]?1:0,s=i[o],i[o+1]):(a=n>i[o]?2:0,s=i[o-1],i[o]);l[c++]=i[o],l[c++]=a,l[c++]=s,l[c++]=u}();return l}var ac=Object.create(ya),sc={round:1,"arrow-tail":2,"arrow-head":3,square:4,butt:5},uc={miter:0,round:1,bevel:2},lc=sc.round,cc=uc.miter,hc=[0,0],fc="antialias join linecaps miter_limit dash_index dash dash_caps dash_phase".split(" ");Object.assign(ac,{name:"pattern-lines",built_in:!0,vertex_shader_src:"uniform vec2 u_resolution;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform sampler2D u_uniforms;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform vec3 u_map_position;uniform float u_antialias;uniform vec2 u_linecaps;uniform float u_linejoin;uniform float u_miter_limit;uniform float u_dash_index;uniform vec2 u_dash_caps;uniform float u_dash_phase;uniform float u_dash_period;attribute vec4 a_position;attribute vec4 a_color;attribute float a_width;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nattribute vec3 a_barycentric;\n#endif\nattribute vec2 a_normal;attribute float a_length;attribute vec2 a_segment;attribute vec2 a_texcoord;attribute vec2 a_angles;attribute vec4 a_tangents;attribute float a_closed;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nvarying vec3 v_barycentric;\n#endif\nvarying vec2 v_segment;varying vec2 v_angles;varying vec2 v_texcoord;varying vec2 v_distances;varying vec2 v_miter;varying float v_length;varying float v_linewidth_and_closed;varying float v_joinIndicator;\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#ifndef TANGRAM_HEIGHT_SCALE\nfloat TANGRAM_HEIGHT_SCALE=16.0;\n#endif\n#define UNPACK_SCALING(x) (x / 1024.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: global\nconst float PI=3.141592653589793;const float THETA=15.0*PI/180.0;float cross(in vec2 v1,in vec2 v2){return v1.x*v2.y-v1.y*v2.x;}float signed_distance(in vec2 v1,in vec2 v2,in vec2 v3){return cross(v2-v1,v1-v3)/length(v2-v1);}void rotate(in vec2 v,in float angle,out vec2 result){float cosine=cos(angle);float sine=sin(angle);result=vec2(cosine*v.x-sine*v.y,sine*v.x+cosine*v.y);}void main(){\n#pragma tangram: setup\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nv_modelpos_base_zoom=modelPositionBaseZoom();\n#endif\nfloat linewidth=a_width*2.0;v_angles=a_angles;v_segment=a_segment;v_color=a_color;v_length=a_length;v_texcoord=a_texcoord;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nv_barycentric=a_barycentric;\n#endif\nv_color.a=min(linewidth,v_color.a);linewidth=max(linewidth,1.0);linewidth/=exp2(u_map_position.z-u_tile_origin.w);v_linewidth_and_closed=linewidth*(a_closed>0.0 ?-1.0 : 1.0);if(v_color.a<=0.0){gl_Position=vec4(0.0,0.0,0.0,1.0);return;}float width=ceil(1.25*u_antialias+linewidth)/2.0;vec2 t1=normalize(a_tangents.xy);vec2 t2=normalize(a_tangents.zw);float u=a_texcoord.x;u*=-1.0;float v=a_texcoord.y;vec4 position=vec4(a_position.xy,a_position.z/TANGRAM_HEIGHT_SCALE,1.0);if(t1!=t2){float angle=a_texcoord.x==1.0 ? a_angles.x : a_angles.y;vec2 t=normalize(t1+t2);vec2 o=vec2(+t.y,-t.x);float segmentLength=a_segment.y-a_segment.x;float magnitude=width/cos(angle/2.0);float sqMagnitude=magnitude*magnitude;float seg1SqMagnitude=dot(a_tangents.xy,a_tangents.xy);float seg2SqMagnitude=dot(a_tangents.zw,a_tangents.zw);if((abs(magnitude)>linewidth)&&(sqMagnitude>=min(seg1SqMagnitude,seg2SqMagnitude))){if(u==1.0){o=vec2(-t2.y,+t2.x);}else{o=vec2(-t1.y,+t1.x);}magnitude=width;angle=0.0;v_angles.x=0.0;v_angles.y=0.0;}if(u_dash_index>0.0){if((abs(angle)>THETA)){position.xy+=v*width*o/cos(angle/2.0);float s=sign(angle);if(angle<0.0){if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);if(v==1.0){position.xy-=2.0*width*t1/sin(angle);u-=2.0*width/sin(angle);}}else{u=v_segment.x-v*width*tan(angle/2.0);if(v==1.0){position.xy+=2.0*width*t2/sin(angle);u+=2.0*width/sin(angle);}}}else{if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);if(v==-1.0){position.xy+=2.0*width*t1/sin(angle);u+=2.0*width/sin(angle);}}else{u=v_segment.x-v*width*tan(angle/2.0);if(v==-1.0){position.xy-=2.0*width*t2/sin(angle);u-=2.0*width/sin(angle);}}}}else{position.xy+=v*width*o/cos(angle/2.0);if(u==+1.0){u=v_segment.y;}else{u=v_segment.x;}}}else{position.xy+=v*o*magnitude;if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);}else{u=v_segment.x-v*width*tan(angle/2.0);}}v_joinIndicator=(segmentLength+v*width*tan(angle/2.0))/segmentLength;}else{v_joinIndicator=-1.0;vec2 o=vec2(+t1.y,-t1.x);position.xy+=v*width*o;if(u==-1.0){u=v_segment.x-width;position.xy-=width*t1;}else{u=v_segment.y+width;position.xy+=width*t2;}}vec2 t;vec2 curr=a_position.xy;if(a_texcoord.x>=0.0){vec2 next=curr+t2*(v_segment.y-v_segment.x);rotate(t1,+a_angles.x/2.0,t);v_miter.x=signed_distance(curr,curr+t,position.xy);rotate(t2,+a_angles.y/2.0,t);v_miter.y=signed_distance(next,next+t,position.xy);}else{vec2 prev=curr-t1*(v_segment.y-v_segment.x);rotate(t1,-a_angles.x/2.0,t);v_miter.x=signed_distance(prev,prev+t,position.xy);rotate(t2,-a_angles.y/2.0,t);v_miter.y=signed_distance(curr,curr+t,position.xy);}v_distances=vec2(u,v*width);v_world_position=wrapWorldPosition(u_model*position);v_local_space_position=position;position=u_modelView*position;\n#pragma tangram: position\nv_position=position;v_normal=normalize(u_normalMatrix*TANGRAM_NORMAL);\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvec3 normal=v_normal;\n#pragma tangram: normal\nv_lighting=calculateLighting(position.xyz-u_eye,normal,vec4(1.));\n#endif\ncameraProjection(position);\n#ifdef TANGRAM_LAYER_ORDER\napplyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);\n#endif\ngl_Position=position;}",fragment_shader_src:"uniform vec2 u_resolution;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform sampler2D u_dash_atlas;uniform float u_antialias;uniform vec2 u_linecaps;uniform float u_linejoin;uniform float u_miter_limit;uniform float u_dash_phase;uniform float u_dash_period;uniform float u_dash_index;uniform vec2 u_dash_caps;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;\n#ifdef TANGRAM_DEBUG_TRIANGLES\nvarying vec3 v_barycentric;\n#endif\nvarying vec2 v_segment;varying vec2 v_angles;varying vec2 v_texcoord;varying vec2 v_distances;varying vec2 v_miter;varying float v_length;varying float v_linewidth_and_closed;varying float v_joinIndicator;\n#define TANGRAM_NORMAL v_normal\n#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING\nvarying vec4 v_modelpos_base_zoom;\n#endif\n#if defined(TANGRAM_LIGHTING_VERTEX)\nvarying vec4 v_lighting;\n#endif\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: global\n#pragma tangram: utils\nconst float PI=3.141592653589793;const float HALF_PI=PI/2.0;const float THETA=15.0*PI/180.0;/***Compute distance to cap.*@param{int}type The Type of the cap(see CAP_TYPE in pattern_lines)*@param{float}dx The distance of the pixel from the beginning of the line(not straight distance,but along the legs)*@param{float}dy The distance of the pixel from the midline(see v_distances in vertex shader,aka ±1*half_line_width)*@param{float}aa_radius The distance from the mid-line from where antialiasing starts.*For example for a linewidth 10px width and 2px filter radius it is 10px/2-2px=3px.*@return{float}distance*/float cap(int type,float dx,float dy,float aa_radius){float dist=0.0;dx=abs(dx);dy=abs(dy);if(type==1)dist=sqrt(dx*dx+dy*dy);else if(type==3)dist=(dx+abs(dy));else if(type==2)dist=max(abs(dy),(aa_radius+dx-abs(dy)));else if(type==4)dist=max(dx,dy);else if(type==5)dist=max(dx+aa_radius,dy);return dist;}/***Compute distance to join.*@param{int}type The type of the join(see JOIN_TYPE in pattern_lines)*@param{vec2}segment Interpolated a_segment attribute from the vertex shader*@param{vec2}texcoord Pair of u/v coordinates to identify the 4 different extruded points of the segment.*@param{vec2}distances 2 component vector where:*x is the distance of the pixel from the beginning of the line(along the legs)*y is the  distance of the pixel from the midline(see v_distances in vertex shader,±1*half_line_width)*@param{vec2}miter Miter point coordiante*@param{float}miter_limit The miter limit*@param{float}linewidth The width of the line*@return{float}computed distance*/float join(in int type,in vec2 segment,in vec2 texcoord,in vec2 distances,in vec2 miter,in float miter_limit,in float linewidth){float dx=distances.x;float result=abs(distances.y);if((dx<segment.x)||(dx>segment.y)){if(type==1){float s=dx<segment.x ? segment.x : segment.y;result=max(result,length(distances-vec2(s,0.0)));}else{float m=abs(texcoord.x>=0.0 ? miter.x : miter.y);if(type==2){result=max(result,m);}else if(type==0){result=max(result,m-miter_limit*linewidth/2.0);}}}return result;}void main(void){\n#pragma tangram: setup\nvec4 color=v_color;vec3 normal=TANGRAM_NORMAL;\n#ifdef TANGRAM_CROP_BY_TILE\nif(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}\n#endif\n#if defined(TANGRAM_LIGHTING_FRAGMENT) && defined(TANGRAM_MATERIAL_NORMAL_TEXTURE)\ncalculateNormal(normal);\n#endif\n#if !defined(TANGRAM_LIGHTING_VERTEX)\n#pragma tangram: normal\n#endif\n#pragma tangram: color\n#if defined(TANGRAM_LIGHTING_FRAGMENT)\ncolor=calculateLighting(v_position.xyz-u_eye,normal,color);\n#elif defined(TANGRAM_LIGHTING_VERTEX)\ncolor*=v_lighting;\n#endif\n#pragma tangram: filter\nif(v_color.a<=0.0){discard;}bool solid=(u_dash_index==0.0);bool closed=v_linewidth_and_closed<0.0;float dx=v_distances.x;float dy=v_distances.y;float linewidth=abs(v_linewidth_and_closed);float aa_radius=linewidth/2.0-u_antialias;float dist=0.0;vec2 linecaps=u_linecaps;vec2 dash_caps=u_dash_caps;float line_start=0.0;float line_stop=v_length;if(solid){dist=abs(dy);bool potentialCap=!closed&&v_joinIndicator<0.0;if(potentialCap&&dx<line_start){dist=cap(int(u_linecaps.x),abs(dx),abs(dy),aa_radius);}else if(potentialCap&&dx>line_stop){dist=cap(int(u_linecaps.y),abs(dx)-line_stop,abs(dy),aa_radius);}else{dist=join(int(u_linejoin),v_segment,v_texcoord,v_distances,v_miter,u_miter_limit,linewidth);}}else{float segment_start=v_segment.x;float segment_stop=v_segment.y;float segment_center=(segment_start+segment_stop)/2.0;float freq=u_dash_period*linewidth;float dash_phase=u_dash_phase-1e-5;float u=mod(dx+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));float dash_center=float(tex.x)*255.0*linewidth;float dash_type=floor(float(tex.y)*255.0+0.5);float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;float dash_start=dx-u+_start;float dash_stop=dx-u+_stop;if((dash_stop<segment_start)&&(dash_caps.x!=5.0)){float u=mod(segment_start+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));dash_center=float(tex.x)*255.0*linewidth;float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;dash_start=segment_start-u+_start;dash_stop=segment_start-u+_stop;}else if((dash_start>segment_stop)&&(dash_caps.y!=5.0)){float u=mod(segment_stop+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));dash_center=float(tex.x)*255.0*linewidth;float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;dash_start=segment_stop-u+_start;dash_stop=segment_stop-u+_stop;}bool discontinuous=((dx<segment_center)&&abs(v_angles.x)>THETA)||((dx>=segment_center)&&abs(v_angles.y)>THETA);float d_join=join(int(u_linejoin),v_segment,v_texcoord,v_distances,v_miter,u_miter_limit,linewidth);if(closed){line_start+=linewidth/2.0;line_stop-=linewidth/2.0;}if(dash_stop<=line_start){discard;}if(dash_start>=line_stop){discard;}if(discontinuous){if((dash_start>segment_stop)){discard;}if((dash_stop<segment_start)){discard;}if(dash_caps.x==1.0){if((u>_stop)&&(dash_stop>segment_stop)&&(abs(v_angles.y)<HALF_PI)){discard;}}if(dash_caps.y==1.0){if((u<_start)&&(dash_start<segment_start)&&(abs(v_angles.x)<HALF_PI)){discard;}}if((dash_caps.x!=1.0)&&(dash_caps.x!=5.0)){if((dash_start<segment_start)&&(abs(v_angles.x)<HALF_PI)){float a=v_angles.x/2.0;float cos_a=cos(a);float sin_a=sin(a);float x=(segment_start-dx)*cos_a-dy*sin_a;float y=(segment_start-dx)*sin_a+dy*cos_a;if(x>0.0){discard;}dash_caps.x=4.0;}}if((dash_caps.y!=1.0)&&(dash_caps.y!=5.0)){if((dash_stop>segment_stop)&&(abs(v_angles.y)<HALF_PI)){float a=v_angles.y/2.0;float cos_a=cos(a);float sin_a=sin(a);float x=(dx-segment_stop)*cos_a-dy*sin_a;float y=(dx-segment_stop)*sin_a+dy*cos_a;if(x>0.0){discard;}dash_caps.y=4.0;}}}if((dx<line_start)&&(dash_start<=line_start)&&(dash_stop>line_start)){dist=cap(int(linecaps.x),dx-line_start,dy,aa_radius);}else if((dx>line_stop)&&(dash_stop>line_stop)&&(dash_start<line_stop)){dist=cap(int(linecaps.y),dx-line_stop,dy,aa_radius);}else if(dash_type==1.0){dist=cap(int(dash_caps.x),abs(dash_center-u),dy,aa_radius);if((dx>line_start)&&(dx<line_stop)){dist=max(dist,d_join);}}else if(dash_type==0.0){dist=abs(dy);}else if(dash_type==2.0){dist=cap(int(dash_caps.y),abs(u-dash_center),dy,aa_radius);if((dx>line_start)&&(dx<line_stop)){dist=max(dist,d_join);}}if((dx>line_start)&&(dx<line_stop)){if((dx<=segment_start)&&(dash_start<=segment_start)&&(dash_stop>=segment_start)){dist=d_join;float angle=HALF_PI+v_angles.x;float f=abs((segment_start-dx)*cos(angle)-dy*sin(angle));dist=max(f,dist);}else if((dx>segment_stop)&&(dash_start<=segment_stop)&&(dash_stop>=segment_stop)){dist=d_join;float angle=HALF_PI+v_angles.y;float f=abs((dx-segment_stop)*cos(angle)-dy*sin(angle));dist=max(f,dist);}else if(dx<(segment_start-linewidth/2.)){discard;}else if(dx>(segment_stop+linewidth/2.)){discard;}}else if(dx<(segment_start-linewidth/2.)){discard;}else if(dx>(segment_stop+linewidth/2.)){discard;}}dist=dist-aa_radius;if(dist>=0.0){if(u_antialias==0.0){discard;}else{color=vec4(color.rgb,exp(-dist*dist)*color.a);}}\n#ifdef TANGRAM_DEBUG_TRIANGLES\nif(any(lessThan(v_barycentric,vec3(0.0085)))){color=vec4(0.0,1.0,0.0,1.0);}\n#endif\ngl_FragColor=color;}",selection:!0,init:function(){ya.init.apply(this,arguments),this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.defines.TANGRAM_DEBUG_TRIANGLES=!1,this.defines.TANGRAM_DEBUG_NO_TEXTURE_FLOAT_SUPPORT=!1,this.styles=this.styles||{},ac.vertex_layouts=[]},calcDistance:function(t,e){return t&&yo.evalCachedDistanceProperty(t,e)||0},calcDash:function(t,e){var r=yo.evalProperty(t.dash,e),n=0;return r&&((r=Array.isArray(r)&&r.length?r:hc).length%2==1&&(r=r.concat(r)),n=+(n=r.reduce(function(t,e){return t+e}))||0),{dash:r,dash_period:n}},calcWidth:function(t,e,r){var n=this.calcDistance(t.width,r);return!(n<0||(e.width=n*r.units_per_meter_overzoom,0))},getCapType:function(t,e,r){var n=yo.evalProperty(t,e);return void 0!==sc[n]?sc[n]:r},_parseFeature:function(t,e,r){if(!1!==this.calcWidth(e,this.feature_style,r)){var n=this.parseColor(e.color,r);if(n&&0!==n[3]){var i=this.getCapType(e.cap,r,lc),o=yo.evalProperty(e.join,r),a=+yo.evalProperty(e.miter_limit,r),s=this.calcDash(e,r),u=s.dash,l=s.dash_period,c=Object.assign({color:n,antialias:e.antialias,linecaps:[this.getCapType(e.tail_cap,r,i),this.getCapType(e.head_cap,r,i)],join:void 0!==uc[o]?uc[o]:cc,miter_limit:0<=a?a:3,dash_index:0===l?0:1,dash:u,dash_caps:[this.getCapType(e.tail_cap,r,i),this.getCapType(e.head_cap,r,i)],dash_phase:+yo.evalProperty(e.dash_phase,r)||0,dash_period:l},this.feature_style);return c.z=e.z&&yo.evalCachedDistanceProperty(e.z||0,r)||yo.defaults.z,c.z*=Qn.height_scale,c.extrude=yo.evalProperty(e.extrude,r),c.extrude&&(!0===c.extrude?(c.height=void 0!==t.properties.height?t.properties.height:yo.defaults.height,c.min_height=void 0!==t.properties.min_height?t.properties.min_height:yo.defaults.min_height):"number"==typeof c.extrude?(c.height=c.extrude,c.min_height=0):Array.isArray(c.extrude)&&(c.min_height=c.extrude[0],c.height=c.extrude[1]),c.height*=Qn.height_scale,c.min_height*=Qn.height_scale),this.addMeshVariantForDraw(this.base,c),c}}},_preprocess:function(t){t.color=yo.createColorPropertyCache(t.color),t.width=yo.createPropertyCache(t.width,yo.parseUnits),t.width&&t.width.type!==yo.CACHE_TYPE.STATIC&&(t.next_width=yo.createPropertyCache(t.width,yo.parseUnits)),t.z=yo.createPropertyCache(t.z,yo.parseUnits);var e=+t.antialias;return t.antialias=isNaN(e)?0:e,t},buildRasterTextures:function(t,e){var r=[];for(var n in e.meshes){var i,o=this.getMeshVariantTypeForDraw({variantKey:n}),a=o.uniforms,s=o.pattern;a.u_dash_index&&(i="__dash_"+s.join("_")+"_"+t.key+"_"+t.id,r.push({name:i,data:oc(s,1024)}),a.u_dash_atlas=i,e.meshes[n].textures=[i]),e.meshes[n].uniforms=a}return e.uniforms=e.uniforms||{},r.length?li.postMessage(this.main_thread_target+".loadTextures",r).then(function(t){return e}):Promise.resolve(e)},loadTextures:function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r],i=(i=this.textureManager.textures[n.name])||this.textureManager.create(this.gl,n.name,{filtering:"nearest",repeat:!0,width:1024,height:1,data:n.data});e.push(i.loading)}return Promise.all(e).then(function(t){return t.map(function(t){return t.retain(),t.name})})},computeVariantForDraw:function(t){var e=function(t){for(var e=[],r=0,n=fc.length;r<n;r++){var i=t[fc[r]];Array.isArray(i)?e.push(i.join("_")):"boolean"==typeof i?e.push(i?1:0):i&&e.push(i.toString())}return e.join("/")}(t);return{key:t.variantKey=e,order:t.variant_order,uniforms:{u_antialias:t.antialias,u_linecaps:t.linecaps,u_linejoin:t.join,u_miter_limit:t.miter_limit,u_dash_index:t.dash_index,u_dash_caps:t.dash_caps,u_dash_phase:t.dash_phase,u_dash_period:t.dash_period},pattern:t.dash}},vertexLayoutForMeshVariant:function(t){var e;return null==ac.vertex_layouts[t.key]&&(e=[{name:"a_position",size:4,type:tl.SHORT,normalized:!1},{name:"a_color",size:4,type:tl.UNSIGNED_BYTE,normalized:!0},{name:"a_width",size:1,type:tl.FLOAT,normalized:!1},{name:"a_tangents",size:4,type:tl.FLOAT,normalized:!1},{name:"a_segment",size:2,type:tl.FLOAT,normalized:!1},{name:"a_angles",size:2,type:tl.FLOAT,normalized:!1},{name:"a_texcoord",size:2,type:tl.FLOAT,normalized:!0},{name:"a_length",size:1,type:tl.FLOAT,normalized:!1},{name:"a_closed",size:1,type:tl.FLOAT,normalized:!1},{name:"a_selection_color",size:4,type:tl.UNSIGNED_BYTE,normalized:!0}],this.defines.TANGRAM_DEBUG_TRIANGLES&&e.push({name:"a_barycentric",size:3,type:tl.SHORT,normalized:!1}),ac.vertex_layouts[t.key]=new ul(e)),ac.vertex_layouts[t.key]},makeVertexTemplate:function(t){var e=0;return this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=t.z+t.height||0,this.vertex_template[e++]=this.scaleOrder(t.order),this.vertex_template[e++]=255*t.color[0],this.vertex_template[e++]=255*t.color[1],this.vertex_template[e++]=255*t.color[2],this.vertex_template[e++]=255*t.color[3],this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.selection&&(this.vertex_template[e++]=255*t.selection_color[0],this.vertex_template[e++]=255*t.selection_color[1],this.vertex_template[e++]=255*t.selection_color[2],this.vertex_template[e++]=255*t.selection_color[3]),this.defines.TANGRAM_DEBUG_TRIANGLES&&(this.vertex_template[e++]=0,this.vertex_template[e++]=0,this.vertex_template[e++]=0),this.vertex_template},buildLines:function(t,e,r,n,i){var o=4<arguments.length&&void 0!==i&&i,a=r.vertex_data,s=a.vertex_layout,u=this.makeVertexTemplate(e,r);return function(t,e,r,n,i,o){for(var a={closed:o,vertex_data:r,vertex_template:n,half_width:e/2,vertex_layout_index:i,geom_count:0},s=0,u=t.length;s<u;s++)!function(t,e){if(!(t.length<2)){for(var r=[t[0]],n=0,i=[],o=[],a=1,s=t.length;a<s;a++){var u,l;t[a][0]===t[a-1][0]&&t[a][1]===t[a-1][1]||(r.push(t[a]),u=ua.sub(t[a],t[a-1]),l=ua.length(u),i.push(u),o.push([n,n+l]),n+=l)}if(!(r.length<2)){var c=0,h=i[i.length-1],f=i[0],p=i[1],d=[0,0];2<r.length&&(e.closed&&(d[0]=ua.signedAngleBetween(h,f)),d[1]=ua.signedAngleBetween(f,p));var v=r[0],y=o[0];e.closed?(nc(v,e,c++,y,n,d,[h,f]),nc(v,e,c++,y,n,d,[h,f])):(nc(v,e,c++,y,n,d,[f,f]),nc(v,e,c++,y,n,d,[f,f]));for(var g=1,m=r.length-1;g<m;g++)v=r[g],h=i[g-1],f=i[g],p=i[g+1],nc(v,e,c++,y=o[g-1],n,d,[h,f]),nc(v,e,c++,y,n,d,[h,f]),ec(e),y=o[g],d[0]=d[1],d[1]=g!==m-1?ua.signedAngleBetween(f,p):e.closed?ua.signedAngleBetween(f,i[0]):0,nc(v,e,c++,y,n,d,[h,f]),nc(v,e,c++,y,n,d,[h,f]);v=r[r.length-1],y=o[o.length-1],f=i[i.length-1],e.closed?(nc(v,e,c++,y,n,d,[f,i[0]]),nc(v,e,c++,y,n,d,[f,i[0]])):(nc(v,e,c++,y,n,d,[f,f]),nc(v,e,c++,y,n,d,[f,f])),ec(e)}}}(t[s],a);return a.geom_count}(t,e.width,a,u,s.index,o)},buildPolygons:function(t,e,r,n){for(var i=0,o=0,a=t.length;o<a;o++)i+=this.buildLines(t[o],e,r,n,!0);return i}});var pc=0,dc={id_prefix:"",nextLabelId:function(){return"".concat(dc.id_prefix,"/").concat(pc++)}};function vc(t){return{priority:t.priority,collide:t.collide,repeat_distance:t.repeat_distance,repeat_group:t.repeat_group,buffer:t.buffer,italic:t.italic}}var yc=["left","top-left","bottom-left"],gc=["right","top-right","bottom-right"],mc=["top","top-left","top-right"],_c=["bottom","bottom-left","bottom-right"],bc={computeOffset:function(t,e,r,n){var i=3<arguments.length&&void 0!==n?n:null;if(!r||"center"===r)return t;var o=[t[0],t[1]];i=i||this.default_buffer;return this.isLeftAnchor(r)?(o[0]-=e[0]/2,"left"===r&&(o[0]-=i[0])):this.isRightAnchor(r)&&(o[0]+=e[0]/2,"right"===r&&(o[0]+=i[1])),this.isTopAnchor(r)?(o[1]-=e[1]/2,"top"===r&&(o[1]-=i[2])):this.isBottomAnchor(r)&&(o[1]+=e[1]/2,"bottom"===r&&(o[1]+=i[3])),o},alignForAnchor:function(t){if(t&&"center"!==t){if(this.isLeftAnchor(t))return"right";if(this.isRightAnchor(t))return"left"}return"center"},isLeftAnchor:function(t){return-1<yc.indexOf(t)},isRightAnchor:function(t){return-1<gc.indexOf(t)},isTopAnchor:function(t){return-1<mc.indexOf(t)},isBottomAnchor:function(t){return-1<_c.indexOf(t)},default_buffer:[2.5,2.5,1.5,.75],zero_buffer:[0,0,0,0]};function xc(t,e,r,n,i){var o=[],a=r-t,s=n-e,u=$n.getLineLength(t,e,r,n),l=2*i;if((c=u/l)<=1)o.push(t+a/2,e+s/2,i);else{var c,h=l/u,f=a*h,p=s*h;(c=u/i/2)%1&&o.push(r-f/2,n-p/2,i),c|=0;for(var d=t+f/2,v=e+p/2;c--;)o.push(d,v,i),d+=f,v+=p}return o}var wc=function(){function t(e,r,n,i){gn(this,t),this.id=dc.nextLabelId(),this.position=[e[0],e[1]],void 0!==e[2]&&this.position.push(e[2]),this.size=r,this.layout=i,this.anchor=Array.isArray(this.layout.anchor)?this.layout.anchor[0]:this.layout.anchor,this.placed=null,this.type="point",this.parent=this.layout.parent,this.offset=this.computeOffset(),this.align=this.layout.align||bc.alignForAnchor(this.anchor),this._is_flat=n}return _n(t,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,size:this.size,offset:this.offset,align:this.align,sides:this.getSides(),breach:!this.inTileBounds(),layout:vc(this.layout)}}},{key:"inTileBounds",value:function(){var t=this.getAABB(),e=t.left,r=t.top,n=t.right,i=t.bottom;return Ai.pointInTile([e,r])&&Ai.pointInTile([n,i])}},{key:"isFlat",value:function(){return this._is_flat}},{key:"setAnchor",value:function(t){this._circles=void 0,this._aabb=void 0,this.anchor=t,this.offset=this.computeOffset()}},{key:"computeOffset",value:function(){var t,e=[this.layout.offset[0],this.layout.offset[1]];return this.parent&&(t=this.parent,e=bc.computeOffset(e,t.size,t.anchor,bc.zero_buffer),e=bc.computeOffset(e,t.size,this.anchor,bc.zero_buffer),t.offset!==yo.zeroPair&&(e===yo.zeroPair?e=t.offset:(e[0]+=t.offset[0],e[1]+=t.offset[1]))),bc.computeOffset(e,this.size,this.anchor)}},{key:"getBoundingCircles",value:function(){return this.angle?(this._circles||(t=this.layout.units_per_pixel,i=-(r=(e=this.size[0]/2*t)*Math.cos(this.angle)),o=-(n=e*Math.sin(this.angle)),s=(a=Cn(this.position,2))[0],u=a[1],r+=s,n+=u*=-1,i+=s,o+=u,l=this.size[1]/2*t,this._circles=xc(r,n,i,o,l)),this._circles):[];var t,e,r,n,i,o,a,s,u,l}},{key:"getAABB",value:function(){var t,e,r,n,i;return this._aabb||(t=this.layout.units_per_pixel,e=(this.size[0]/2+this.layout.buffer[0])*t,r=(this.size[1]/2+this.layout.buffer[1])*t,n=this.position[0]+this.offset[0]*t,i=this.position[1]-this.offset[1]*t,this._aabb={left:n-e,top:i+r,right:n+e,bottom:i-r}),this._aabb}},{key:"getSides",value:function(){var t=this.getAABB(),e=t.left,r=t.top,n=t.right,i=(r+t.bottom)/2;return[e,i,n,i]}}]),t}();wc.PLACEMENT={VERTEX:0,MIDPOINT:1,SPACED:2,CENTROID:3};var Ec=wc.PLACEMENT,Tc=80;function Ac(t,e,r,n){var i=[],o=n.placement,a=Math.max(e[0],e[1])*n.placement_min_length_ratio*n.units_per_pixel;switch(o){case Ec.SPACED:var s=function(t,e,r){var n=r.units_per_pixel,i=(r.placement_spacing||Tc)*n,o=function(t){for(var e=0,r=0;r<t.length-1;r++)e+=Sc(t[r],t[r+1]);return e}(t);if(o<=e)return!1;for(var a=Math.max(Math.floor(o/i),1),s=[],u=[],l=.5*(o-(a-1)*i),c=0;c<a;c++){var h=function(t,e,r,n){for(var i,o,a=0,s=0;s<t.length-1;s++){var u=t[s],l=t[s+1],c=Sc(u,l);if(!(c<=r)&&e<(a+=c)){i=function(t,e,r){var n=r/Sc(t,e);return[n*t[0]+(1-n)*e[0],n*t[1]+(1-n)*e[1]]}(u,l,a-e),o=kc(u,l,n.angle);break}}return{position:i,angle:o}}(t,l,e,r),f=h.position,p=h.angle;null!=f&&null!=p&&(s.push(f),u.push(p)),l+=i}return{positions:s,angles:u}}(t,a,n);if(!s)return[];for(var u=s.positions,l=s.angles,c=0;c<u.length;c++){var h,f=u[c],p=l[c];!0!==n.tile_edges&&fl(f)||((h=new wc(f,e,r,n)).angle=p,i.push(h))}break;case Ec.VERTEX:for(var d,v,y,g=0;g<t.length-1;g++)d=t[g],v=t[g+1],!0!==n.tile_edges&&fl(d)||((y=new wc(d,e,r,n)).angle=kc(d,v,n.angle),i.push(y));(y=new wc(v,e,r,n)).angle=kc(d,v,n.angle),i.push(y);break;case Ec.MIDPOINT:for(var m=0;m<t.length-1;m++){var _,b=t[m],x=t[m+1],w=[.5*(b[0]+x[0]),.5*(b[1]+x[1])];!0!==n.tile_edges&&fl(w)||(!a||Sc(b,x)>a)&&((_=new wc(w,e,r,n)).angle=kc(b,x,n.angle),i.push(_))}}return i}function kc(t,e,r){var n=2<arguments.length&&void 0!==r?r:0;return"auto"===n?Math.atan2(e[0]-t[0],e[1]-t[1]):n}function Sc(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}var Mc={key:function(t){return[t.style,t.weight,t.family,t.px_size,t.fill,t.stroke,t.stroke_width,t.transform,t.text_wrap,t.max_lines,t.supersample,t.background_color,t.outline_color,t.outline_width,t.padding,Ai.device_pixel_ratio].join("/")},defaults:{style:"normal",weight:null,size:"12px",px_size:12,family:"Helvetica",fill:"white",text_wrap:15,max_lines:5,align:"center",stroke:null,stroke_width:0,background_color:null,outline_color:null,outline_width:0,padding:[0,0,0,0]},compute:function(t,e,r){var n={};if(e.font=e.font||this.defaults,n.can_articulate=e.can_articulate,n.fill=e.font.fill&&Ai.toCSSColor(yo.evalCachedColorProperty(e.font.fill,r))||this.defaults.fill,n.style=e.font.style||this.defaults.style,n.weight=e.font.weight||this.defaults.weight,e.font.family?(n.family=e.font.family,n.family!==this.defaults.family&&(n.family+=", "+this.defaults.family)):n.family=this.defaults.family,n.transform=e.font.transform,n.size=e.font.size||this.defaults.size,n.supersample=e.supersample_text?1.5:1,n.px_size=yo.evalCachedProperty(e.font.px_size,r)*n.supersample,0!==n.px_size){e.font.stroke&&e.font.stroke.color&&(n.stroke=Ai.toCSSColor(yo.evalCachedColorProperty(e.font.stroke.color,r)||this.defaults.stroke),n.stroke_width=yo.evalCachedProperty(e.font.stroke.width,r)||this.defaults.stroke_width),n.font_css=this.fontCSS(n);var i=e.text_wrap;return null==i&&"line"!==Qn.geometryType(t.geometry.type)&&(i=!0),!0===i&&(i=this.defaults.text_wrap),n.text_wrap=i,n.max_lines=e.max_lines||this.defaults.max_lines,n.background_color=e.background&&e.background.color&&!e.can_articulate?Ai.toCSSColor(yo.evalCachedColorProperty(e.background.color,r)):this.defaults.background_color,n.outline_color=e.outline&&e.outline.color&&!e.can_articulate?Ai.toCSSColor(yo.evalCachedColorProperty(e.outline.color,r)):this.defaults.outline_color,n.outline_width=e.outline&&e.outline.width&&!e.can_articulate?yo.evalCachedProperty(e.outline.width,r):this.defaults.outline_width,n.padding=e.padding&&!e.can_articulate?yo.evalCachedProperty(e.padding,r):this.defaults.padding,n}},fontCSS:function(t){return[t.style,t.weight,t.px_size+"px",t.family].filter(function(t){return t}).join(" ")}},Oc=a(function(t){function e(t,e){document.addEventListener?t.addEventListener("scroll",e,!1):t.attachEvent("scroll",e)}function r(t){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(t)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function n(t,e){t.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;left:-999px;white-space:nowrap;font:"+e+";"}function i(t){var e=t.a.offsetWidth,r=e+100;return t.f.style.width=r+"px",t.c.scrollLeft=r,t.b.scrollLeft=t.b.scrollWidth+100,t.g!==e&&(t.g=e,1)}function o(t,r){function n(){var t=o;i(t)&&t.a.parentNode&&r(t.g)}var o=t;e(t.b,n),e(t.c,n),i(t)}function a(t,e){var r=e||{};this.family=t,this.style=r.style||"normal",this.weight=r.weight||"normal",this.stretch=r.stretch||"normal"}function s(t,e){return[t.style,t.weight,function(){if(null===c){var t=document.createElement("div");try{t.style.font="condensed 100px sans-serif"}catch(t){}c=""!==t.style.font}return c}()?t.stretch:"","100px",e].join(" ")}var u,l,c,h;h=c=l=u=null,a.prototype.load=function(t,e){var i=this,a=t||"BESbswy",c=0,f=e||3e3,p=(new Date).getTime();return new Promise(function(t,e){var d,v,y;null===h&&(h=!!document.fonts),(d=h)&&(null===l&&(l=/OS X.*Version\/10\..*Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),d=!l),d?(d=new Promise(function(t,e){!function r(){(new Date).getTime()-p>=f?e():document.fonts.load(s(i,'"'+i.family+'"'),a).then(function(e){1<=e.length?t():setTimeout(r,25)},function(){e()})}()}),v=new Promise(function(t,e){c=setTimeout(e,f)}),Promise.race([v,d]).then(function(){clearTimeout(c),t(i)},function(){e(i)})):(y=function(){function l(){var e;(e=-1!=y&&-1!=g||-1!=y&&-1!=m||-1!=g&&-1!=m)&&((e=y!=g&&y!=m&&g!=m)||(null===u&&(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),u=!!e&&(parseInt(e[1],10)<536||536===parseInt(e[1],10)&&parseInt(e[2],10)<=11)),e=u&&(y==_&&g==_&&m==_||y==b&&g==b&&m==b||y==x&&g==x&&m==x)),e=!e),e&&(w.parentNode&&w.parentNode.removeChild(w),clearTimeout(c),t(i))}var h=new r(a),d=new r(a),v=new r(a),y=-1,g=-1,m=-1,_=-1,b=-1,x=-1,w=document.createElement("div");w.dir="ltr",n(h,s(i,"sans-serif")),n(d,s(i,"serif")),n(v,s(i,"monospace")),w.appendChild(h.a),w.appendChild(d.a),w.appendChild(v.a),document.body.appendChild(w),_=h.a.offsetWidth,b=d.a.offsetWidth,x=v.a.offsetWidth,function t(){var r;(new Date).getTime()-p>=f?(w.parentNode&&w.parentNode.removeChild(w),e(i)):(!0!==(r=document.hidden)&&void 0!==r||(y=h.a.offsetWidth,g=d.a.offsetWidth,m=v.a.offsetWidth,l()),c=setTimeout(t,50))}(),o(h,function(t){y=t,l()}),n(h,s(i,'"'+i.family+'",sans-serif')),o(d,function(t){g=t,l()}),n(d,s(i,'"'+i.family+'",serif')),o(v,function(t){m=t,l()}),n(v,s(i,'"'+i.family+'",monospace'))},document.body?y():document.addEventListener?document.addEventListener("DOMContentLoaded",function t(){document.removeEventListener("DOMContentLoaded",t),y()}):document.attachEvent("onreadystatechange",function t(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",t),y())}))})},t.exports=a}),Ic={fonts_loaded:Promise.resolve(),last_loaded:null,loadFonts:function(t){var e=this,r=JSON.stringify(t)===this.last_loaded;return t&&!r&&function(){var r=[];for(var n in t)!function(n){Array.isArray(t[n])?t[n].forEach(function(t){return r.push(e.loadFontFace(n,t))}):r.push(e.loadFontFace(n,t[n]))}(n);e.last_loaded=JSON.stringify(t),e.fonts_loaded=Promise.all(r.filter(function(t){return t}))}(),this.fonts_loaded},loadFontFace:function(t,e){if(null!=e&&("object"===yn(e)||"external"===e)){var r={family:t},n=Promise.resolve();"object"===yn(e)&&(Object.assign(r,e),"string"==typeof e.url&&(n=this.injectFontFace(r)));var i=new Oc(t,r);return n.then(function(){return i.load()}).then(function(){Ei("debug","Font face '".concat(t,"' is available"),r)},function(){Ei("debug","Font face '".concat(t,"' is NOT available"),r)})}},injectFontFace:function(t){var e=this,r=t.family,n=t.url,i=t.weight,o=t.style;void 0===this.supports_native_font_loading&&(this.supports_native_font_loading=void 0!==window.FontFace);var a=Promise.resolve(n);return"blob:"===n.slice(0,5)&&(a=Ai.io(n,6e4,"arraybuffer").then(function(t){var r=new Uint8Array(t);if(e.supports_native_font_loading)return r;for(var n="",i=0;i<r.length;i++)n+=String.fromCharCode(r[i]);return"data:font/opentype;base64,"+btoa(n)})),a.then(function(t){var n,a,s;e.supports_native_font_loading?("string"==typeof t?n=new FontFace(r,"url(".concat(encodeURI(t),")"),{weight:i,style:o}):t instanceof Uint8Array&&(n=new FontFace(r,t,{weight:i,style:o})),document.fonts.add(n),Ei("trace","Adding FontFace to document.fonts:",n)):(a="\n                    @font-face {\n                        font-family: '".concat(r,"';\n                        font-weight: ").concat(i||"normal",";\n                        font-style: ").concat(o||"normal",";\n                        src: url(").concat(encodeURI(t),");\n                    }\n                "),(s=document.createElement("style")).appendChild(document.createTextNode("")),document.head.appendChild(s),s.sheet.insertRule(a,0),Ei("trace","Injecting CSS font face:",a))})}},Lc=function(){function t(){gn(this,t),this.vertical_text_buffer=1,this.horizontal_text_buffer=1,this.layout=Cu("binary-tree")}return _n(t,[{key:"createCanvas",value:function(t,e){var r=document.createElement("canvas");return t&&e&&(r.width=t,r.height=e),r.style.backgroundColor="transparent",r}},{key:"setFont",value:function(t,e){var r=e.font_css,n=e.fill,i=e.stroke,o=e.stroke_width,a=e.px_size,s=e.supersample;this.px_size=a;var u=Ai.device_pixel_ratio*s;i&&0<o&&(t.strokeStyle=i,t.lineWidth=o*u),t.fillStyle=n,t.textBaseline="bottom",t.font=r,t.miterLimit=2}},{key:"textSizes",value:function(t,e,r){var n=this;return Ic.loadFonts().then(function(){return Ao.add({type:"textSizes",run:n.processTextSizesTask.bind(n),texts:e,tile_id:t,cursor:{ctx:r,styles:Object.keys(e),texts:null,style_idx:null,text_idx:null}})})}},{key:"processTextSizesTask",value:function(t){var e,r=t.cursor,n=t.texts,i=r.ctx;for(r.style_idx=r.style_idx||0;r.style_idx<r.styles.length;){var o=r.styles[r.style_idx];null==r.text_idx&&(r.text_idx=0,r.texts=Object.keys(n[o]));for(var a=n[o],s=!0;r.text_idx<r.texts.length;){var u=r.texts[r.text_idx],l=a[u],c=l.text_settings;if(s&&(this.setFont(i,c),s=!1),l.size=this.textSize(i,o,u,c).size,c.can_articulate){var h=!1,f=!1;if(Rc(u)&&(jc(u)?h=!0:f=!0),l.isRTL=h,l.no_curving=f||(e=u,qc.test(e)),l.vertical_buffer=this.vertical_text_buffer+c.outline_width+(c.padding[0]+c.padding[2])/2,l.segment_sizes=[],!l.no_curving){var p=function(t,e){var r=e?1:Vc;if(t.length<r)return[t];var n=t;if(Lc.cache.segment[n])return Lc.cache.stats.segment_hits++,Lc.cache.segment[n];var i=[];if(Dc.exec(t)){i=t.split(zc);for(var o,a=-1,s=0;s<i.length-1;s++)0<s&&(o=Hc.exec(i[s]))&&(i[s]=i[s].substring(o[0].length),i[s-1]+=o[0],a+=o[0].length),a+=1+i[s].length,i[s]+=t.slice(a,a+1);t=""}for(;t.length;){for(var u="",l=t,c=0;c<r&&l.length;c++){var h=(Bc.exec(l)||l)[0];u+=h,l=l.substring(h.length)}i.push(u),t=t.substring(u.length)}return e&&i.reverse(),Lc.cache.stats.segment_misses++,Lc.cache.segment[n]=i}(u,h);l.segments=p;for(var d=0;d<p.length;d++)l.segment_sizes.push(this.textSize(i,o,p[d],c).size)}}if(r.text_idx++,!Ao.shouldContinue(t))return!1}r.text_idx=null,r.style_idx++}return Ao.finish(t,{texts:n}),!0}},{key:"textSize",value:function(e,r,n,i){var o=i.transform,a=i.text_wrap,s=i.max_lines,u=i.stroke_width,l=void 0===u?0:u,c=i.supersample,h=i.padding,f=i.outline_width,p=i.can_articulate;if(t.cache.text[r]=t.cache.text[r]||{},t.cache.text[r][n])return t.cache.stats.text_hits++,t.cache.text[r][n];t.cache.stats.text_misses++,t.cache.text_count++;var d=Ai.device_pixel_ratio*c,v=this.applyTextTransform(n,o),y=d*(this.vertical_text_buffer+f+(h[0]+h[2])/2),g=d*(this.horizontal_text_buffer+f+l+(h[1]+h[3])/2),m=2*d,_=this.px_size+m,b=Wc.parse(v,a,s,_,e),x=b.height,w=b.width,E=b.lines,T=[w/d,x/d];p||(T[0]+=2*g/d,T[1]+=2*y/d);var A=[w+2*g,x+2*y],k=[A[0]/d,A[1]/d];return t.cache.text[r][n]={lines:E,size:{collision_size:T,texture_size:A,logical_size:k,line_height:_}},t.cache.text[r][n]}},{key:"drawTextMultiLine",value:function(t,e,r,n,i,o){var a=Cn(r,2),s=a[0],u=a[1],l=Ai.device_pixel_ratio*i.supersample,c=i.stroke_width||0,h=i.stroke;i.background_color&&(t.fillStyle=i.background_color,t.fillRect(s,u,n.texture_size[0],n.texture_size[1]));var f=i.outline_width*l,p=i.outline_color;f&&p&&(t.strokeStyle=p,t.lineWidth=f,t.strokeRect(s+f/2,u+f/2,n.texture_size[0]-f,n.texture_size[1]-f)),(i.background_color||f&&p)&&this.setFont(t,i);for(var d,v,y,g,m=n.line_height,_=u,b=0;b<e.length;b++){var x=e[b];this.drawTextLine(t,x,[s,_],n,i,o),_+=m}Xu.draw_label_collision_boxes&&(t.save(),d=l*(this.horizontal_text_buffer+i.outline_width+c+(i.padding[1]+i.padding[3])/2),v=l*(this.vertical_text_buffer+i.outline_width+(i.padding[0]+i.padding[2])/2),y=n.collision_size,t.strokeStyle="blue",t.lineWidth=2,t.strokeRect(s+d,u+v,l*y[0],l*y[1]),"curved"===o&&h&&0<c&&t.strokeRect(s+n.texture_size[0]+d,u+v,l*y[0],l*y[1]),t.restore()),Xu.draw_label_texture_boxes&&(t.save(),g=n.texture_size,t.strokeStyle="green",t.lineWidth=2,t.strokeRect(s+2,u+2,g[0]-4,g[1]-4),"curved"===o&&h&&0<c&&t.strokeRect(s+2+n.texture_size[0],u+2,g[0]-4,g[1]-4),t.restore())}},{key:"drawTextLine",value:function(t,e,r,n,i,o){var a,s=Cn(r,2),u=s[0],l=s[1],c=i.stroke,h=i.stroke_width,f=void 0===h?0:h,p=i.transform,d=i.align,v=i.supersample,y=i.padding,g=i.outline_width,m=Ai.device_pixel_ratio*v,_=(d=d||"center",n.texture_size),b=n.line_height,x=m*(this.vertical_text_buffer+g),w=m*(this.horizontal_text_buffer+g+f),E=this.applyTextTransform(e.text,p);"left"===d?a=u+w+y[3]*m:"center"===d?a=u+_[0]/2-e.width/2-(y[1]-y[3])*m/2:"right"===d&&(a=u+_[0]-e.width-w-y[1]*m);var T,A=l+x+b+y[0]*m;c&&0<f&&(T="curved"===o?_[0]:0,t.strokeText(E,a+T,A)),t.fillText(E,a,A)}},{key:"rasterize",value:function(e,r,n,i,o,a){return Ao.removeForTile(n),Ao.add({type:"rasterizeLabels",run:this.processRasterizeTask.bind(this),cancel:t.returnNoTextures,pause_factor:2,user_moving_view:!1,texts:e,textures:r,texture_prefix:i,gl:o,tile_id:n,texture_manager:a,cursor:{styles:Object.keys(e),texts:null,style_idx:0,text_idx:null,texture_idx:0,texture_names:[]}})}},{key:"processRasterizeTask",value:function(t){if(!Ao.shouldContinue(t))return!1;for(var e=t.cursor,r=t.texts,n=t.textures;e.texture_idx<t.textures.length;){for(var i=!1,o=n[e.texture_idx],a=this.createCanvas.apply(this,Rn(o.texture_size)),s=a.getContext("2d");e.style_idx<e.styles.length;){var u=e.styles[e.style_idx];null==e.text_idx&&(e.text_idx=0,e.texts=Object.keys(r[u]));for(var l=r[u],c=!0;e.text_idx<e.texts.length;){var h=e.texts[e.text_idx],f=l[h],p=f.text_settings;if(c&&(this.setFont(s,p),c=!1),p.can_articulate){f.texcoords=f.texcoords||{};for(var d=0;d<f.type.length;d++){var v=f.type[d];switch(v){case"straight":if(f.textures[d]!==e.texture_idx)continue;var y,g,m,_,b=f.isRTL?h.split().reverse().join():h,x=o.texcoord_cache[u][b],w=void 0;x.texcoord?w=x.texcoord:(y=x.texture_position,m=(g=this.textSize(s,u,b,p)).size,_=g.lines,this.drawTextMultiLine(s,_,y,m,p,v),w=t.texture_manager.getTexcoordsForSprite(y,m.texture_size,o.texture_size),x.texcoord=w),f.texcoords[v]={texcoord:w,texture_id:x.texture_id};break;case"curved":var E=f.segments;f.texcoords.curved=[],f.texcoords_stroke=[];for(var T,A,k,S,M,O,I,L,C=0;C<E.length;C++)f.textures[d][C]===e.texture_idx&&(T=E[C],S=k=void 0,(A=o.texcoord_cache[u][T]).texcoord&&A.texcoord_stroke?(k=A.texcoord,S=A.texcoord_stroke):(M=A.texture_position,I=(O=this.textSize(s,u,T,p)).size,L=O.lines,this.drawTextMultiLine(s,L,M,I,p,v),k=t.texture_manager.getTexcoordsForSprite(M,I.texture_size,o.texture_size),S=p.stroke&&0<p.stroke_width?t.texture_manager.getTexcoordsForSprite([M[0]+I.texture_size[0],M[1]],I.texture_size,o.texture_size):(i=!0,t.texture_manager.getTexcoordsForSprite([o.texture_size[0],o.texture_size[1]],[0,0],o.texture_size)),A.texcoord=k,A.texcoord_stroke=S),f.texcoords_stroke.push(S),f.texcoords.curved.push({texcoord:k,texture_id:A.texture_id}))}}}else{var R=this.textSize(s,u,h,p).lines;for(var P in f.align)f.align[P].texture_id===e.texture_idx&&(this.drawTextMultiLine(s,R,f.align[P].texture_position,f.size,{stroke:p.stroke,stroke_width:p.stroke_width,transform:p.transform,supersample:p.supersample,align:P,background_color:p.background_color,outline_width:p.outline_width,outline_color:p.outline_color,padding:p.padding,fill:p.fill,font_css:p.font_css,px_size:p.px_size}),f.align[P].texcoords=t.texture_manager.getTexcoordsForSprite(f.align[P].texture_position,f.size.texture_size,o.texture_size))}e.text_idx++}e.text_idx=null,e.style_idx++}!0===i&&(s.fillStyle="rgba(0, 0, 0, 0)",s.fillRect(a.width-1,a.height-1,1,1));var N=t.texture_prefix+e.texture_idx;t.texture_manager.create(t.gl,N,{element:a,filtering:"linear",UNPACK_PREMULTIPLY_ALPHA_WEBGL:!0}),e.texture_names.push(N),e.texture_idx++,e.style_idx=0,a.width=0,a.height=0}return Ao.finish(t,e.texture_names),!0}},{key:"setTextureTextPositions",value:function(t){var e={texture_id:0,texcoord_cache:{}},r=[];for(var n in t){var i=t[n];for(var o in i){var a=i[o],s=a.text_settings,u=s.can_articulate,l=s.stroke,c=s.stroke_width;if(u){a.textures=[],e.texcoord_cache[n]=e.texcoord_cache[n]||{};for(var h=0;h<a.type.length;h++)switch(a.type[h]){case"straight":var f,p=a.isRTL?o.split().reverse().join():o;e.texcoord_cache[n][p]||(f=a.size.texture_size,e.texcoord_cache[n][p]={},this.placeText(f[0],f[1],{can_articulate:u,style:n,word:p})),a.textures[h]=e.texture_id;break;case"curved":a.textures[h]=[];for(var d=0;d<a.segment_sizes.length;d++){var v,y,g=a.segments[d];e.texcoord_cache[n][g]||(y=(v=a.segment_sizes[d].texture_size)[0],l&&0<c&&(y*=2),e.texcoord_cache[n][g]={},this.placeText(y,v[1],{can_articulate:u,style:n,word:g})),a.textures[h].push(e.texture_id)}}}else{var m=a.size.texture_size;this.placeText(m[0],m[1],{can_articulate:u,text_info:a})}}}var _=this.layout.export(),b=_.items,x=_.width,w=_.height;e.texcoord_cache={};for(var E=0,T=b.length;E<T;E++){var A=b[E],k=A.x,S=A.y;if(A.meta.can_articulate){var M=A.meta,O=M.style,I=M.word;e.texcoord_cache[O]=e.texcoord_cache[O]||{},e.texcoord_cache[O][I]||(e.texcoord_cache[O][I]={texture_id:e.texture_id,texture_position:[k,S]})}else{var L=A.meta.text_info;for(var C in L.align)L.align[C].texture_id=e.texture_id,L.align[C].texture_position=[k,S]}}return 0<x&&0<w&&(r[e.texture_id]={texture_size:[x,w],texcoord_cache:e.texcoord_cache}),r}},{key:"placeText",value:function(t,e,r){this.layout.addItem({width:t+this.vertical_text_buffer,height:e+this.vertical_text_buffer,meta:r})}},{key:"applyTextTransform",value:function(t,e){return"capitalize"===e?t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1)}):"uppercase"===e?t.toUpperCase():"lowercase"===e?t.toLowerCase():t}}],[{key:"fontPixelSize",value:function(e){if(null!=e){var r=Cn((e="string"==typeof e?e:String(e)).match(t.font_size_re)||[],3),n=r[1],i=r[2];return"em"===(i=i||"px")?n*=16:"pt"===i?n/=.75:"%"===i&&(n/=6.25),(n=yo.parsePositiveNumber(n))*Ai.device_pixel_ratio}}},{key:"pruneTextCache",value:function(){t.cache.text_count>t.cache.text_count_max&&(t.cache.text={},t.cache.text_count=0,Ei("debug","CanvasText: pruning text cache")),Object.keys(t.cache.segment).length>t.cache.segment_count_max&&(t.cache.segment={},Ei("debug","CanvasText: pruning segment cache"))}}]),t}();Lc.font_size_re=/((?:[0-9]*\.)?[0-9]+)\s*(px|pt|em|%)?/,Lc.cache={text:{},text_count:0,text_count_max:2e3,segment:{},segment_count_max:2e3,stats:{text_hits:0,text_misses:0,segment_hits:0,segment_misses:0}},Lc.EMPTY_TEXTURES_ARR=[],Lc.returnNoTextures=function(){return Lc.EMPTY_TEXTURES_ARR};var Cc=new RegExp("[֑-߿‏‫‮יִ-﷽ﹰ-ﻼ]");function Rc(t){return Cc.test(t)}var Pc="\0-/:-@[-`{-¿×÷ʹ-˿ -⯿‐-\u2029‬ -⯿",Nc=new RegExp("["+Pc+"]+");function jc(t){return Nc.test(t)}var Dc=new RegExp("^["+Pc+"؀-ۿ]+"),zc=new RegExp("["+Pc+"آ-إاد-زوٱ-ٷڈ-ڙۄ-ۋۏےۓۮۯ]"),Hc=new RegExp("^[ؐ-ًؚ-ٰٟۖ-ۜ۟-۪ۤۧۨ-ۭ]+"),Fc="[̀-֑ͯ-ׇֽֿׁׂׅׄަ-ްऀ-ःऺ-ौॎॏ॑-ॗॢॣঁ-ঃ়া-ৌৗৢৣਁ-ਃ਼-ੌੑઁ-ઃ઼ા-ૌૢૣଁ-ଃ଼ା-ୌୖୗୢୣஂா-்ௗఀ-ఃా-ౌౕౖౢౣಁ-ಃ಼ಾ-ೌೕೖೢೣഁ-ഃാ-ൌൎൗൢൣංඃ්-ෟෲෳัิ-ฺ็-๎ັິ-ຼ່-ໍ༹༘༙༵༷༾༿ཱ-ྃ྆྇ྍ-ྼ࿆ါ-း်-ှၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏႚ-ႝ឴-៑៓ᩕ-ᩞᩡ-᩼᷀-᷿⃐-⃿]",Bc=new RegExp("^.(?:"+Fc+"+)?([्্੍્୍్್്྄္្᩠᩿]\\W(?:"+Fc+"+)?)*"),Uc={Mongolian:"᠀-᢯"},Gc=Object.keys(Uc).map(function(t){return Uc[t]}).join(""),qc=new RegExp("["+Gc+"]"),Vc=2,Wc=function(){function t(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1/0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1/0;gn(this,t),this.width=0,this.height=0,this.lines=[],this.max_lines=r,this.text_wrap=n,this.context=e}return _n(t,[{key:"createLine",value:function(t){return this.lines.length<this.max_lines&&new Yc(t,this.text_wrap)}},{key:"push",value:function(t){if(this.lines.length<this.max_lines){var e=this.context.measureText(t.text).width;return(t.width=e)>this.width&&(this.width=Math.ceil(e)),this.lines.push(t),this.height+=t.height,!0}return this.addEllipsis(),!1}},{key:"advance",value:function(t,e){return!!this.push(t)&&this.createLine(e)}},{key:"addEllipsis",value:function(){var e=this.lines[this.lines.length-1],r=Math.ceil(this.context.measureText(t.ellipsis).width);e.append(t.ellipsis),e.width+=r,e.width>this.width&&(this.width=e.width)}},{key:"finish",value:function(t){t?this.push(t):this.addEllipsis()}}],[{key:"parse",value:function(e,r,n,i,o){for(var a="number"==typeof r?e.split(" "):[e],s=new t(o,n,r),u=s.createLine(i),l=0;l<a.length;l++){for(var c=a[l].split("\n"),h=0===l,f=0;f<c.length&&u;f++){var p=c[f];Rc(p)&&jc(p[p.length-1])&&(p+="‏");var d=h?p:" "+p;if(r&&0<l&&u.exceedsTextwrap(d)){if(!(u=s.advance(u,i)))break;u.append(p),h=!0}else u.append(d);f<c.length-1&&(u=s.advance(u,i),h=!0)}l===a.length-1&&s.finish(u)}return s}}]),t}();Wc.ellipsis="...";var Yc=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;gn(this,t),this.chars=0,this.text="",this.height=Math.ceil(e),this.text_wrap=r}return _n(t,[{key:"append",value:function(t){this.chars+=t.length,this.text+=t}},{key:"exceedsTextwrap",value:function(t){return t.length+this.chars>this.text_wrap}}]),t}(),Kc={resetText:function(){this.texts={}},freeText:function(t){delete this.texts[t.id]},parseTextFeature:function(t,e,r,n){var i=this.parseTextSource(t,e,r);if(null!=i&&""!==i){var o=Mc.compute(t,e,r);if(o){var a=Mc.key(o);this.texts[n.id]=this.texts[n.id]||{};var s=this.texts[n.id][a]=this.texts[n.id][a]||{};if(i instanceof Object){var u=[],l=i.left+"-"+i.right;for(var c in i){var h,f=i[c];f&&(h=this.computeTextLayout({},t,e,r,n,f,o,l,c),s[f]||(s[f]={text_settings:o,ref:0}),u.push({draw:e,text:f,text_settings_key:a,layout:h}))}return 0<u.length&&u}var p=this.computeTextLayout({},t,e,r,n,i,o);return s[i]||(s[i]={text_settings:o,ref:0}),{draw:e,text:i,text_settings_key:a,layout:p}}}},parseTextSource:function(t,e,r){var n,i=e.text_source||"name";if(null!=i&&"object"===yn(i))for(var o in n={},i)n[o]=this.parseTextSourceValue(i[o],t,r);else n=this.parseTextSourceValue(i,t,r);return n},parseTextSourceValue:function(t,e,r){var n;if(Array.isArray(t)){for(var i=0;i<t.length;i++)if("string"==typeof t[i]?n=e.properties[t[i]]:"function"==typeof t[i]&&(n=t[i](r)),n)return n}else"string"==typeof t?n=e.properties[t]:t instanceof Function&&(n=t(r));return n},prepareTextLabels:function(t,e,r){var n=this;return 0===Object.keys(this.texts[t.id]||{}).length?Promise.resolve([]):li.postMessage(this.main_thread_target+".calcTextSizes",t.id,this.texts[t.id]).then(function(e){var i=e.texts;return t.canceled?(Ei("trace","Style ".concat(n.name,": stop tile build because tile was canceled: ").concat(t.key,", post-calcTextSizes()")),[]):(n.texts[t.id]=i||[],i?n.buildTextLabels(t,r):(To.abortTile(t.id),[]))})},collideAndRenderTextLabels:function(t,e,r){var n=this;return this.prepareTextLabels(t,e,r).then(function(r){return 0===r.length?(To.collide([],e,t.id),Promise.resolve({})):To.collide(r,e,t.id).then(function(e){if(t.canceled)return Ei("trace","stop tile build because tile was canceled: ".concat(t.key,", post-collide()")),{};var r=n.texts[t.id];return null==r||0===e.length?{}:(n.cullTextStyles(r,e),e.forEach(function(t){var e=t.text_settings_key,n=r[e]&&r[e][t.text];n.text_settings.can_articulate?(n.type||(n.type=[]),-1===n.type.indexOf(t.label.type)&&n.type.push(t.label.type)):(n.align=n.align||{},n.align[t.label.align]={})}),{labels:e,texts:r,textures:[]})})})},cullTextStyles:function(t,e){for(var r=0;r<e.length;r++){var n=e[r];t[n.text_settings_key][n.text].ref++}for(var i in t)for(var o in t[i])t[i][o].ref<1&&delete t[i][o];for(var a in t)0===Object.keys(t[a]).length&&delete t[a]},calcTextSizes:function(t,e){return this._canvas_text||(this._canvas_text=new Lc,this._canvas_ctx_for_sizes=this._canvas_text.createCanvas().getContext("2d")),this._canvas_text.textSizes(t,e,this._canvas_ctx_for_sizes)},preprocessText:function(t){if(t&&t.font&&"object"===yn(t.font))return t.font.fill=yo.createPropertyCache(t.font.fill),t.font.stroke&&(t.font.stroke.color=yo.createPropertyCache(t.font.stroke.color)),t.background&&t.background.color&&(t.background.color=yo.createPropertyCache(t.background.color)),t.outline&&(t.outline.color&&(t.outline.color=yo.createPropertyCache(t.outline.color)),t.outline.width&&(t.outline.width=yo.createPropertyCache(t.outline.width,yo.parsePositiveNumber))),t.padding&&(Array.isArray(t.padding)?2===t.padding.length&&(t.padding=[t.padding[0],t.padding[1],t.padding[0],t.padding[1]]):t.padding=Array(4).fill(t.padding),t.padding=yo.createPropertyCache(t.padding,function(t){return t.map(yo.parsePositiveNumber)})),t.font.px_size=yo.createPropertyCache(t.font.size||Mc.defaults.size,Lc.fontPixelSize),t.font.stroke&&null!=t.font.stroke.width&&(t.font.stroke.width=yo.createPropertyCache(t.font.stroke.width,yo.parsePositiveNumber)),t.offset=yo.createPropertyCache(t.offset,function(t){return Array.isArray(t)&&t.map(yo.parseNumber)}),t.buffer=yo.createPropertyCache(t.buffer,function(t){return(Array.isArray(t)?t:[t,t]).map(yo.parsePositiveNumber)}),t.repeat_distance=yo.createPropertyCache(t.repeat_distance||Qn.tile_size,yo.parsePositiveNumber),t},computeTextLayout:function(t,e,r,n,i,o,a,s,u){var l=t||{};return(l=this.computeLayout(l,e,r,n,i)).repeat_distance&&(s&&(l.repeat_group+="/"+s),l.repeat_group+="/"+o),l.subdiv=i.overzoom2,l.align=r.align,l.italic="normal"!==a.style,"right"===u?l.orientation=1:"left"===u&&(l.orientation=-1),l}},Xc=Math.PI/180,Zc=function(){function t(e,r){gn(this,t),this._min_zoom=H.util.constants.DEFAULT_MIN_ZOOM_LEVEL,this._max_zoom=H.util.constants.DEFAULT_MAX_ZOOM_LEVEL,this._viewport=e,this._center_offset=[],this._center_offset_normalized=[],this._viewport_aspect_ratio=1,this._focal_length=[[16,2],[17,2.5],[18,3],[19,4],[20,6]],this._view_matrix=new Float64Array(16),this._projection_matrix=new Float64Array(16),this._heading_matrix=new Float64Array(16),this._tilt_matrix=new Float64Array(16),this._transformation_matrix=new Float64Array(16),this._camera_matrix=new Float64Array(16),this._lookAtData={position:[0,0,0],zoom:0,tile_level:0,tetragon:void 0,bounds:void 0,unpadded_bounds:void 0,distance:void 0,tilt:0,incline:0,heading:180},this._zoom_direction=0,this._horizon=0,this.handleViewportUpdate(!0),r?this.setLookAtData(r):this._updateMatrices(),ra.replaceBlock("camera","\n            uniform mat4 u_projection;\n            uniform vec3 u_eye;\n            uniform vec2 u_center_offset;\n\n            void cameraProjection (inout vec4 position) {\n                position = u_projection * position;\n            }")}return _n(t,[{key:"getZoomForBounds",value:function(t,e,r,n){var i,o=this.clone(),a=this._max_zoom,s=this._min_zoom,u=(a-s)/2,l=a-u,c=e,h=$n.getBBoxCenter($n.getBBox(t));for(void 0===c?c=h:(i=h[0]-c[0],Math.abs(i)>Qn.half_circumference_meters+1e-8&&(c[0]+=Math.round(i/Qn.circumference_meters)*Qn.circumference_meters));.001<u;)!function(){o.setLookAtData({zoom:l,position:c,tilt:r,heading:n});var e,i,h,f,p,d=o.getLookAtData().bounds;t.every(function(t){return $n.isPointInsidePolygon(t,d)})?s=l:(i=(e=Cn($n.getBBox(d),4))[0],h=e[1],f=e[2],p=e[3],f-i+1e-8>=Qn.circumference_meters&&p-h+1e-8>=Qn.circumference_meters?s=l:a=l),l=a-(u=(a-s)/2)}();return s}},{key:"setZoomConstraints",value:function(t,e){this._min_zoom=t,this._max_zoom=e,this.setLookAtData(this.getLookAtData())}},{key:"setLookAtData",value:function(t,e){var r,n,i,o,a,s=t.position,u=t.zoom;s===r&&t.bounds!==r&&(s=$n.getBBoxCenter($n.getBBox(t.bounds))),u===r&&t.bounds!==r&&(u=this.getZoomForBounds(t.bounds,s,t.tilt,t.heading)),e!==r&&(n=s||this.screenToWorld(e)),u!==r&&(u=$n.clamp(u,this._min_zoom,this._max_zoom),(i=Ai.zoomToTileLevel(u))!==(o=this._lookAtData.tile_level)&&(this._zoom_direction=o<i?1:-1),this._lookAtData.zoom=u,this._lookAtData.tile_level=i),t.tilt!==r&&(this._lookAtData.tilt=t.tilt),t.heading!==r&&(this._lookAtData.heading=t.heading),e!==r?(this._updateMatrices(),a=this.screenToWorld(e),this._lookAtData.position[0]-=a[0]-n[0],this._lookAtData.position[1]-=a[1]-n[1]):s&&(this._lookAtData.position=s),this._lookAtData.position[2]=0,this._lookAtData.position[1]=$n.clamp(this._lookAtData.position[1],-Qn.half_circumference_meters,Qn.half_circumference_meters),this._updateMatrices(),this._updateVisibleBounds()}},{key:"getZoomDirection",value:function(){return this._zoom_direction}},{key:"resetZoomDirection",value:function(){this._zoom_direction=0}},{key:"getLookAtData",value:function(){return this._lookAtData}},{key:"handleViewportUpdate",value:function(t){var e=0<arguments.length&&void 0!==t&&t,r=this._viewport,n=r.width,i=r.height;this._viewport_aspect_ratio=n/i;var o=this._viewport.center.x-(n/2<<0),a=this._viewport.center.y-(i/2<<0);this._center_offset[0]=o,this._center_offset[1]=a,this._center_offset_normalized[0]=o/n,this._center_offset_normalized[1]=a/-i,e||(this._updateMatrices(),this._updateVisibleBounds())}},{key:"setupMatrices",value:function(t,e){Do(t.model_view32,this._view_matrix,t.model),e.uniform("Matrix4fv","u_modelView",t.model_view32),No(t.normal32,t.model_view32),jo(t.inverse_normal32,t.normal32),e.uniform("Matrix3fv","u_normalMatrix",t.normal32),e.uniform("Matrix3fv","u_inverseNormalMatrix",t.inverse_normal32)}},{key:"_updateMatrices",value:function(){var t=this._viewport.height*Qn.metersPerPixel(this._lookAtData.zoom),e=Ai.interpolate(this._lookAtData.zoom,this._focal_length);this._lookAtData.distance=t/2*e;var r=this._lookAtData.position[0],n=this._lookAtData.position[1];Bo(this._view_matrix,Ro(r,n,0),Ro(r,n,-1),Ro(0,1,0)),this._heading_matrix=Uo(this._heading_matrix);var i=180-this._lookAtData.heading;i*=Xc,this._heading_matrix[0]=Math.cos(i),this._heading_matrix[1]=-Math.sin(i),this._heading_matrix[4]=Math.sin(i),this._heading_matrix[5]=Math.cos(i),this._tilt_matrix=Uo(this._tilt_matrix),i=0<(i=this._lookAtData.tilt?this._lookAtData.tilt*Xc:0)?-i:i,this._tilt_matrix[5]=Math.cos(i),this._tilt_matrix[6]=Math.sin(i),this._tilt_matrix[9]=-Math.sin(i),this._tilt_matrix[10]=Math.cos(i),Do(this._transformation_matrix,this._tilt_matrix,this._heading_matrix),Do(this._view_matrix,this._transformation_matrix,this._view_matrix);var o=2*Math.atan(1/e),a=2*this._lookAtData.distance;this._depth_buffer_adjustment=2/Math.log(a),Fo(this._projection_matrix,o,this._viewport_aspect_ratio,1,a),this._projection_matrix[8]=2*-this._center_offset_normalized[0],this._projection_matrix[9]=2*-this._center_offset_normalized[1],zo(this._projection_matrix,this._projection_matrix,Ro(0,0,-this._lookAtData.distance)),this._camera_matrix=Do(this._camera_matrix,this._projection_matrix,this._view_matrix)}},{key:"_updateVisibleBounds",value:function(){var t,e,r,n,i,o=this._viewport,a=o.width,s=o.height,u=o.padding,l=this._lookAtData.tilt*Math.PI/180;this._horizon=Math.max((u.top+s)/2-Math.cos(l)*(u.top*(1-Math.sin(l))+.75*s),0),this._lookAtData.tetragon=[this.screenToWorld([0,this._horizon]),this.screenToWorld([a,this._horizon]),this.screenToWorld([a,s]),this.screenToWorld([0,s])],this._lookAtData.unpadded_bounds=this._clipAgainstGeoBounds(this._lookAtData.tetragon),0===u.left&&0===u.top&&0===u.right&&0===u.bottom?this._lookAtData.bounds=this._lookAtData.unpadded_bounds:(t=u.left,e=Math.max(this._horizon,u.top),r=a-u.right,n=s-u.bottom,i=[this.screenToWorld([t,e]),this.screenToWorld([r,e]),this.screenToWorld([r,n]),this.screenToWorld([t,n])],this._lookAtData.bounds=this._clipAgainstGeoBounds(i))}},{key:"_clipAgainstGeoBounds",value:function(t){var e,r=Cn($n.getBBox(t),4),n=r[0],i=r[1],o=r[2],a=r[3],s=Qn.half_circumference_meters,u=[[n-1,+s],[o+1,+s],[o+1,-s],[n-1,-s]],l=$n.clipPolygon(u,t)[0],c=Cn($n.getBBox(l),4);n=c[0],i=c[1],o=c[2],a=c[3];o-n>=Qn.circumference_meters&&(l=[[(e=(o-n)/2)-s,a],[e+s,a],[e+s,i],[e-s,i]]);var h=[];return l&&(h=$n.splitLegs(l,s)),h}},{key:"applyPxOffset",value:function(t){var e=Cn(t,2),r=e[0],n=e[1],i=Math.PI-this._lookAtData.heading*Xc,o=Qn.metersPerPixel(this._lookAtData.zoom);this._lookAtData.position[0]+=(r*Math.cos(i)+n*Math.sin(i))*o,this._lookAtData.position[1]-=(n*Math.cos(i)-r*Math.sin(i))*o,this._lookAtData.position[1]=$n.clamp(this._lookAtData.position[1],-Qn.half_circumference_meters,Qn.half_circumference_meters),this._updateMatrices(),this._updateVisibleBounds()}},{key:"screenToWorld",value:function(t){var e=Cn(t,2),r=e[0],n=e[1],i=this._viewport,o=i.width,a=i.height;return 0===o||0===a?[0,0]:(r-=o/2,n-=a/2,this._clipCoordsToWorldPlaneCoords([2*(r+o/2)/o-1,1-2*(n+a/2)/a,-1,1]))}},{key:"_clipToScreenCoords",value:function(t){var e=this._viewport,r=e.width,n=e.height;return[(.5*t[0]+.5)*r,n-(.5*t[1]+.5)*n]}},{key:"_isScreenPointInViewPort",value:function(t){var e=this._viewport,r=e.width,n=e.height;return 0<=t[0]&&t[0]<=r&&0<=t[1]&&t[1]<=n}},{key:"worldToScreen",value:function(t,e){var r,n,i,o,a,s,u=1<arguments.length&&void 0!==e&&e;return t[2]||(t[2]=0),u?(r=this._worldToClipCoords(t),a=this._clipToScreenCoords(r)):(n=Math.sign(this._lookAtData.position[0]),i=Math.trunc(this._lookAtData.position[0]/Qn.circumference_meters+n/2),t[0]+=Qn.circumference_meters*i,o=this._worldToClipCoords(t),s=a=this._clipToScreenCoords(o),this._isScreenPointInViewPort(a)||(o=this._worldToClipCoords([t[0]+Qn.circumference_meters,t[1],t[2]]),a=this._clipToScreenCoords(o),this._isScreenPointInViewPort(a)||(o=this._worldToClipCoords([t[0]-Qn.circumference_meters,t[1],t[2]]),a=this._clipToScreenCoords(o)),this._isScreenPointInViewPort(a)||(a=s))),a}},{key:"getHorizon",value:function(){return this._horizon}},{key:"_clipCoordsToWorldPlaneCoords",value:function(t){var e=[],r=this._lookAtData.distance,n=this._lookAtData.position,i=[0,0,r,0],o=0,a=r*Math.sin(Xc*this._lookAtData.tilt)*Math.cos(Xc*this._lookAtData.heading),s=r*Math.sin(Xc*this._lookAtData.tilt)*Math.sin(Xc*this._lookAtData.heading),u=new Float64Array(16),l=new Float64Array(16);return qo(u,this._projection_matrix),Vo(e,t,u),e[2]=-1,e[3]=0,qo(l,this._view_matrix),Vo(e,e,l),Wo(e,e),Vo(i,i,this._transformation_matrix),0!==e[2]&&(o=-i[2]/e[2]),Yo(e,e,o),[n[0]+(e[0]+s),n[1]+(e[1]+a)]}},{key:"_worldToClipCoords",value:function(t){var e=[t[0],t[1],t[2],1];return Vo(e,e,this._view_matrix),Vo(e,e,this._projection_matrix),Yo(e,e,1/e[3]),e}},{key:"setupProgram",value:function(t){t.uniform("Matrix4fv","u_projection",this._projection_matrix),t.uniform("3f","u_eye",[0,0,this._lookAtData.distance]),t.uniform("2fv","u_center_offset",this._center_offset_normalized),t.uniform("1f","u_tilt",this._lookAtData.tilt*Xc),t.uniform("1f","u_heading",this._lookAtData.heading*Xc),t.uniform("1f","u_near_plane",1),t.uniform("1f","u_depth_buffer_adjustment",this._depth_buffer_adjustment)}},{key:"getTransformationMatrix",value:function(){return this._transformation_matrix}},{key:"getCameraMatrix",value:function(){return this._camera_matrix}},{key:"clone",value:function(){var e=new t(this._viewport,this._lookAtData);return e.setZoomConstraints(this._min_zoom,this._max_zoom),e}},{key:"getViewport",value:function(){return this._viewport}}]),t}();function $c(t){return void 0===t.x?t[0]:t.x}function Jc(t){return void 0===t.y?t[1]:t.y}function Qc(t,e){return $c(t)-$c(e)}function th(t,e){return Jc(t)-Jc(e)}function eh(t){return t.sort(Qc)}function rh(t,e){for(var r,n=t[0],i=n,o=0;o<t.length;o+=1)e(r=t[o],n)<0?n=r:0<e(r,i)&&(i=r);return[n,i]}function nh(t,e){return Object.values(e.reduce(function(e,r){var n=r[+t];return e[n]||(e[n]=[]),e[n].push(r),e},{}))}function ih(t,e,r){var n=+t,i=e[n],o=r[n];if(o<i)return[];var a=[e];if(o<i)return a;for(var s=e[(1+n)%2],u=t?function(t){return a.push([s,t])}:function(t){return a.push([t,s])},l=i+1;l<o;l+=1)u(l);return a.push(r),a}function oh(t,e){return ih(!1,t,e)}function ah(t,e){return ih(!0,t,e)}function sh(t){var e={},r=[];return t.forEach(function(t){var n=t.key||(Array.isArray(t)?"".concat(t[0],"/").concat(t[1]):"".concat(t.x,"/").concat(t.y));e[n]||(e[n]=!0,r.push(t))}),r}function uh(t){return t.reduce(function(t,e){return t.concat(e)})}function lh(t,e,r){function n(e){return Object.values(Qn.metersToExactTileCoords(e,t.tile_level))}var i,o,a,s,u,l,c,h,f;return sh((i=function(t,e){return e<=0?t:sh(uh(nh(!0,uh(nh(!1,t).map(function(t){var r=Cn(rh(t,th),2),n=r[0],i=r[1],o=[n[0],n[1]-e],a=[i[0],i[1]+e];return t.concat(ah(o,n),ah(i,a))}))).map(function(t){var r=Cn(rh(t,Qc),2),n=r[0],i=r[1],o=[n[0]-e,n[1]],a=[i[0]+e,i[1]];return t.concat(oh(o,n),oh(i,a))})))}((s=n(t.tetragon[0]),u=n(t.tetragon[1]),l=n(t.tetragon[3]),c=n(t.tetragon[2]),h=ch(u,s,l),f=ch(l,c,u),sh(h.concat(f))),e),o=t.tile_level,a=r,i.map(function(t){var e=Cn(t,2),r=e[0],n=e[1];return _a.coord(Qn.wrapTile({x:r,y:n,z:o},{x:!a,y:!0}))})))}function ch(t,e,r){var n=Cn(function(t,e,r){var n=Cn(t,2),i=n[0],o=n[1],a=Cn(e,2),s=a[0],u=a[1],l=Cn(r,2),c=l[0],h=l[1],f=i+(u-o)/(h-o)*(c-i);return[[[i,o]].concat(Rn(eh([[s,u],[f,u]]))),[].concat(Rn(eh([[s,u],[f,u]])),[[c,h]])]}.apply(void 0,Rn([t,e,r].sort(th))),2),i=n[0],o=n[1];return sh(function(t,e,r){var n=Cn(t,2),i=n[0],o=n[1],a=Cn(e,2),s=a[0],u=a[1];return fh(i,s,Cn(r,1)[0],o,u)}.apply(void 0,Rn(i)).concat(function(t,e,r){var n=Cn(t,2),i=n[0],o=n[1],a=Cn(e,1)[0],s=Cn(r,2);return fh(s[0],i,a,s[1],o)}.apply(void 0,Rn(o))))}var hh=.125;function fh(t,e,r,n,i){var o,a,s,u,l,c,h,f,p,d,v=Math.min(t,e),y=Math.max(t,r),g=Math.min(n,i),m=Math.max(n,i);if(Math.floor(n)===Math.floor(i))return vh(v,y,n);if(m-g<hh)return o=[y,m],s=(a=Cn([v,g],2))[0],u=a[1],c=(l=Cn(o,2))[0],h=l[1],p=ph(f=dh(s,c),u),d=ph(f,h),p.concat(d);function _(t){k=k.concat(vh(S,M,Math.floor(t))),S+=T,M+=A}var b,x,w=hh*((x=m)-(b=g))/(Math.ceil(x)-Math.floor(b)),E=(m-g)/w,T=(e-t)/E,A=(r-t)/E,k=[],S=t,M=t;if(n<i)for(var O=g;O<=m;O+=w)_(O);else for(var I=m;g<=I;I-=w)_(I);return sh(k)}function ph(t,e){return t.map(function(t){return[t,e]})}function dh(t,e){var r=Math.floor(t),n=Math.floor(e);if(n<r)return[];if(r===n)return[r];for(var i=[],o=r;o<=n;o+=1)i.push(o);return i}function vh(t,e,r){return ph(dh(t,e),r)}var yh=function(){function t(e,r){gn(this,t),Mo(this),this.scene=e,this.createMatrices(),this.bounds=null,this.center_tile=null,this.panning=!1,this.panning_stop_at=0,this.pan_snap_timer=0,this.user_input_at=0,this.user_input_timeout=50,this.user_input_active=!1,this.size={},this.buffer=0,this.wrap=!1!==r.wrapView,this.preserve_tiles_within_zoom=1,this.lookAtManipulator=new Zc(r.viewport),this._viewport=r.viewport,this._offset_buffer=[0,0],this.handleViewportUpdate(!0)}return _n(t,[{key:"update",value:function(){this.pan_snap_timer=(new Date-this.panning_stop_at)/1e3,this.user_input_active=new Date-this.user_input_at<this.user_input_timeout,this.scene.tile_manager.updateTilesVisibilityCounters()}},{key:"handleViewportUpdate",value:function(t){var e=0<arguments.length&&void 0!==t&&t,r=this._viewport,n=r.width,i=r.height;this.size.css={width:n,height:i},this.size.device={width:Math.round(n*Ai.device_pixel_ratio),height:Math.round(i*Ai.device_pixel_ratio)},this.lookAtManipulator.handleViewportUpdate(),e||this.updateBounds()}},{key:"setLookAtData",value:function(e,r){t._setLookAtDataForManipulator(this.lookAtManipulator,e,r),this.updateBounds()}},{key:"getLookAtData",value:function(e){var r=0<arguments.length&&void 0!==e&&e;return t._getLookAtDataFromManipulator(this.lookAtManipulator,r)}},{key:"getBestLookAtData",value:function(e,r,n){var i=2<arguments.length&&void 0!==n&&n,o=this.lookAtManipulator.clone();return t._setLookAtDataForManipulator(o,e,r),t._getLookAtDataFromManipulator(o,i)}},{key:"getTileLevel",value:function(){return this.lookAtManipulator.getLookAtData().tile_level}},{key:"applyPxOffset",value:function(t){var e=this._offset_buffer;e[0]+=t[0],e[1]+=t[1];var r,n,i=Math.abs(e[0]),o=Math.abs(e[1]);(1<=i||1<=o)&&(r=~~e[0],n=~~e[1],this.lookAtManipulator.applyPxOffset([i<1?0:r,o<1?0:n]),1<=i&&(e[0]-=r),1<=o&&(e[1]-=n),this.updateBounds())}},{key:"setPanning",value:function(t){this.panning=t,this.panning||(this.panning_stop_at=+new Date)}},{key:"markUserInput",value:function(){this.user_input_at=+new Date}},{key:"ready",value:function(){return"number"==typeof this.size.css.width&&"number"==typeof this.size.css.height}},{key:"updateBounds",value:function(){var t,e;this.markUserInput(),this.ready()&&(this.center_tile=Qn.tileForMeters(this.lookAtManipulator.getLookAtData().position,this.lookAtManipulator.getLookAtData().tile_level),t=this.lookAtManipulator.screenToWorld([0,this.size.css.height]),e=this.lookAtManipulator.screenToWorld([this.size.css.width,0]),this.bounds={sw:{x:t[0],y:t[1]},ne:{x:e[0],y:e[1]}},this.scene.tile_manager.updateTilesForView(!0),this.trigger("move"),this.scene.requestRedraw())}},{key:"getTileGridFlatForBBox",value:function(t,e,r,n,i,o){var a,s=4<arguments.length&&void 0!==i?i:0,u=!(5<arguments.length&&void 0!==o)||o,l=this.lookAtManipulator.getLookAtData().tile_level,c=Qn.tileForMeters([e,t],l),h=Qn.tileForMeters([n,r],l);c.x-=s,c.y-=s,h.x+=s,h.y+=s,!1===u&&(a=(1<<l)-1,c.x=Math.min(Math.max(0,c.x),a),c.y=Math.min(Math.max(0,c.y),a),h.x=Math.min(Math.max(0,h.x),a),h.y=Math.min(Math.max(0,h.y),a));for(var f=[],p={},d=c.x;d<=h.x;d++)for(var v=c.y;v<=h.y;v++){var y=_a.coord(Qn.wrapTile({x:d,y:v,z:l},{x:!u,y:!0}));p[y.key]||(p[y.key]=!0,f.push(y))}return f}},{key:"getTileGridFlat",value:function(){return this.getTileGridFlatForBBox(this.bounds.ne.y,this.bounds.sw.x,this.bounds.sw.y,this.bounds.ne.x,this.buffer,this.wrap)}},{key:"getTileGridDistorted",value:function(){return lh(this.lookAtManipulator.getLookAtData(),this.buffer,this.wrap)}},{key:"findVisibleTileCoordinates",value:function(){if(!this.bounds)return[];var t=this.lookAtManipulator.getLookAtData(),e=t.tilt,r=t.heading;return 0===e&&180===r?this.getTileGridFlat():this.getTileGridDistorted()}},{key:"createMatrices",value:function(){this.matrices={},this.matrices.model=new Float64Array(16),this.matrices.model32=new Float32Array(16),this.matrices.model_view=new Float64Array(16),this.matrices.model_view32=new Float32Array(16),this.matrices.normal=new Float64Array(9),this.matrices.normal32=new Float32Array(9),this.matrices.inverse_normal32=new Float32Array(9)}},{key:"setupTile",value:function(t,e){t.setupProgram(this.matrices,e),this.lookAtManipulator.setupMatrices(this.matrices,e)}},{key:"setupProgram",value:function(t){var e=this.lookAtManipulator.getLookAtData();t.uniform("2fv","u_resolution",[this.size.device.width,this.size.device.height]),t.uniform("3fv","u_map_position",[e.position[0],e.position[1],Math.trunc(1e5*e.zoom)/1e5]),t.uniform("1f","u_meters_per_pixel",Qn.metersPerPixel(e.zoom)),t.uniform("1f","u_device_pixel_ratio",Ai.device_pixel_ratio),t.uniform("1f","u_view_pan_snap_timer",this.pan_snap_timer),t.uniform("1i","u_view_panning",this.panning),t.uniform("1f","u_horizon",this.lookAtManipulator.getHorizon()/(this.size.css.height/2)),this.lookAtManipulator.setupProgram(t)}},{key:"isAnimating",value:function(){return this.pan_snap_timer<=.5}},{key:"xyToGeo",value:function(t,e){var r=this.lookAtManipulator.screenToWorld([t,e]),n=Cn(Qn.metersToLatLng(r),2),i=n[0];return{lat:n[1],lng:i}}},{key:"geoToPixel",value:function(t){var e=Qn.latLngToMeters([t.lng,t.lat]);e.push(t.alt||0);var r=this.lookAtManipulator.worldToScreen(e);return{x:Math.floor(r[0]),y:Math.floor(r[1])}}},{key:"geoToMeters",value:function(t){var e=Cn(Qn.latLngToMeters([t.lng,t.lat]),2);return{x:e[0],y:e[1],z:t.alt||0}}},{key:"metersToGeo",value:function(t){var e=Cn(Qn.metersToLatLng([t.x,t.y]),2),r=e[0];return{lat:e[1],lng:r,alt:t.z||0}}},{key:"setZoomConstraints",value:function(t,e){this.lookAtManipulator.setZoomConstraints(t,e)}}],[{key:"_setLookAtDataForManipulator",value:function(t,e,r){var n=e.position,i=e.zoom,o=e.tilt,a=e.heading,s=e.bounds,u={zoom:i,tilt:o,heading:a};if(n&&"number"==typeof n.lng&&"number"==typeof n.lat&&(u.position=Qn.latLngToMeters([n.lng,n.lat])),s){var l=s.getExterior().getLatLngAltArray(),c=l.length/3,h=Array(c);if(s.getBoundingBox().isCDB())for(var f=l[1],p=0,d=0;d<c;d++){var v,y=l[3*d+1];0<d&&(v=y-f,180<Math.abs(v)&&(p+=f<y?-360:360)),f=y,h[d]=Qn.latLngToMeters([y+p,l[3*d]])}else for(var g=0;g<c;g++)h[g]=Qn.latLngToMeters([l[3*g+1],l[3*g]]);u.bounds=h}t.setLookAtData(u,r)}},{key:"_getLookAtDataFromManipulator",value:function(t,e){var r=1<arguments.length&&void 0!==e&&e,n=t.getLookAtData(),i=n.heading,o=n.incline,a=n.tilt,s=n.zoom,u=n.position,l=n.bounds,c=n.unpadded_bounds,h=Cn(Qn.metersToLatLng(u),2),f=h[0],p=h[1],d=new H.geo.LineString;return(r?c:l).forEach(function(t){var e=Qn.metersToLatLng(t);d.pushLatLngAlt(e[1],e[0],0)}),{heading:i,incline:o,tilt:a,zoom:s,bounds:new H.geo.Polygon(d),position:{lat:p,lng:f,alt:u[2]}}}}]),t}(),gh=wc.PLACEMENT,mh=128/Math.PI,_h=16384/Math.PI,bh=Object.create(ya);Object.assign(bh,Kc),Object.assign(bh,{name:"points",built_in:!0,vertex_shader_src:"uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform bool u_tile_fade_in;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform float u_visible_time;uniform bool u_view_panning;uniform float u_tilt;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform float u_heading;uniform float u_near_plane;uniform float u_depth_buffer_adjustment;attribute vec4 a_position;attribute vec4 a_shape;attribute vec4 a_color;attribute vec2 a_texcoord;attribute vec2 a_offset;uniform float u_point_type;attribute float a_is_flat;\n#ifdef TANGRAM_IS_TEXT_STYLE\nattribute vec4 a_offsets_alt;attribute vec4 a_pre_angles_alt;attribute vec4 a_angles_alt;attribute vec4 a_offsets;attribute vec4 a_pre_angles;attribute vec4 a_angles;\n#endif\n#ifdef TANGRAM_POINT_DRAW_STICK\nattribute float a_is_stick;attribute float a_stick_height;varying float v_is_stick;\n#endif\nvarying vec4 v_color;varying vec2 v_texcoord;varying vec4 v_world_position;varying float v_alpha_factor;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nattribute float a_outline_edge;attribute vec4 a_outline_color;varying float v_outline_edge;varying vec4 v_outline_color;varying float v_aa_offset;\n#endif\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nvarying float v_label_hidden;\n#endif\n#define PI 3.14159265359\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\nvec2 rotate2D(vec2 _st,float _angle){return mat2(cos(_angle),-sin(_angle),sin(_angle),cos(_angle))*_st;}vec3 rotateX3D(vec3 _st,float _angle){return mat3(1.,0.,0.,0.,cos(_angle),sin(_angle),0.,-sin(_angle),cos(_angle))*_st;}vec3 rotateZ3D(vec3 _st,float _angle){return mat3(cos(_angle),sin(_angle),0.,-sin(_angle),cos(_angle),0.,0.,0.,1.)*_st;}\n#ifdef TANGRAM_IS_TEXT_STYLE\nfloat mix4linear(float a,float b,float c,float d,float x){return mix(mix(a,b,3.*x),mix(b,mix(c,d,3.*(max(x,.66)-.66)),3.*(clamp(x,.33,.66)-.33)),step(0.33,x));}\n#endif\nvoid main(){\n#pragma tangram: setup\n#ifndef TANGRAM_SHOW_HIDDEN_LABELS\nif(a_shape.w==0.){gl_Position=vec4(0.,0.,0.,1.);return;}\n#else\nif(a_shape.w==0.){v_label_hidden=1.;}else{v_label_hidden=0.;}\n#endif\nv_alpha_factor=1.0;v_color=a_color;v_texcoord=a_texcoord;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nv_outline_color=a_outline_color;v_outline_edge=a_outline_edge;if(u_point_type==TANGRAM_POINT_TYPE_SHADER){v_outline_color=a_outline_color;v_outline_edge=a_outline_edge;float size=abs(a_shape.x/128.);v_texcoord=sign(a_shape.xy)*(size+1.0)/size;size+=2.0;v_aa_offset=2.0/size;}\n#endif\nvec4 position=u_modelView*vec4(a_position.xyz,1.);vec4 shape=vec4(a_shape.xy,0.,0.);vec2 offset=vec2(a_offset.x,-a_offset.y);\n#ifdef TANGRAM_POINT_DRAW_STICK\nv_is_stick=a_is_stick;float scaled_stick_height=(sin(u_tilt+(1.5*PI))+1.0)*a_stick_height;offset.y+=(1.0-a_is_stick)*scaled_stick_height;\n#endif\nfloat zoom=clamp(u_map_position.z-u_tile_origin.z,0.,1.);float theta=a_shape.z/4096.;float heading=u_heading;float delta=(heading-PI);float new_theta=theta-delta;float reversed=abs(new_theta)>PI/2. ? 1. : 0.;if(a_is_flat==1.0){\n#ifdef TANGRAM_IS_TEXT_STYLE\nif(a_offsets[0]!=0.){vec4 angles_scaled;vec4 pre_angles_scaled;vec4 offsets_scaled;if(reversed==1.){offsets_scaled=a_offsets_alt*4.;angles_scaled=(PI/16384.)*a_angles_alt;pre_angles_scaled=(PI/128.)*a_pre_angles_alt;}else{offsets_scaled=a_offsets*4.;angles_scaled=(PI/16384.)*a_angles;pre_angles_scaled=(PI/128.)*a_pre_angles;}float pre_angle=mix4linear(pre_angles_scaled[0],pre_angles_scaled[1],pre_angles_scaled[2],pre_angles_scaled[3],zoom);float angle=mix4linear(angles_scaled[0],angles_scaled[1],angles_scaled[2],angles_scaled[3],zoom);float offset_curve=mix4linear(offsets_scaled[0],offsets_scaled[1],offsets_scaled[2],offsets_scaled[3],zoom);shape.xy=rotate2D(shape.xy,pre_angle+PI*reversed);shape.x+=offset_curve;shape.xy=rotate2D(shape.xy,angle);shape.xy+=rotate2D(offset,theta);}else{shape.xy=rotate2D(shape.xy+offset*256.,theta+(PI*reversed));}\n#else\nshape.xy=rotate2D(shape.xy+offset*256.,theta);\n#endif\nshape.xy/=pow(2.,4.+(u_map_position.z-u_tile_origin.w));shape=u_modelView*shape;position+=shape;}else{shape.xy/=256.;\n#ifdef TANGRAM_POINT_DRAW_STICK\nshape.y*=1.0+(scaled_stick_height-1.0)*a_is_stick;\n#endif\nshape.xy=rotate2D(shape.xy+offset,theta);}\n#ifdef TANGRAM_FADE_IN_RATE\nif(u_tile_fade_in){v_alpha_factor*=clamp(u_visible_time*TANGRAM_FADE_IN_RATE,0.,1.);}\n#endif\n#ifdef TANGRAM_FADE_ON_ZOOM_OUT\nv_alpha_factor*=clamp(1.+TANGRAM_FADE_ON_ZOOM_OUT_RATE*(u_map_position.z-u_tile_origin.z),0.,1.);\n#endif\nv_world_position=u_model*position;v_world_position.xy+=shape.xy*u_meters_per_pixel;v_world_position=wrapWorldPosition(v_world_position);\n#pragma tangram: position\ncameraProjection(position);\n#ifdef TANGRAM_LAYER_ORDER\napplyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);/***Due to the precision loss on depth buffer,we had a z-fighting of translucent points when the distance to the camera was big.*For more information about the problem see: https:*For more information about the fix see: https:*position.z=(2.0*log(position.w/u_near_plane)/log(u_far_plane/u_near_plane)-1.0)*position.w;*/position.z=(log(position.w/u_near_plane)*u_depth_buffer_adjustment-1.0)*position.w;\n#endif\nif(a_is_flat!=1.){position.xy+=shape.xy*position.w*2.*u_device_pixel_ratio/u_resolution;}\n#ifdef TANGRAM_HAS_SHADER_POINTS\nif(u_point_type==TANGRAM_POINT_TYPE_SHADER){position.xy+=sign(shape.xy)*position.w*u_device_pixel_ratio/u_resolution;}\n#endif\nif(!u_view_panning){snapToPixelGrid(position);}gl_Position=position;}",fragment_shader_src:"uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform float u_visible_time;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform sampler2D u_texture;uniform float u_point_type;uniform bool u_apply_color_blocks;varying vec4 v_color;varying vec2 v_texcoord;varying vec4 v_world_position;varying float v_alpha_factor;\n#ifdef TANGRAM_HAS_SHADER_POINTS\nvarying vec4 v_outline_color;varying float v_outline_edge;varying float v_aa_offset;\n#endif\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nvarying float v_label_hidden;\n#endif\n#ifdef TANGRAM_POINT_DRAW_STICK\nvarying float v_is_stick;\n#endif\n#define TANGRAM_NORMAL vec3(0., 0., 1.)\n#pragma tangram: camera\n#pragma tangram: material\n#pragma tangram: lighting\n#pragma tangram: raster\n#pragma tangram: global\n#ifdef TANGRAM_HAS_SHADER_POINTS\nfloat _tangram_antialias(float l,float R){float low=R-v_aa_offset;float high=R+v_aa_offset;return 1.-smoothstep(low,high,l);}\n#endif\nvoid mixTextureColor(inout vec4 color){\n#ifdef TANGRAM_HAS_SHADER_POINTS\nif(u_point_type==TANGRAM_POINT_TYPE_TEXTURE){color*=texture2D(u_texture,v_texcoord);}else if(u_point_type==TANGRAM_POINT_TYPE_LABEL){color=texture2D(u_texture,v_texcoord);color.rgb/=max(color.a,0.001);}else if(u_point_type==TANGRAM_POINT_TYPE_SHADER){float outline_edge=v_outline_edge;vec4 outlineColor=v_outline_color;float l=length(v_texcoord);float outer_alpha=_tangram_antialias(l,1.);float fill_alpha=_tangram_antialias(l,1.-v_outline_edge*0.5)*color.a;float stroke_alpha=(outer_alpha-_tangram_antialias(l,1.-v_outline_edge))*outlineColor.a;\n#ifdef TANGRAM_BLEND_ADD\ncolor.a=stroke_alpha+fill_alpha;color.rgb=color.rgb*fill_alpha+outlineColor.rgb*stroke_alpha;\n#else\ncolor.a=stroke_alpha+fill_alpha*(1.-stroke_alpha);color.rgb=mix(color.rgb*fill_alpha,outlineColor.rgb,stroke_alpha)/max(color.a,0.001);\n#endif\n}\n#else\ncolor=texture2D(u_texture,v_texcoord);color.rgb/=max(color.a,0.001);\n#endif\nif(u_apply_color_blocks){\n#pragma tangram: color\n#pragma tangram: filter\n}color.a*=v_alpha_factor;\n#ifdef TANGRAM_SHOW_HIDDEN_LABELS\nif(v_label_hidden>0.){color.a*=0.5;color.rgb=vec3(1.,0.,0.);}\n#endif\n#if !defined(TANGRAM_BLEND_OVERLAY) && !defined(TANGRAM_BLEND_INLAY) && !defined(TANGRAM_BLEND_ADD)\nif(color.a<TANGRAM_ALPHA_TEST){discard;}\n#endif\n}void main(void){\n#pragma tangram: setup\nvec4 color=v_color;\n#ifdef TANGRAM_POINT_DRAW_STICK\nif(v_is_stick==0.0){mixTextureColor(color);}\n#else\nmixTextureColor(color);\n#endif\ngl_FragColor=color;}",selection:!0,collision:!0,blend:"overlay",init:function(t){var e=0<arguments.length&&void 0!==t?t:{};ya.init.call(this,e),this.setupDefines(),this.defines.TANGRAM_HAS_SHADER_POINTS=!0,this.defines.TANGRAM_POINT_TYPE_TEXTURE=1,this.defines.TANGRAM_POINT_TYPE_LABEL=2,this.defines.TANGRAM_POINT_TYPE_SHADER=3,this.defines.TANGRAM_POINT_DRAW_STICK=!!this.stick,this.collision_group_points=this.name+"-points",this.collision_group_text=this.name+"-text",this.reset()},setupDefines:function(){"overlay"!==this.blend&&(this.defines.TANGRAM_LAYER_ORDER=!0),this.defines.TANGRAM_FADE_ON_ZOOM_OUT=!0,this.defines.TANGRAM_FADE_ON_ZOOM_OUT_RATE=2,Xu.suppress_label_fade_in||this.suppress_fade?(this.fade_in_time=0,this.defines.TANGRAM_FADE_IN_RATE=null):(this.fade_in_time=.15,this.defines.TANGRAM_FADE_IN_RATE=1/this.fade_in_time),Xu.suppress_snap_animation||(this.defines.TANGRAM_VIEW_PAN_SNAP_RATE=2),Xu.show_hidden_labels&&(this.defines.TANGRAM_SHOW_HIDDEN_LABELS=!0)},reset:function(){this.queues={},this.resetText(),this.texture_missing_sprites={}},addFeature:function(t,e,r){var n,i,o,a=r.tile,s={};if(s.color=this.parseColor(e.color,r),s.texture=e.texture,s.label_texture=null,s.color||s.texture){if(this.hasSprites(s)){if(!(n=this.parseSprite(s,e,r)))return;s.texcoords=n.texcoords}if(s.size=e.size,s.size){if(s.size=yo.evalCachedPointSizeProperty(e.size,n,r),null==s.size)return void Ei({level:"warn",once:!0},"Layer '".concat(e.layers[e.layers.length-1],"': ")+"'size' includes % and/or ratio-based scaling (".concat(JSON.stringify(e.size.value),"); ")+"these can only applied to sprites, but no sprite was specified, skipping features in layer");"number"==typeof s.size&&(s.size=[s.size,s.size])}else s.size=n&&n.css_size||[16,16];e.outline&&(s.outline_width=yo.evalCachedProperty(e.outline.width,r)||yo.defaults.outline.width,s.outline_color=this.parseColor(e.outline.color,r)),s.outline_edge_pct=0,s.outline_width&&s.outline_color&&(i=s.outline_width,s.size[0]+=i,s.size[1]+=i,s.outline_edge_pct=i/Math.min(s.size[0],s.size[1])*2),s.size[0]=Math.min(s.size[0],256),s.size[1]=Math.min(s.size[1],256),s.placement=e.placement,s.placement_min_length_ratio=yo.evalCachedProperty(e.placement_min_length_ratio,r),s.placement===gh.SPACED&&e.placement_spacing&&(s.placement_spacing=yo.evalCachedProperty(e.placement_spacing,r)),s.angle=yo.evalProperty(e.angle,r)||0,s.elevate_by_altitude=!!e.elevate_by_altitude,s.z=e.z?$n.clamp(yo.evalCachedDistanceProperty(e.z,r),0,32767):yo.defaults.z,s.flat=e.flat,s.tile_edges=e.tile_edges,this.computeLayout(s,t,e,r,a),e.stick&&!s.flat&&(o=yo.parseNumber(yo.evalProperty(e.stick.height,r)),s.stick={color:this.parseColor(e.stick.color,r)||yo.defaults.color,height:o?Math.max(o,0):0});var u=e.text&&!1!==yo.evalProperty(e.text.visible,r)&&this.parseTextFeature(t,e.text,r,a);Array.isArray(u)&&Ei({level:"warn",once:!(u=null)},"Layer '".concat(e.layers[e.layers.length-1],"': ")+"cannot use boundary labels (e.g. 'text_source: { left: ..., right: ... }') for 'text' labels attached to 'points'; "+"provided 'text_source' value was ".concat(JSON.stringify(e.text.text_source))),u&&(u.layout.parent=s,u.layout.priority=e.text.priority?Math.max(u.layout.priority,s.priority+.5):s.priority+.5,u.layout.move_into_tile=!1,To.addStyle(this.collision_group_text,a.id)),this.queueFeature({feature:t,draw:e,context:r,style:s,text_feature:u},a),To.addStyle(this.collision_group_points,a.id)}},hasSprites:function(t){return t.texture&&this.textureManager.textures[t.texture]&&this.textureManager.textures[t.texture].sprites},getSpriteInfo:function(t,e){var r=this.textureManager.textures[t.texture].sprites[e]&&this.textureManager.getSpriteInfo(t.texture,e);return e&&!r?(this.texture_missing_sprites[t.texture]=this.texture_missing_sprites[t.texture]||{},this.texture_missing_sprites[t.texture][e]||(Ei("debug","Style: in style '".concat(this.name,"', could not find sprite '").concat(e,"' for texture '").concat(t.texture,"'")),this.texture_missing_sprites[t.texture][e]=!0)):r&&(r.sprite=e),r},parseSprite:function(t,e,r){var n=yo.evalProperty(e.sprite,r);return this.getSpriteInfo(t,n)||this.getSpriteInfo(t,e.sprite_default)},queueFeature:function(t,e){this.tile_data[e.id]&&this.queues[e.id]||this.startData(e),this.queues[e.id]=this.queues[e.id]||[],this.queues[e.id].push(t)},endData:function(t){var e=this;if(t.canceled)return Ei("trace","Style ".concat(this.name,": stop tile build because tile was canceled: ").concat(t.key)),Promise.resolve();var r=this.queues[t.id];delete this.queues[t.id];var n=[],i=[];return r.forEach(function(t){for(var r=t.style,o=t.feature,a=o.geometry,s=e.buildLabels(r.size,a,r),u=0;u<s.length;u++){var l,c=s[u],h={feature:o,draw:t.draw,context:t.context,style:r,label:c};i.push(h),t.text_feature&&(l={feature:o,draw:t.text_feature.draw,context:t.context,text:t.text_feature.text,text_settings_key:t.text_feature.text_settings_key,layout:t.text_feature.layout,point_label:c,linked:h},n.push(l),t.draw.text.optional||(h.linked=l))}}),Promise.all([To.collide(i,this.collision_group_points,t.id).then(function(t){t.forEach(function(t){e.feature_style=t.style,e.feature_style.label=t.label,e.feature_style.linked=t.linked,ya.addFeature.call(e,t.feature,t.draw,t.context)})}),this.collideAndRenderTextLabels(t,this.collision_group_text,n)]).then(function(r){var n=Cn(r,2)[1],i=n.labels,o=n.texts;return i&&o&&i.forEach(function(t){var r=t.text_settings_key,n=o[r]&&o[r][t.text],i=e.feature_style;i.label=t.label,i.linked=t.linked,i.size=n.size.logical_size,i.angle=0,t.label.text_data={text_info:n,text_settings_key:r,text:t.text},i.label_texture=e.textureManager.default,ya.addFeature.call(e,t.feature,t.draw,t.context)}),e.freeText(t),ya.endData.call(e,t)})},_preprocess:function(t){t.color=yo.createColorPropertyCache(t.color),t.texture=void 0!==t.texture?t.texture:this.texture,t.outline&&(t.outline.color=yo.createColorPropertyCache(t.outline.color),t.outline.width=yo.createPropertyCache(t.outline.width,yo.parsePositiveNumber)),t.z=yo.createPropertyCache(t.z,yo.parseUnits);try{t.size=yo.createPointSizePropertyCache(t.size)}catch(e){return Ei({level:"warn",once:!0},"Layer '".concat(t.layers[t.layers.length-1],"': ")+"".concat(e," (").concat(JSON.stringify(t.size),"), skipping features in layer")),null}return t.offset=yo.createPropertyCache(t.offset,function(t){return Array.isArray(t)&&t.map(yo.parseNumber)}),t.buffer=yo.createPropertyCache(t.buffer,function(t){return(Array.isArray(t)?t:[t,t]).map(yo.parsePositiveNumber)}),t.repeat_distance=yo.createPropertyCache(t.repeat_distance,yo.parseNumber),null==t.repeat_group&&(t.repeat_group=t.layers.join("-")),t.placement=gh[t.placement&&t.placement.toUpperCase()],null==t.placement&&(t.placement=gh.VERTEX),t.placement_spacing=null!=t.placement_spacing?t.placement_spacing:80,t.placement_spacing=yo.createPropertyCache(t.placement_spacing,yo.parsePositiveNumber),t.placement_min_length_ratio=null!=t.placement_min_length_ratio?t.placement_min_length_ratio:1,t.placement_min_length_ratio=yo.createPropertyCache(t.placement_min_length_ratio,yo.parsePositiveNumber),"number"==typeof t.angle?t.angle=t.angle*Math.PI/180:t.angle=t.angle||0,t.text=this.preprocessText(t.text),t.text&&(t.text.variantKey=t.variantKey,t.text.group=t.group,t.text.layers=t.layers,t.text.order=t.order,t.text.repeat_group=t.text.repeat_group||t.repeat_group,t.text.anchor=t.text.anchor||this.default_anchor,t.text.optional="boolean"==typeof t.text.optional&&t.text.optional,t.text.interactive=t.text.interactive||t.interactive),t.stick&&(t.stick.color=yo.createColorPropertyCache(t.stick.color)),t},default_anchor:["bottom","top","right","left"],computeLayout:function(t,e,r,n,i){var o=t||{};o.id=e,o.units_per_pixel=i.units_per_pixel||1,o.collide=!1!==r.collide,o.anchor=r.anchor,o.offset=yo.evalCachedProperty(r.offset,n)||yo.zeroPair,o.buffer=yo.evalCachedProperty(r.buffer,n)||yo.zeroPair,o.repeat_distance=yo.evalCachedProperty(r.repeat_distance,n),o.repeat_distance&&(o.repeat_distance*=o.units_per_pixel,o.repeat_scale=1,"function"==typeof r.repeat_group?o.repeat_group=r.repeat_group(n):o.repeat_group=r.repeat_group);var a=r.priority;return null!=a?"function"==typeof a&&(a=a(n)):a=-1>>>0,o.priority=a,o},buildTextLabels:function(t,e){for(var r=[],n=0;n<e.length;n++){var i=e[n],o=this.texts[t.id][i.text_settings_key][i.text].size.collision_size;i.label=new wc(i.point_label.position,o,i.point_label.isFlat(),i.layout),r.push(i)}return r},buildLabels:function(t,e,r){var n=!!r.flat,i=[];if("Point"===e.type)i.push(new wc(e.coordinates,t,n,r));else if("MultiPoint"===e.type)for(var o=e.coordinates,a=0;a<o.length;++a){var s=o[a];i.push(new wc(s,t,n,r))}else if("LineString"===e.type)for(var u=Ac(e.coordinates,t,n,r),l=0;l<u.length;++l)i.push(u[l]);else if("MultiLineString"===e.type)for(var c=e.coordinates,h=0;h<c.length;h++)for(var f=Ac(c[h],t,n,r),p=0;p<f.length;++p)i.push(f[p]);else if("Polygon"===e.type)if(r.placement===gh.CENTROID){var d=Qn.centroid(e.coordinates);i.push(new wc(d,t,n,r))}else for(var v=e.coordinates,y=0;y<v.length;y++)for(var g=Ac(v[y],t,n,r),m=0;m<g.length;++m)i.push(g[m]);else if("MultiPolygon"===e.type)if(r.placement===gh.CENTROID){var _=Qn.multiCentroid(e.coordinates);i.push(new wc(_,t,n,r))}else for(var b=e.coordinates,x=0;x<b.length;x++)for(var w=b[x],E=0;E<w.length;E++)for(var T=Ac(w[E],t,n,r),A=0;A<T.length;++A)i.push(T[A]);return i},makeVertexTemplate:function(t,e){var r,n=t.color||yo.defaults.color,i=e.vertex_data.vertex_layout;return this.fillVertexTemplate(i,"a_position",0,{size:2}),this.fillVertexTemplate(i,"a_position",t.z||0,{size:1,offset:2}),this.fillVertexTemplate(i,"a_position",this.scaleOrder(t.order),{size:1,offset:3}),this.fillVertexTemplate(i,"a_shape",0,{size:4}),this.fillVertexTemplate(i,"a_shape",t.label.layout.collide?0:1,{size:1,offset:3}),this.fillVertexTemplate(i,"a_texcoord",0,{size:2}),this.fillVertexTemplate(i,"a_offset",0,{size:2}),this.fillVertexTemplate(i,"a_color",ua.mult(n,255),{size:4}),this.defines.TANGRAM_HAS_SHADER_POINTS&&e.variant.shader_point&&(r=t.outline_color||yo.defaults.outline.color,this.fillVertexTemplate(i,"a_outline_color",ua.mult(r,255),{size:4}),this.fillVertexTemplate(i,"a_outline_edge",t.outline_edge_pct||yo.defaults.outline.width,{size:1})),this.selection&&this.fillVertexTemplate(i,"a_selection_color",ua.mult(t.selection_color,255),{size:4}),this.fillVertexTemplate(i,"a_is_flat",0,{size:1}),this.defines.TANGRAM_POINT_DRAW_STICK&&t.stick&&(this.fillVertexTemplate(i,"a_is_stick",0,{size:1}),this.fillVertexTemplate(i,"a_stick_height",t.stick.height,{size:1})),this.vertex_template},buildQuad:function(t,e,r,n,i,o,a,s,u,l,c,h,f,p,d,v,y,g,m){return e[0]<=0||e[1]<=0?0:function(t,e,r,n){var i,o,a,s,u,l,c=n.quad,h=n.offset,f=n.offsets,p=n.offsets_alt,d=n.pre_angles,v=n.pre_angles_alt,y=n.angle,g=n.angles,m=n.angles_alt,_=n.is_flat,b=n.elevate_by_altitude,x=n.build_stick_points,w=n.color,E=n.stick_color,T=n.curve,A=n.texcoord_scale,k=n.texcoord_normalize,S=n.pre_angles_normalize,M=n.angles_normalize,O=n.offsets_normalize,I=(I=n.quad_normalize)||1,L=c[0]/2*I,C=c[1]/2*I,R=[[-L,-C],[L,-C],[L,C],[-L,C]],P=e.vertex_elements,N=e.vertex_count,j=e.vertex_layout.index,D=j.a_texcoord,z=j.a_position,H=j.a_shape,F=j.a_offset,B=j.a_offsets,U=j.a_offsets_alt,G=j.a_pre_angles,q=j.a_pre_angles_alt,V=j.a_angles,W=j.a_angles_alt,Y=j.a_is_flat,K=j.a_is_stick,X=j.a_color;D&&(k=k||1,l=[[o=(i=Cn(A||cl,4))[0],a=i[1]],[s=i[2],a],[s,u=i[3]],[o,u]]);for(var Z=0,$=t.length,J=0;J<$;J++){var Q=t[J];if(x){for(var tt=.5*I,et=+I,rt=[[-tt,0],[+tt,0],[+tt,et],[-tt,et]],nt=0;nt<4;nt++)D&&(r[D+0]=l[nt][0]*k,r[D+1]=l[nt][1]*k),r[z+0]=Q[0],r[z+1]=Q[1],b&&(r[z+2]=$n.clamp(Q[2],0,32767)),r[H+0]=rt[nt][0],r[H+1]=rt[nt][1],r[H+2]=0,r[X+0]=E[0],r[X+1]=E[1],r[X+2]=E[2],r[X+3]=E[3],r[K+0]=255,e.addVertex(r);P.push(N+0),P.push(N+1),P.push(N+2),P.push(N+2),P.push(N+3),P.push(N+0),N+=4,Z+=2}for(var it=0;it<4;it++)D&&(r[D+0]=l[it][0]*k,r[D+1]=l[it][1]*k),r[z+0]=Q[0],r[z+1]=Q[1],b&&(r[z+2]=$n.clamp(Q[2],0,32767)),r[H+0]=R[it][0],r[H+1]=R[it][1],r[H+2]=y,r[X+0]=w[0],r[X+1]=w[1],r[X+2]=w[2],r[X+3]=w[3],r[F+0]=h[0],r[F+1]=h[1],r[Y+0]=_?255:0,x&&(r[K+0]=0),T&&(r[G+0]=S*d[0],r[G+1]=S*d[1],r[G+2]=S*d[2],r[G+3]=S*d[3],r[V+0]=M*g[0],r[V+1]=M*g[1],r[V+2]=M*g[2],r[V+3]=M*g[3],r[B+0]=O*f[0],r[B+1]=O*f[1],r[B+2]=O*f[2],r[B+3]=O*f[3],p&&(r[U+0]=O*p[0],r[U+1]=O*p[1],r[U+2]=O*p[2],r[U+3]=O*p[3],r[q+0]=S*v[0],r[q+1]=S*v[1],r[q+2]=S*v[2],r[q+3]=S*v[3],r[W+0]=M*m[0],r[W+1]=M*m[1],r[W+2]=M*m[2],r[W+3]=M*m[3])),e.addVertex(r);P.push(N+0),P.push(N+1),P.push(N+2),P.push(N+2),P.push(N+3),P.push(N+0),N+=4,Z+=2}return Z}(t,d,v,{quad:e,quad_normalize:256,offset:s,offsets:u,offsets_alt:l,pre_angles:o,pre_angles_alt:a,angle:4096*r,angles:n,angles_alt:i,is_flat:f,elevate_by_altitude:p,build_stick_points:y,stick_color:y&&ua.mult(g,255),color:ua.mult(m||yo.defaults.color,255),curve:h,texcoord_scale:c,texcoord_normalize:65535,pre_angles_normalize:mh,angles_normalize:_h,offsets_normalize:64})},build:function(t,e,r){var n=t.label;return"curved"===n.type?this.buildCurvedLabel(n,t,e,r):this.buildStraightLabel(n,t,e,r)},buildStraightLabel:function(t,e,r,n){var i,o=this.makeVertexTemplate(e,r),a=t.angle||e.angle,s="point"!==t.type?(i=e.size[t.type],cl):(i=e.size,e.texcoords||cl);r.uniforms=r.uniforms||{},e.label_texture?(r.uniforms.u_texture=e.label_texture,r.uniforms.u_point_type=2,r.uniforms.u_apply_color_blocks=!1):(e.texture?(r.uniforms.u_texture=e.texture,r.uniforms.u_point_type=1):(r.uniforms.u_texture=this.textureManager.default,r.uniforms.u_point_type=3),r.uniforms.u_apply_color_blocks=!0);var u=t.offset,l=this.defines.TANGRAM_POINT_DRAW_STICK&&!e.label_texture&&e.stick&&0<e.stick.height,c=this.buildQuad([t.position],i,a,null,null,null,null,u,null,null,s,!1,t.isFlat(),e.elevate_by_altitude,r.vertex_data,o,l,l&&e.stick.color,e.color),h=e.linked&&e.linked.label.id;return this.trackLabel(t,h,r,c,n,l),c},buildCurvedLabel:function(t,e,r,n){for(var i=this.makeVertexTemplate(e,r),o=t.angle,a=0,s=0;s<2;s++)for(var u=0;u<t.num_segments;u++){var l=e.size[t.type][u],c=cl,h=this.getTileMesh(n.tile,this.getMeshVariantTypeForDraw(e));h.uniforms=h.uniforms||{},h.uniforms.u_texture=e.label_texture,h.uniforms.u_point_type=2,h.uniforms.u_apply_color_blocks=!1;var f=t.offset||[0,0],p=t.position,d=t.angles[u],v=t.offsets[u],y=t.pre_angles[u],g=t.num_segments-u-1,m=t.alt_angles[g],_=t.alt_pre_angles[g],b=t.alt_offsets[g],x=this.buildQuad([p],l,o,d,m,y,_,f,v,b,c,!0,t.isFlat(),e.elevate_by_altitude,h.vertex_data,i,!1,!1,e.color);a+=x;var w=e.linked&&e.linked.label.id;this.trackLabel(t,w,r,x,n,!1)}return a},trackLabel:function(t,e,r,n,i,o){var a=5<arguments.length&&void 0!==o&&o;r.labels=r.labels||{},r.labels.collision=r.labels.collision||{},r.labels["non-collision"]=r.labels["non-collision"]||{};var s=t.layout.collide?r.labels.collision:r.labels["non-collision"];s[t.id]=s[t.id]||{container:{label:t.text_data?Object.assign(t.toJSON(),{text_data:t.text_data}):t.toJSON(),linked:e},ranges:[]};var u=2*n,l=r.vertex_data.offset-r.vertex_data.stride*u;s[t.id].ranges.push([l,u,a])},buildLines:function(t,e,r,n){return this.build(e,r,n)},buildPoints:function(t,e,r,n){return this.build(e,r,n)},buildPolygons:function(t,e,r,n){return this.build(e,r,n)},vertexLayoutForMeshVariant:function(t){var e;return this.vertex_layout||(e=[{name:"a_position",size:4,type:tl.SHORT,normalized:!1},{name:"a_shape",size:4,type:tl.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:tl.UNSIGNED_SHORT,normalized:!0},{name:"a_offset",size:2,type:tl.SHORT,normalized:!1},{name:"a_color",size:4,type:tl.UNSIGNED_BYTE,normalized:!0},{name:"a_outline_color",size:4,type:tl.UNSIGNED_BYTE,normalized:!0,static:[0,0,0,0]},{name:"a_outline_edge",size:1,type:tl.FLOAT,normalized:!1,static:0},{name:"a_selection_color",size:4,type:tl.UNSIGNED_BYTE,normalized:!0},{name:"a_is_flat",size:1,type:tl.UNSIGNED_BYTE,normalized:!0}],this.defines&&this.defines.TANGRAM_POINT_DRAW_STICK&&e.push({name:"a_is_stick",size:1,type:tl.UNSIGNED_BYTE,normalized:!0},{name:"a_stick_height",size:1,type:tl.FLOAT,normalized:!1}),this.vertex_layout=new ul(e),(e=e.map(function(t){return Object.assign({},t)})).forEach(function(t){"a_outline_color"!==t.name&&"a_outline_edge"!==t.name||(t.static=null)}),this.vertex_layout_shader_point=new ul(e)),t.shader_point?this.vertex_layout_shader_point:this.vertex_layout},computeVariantForDraw:function(t){var e=t.label_texture||t.texture||this.default_mesh_variant.key;return{key:e,shader_point:e===this.default_mesh_variant.key,order:t.label_texture?1:0}},makeMesh:function(t,e,r){var n=2<arguments.length&&void 0!==r?r:{};n=Object.assign({},n,{fade_in_time:this.fade_in_time});return ya.makeMesh.call(this,t,e,n)}});var xh=[0,.33,.66,.99],wh=function(t,e,r,n,i){for(var o=[{type:"straight",tolerance:i.no_curving?1.8:1.5},{type:"curved"},{type:"straight",tolerance:2.3}],a=0;a<o.length;a++){var s=o[a],u=void 0;if("straight"===s.type?u=new Th(e,r,n,i,s.tolerance):"curved"===s.type&&!i.no_curving&&2<r.length&&(u=new Ah(t,r,n,i)),u&&!u.throw_away)return u}return!1},Eh=function(){function t(e,r){gn(this,t),this.id=dc.nextLabelId(),this.layout=r,this.position=[],this.angle=0,this.offset=r.offset.slice(),this.unit_scale=this.layout.units_per_pixel,this.type="",this.throw_away=!1,this._is_flat=e,this._circles=void 0,this.placed=null}return _n(t,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,size:this.size,offset:this.offset,angle:this.angle,breach:this.breach,layout:vc(this.layout),circles:this.getBoundingCircles()}}},{key:"inTileBounds",value:function(){var t=this.getAABB(),e=t.left,r=t.top,n=t.right,i=t.bottom;return Ai.pointInTile([e,r])&&Ai.pointInTile([n,i])}},{key:"getAABBForSegment",value:function(t,e,r,n){var i,o=this.unit_scale,a=e/2,s=r/2,u=Cn(t,2),l=u[0],c=u[1];0===this.offset[0]&&0===this.offset[1]||(l+=(i=ua.rot(this.offset,this.angle))[0]*o,c-=i[1]*o);var h=[[Math.cos(n),-Math.sin(n)],[Math.sin(n),Math.cos(n)]],f=ua.multMatrix(h,[-a,-s]),p=ua.multMatrix(h,[a,-s]),d=ua.multMatrix(h,[a,s]),v=ua.multMatrix(h,[-a,s]);return{left:l+Math.min(f[0],p[0],d[0],v[0]),top:c+Math.max(f[1],p[1],d[1],v[1]),right:l+Math.max(f[0],p[0],d[0],v[0]),bottom:c+Math.min(f[1],p[1],d[1],v[1])}}},{key:"isFlat",value:function(){return this._is_flat}},{key:"getBoundingCircles",value:function(){}},{key:"getAABB",value:function(){}}],[{key:"splitLineByOrientation",value:function(t){for(var e=[t[0]],r=0,n=0,i=0,o=e,a=!1,s=1;s<t.length;s++){var u=t[s],l=t[s-1],c=ua.length(ua.sub(u,l));u[0]>l[0]?1===i?(e.push(u),n<(r+=c)&&(o=e,n=r,a=!1)):(e=[l,u],n<(r=c)&&(o=e,n=r,a=!1),i=1):u[0]<l[0]?-1===i?(e.unshift(u),n<(r+=c)&&(o=e,n=r,a=!0)):(e=[u,l],n<(r=c)&&(o=e,n=r,a=!0),i=-1):(-1===i?e.unshift(u):(e.push(u),i=1),n<(r+=c)&&(o=e,n=r,a=-1===i))}return[o,a]}}]),t}(),Th=function(){En(e,Eh);var t=In(e);function e(r,n,i,o,a){var s;return gn(this,e),(s=t.call(this,i,o)).type="straight",s.size=r,s.throw_away=!s.fit(r,n,o,a),s}return _n(e,[{key:"fit",value:function(t,e,r,n){var i,o=this.unit_scale,a=Cn(Eh.splitLineByOrientation(e),2);e=a[0],i=a[1],"number"==typeof r.orientation&&(this.offset[1]+=1.2*(t[1]-r.vertical_buffer),i&&(this.offset[1]*=-1),-1===r.orientation&&(this.offset[1]*=-1));for(var s=Sh(e),u=t[0]*o,l=0;l<e.length-1;l++)for(var c=e[l],h=0,f=0,p=l+1,d=void 0;p<e.length;){var v=e[p-1],y=e[p],g=kh(v,y);if(p!==l+1&&(h+=function(t,e){var r,n;for(n=d<g?(r=d,g):(r=g,d);n-r>Math.PI;)r+=2*Math.PI;return Math.abs(n-r)}()),.1<Math.abs(h))break;if(u/(f+=s[p-1])<n){var m=ua.mult(ua.add(c,y),.5);return this.angle=-g,Math.abs(this.angle-Math.PI/2)<.01&&(this.angle=-Math.PI/2,"number"==typeof r.orientation&&(this.offset[1]*=-1)),this.position=m,this.breach=!this.inTileBounds(),!0}d=g,p++}return!1}},{key:"getBoundingCircles",value:function(){var t,e,r,n,i,o,a,s,u,l,c,h,f,p;return this._circles||(t=this.unit_scale,i=-(r=(e=this.size[0]/2*t)*Math.cos(this.angle)),o=-(n=e*Math.sin(this.angle)),a=this.offset[0]*t,s=this.offset[1]*t,l=(u=Cn(this.position,2))[0],c=u[1],c*=-1,a&&(h=[r,n],ua.normalize(h),h[0]*=a,h[1]*=a,l+=h[0],c+=h[1]),s&&(f=[n,-r],ua.normalize(f),f[0]*=s,f[1]*=s,l-=f[0],c-=f[1]),r+=l,n+=c,i+=l,o+=c,p=this.size[1]/2*t,this._circles=xc(r,n,i,o,p)),this._circles}},{key:"getAABB",value:function(){var t,e,r,n,i;return this._aabb||(t=this.unit_scale,e=this.size,r=this.layout.buffer,n=(e[0]+2*r[0])*t,i=(e[1]+2*r[1])*t,this._aabb=this.getAABBForSegment(this.position,n,i,this.angle)),this._aabb}}]),e}(),Ah=function(){En(e,Eh);var t=In(e);function e(r,n,i,o){var a;return gn(this,e),(a=t.call(this,i,o)).type="curved",a.positions=[],a.angles=[],a._aabbs=[],a.pre_angles=[],a.offsets=[],a.num_segments=r.length,a.sizes=r,a.alt_angles=[],a.alt_pre_angles=[],a.alt_offsets=[],a.throw_away=!a.fit(a.sizes,n,o),a}return _n(e,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,breach:this.breach,layout:vc(this.layout),circles:this.getBoundingCircles()}}},{key:"fit",value:function(t,r,n){var i,o=this.unit_scale,a=Math.max.apply(Math,Rn(t.map(function(t){return t[1]}))),s=a*o,u=Cn(Eh.splitLineByOrientation(r),2);r=u[0],i=u[1],"number"==typeof n.orientation&&(this.offset[1]+=1.2*(a-n.vertical_buffer),i&&(this.offset[1]*=-1),-1===n.orientation&&(this.offset[1]*=-1));var l=Sh(r),c=t.map(function(t){return t[0]*o}),h=l.reduce(function(t,e){return t+e},0),f=c.reduce(function(t,e){return t+e},0);if(h<f)return!1;var p=r.length-1;if(p<2)return!1;var d=e.curvaturePlacement(r,h,l,f,0,p),v=r[d];if(-1===d||p-d<2)return!1;this.position=v;for(var y=0;y<c.length;y++){this.positions[y]=[],this.offsets[y]=[],this.angles[y]=[],this.pre_angles[y]=[];for(var g=0;g<xh.length;g++){var m=xh[g],_=Cn(e.scaleLine(m,r),2),b=_[0],x=_[1],w=(v=b[d],e.placeAtIndex(d,b,x,c)),E=w.positions,T=w.offsets,A=w.angles,k=w.pre_angles,S=T.map(function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])/o});if(0===m){this.angle=1/A.length*A.reduce(function(t,e){return t+e});for(var M=0;M<E.length;M++){var O=E[M],I=k[M],L=c[M],C=I+A[M];this._aabbs.push(this.getAABBForSegment(O,L,s,C))}}this.positions[y].push(E[y]),this.offsets[y].push(S[y]),this.angles[y].push(A[y]),this.pre_angles[y].push(k[y])}}c=t.slice().reverse().map(function(t){return t[0]*o});for(var R=0;R<c.length;R++){this.alt_offsets[R]=[],this.alt_angles[R]=[],this.alt_pre_angles[R]=[];for(var P=0;P<xh.length;P++){var N=xh[P],j=Cn(e.scaleLine(N,r),2),D=j[0],z=j[1];v=D[d];var H=e.placeAtIndex(d,D,z,c),F=H.offsets,B=H.angles,U=H.pre_angles,G=F.map(function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])/o});0===N&&(this.alt_angle=1/B.length*B.reduce(function(t,e){return t+e})),this.alt_offsets[R].push(G[R]),this.alt_angles[R].push(B[R]),this.alt_pre_angles[R].push(U[R])}}return!0}},{key:"getBoundingCircles",value:function(){if(!this._circles){for(var t=[],e=this.unit_scale,r=0;r<this.positions.length;r++){var n=this.sizes[r],i=this.angles[r][0],o=this.positions[r][0],a=n[0]/2*e,s=a*Math.cos(i),u=a*Math.sin(i),l=-s,c=-u,h=Cn(o,2),f=h[0],p=h[1],d=xc(s+=f,u+=p*=-1,l+=f,c+=p,n[1]/2*e);Array.prototype.push.apply(t,d)}this._circles=t}return this._circles}},{key:"getAABB",value:function(){if(!this._aabb){for(var t=1/0,e=-1/0,r=-1/0,n=1/0,i=0;i<this._aabbs.length;i++){var o=this._aabbs[i];t=Math.min(t,o.left),e=Math.max(e,o.top),r=Math.max(r,o.right),n=Math.min(n,o.bottom)}this._aabb={left:t,top:e,right:r,bottom:n}}return this._aabb}}],[{key:"curvaturePlacement",value:function(t,e,r,n,i,o){i=i||0,o=o||t.length-1;for(var a=[],s=i+1;s<o;s++){var u=t[s-1],l=t[s],c=t[s+1],h=ua.perp(l,u),f=ua.perp(c,l),p=ua.angleBetween(h,f);1<p&&(p=1/0),a.push(p)}a.push(1/0);for(var d=[],v=[],y=i,g=0,m=0;m<i;m++)g+=r[m];for(;g+n<e;){for(var _=g+n,b=g,x=y,w=0;x<o&&b+r[x]<_&&(w+=a[x])!==1/0;)b+=r[x],x++;if(0===w)return y;var E=w/(x-y);d.push(w),v.push(E),g+=r[y],y++}if(0===d.length)return-1;var T=Math.min.apply(null,d),A=v[d.indexOf(T)];return T<1.3&&A<.4?d.indexOf(T):-1}},{key:"scaleLine",value:function(t,e){var r=[e[0]],n=[];return e.forEach(function(i,o){var a,s;o!==e.length-1&&(a=ua.sub(e[o+1],e[o]),s=ua.mult(a,1+t),r.push(ua.add(r[o],s)),n.push(ua.length(s)))}),[r,n]}},{key:"placeAtIndex",value:function(t,r,n,i){var o=r[t],a=Cn(e.getIndicesAndOffsets(t,n,i),2),s=a[0],u=a[1],l=e.getPositionsFromIndicesAndOffsets(r,s,u),c=Cn(e.getAnglesFromIndicesAndOffsets(o,s,r,l),3);return{positions:l,offsets:c[0],angles:c[1],pre_angles:c[2]}}},{key:"getIndicesAndOffsets",value:function(t,e,r){for(var n=r.length,i=[],o=[],a=0,s=0,u=0;a<n;){for(var l=r[a];a<n&&s+.5*l<=u+e[t];){var c=s-u+.5*l;o.push(c),i.push(t),s+=l,l=r[++a]}u+=e[t],t++}return[i,o]}},{key:"getPositionsFromIndicesAndOffsets",value:function(t,e,r){for(var n=[],i=0;i<e.length;i++){var o=e[i],a=r[i],s=kh(t[o],t[o+1]),u=ua.rot([a,0],s),l=ua.add(t[o],u);n.push(l)}return n}},{key:"getAnglesFromIndicesAndOffsets",value:function(t,e,r,n){for(var i=[],o=[],a=[],s=0;s<n.length;s++){var u,l,c=n[s],h=e[s],f=ua.sub(c,t),p=-ua.angle(f),d=-kh(r[h],r[h+1])-p;0<s&&(u=i[s-1],l=o[s-1],Math.abs(p-u)>Math.PI&&(p+=u<p?-2*Math.PI:2*Math.PI),Math.abs(l-d)>Math.PI&&(d+=l<d?-2*Math.PI:2*Math.PI)),i.push(p),o.push(d),a.push(f)}return[a,i,o]}}]),e}();function kh(t,e){var r=ua.sub(e,t);return ua.angle(r)}function Sh(t){for(var e=[],r=0;r<t.length-1;r++){var n=t[r],i=t[r+1],o=Math.hypot(n[0]-i[0],n[1]-i[1]);e.push(o)}return e}var Mh=Object.create(bh);Object.assign(Mh,{name:"text",super:bh,built_in:!0,init:function(t){var e=0<arguments.length&&void 0!==t?t:{};ya.init.call(this,e),this.setupDefines(),this.defines.TANGRAM_HAS_SHADER_POINTS=!1,this.defines.TANGRAM_IS_TEXT_STYLE=!0,this.reset()},makeVertexTemplate:function(t,e){this.super.makeVertexTemplate.apply(this,arguments);var r=e.vertex_data.vertex_layout;return this.fillVertexTemplate(r,"a_pre_angles",0,{size:4}),this.fillVertexTemplate(r,"a_offsets",0,{size:4}),this.fillVertexTemplate(r,"a_angles",0,{size:4}),this.fillVertexTemplate(r,"a_offsets_alt",0,{size:4}),this.fillVertexTemplate(r,"a_pre_angles_alt",0,{size:4}),this.fillVertexTemplate(r,"a_angles_alt",0,{size:4}),this.vertex_template},reset:function(){this.queues={},this.resetText()},addFeature:function(t,e,r){var n=this,i=r.tile,o=t.geometry.type;e.can_articulate="LineString"===o||"MultiLineString"===o,e.supersample_text="LineString"===o||"MultiLineString"===o;var a=this.parseTextFeature(t,e,r,i);a&&(a instanceof Array?a.forEach(function(e){e.feature=t,e.context=r,e.layout.vertex=!1,n.queueFeature(e,i)}):(a.feature=t,a.context=r,a.layout.vertex=!1,this.queueFeature(a,i)),To.addStyle(this.name,i.id))},endData:function(t){var e=this,r=this.queues[t.id];return delete this.queues[t.id],this.collideAndRenderTextLabels(t,this.name,r).then(function(r){var n=r.labels,i=r.texts;return n&&i&&(e.texts[t.id]=i,n.forEach(function(r){var n=r.text_settings_key,i=e.texts[t.id][n]&&e.texts[t.id][n][r.text],o=e.feature_style;o.label=r.label,r.label.text_data={text_info:i,text_settings_key:n,text:r.text},o.label_texture=e.textureManager.default,i.text_settings.can_articulate?(o.size={},"straight"===r.label.type?o.size.straight=i.size.logical_size:o.size.curved=i.segment_sizes.map(function(t){return t.logical_size})):o.size=i.size.logical_size,ya.addFeature.call(e,r.feature,r.draw,r.context)})),e.freeText(t),ya.endData.call(e,t).then(function(r){if(r){for(var n in r.meshes)r.meshes[n].uniforms.u_apply_color_blocks=!0;t.mesh_data[e.name]=r}return r})})},_preprocess:function(t){return this.preprocessText(t)},buildTextLabels:function(t,e){for(var r=[],n=0;n<e.length;n++){var i,o,a=e[n],s=this.texts[t.id][a.text_settings_key][a.text];a.layout.vertical_buffer=s.vertical_buffer,o=s.text_settings.can_articulate?(i=s.segment_sizes.map(function(t){return t.collision_size}),a.layout.no_curving=s.no_curving,this.buildLabels(i,a.feature.geometry,a.layout,s.size.collision_size)):this.buildLabels(s.size.collision_size,a.feature.geometry,a.layout);for(var u=0;u<o.length;u++){var l=Object.create(a);l.label=o[u],r.push(l)}}return r},buildLabels:function(t,e,r,n){var i,o,a="Point"!==e.type,s=[];if("LineString"===e.type)Array.prototype.push.apply(s,this.buildLineLabels(e.coordinates,t,a,r,n));else if("MultiLineString"===e.type)for(var u=e.coordinates,l=0;l<u.length;++l)Array.prototype.push.apply(s,this.buildLineLabels(u[l],t,a,r,n));else if("Point"===e.type)s.push(new wc(e.coordinates,t,a,r));else if("MultiPoint"===e.type)for(var c=e.coordinates,h=0;h<c.length;++h)s.push(new wc(c[h],t,a,r));else"Polygon"===e.type?(i=Qn.centroid(e.coordinates),s.push(new wc(i,t,a,r))):"MultiPolygon"===e.type&&(o=Qn.multiCentroid(e.coordinates),s.push(new wc(o,t,a,r)));return s},buildLineLabels:function(t,e,r,n,i){var o,a=[],s=Math.min(n.subdiv,t.length-1);if(1<s)for(var u=(t.length-1)/s,l=0;l<s;l++){var c=Math.floor(l*u),h=Math.floor((l+1)*u)+1,f=t.slice(c,h),p=wh(e,i,f,r,n);p&&a.push(p)}return a.length<s&&(o=wh(e,i,t,r,n))&&a.push(o),a},vertexLayoutForMeshVariant:function(){var t;return this.vertex_layout||(t=[{name:"a_position",size:4,type:tl.SHORT,normalized:!1},{name:"a_shape",size:4,type:tl.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:tl.UNSIGNED_SHORT,normalized:!0},{name:"a_offset",size:2,type:tl.SHORT,normalized:!1},{name:"a_color",size:4,type:tl.UNSIGNED_BYTE,normalized:!0},{name:"a_angles",size:4,type:tl.SHORT,normalized:!1},{name:"a_offsets",size:4,type:tl.UNSIGNED_SHORT,normalized:!1},{name:"a_pre_angles",size:4,type:tl.BYTE,normalized:!1},{name:"a_selection_color",size:4,type:tl.UNSIGNED_BYTE,normalized:!0},{name:"a_is_flat",size:1,type:tl.UNSIGNED_BYTE,normalized:!0},{name:"a_offsets_alt",size:4,type:tl.UNSIGNED_SHORT,normalized:!1},{name:"a_pre_angles_alt",size:4,type:tl.BYTE,normalized:!1},{name:"a_angles_alt",size:4,type:tl.SHORT,normalized:!1}],this.vertex_layout=new ul(t)),this.vertex_layout},getMeshVariantTypeForDraw:bh.getMeshVariantTypeForDraw}),Mh.texture_id=0;var Oh=Object.create(Rl);Object.assign(Oh,{name:"raster",super:Rl,built_in:!0,init:function(){this.raster=this.raster||"color",this.super.init.apply(this,arguments),this.selection=!1,this.defines.SNAP_TO_PIXEL_GRID=!0},_preprocess:function(t){return t.color=t.color||yo.defaults.color,this.super._preprocess.apply(this,arguments)}});var Ih=Object.create(bh);Object.assign(Ih,{name:"custom_icons",collision:!1,init:function(t){var e=0<arguments.length&&void 0!==t?t:{};bh.init.call(this,e)},loadTexture:function(t,e,r){var n,i=t.width,o=t.height,a=t.items,s=document.createElement("canvas"),u=Ai.device_pixel_ratio,l=this.sources[e],c={sprites:{}};if(s.width=i*u,s.height=o*u,l){var h,f=a.length,p=s.getContext("2d");for(p.scale(u,u);h=a[--f];){var d,v=l.getIconBitmapByObjectId(h.meta.objectId,h.meta.id);v&&((d=Ru(v))?Ei("error",d):(p.drawImage(v,h.x,h.y,h.width,h.height),c.sprites[h.meta.id]=[h.x,h.y,h.width,h.height]))}}return c.element=s,(n=this.textureManager.create(this.gl,r,c)).retain(),n.loading.then(function(t){return t.name})},buildRasterTextures:function(t,e){return li.postMessage(this.main_thread_target+".loadTexture",t.rasters,t.source,t.texture_name).then(function(t){return e.textures.push(t),e})},addFeature:function(t,e,r){var n=r.tile.rasters,i={};n.items.forEach(function(t){i[t.meta.id]=[t.x,t.y,t.width,t.height]});var o="".concat(r.tile.source,"_dyn_").concat(r.tile.coords.key,"_").concat(this.generation,"_").concat(r.tile.id);e.texture=r.tile.texture_name=o;var a=Object.assign({},Lh,{name:o,width:n.width,height:n.height,sprites:i,manager:this.textureManager});So.prototype.calculateSprites.apply(a),this.textureManager.textures[o]=a,bh.addFeature.apply(this,arguments),delete this.textureManager.textures[o]}});var Lh={filtering:"linear",density:1,valid:!0,power_of_2:!1,texcoords:{},sizes:{},css_sizes:{},aspects:{}},Ch=Object.create(Rl);Object.assign(Ch,{name:"overlays",super:Rl,init:function(t){var e=0<arguments.length&&void 0!==t?t:{};this.selection=e.selection||!0,this.raster=this.raster||"color",this.super.init.apply(this,arguments)},setupRasters:function(){if(!ui.is_main)return!1;if(this.super.setupRasters.call(this))return!0;var t=!1;for(var e in this.sources)if(this.sources[e]instanceof Du){t=!0;break}return!!t&&(this.defines.TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING=!0,this.replaceShaderBlock("raster",va,"Raster"),!0)},loadTextures:function(t,e){var r,n,i,o=this.sources[e],a=t.name;if(t.overlays_config.forEach(function(e){var a,s=e.texcoords,u=e.id,l=o.getMapObjectById(u),c=l.getBitmap();c&&((a=Ru(c=Pu(c,c.width,c.height)))?Ei("error",a):(r||((r=document.createElement("canvas")).width=t.width,r.height=t.height,n=r.getContext("2d")),n.save(),n.globalAlpha=l.getOpacity(),s.forEach(function(t){return n.drawImage(c,t[0],t[1],t[2],t[3])}),n.restore(),i=!0))}),i){t.element=r;var s={};return s[a]=t,this.super.loadTextures.call(this,s)}var u=this.textureManager.textures[this.textureManager.default];return Promise.resolve([{name:u.name,width:u.width,height:u.height,loaded:u.loaded}])},buildRasterTextures:function(t,e){var r=this.sources[t.source].tileTexture(t);return r?li.postMessage(this.main_thread_target+".loadTextures",r,t.source).then(function(t){if(!t||t.length<1)return e;if(t.some(function(t){return!t.loaded}))return null;var r=t[0].name;return e.uniforms=e.uniforms||{},e.textures=e.textures||[],e.uniforms.u_raster=r,e.uniforms.u_raster_offset=[0,0,1],e.textures.push(r),e}):Promise.resolve(e)}});var Rh=Object.create(ya),Ph=[-1,0,1,0,-1,1,-1,1,1,0,1,1,-1,0,1,0,-1,1,-1,1,1,0,1,1];Object.assign(Rh,{name:"skybox",built_in:!0,vertex_shader_src:"uniform float u_horizon;uniform float u_tilt;uniform float u_zoom;attribute vec2 a_position;attribute float a_is_sky;attribute float a_is_top;attribute vec4 a_color;varying vec4 v_color;const float SIN_THRESHOLD_ANGLE=0.96126069082;void main(){v_color=a_color;float sin_tilt=sin(u_tilt);float sky_bottom_alpha=1.-max(sin_tilt-SIN_THRESHOLD_ANGLE,0.)*3.;if((a_position.y==1.&&a_is_sky==0.)||(a_position.y==0.&&a_is_sky==1.)){v_color.w=sky_bottom_alpha;}float fog_height=max((22.-u_zoom)*0.04,0.)*(sin_tilt-.7);float position_z=u_zoom<17. ? .942 : .9418;gl_Position=vec4(a_position.x,a_is_sky*(a_position.y+a_is_top)+1.0-u_horizon-(1.0-a_is_sky)*(1.0-a_position.y)*fog_height,position_z,1.0);}",fragment_shader_src:"varying vec4 v_color;void main(void){gl_FragColor=v_color;}",selection:!1,blend:"inlay",blend_order:1,init:function(){ya.init.apply(this,arguments),this.selection=!1},_preprocess:function(t){return t.color={top:yo.createColorPropertyCache(t.color.zenith),bottom:yo.createColorPropertyCache(t.color.horizon),fog:yo.createColorPropertyCache(t.color.fog)},t},vertexLayoutForMeshVariant:function(){var t;return this.vertex_layout||(t=[{name:"a_position",size:2,type:tl.FLOAT,normalized:!1},{name:"a_is_sky",size:1,type:tl.FLOAT,normalized:!0},{name:"a_color",size:4,type:tl.UNSIGNED_BYTE,normalized:!0},{name:"a_is_top",size:1,type:tl.FLOAT,normalized:!0}],this.vertex_layout=new ul(t)),this.vertex_layout},makeVertexTemplate:function(){var t=0;return this.vertex_template[t++]=0,this.vertex_template[1]=0,this.vertex_template},parseFeature:function(t,e,r){var n=this.feature_style;return e.color&&e.color.top&&e.color.bottom&&(n.color_top=this.parseColor(e.color.top,r),n.color_bottom=this.parseColor(e.color.bottom,r),n.color_fog=this.parseColor(e.color.fog||"white",r),Array.isArray(n.color_fog)&&(n.color_fog=n.color_fog.slice(),n.color_fog[3]=0)),n},buildGeometry:function(t,e,r){for(var n=this.makeVertexTemplate(e),i=r.vertex_data,o=r.vertex_data.vertex_layout,a=i.vertex_layout.index.a_position,s={top:e.color_top,bottom:e.color_bottom},u={top:e.color_bottom,bottom:e.color_fog},l=0,c=Ph.length-1;l<c;l+=2){n[a+0]=Ph[l],n[a+1]=Ph[l+1];var h=l<12,f=0<Ph[l+1],p=h?s:u;this.fillVertexTemplate(o,"a_is_sky",h?1:0,{size:1}),this.fillVertexTemplate(o,"a_is_top",f?1:0,{size:1}),this.fillVertexTemplate(o,"a_color",ua.mult(f?p.top:p.bottom,255),{size:4}),i.addVertex(n)}return 4}});var Nh=function(){function t(){gn(this,t),this.styles={},this.base_styles={},this.register(Object.create(Rl)),this.register(Object.create(tc)),this.register(Object.create(ac)),this.register(Object.create(bh)),this.register(Object.create(Mh)),this.register(Object.create(Oh)),this.register(Object.create(Ih)),this.register(Object.create(Ch)),this.register(Object.create(Rh))}return _n(t,[{key:"init",value:function(){ra.removeBlock("global"),ra.removeBlock("setup"),ra.addBlock("global","#ifdef TANGRAM_VERTEX_SHADER\nvec4 modelPosition(){return vec4(a_position.xyz/TANGRAM_TILE_SCALE*exp2(u_tile_origin.z-u_tile_origin.w),1.)+vec4(0.,1.,0.,0.);}vec4 modelPositionBaseZoom(){return vec4(a_position.xyz/TANGRAM_TILE_SCALE,1.)+vec4(0.,1.,0.,0.);}\n#endif\nvec4 worldPosition(){return v_world_position;}\n#ifdef TANGRAM_VERTEX_SHADER\nvec4 wrapWorldPosition(vec4 world_position){\n#if defined(TANGRAM_WORLD_POSITION_WRAP)\nvec2 anchor=u_tile_origin.xy-mod(u_tile_origin.xy,TANGRAM_WORLD_POSITION_WRAP);world_position.xy-=anchor;\n#endif\nreturn world_position;}\n#endif\n#if defined(TANGRAM_VERTEX_SHADER)\nvec3 worldNormal(){return TANGRAM_NORMAL;}\n#elif defined(TANGRAM_FRAGMENT_SHADER)\nvec3 worldNormal(){return u_inverseNormalMatrix*TANGRAM_NORMAL;}\n#endif\n"),ra.addBlock("global","void applyLayerOrder(float layer,inout vec4 position){position.z-=layer*TANGRAM_LAYER_DELTA*position.w;}"),ra.addBlock("global","\n#if defined(TANGRAM_FEATURE_SELECTION) && defined(TANGRAM_VERTEX_SHADER)\nattribute vec4 a_selection_color;varying vec4 v_selection_color;uniform vec4 u_selection_discard0;uniform vec4 u_selection_discard1;uniform vec4 u_selection_discard2;uniform vec4 u_selection_discard3;uniform vec4 u_selection_discard4;uniform vec4 u_selection_discard5;uniform vec4 u_selection_discard6;uniform vec4 u_selection_discard7;uniform vec4 u_selection_discard8;uniform vec4 u_selection_discard9;\n#endif\n"),ra.addBlock("global","uniform float u_view_pan_snap_timer;void snapToPixelGrid(inout vec4 position){vec2 position_fract=fract((((position.xy/position.w)+1.)*.5)*u_resolution);vec2 position_snap=position.xy+((step(0.5,position_fract)-position_fract)*position.w*2./u_resolution);\n#ifdef TANGRAM_VIEW_PAN_SNAP_RATE\nposition.xy=mix(position.xy,position_snap,clamp(u_view_pan_snap_timer*TANGRAM_VIEW_PAN_SNAP_RATE,0.,1.));\n#else\nposition.xy=position_snap;\n#endif\n}"),ra.replaceBlock("utils","#ifndef UTILS\n#define UTILS\nbool isLocalSpacePixelOutsideTile(vec4 pixel_local_space_position,float tile_scale){return pixel_local_space_position.x<0.||pixel_local_space_position.x>=tile_scale||pixel_local_space_position.y>0.||pixel_local_space_position.y<=-tile_scale;}\n#endif\n"),ra.replaceBlock("setup","\n#if defined(TANGRAM_FEATURE_SELECTION) && defined(TANGRAM_VERTEX_SHADER)\nif(a_selection_color.rgb==vec3(0.)||a_selection_color==u_selection_discard0||a_selection_color==u_selection_discard1||a_selection_color==u_selection_discard2||a_selection_color==u_selection_discard3||a_selection_color==u_selection_discard4||a_selection_color==u_selection_discard5||a_selection_color==u_selection_discard6||a_selection_color==u_selection_discard7||a_selection_color==u_selection_discard8||a_selection_color==u_selection_discard9){gl_Position=vec4(0.,0.,0.,1.);return;}v_selection_color=a_selection_color;\n#endif\n"),ra.defines.TANGRAM_EPSILON=1e-5,ra.defines.TANGRAM_LAYER_DELTA=1/16384,ra.defines.TANGRAM_TILE_SCALE="vec3(".concat(Qn.tile_scale,"., ").concat(Qn.tile_scale,"., u_meters_per_pixel * ").concat(Qn.tile_size,".)"),ra.defines.TANGRAM_HEIGHT_SCALE=Qn.height_scale,ra.defines.TANGRAM_ALPHA_TEST=.1,tc.dash_textures={}}},{key:"destroy",value:function(t){var e=this;Object.keys(this.styles).forEach(function(r){var n=e.styles[r];n.gl===t&&(Ei("trace","StyleManager.destroy: destroying render style ".concat(n.name)),n.base&&e.remove(n.name),n.destroy())})}},{key:"register",value:function(t){this.styles[t.name]=t,this.base_styles[t.name]=t}},{key:"remove",value:function(t){delete this.styles[t]}},{key:"mix",value:function(t,e){if(t.mixed)return t;t.mixed={};var r=[];t.mix&&(Array.isArray(t.mix)?r.push.apply(r,Rn(t.mix)):r.push(t.mix),(r=r.map(function(t){return e[t]}).filter(function(e){return e&&e!==t})).forEach(function(e){return t.mixed[e.name]=!0})),r.push(t),t.animated=r.some(function(t){return t&&t.animated}),t.texcoords=r.some(function(t){return t&&t.texcoords}),t.base=r.map(function(t){return t.base}).filter(function(t){return t}).pop(),t.lighting=r.map(function(t){return t.lighting}).filter(function(t){return null!=t}).pop(),t.texture=r.map(function(t){return t.texture}).filter(function(t){return t}).pop(),t.raster=r.map(function(t){return t.raster}).filter(function(t){return null!=t}).pop(),t.dash=r.map(function(t){return t.dash}).filter(function(t){return null!=t}).pop(),t.dash_background_color=r.map(function(t){return t.dash_background_color}).filter(function(t){return null!=t}).pop(),r.some(function(t){return t.hasOwnProperty("blend")&&t.blend})&&(t.blend=r.map(function(t){return t.hasOwnProperty("blend")&&t.blend}).filter(function(t){return t}).pop()),t.blend_order=r.map(function(t){return t.blend_order}).filter(function(t){return null!=t}).pop(),t.defines=Object.assign.apply(Object,[{}].concat(Rn(r.map(function(t){return t.defines}).filter(function(t){return t})))),t.material=Object.assign.apply(Object,[{}].concat(Rn(r.map(function(t){return t.material}).filter(function(t){return t}))));var n=r.map(function(t){return t.draw}).filter(function(t){return t});return 0<n.length&&(t.draw=da.apply(void 0,[{}].concat(Rn(n)))),this.mixShaders(t,e,r),t}},{key:"mixShaders",value:function(t,e,r){var n={},i=r.map(function(t){return t.shaders}).filter(function(t){return t});if(n.defines=Object.assign.apply(Object,[{}].concat(Rn(i.map(function(t){return t.defines}).filter(function(t){return t})))),n.uniforms={},n._uniforms=t.shaders&&t.shaders.uniforms||{},n._uniform_scopes={},r.filter(function(t){return t.shaders&&t.shaders.uniforms}).forEach(function(t){for(var r in t.shaders.uniforms)!function(r){n._uniform_scopes[r]=t.name,Object.defineProperty(n.uniforms,r,{enumerable:!0,configurable:!0,get:function(){return void 0!==n._uniforms[r]?n._uniforms[r]:e[n._uniform_scopes[r]].shaders.uniforms!==n.uniforms?e[n._uniform_scopes[r]].shaders.uniforms[r]:void 0},set:function(t){n._uniforms[r]=t}})}(r)}),n.extensions=Object.keys(i.map(function(t){return t.extensions}).filter(function(t){return t}).reduce(function(t,e){return"string"==typeof e?t[e]=!0:e.forEach(function(e){return t[e]=!0}),t},{})||{}),t.shaders&&t.shaders.blocks)for(var o in t.shaders.block_scopes=t.shaders.block_scopes||{},t.shaders.blocks){var a,s=t.shaders.blocks[o];t.shaders.block_scopes[o]=t.shaders.block_scopes[o]||[],Array.isArray(s)?(a=t.shaders.block_scopes[o]).push.apply(a,Rn(s.map(function(){return t.name}))):t.shaders.block_scopes[o].push(t.name)}var u={};return i.forEach(function(t){if(t.blocks){n.blocks=n.blocks||{},n.block_scopes=n.block_scopes||{};var e={};for(var r in t.blocks){var i=t.blocks[r],o=t.block_scopes[r];n.blocks[r]=n.blocks[r]||[],n.block_scopes[r]=n.block_scopes[r]||[],i=Array.isArray(i)?i:[i],o=Array.isArray(o)?o:[o];for(var a=0;a<i.length;a++)u[o[a]]||(e[o[a]]=!0,n.blocks[r].push(i[a]),n.block_scopes[r].push(o[a]))}Object.assign(u,e)}}),Object.assign(t.mixed,u),t.shaders=n,t}},{key:"create",value:function(t,e,r){var n=2<arguments.length&&void 0!==r?r:{},i=da({},e);return i.name=t,(i=this.mix(i,n)).base&&this.base_styles[i.base]?this.styles[t]=i=Object.assign(Object.create(this.base_styles[i.base]),i):i.base=null,i}},{key:"build",value:function(t){var e=this,r=Object.keys(t).sort(function(r,n){return e.inheritanceDepth(r,t)-e.inheritanceDepth(n,t)});for(var n in this.styles)this.base_styles[n]?this.styles[n].reset():delete this.styles[n];var i={};return r.forEach(function(r){i[r]=e.create(r,t[r],i)}),this.styles}},{key:"initStyles",value:function(t){var e=0<arguments.length&&void 0!==t?t:{};for(var r in this.styles)this.styles[r].init(e)}},{key:"inheritanceDepth",value:function(t,e){for(var r=this,n=0;;){var i=e[t];if(!i)break;if(!i.mix)break;if(n++,Array.isArray(i.mix)){n+=Math.max.apply(Math,Rn(i.mix.map(function(n){if(t!==n)return r.inheritanceDepth(n,e)})));break}if(t===i.mix)break;t=i.mix}return n}}]),t}();function jh(t){return null==t}var Dh={isNothing:jh,isObject:function(t){return"object"==typeof t&&null!==t},toArray:function(t){return Array.isArray(t)?t:jh(t)?[]:[t]},repeat:function(t,e){for(var r="",n=0;n<e;n+=1)r+=t;return r},isNegativeZero:function(t){return 0===t&&Number.NEGATIVE_INFINITY===1/t},extend:function(t,e){var r,n,i,o;if(e)for(r=0,n=(o=Object.keys(e)).length;r<n;r+=1)t[i=o[r]]=e[i];return t}};function zh(t,e){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||"",this.name="YAMLException",this.reason=t,this.mark=e,this.message=(this.reason||"(unknown reason)")+(this.mark?" "+this.mark.toString():"")}((zh.prototype=Object.create(Error.prototype)).constructor=zh).prototype.toString=function(t){var e=this.name+": ";return e+=this.reason||"(unknown reason)",!t&&this.mark&&(e+=" "+this.mark.toString()),e};var Hh=zh;function Fh(t,e,r,n,i){this.name=t,this.buffer=e,this.position=r,this.line=n,this.column=i}Fh.prototype.getSnippet=function(t,e){var r,n,i,o,a;if(!this.buffer)return null;for(t=t||4,e=e||75,r="",n=this.position;0<n&&-1==="\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(n-1));)if(--n,this.position-n>e/2-1){r=" ... ",n+=5;break}for(i="",o=this.position;o<this.buffer.length&&-1==="\0\r\n\u2028\u2029".indexOf(this.buffer.charAt(o));)if((o+=1)-this.position>e/2-1){i=" ... ",o-=5;break}return a=this.buffer.slice(n,o),Dh.repeat(" ",t)+r+a+i+"\n"+Dh.repeat(" ",t+this.position-n+r.length)+"^"},Fh.prototype.toString=function(t){var e,r="";return this.name&&(r+='in "'+this.name+'" '),r+="at line "+(this.line+1)+", column "+(this.column+1),t||(e=this.getSnippet())&&(r+=":\n"+e),r};var Bh=Fh,Uh=["kind","resolve","construct","instanceOf","predicate","represent","defaultStyle","styleAliases"],Gh=["scalar","sequence","mapping"],qh=function(t,e){var r,n;if(e=e||{},Object.keys(e).forEach(function(e){if(-1===Uh.indexOf(e))throw new Hh('Unknown option "'+e+'" is met in definition of "'+t+'" YAML type.')}),this.tag=t,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(t){return t},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.defaultStyle=e.defaultStyle||null,this.styleAliases=(r=e.styleAliases||null,n={},null!==r&&Object.keys(r).forEach(function(t){r[t].forEach(function(e){n[String(e)]=t})}),n),-1===Gh.indexOf(this.kind))throw new Hh('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')};function Vh(t,e,r){var n=[];return t.include.forEach(function(t){r=Vh(t,e,r)}),t[e].forEach(function(t){r.forEach(function(e,r){e.tag===t.tag&&n.push(r)}),r.push(t)}),r.filter(function(t,e){return-1===n.indexOf(e)})}function Wh(t){this.include=t.include||[],this.implicit=t.implicit||[],this.explicit=t.explicit||[],this.implicit.forEach(function(t){if(t.loadKind&&"scalar"!==t.loadKind)throw new Hh("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.")}),this.compiledImplicit=Vh(this,"implicit",[]),this.compiledExplicit=Vh(this,"explicit",[]),this.compiledTypeMap=function(){var t,e,r={};function n(t){r[t.tag]=t}for(t=0,e=arguments.length;t<e;t+=1)arguments[t].forEach(n);return r}(this.compiledImplicit,this.compiledExplicit)}Wh.DEFAULT=null,Wh.create=function(t,e){var r,n;switch(arguments.length){case 1:r=Wh.DEFAULT,n=t;break;case 2:r=t,n=e;break;default:throw new Hh("Wrong number of arguments for Schema.create function")}if(r=Dh.toArray(r),n=Dh.toArray(n),!r.every(function(t){return t instanceof Wh}))throw new Hh("Specified list of super schemas (or a single Schema object) contains a non-Schema object.");if(!n.every(function(t){return t instanceof qh}))throw new Hh("Specified list of YAML types (or a single Type object) contains a non-Type object.");return new Wh({include:r,explicit:n})};var Yh=Wh,Kh=new Yh({explicit:[new qh("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return null!==t?t:""}}),new qh("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return null!==t?t:[]}}),new qh("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return null!==t?t:{}}})]}),Xh=new qh("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(t){if(null===t)return!0;var e=t.length;return 1===e&&"~"===t||4===e&&("null"===t||"Null"===t||"NULL"===t)},construct:function(){return null},predicate:function(t){return null===t},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"}},defaultStyle:"lowercase"}),Zh=new qh("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(t){if(null===t)return!1;var e=t.length;return 4===e&&("true"===t||"True"===t||"TRUE"===t)||5===e&&("false"===t||"False"===t||"FALSE"===t)},construct:function(t){return"true"===t||"True"===t||"TRUE"===t},predicate:function(t){return"[object Boolean]"===Object.prototype.toString.call(t)},represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"}),$h=new qh("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(t){if(null===t)return!1;var e,r,n,i,o=t.length,a=0,s=!1;if(!o)return!1;if("-"!==(e=t[a])&&"+"!==e||(e=t[++a]),"0"===e){if(a+1===o)return!0;if("b"===(e=t[++a])){for(a++;a<o;a++)if("_"!==(e=t[a])){if("0"!==e&&"1"!==e)return!1;s=!0}return s}if("x"===e){for(a++;a<o;a++)if("_"!==(e=t[a])){if(!(48<=(n=t.charCodeAt(a))&&n<=57||65<=n&&n<=70||97<=n&&n<=102))return!1;s=!0}return s}for(;a<o;a++)if("_"!==(e=t[a])){if(!(48<=(r=t.charCodeAt(a))&&r<=55))return!1;s=!0}return s}for(;a<o;a++)if("_"!==(e=t[a])){if(":"===e)break;if(!(48<=(i=t.charCodeAt(a))&&i<=57))return!1;s=!0}return!!s&&(":"!==e||/^(:[0-5]?[0-9])+$/.test(t.slice(a)))},construct:function(t){var e,r,n=t,i=1,o=[];return-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(e=n[0])&&"+"!==e||("-"===e&&(i=-1),e=(n=n.slice(1))[0]),"0"===n?0:"0"===e?"b"===n[1]?i*parseInt(n.slice(2),2):"x"===n[1]?i*parseInt(n,16):i*parseInt(n,8):-1!==n.indexOf(":")?(n.split(":").forEach(function(t){o.unshift(parseInt(t,10))}),n=0,r=1,o.forEach(function(t){n+=t*r,r*=60}),i*n):i*parseInt(n,10)},predicate:function(t){return"[object Number]"===Object.prototype.toString.call(t)&&t%1==0&&!Dh.isNegativeZero(t)},represent:{binary:function(t){return"0b"+t.toString(2)},octal:function(t){return"0"+t.toString(8)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return"0x"+t.toString(16).toUpperCase()}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),Jh=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)\\.[0-9_]*(?:[eE][-+][0-9]+)?|\\.[0-9_]+(?:[eE][-+][0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\.[0-9_]*|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),Qh=/^[-+]?[0-9]+e/,tf=new Yh({include:[Kh],implicit:[Xh,Zh,$h,new qh("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(t){return null!==t&&!!Jh.test(t)},construct:function(t){var e,r=t.replace(/_/g,"").toLowerCase(),n="-"===r[0]?-1:1,i=[];return 0<="+-".indexOf(r[0])&&(r=r.slice(1)),".inf"===r?1==n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===r?NaN:0<=r.indexOf(":")?(r.split(":").forEach(function(t){i.unshift(parseFloat(t,10))}),r=0,e=1,i.forEach(function(t){r+=t*e,e*=60}),n*r):n*parseFloat(r,10)},predicate:function(t){return"[object Number]"===Object.prototype.toString.call(t)&&(t%1!=0||Dh.isNegativeZero(t))},represent:function(t,e){var r;if(isNaN(t))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Dh.isNegativeZero(t))return"-0.0";return r=t.toString(10),Qh.test(r)?r.replace("e",".e"):r},defaultStyle:"lowercase"})]}),ef=new Yh({include:[tf]}),rf=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?)?$"),nf=new qh("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(t){return null!==t&&null!==rf.exec(t)},construct:function(t){var e,r,n,i,o,a,s,u=0,l=null,c=rf.exec(t);if(null===c)throw new Error("Date resolve error");if(e=+c[1],r=c[2]-1,n=+c[3],!c[4])return new Date(Date.UTC(e,r,n));if(i=+c[4],o=+c[5],a=+c[6],c[7]){for(u=c[7].slice(0,3);u.length<3;)u+="0";u=+u}return c[9]&&(l=6e4*(60*+c[10]+ +(c[11]||0)),"-"===c[9]&&(l=-l)),s=new Date(Date.UTC(e,r,n,i,o,a,u)),l&&s.setTime(s.getTime()-l),s},instanceOf:Date,represent:function(t){return t.toISOString()}}),of=new qh("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(t){return"<<"===t||null===t}}),af=zs.Buffer,sf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",uf=new qh("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(t){if(null===t)return!1;for(var e,r=0,n=t.length,i=sf,o=0;o<n;o++)if(!(64<(e=i.indexOf(t.charAt(o))))){if(e<0)return!1;r+=6}return r%8==0},construct:function(t){for(var e,r=t.replace(/[\r\n=]/g,""),n=r.length,i=sf,o=0,a=[],s=0;s<n;s++)s%4==0&&s&&(a.push(o>>16&255),a.push(o>>8&255),a.push(255&o)),o=o<<6|i.indexOf(r.charAt(s));return 0==(e=n%4*6)?(a.push(o>>16&255),a.push(o>>8&255),a.push(255&o)):18==e?(a.push(o>>10&255),a.push(o>>2&255)):12==e&&a.push(o>>4&255),af?new af(a):a},predicate:function(t){return af&&af.isBuffer(t)},represent:function(t){for(var e,r="",n=0,i=t.length,o=sf,a=0;a<i;a++)a%3==0&&a&&(r+=o[n>>18&63],r+=o[n>>12&63],r+=o[n>>6&63],r+=o[63&n]),n=(n<<8)+t[a];return 0==(e=i%3)?(r+=o[n>>18&63],r+=o[n>>12&63],r+=o[n>>6&63],r+=o[63&n]):2==e?(r+=o[n>>10&63],r+=o[n>>4&63],r+=o[n<<2&63],r+=o[64]):1==e&&(r+=o[n>>2&63],r+=o[n<<4&63],r+=o[64],r+=o[64]),r}}),lf=Object.prototype.hasOwnProperty,cf=Object.prototype.toString,hf=new qh("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(t){if(null===t)return!0;for(var e,r,n,i=[],o=t,a=0,s=o.length;a<s;a+=1){if(e=o[a],n=!1,"[object Object]"!==cf.call(e))return!1;for(r in e)if(lf.call(e,r)){if(n)return!1;n=!0}if(!n)return!1;if(-1!==i.indexOf(r))return!1;i.push(r)}return!0},construct:function(t){return null!==t?t:[]}}),ff=Object.prototype.toString,pf=new qh("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(t){if(null===t)return!0;for(var e,r,n=t,i=new Array(n.length),o=0,a=n.length;o<a;o+=1){if(e=n[o],"[object Object]"!==ff.call(e))return!1;if(1!==(r=Object.keys(e)).length)return!1;i[o]=[r[0],e[r[0]]]}return!0},construct:function(t){if(null===t)return[];for(var e,r,n=t,i=new Array(n.length),o=0,a=n.length;o<a;o+=1)e=n[o],r=Object.keys(e),i[o]=[r[0],e[r[0]]];return i}}),df=Object.prototype.hasOwnProperty,vf=new Yh({include:[ef],implicit:[nf,of],explicit:[uf,hf,pf,new qh("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(t){if(null===t)return!0;var e,r=t;for(e in r)if(df.call(r,e)&&null!==r[e])return!1;return!0},construct:function(t){return null!==t?t:{}}})]}),yf=new qh("tag:yaml.org,2002:js/undefined",{kind:"scalar",resolve:function(){return!0},construct:function(){},predicate:function(t){return void 0===t},represent:function(){return""}}),gf=new qh("tag:yaml.org,2002:js/regexp",{kind:"scalar",resolve:function(t){if(null===t)return!1;if(0===t.length)return!1;var e=t,r=/\/([gim]*)$/.exec(t),n="";if("/"===e[0]){if(r&&(n=r[1]),3<n.length)return!1;if("/"!==e[e.length-n.length-1])return!1}return!0},construct:function(t){var e=t,r=/\/([gim]*)$/.exec(t),n="";return"/"===e[0]&&(r&&(n=r[1]),e=e.slice(1,e.length-n.length-1)),new RegExp(e,n)},predicate:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},represent:function(t){var e="/"+t.source+"/";return t.global&&(e+="g"),t.multiline&&(e+="m"),t.ignoreCase&&(e+="i"),e}});try{var mf=function(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}()}catch(o){"undefined"!=typeof window&&(mf=window.esprima)}var _f=new qh("tag:yaml.org,2002:js/function",{kind:"scalar",resolve:function(t){if(null===t)return!1;try{var e="("+t+")",r=mf.parse(e,{range:!0});return"Program"===r.type&&1===r.body.length&&"ExpressionStatement"===r.body[0].type&&"FunctionExpression"===r.body[0].expression.type}catch(t){return!1}},construct:function(t){var e,r="("+t+")",n=mf.parse(r,{range:!0}),i=[];if("Program"!==n.type||1!==n.body.length||"ExpressionStatement"!==n.body[0].type||"FunctionExpression"!==n.body[0].expression.type)throw new Error("Failed to resolve function");return n.body[0].expression.params.forEach(function(t){i.push(t.name)}),e=n.body[0].expression.body.range,new Function(i,r.slice(e[0]+1,e[1]-1))},predicate:function(t){return"[object Function]"===Object.prototype.toString.call(t)},represent:function(t){return t.toString()}}),bf=Yh.DEFAULT=new Yh({include:[vf],explicit:[yf,gf,_f]}),xf=Object.prototype.hasOwnProperty,wf=1,Ef=2,Tf=3,Af=4,kf=1,Sf=2,Mf=3,Of=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,If=/[\x85\u2028\u2029]/,Lf=/[,\[\]\{\}]/,Cf=/^(?:!|!!|![a-z\-]+!)$/i,Rf=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Pf(t){return 10===t||13===t}function Nf(t){return 9===t||32===t}function jf(t){return 9===t||32===t||10===t||13===t}function Df(t){return 44===t||91===t||93===t||123===t||125===t}function zf(t){return 48===t?"\0":97===t?"":98===t?"\b":116===t||9===t?"\t":110===t?"\n":118===t?"\v":102===t?"\f":114===t?"\r":101===t?"":32===t?" ":34===t?'"':47===t?"/":92===t?"\\":78===t?"":95===t?" ":76===t?"\u2028":80===t?"\u2029":""}for(var Hf=new Array(256),Ff=new Array(256),Bf=0;Bf<256;Bf++)Hf[Bf]=zf(Bf)?1:0,Ff[Bf]=zf(Bf);function Uf(t,e){return new Hh(e,new Bh(t.filename,t.input,t.position,t.line,t.position-t.lineStart))}function Gf(t,e){throw Uf(t,e)}function qf(t,e){t.onWarning&&t.onWarning.call(null,Uf(t,e))}var Vf={YAML:function(t,e,r){var n,i,o;null!==t.version&&Gf(t,"duplication of %YAML directive"),1!==r.length&&Gf(t,"YAML directive accepts exactly one argument"),null===(n=/^([0-9]+)\.([0-9]+)$/.exec(r[0]))&&Gf(t,"ill-formed argument of the YAML directive"),i=parseInt(n[1],10),o=parseInt(n[2],10),1!==i&&Gf(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=o<2,1!==o&&2!==o&&qf(t,"unsupported YAML version of the document")},TAG:function(t,e,r){var n,i;2!==r.length&&Gf(t,"TAG directive accepts exactly two arguments"),n=r[0],i=r[1],Cf.test(n)||Gf(t,"ill-formed tag handle (first argument) of the TAG directive"),xf.call(t.tagMap,n)&&Gf(t,'there is a previously declared suffix for "'+n+'" tag handle'),Rf.test(i)||Gf(t,"ill-formed tag prefix (second argument) of the TAG directive"),t.tagMap[n]=i}};function Wf(t,e,r,n){var i,o,a,s;if(e<r){if(s=t.input.slice(e,r),n)for(i=0,o=s.length;i<o;i+=1)9===(a=s.charCodeAt(i))||32<=a&&a<=1114111||Gf(t,"expected valid JSON character");else Of.test(s)&&Gf(t,"the stream contains non-printable characters");t.result+=s}}function Yf(t,e,r,n){var i,o,a,s;for(Dh.isObject(r)||Gf(t,"cannot merge mappings; the provided source object is unacceptable"),a=0,s=(i=Object.keys(r)).length;a<s;a+=1)o=i[a],xf.call(e,o)||(e[o]=r[o],n[o]=!0)}function Kf(t,e,r,n,i,o){var a,s;if(i=String(i),null===e&&(e={}),"tag:yaml.org,2002:merge"===n)if(Array.isArray(o))for(a=0,s=o.length;a<s;a+=1)Yf(t,e,o[a],r);else Yf(t,e,o,r);else t.json||xf.call(r,i)||!xf.call(e,i)||Gf(t,"duplicated mapping key"),e[i]=o,delete r[i];return e}function Xf(t){var e=t.input.charCodeAt(t.position);10===e?t.position++:13===e?(t.position++,10===t.input.charCodeAt(t.position)&&t.position++):Gf(t,"a line break is expected"),t.line+=1,t.lineStart=t.position}function Zf(t,e,r){for(var n=0,i=t.input.charCodeAt(t.position);0!==i;){for(;Nf(i);)i=t.input.charCodeAt(++t.position);if(e&&35===i)for(;10!==(i=t.input.charCodeAt(++t.position))&&13!==i&&0!==i;);if(!Pf(i))break;for(Xf(t),i=t.input.charCodeAt(t.position),n++,t.lineIndent=0;32===i;)t.lineIndent++,i=t.input.charCodeAt(++t.position)}return-1!==r&&0!==n&&t.lineIndent<r&&qf(t,"deficient indentation"),n}function $f(t){var e=t.position,r=t.input.charCodeAt(e);return 45!==r&&46!==r||r!==t.input.charCodeAt(e+1)||r!==t.input.charCodeAt(e+2)||(e+=3,0!==(r=t.input.charCodeAt(e))&&!jf(r))?void 0:1}function Jf(t,e){1===e?t.result+=" ":1<e&&(t.result+=Dh.repeat("\n",e-1))}function Qf(t,e){var r,n,i=t.tag,o=t.anchor,a=[],s=!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=a),n=t.input.charCodeAt(t.position);0!==n&&45===n&&jf(t.input.charCodeAt(t.position+1));)if(s=!0,t.position++,Zf(t,!0,-1)&&t.lineIndent<=e)a.push(null),n=t.input.charCodeAt(t.position);else if(r=t.line,tp(t,e,Tf,!1,!0),a.push(t.result),Zf(t,!0,-1),n=t.input.charCodeAt(t.position),(t.line===r||t.lineIndent>e)&&0!==n)Gf(t,"bad indentation of a sequence entry");else if(t.lineIndent<e)break;return!!s&&(t.tag=i,t.anchor=o,t.kind="sequence",t.result=a,!0)}function tp(t,e,r,n,i){var o,a,s,u,l,c,h,f,p=1,d=!1,v=!1;if(null!==t.listener&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,o=a=s=Af===r||Tf===r,n&&Zf(t,!0,-1)&&(d=!0,t.lineIndent>e?p=1:t.lineIndent===e?p=0:t.lineIndent<e&&(p=-1)),1===p)for(;function(t){var e,r,n,i=!1,o=!1,a=t.input.charCodeAt(t.position);if(33===a){if(null!==t.tag&&Gf(t,"duplication of a tag property"),60===(a=t.input.charCodeAt(++t.position))?(i=!0,a=t.input.charCodeAt(++t.position)):33===a?(o=!0,r="!!",a=t.input.charCodeAt(++t.position)):r="!",e=t.position,i){for(;0!==(a=t.input.charCodeAt(++t.position))&&62!==a;);t.position<t.length?(n=t.input.slice(e,t.position),a=t.input.charCodeAt(++t.position)):Gf(t,"unexpected end of the stream within a verbatim tag")}else{for(;0!==a&&!jf(a);)33===a&&(o?Gf(t,"tag suffix cannot contain exclamation marks"):(r=t.input.slice(e-1,t.position+1),Cf.test(r)||Gf(t,"named tag handle cannot contain such characters"),o=!0,e=t.position+1)),a=t.input.charCodeAt(++t.position);n=t.input.slice(e,t.position),Lf.test(n)&&Gf(t,"tag suffix cannot contain flow indicator characters")}return n&&!Rf.test(n)&&Gf(t,"tag name cannot contain such characters: "+n),i?t.tag=n:xf.call(t.tagMap,r)?t.tag=t.tagMap[r]+n:"!"===r?t.tag="!"+n:"!!"===r?t.tag="tag:yaml.org,2002:"+n:Gf(t,'undeclared tag handle "'+r+'"'),1}}(t)||function(t){var e,r=t.input.charCodeAt(t.position);if(38===r){for(null!==t.anchor&&Gf(t,"duplication of an anchor property"),r=t.input.charCodeAt(++t.position),e=t.position;0!==r&&!jf(r)&&!Df(r);)r=t.input.charCodeAt(++t.position);return t.position===e&&Gf(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(e,t.position),1}}(t);)Zf(t,!0,-1)?(d=!0,s=o,t.lineIndent>e?p=1:t.lineIndent===e?p=0:t.lineIndent<e&&(p=-1)):s=!1;if(s=s&&(d||i),1!==p&&Af!==r||(h=wf===r||Ef===r?e:e+1,f=t.position-t.lineStart,1===p?s&&(Qf(t,f)||function(t,e,r){var n,i,o,a,s=t.tag,u=t.anchor,l={},c={},h=null,f=null,p=null,d=!1,v=!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=l),a=t.input.charCodeAt(t.position);0!==a;){if(n=t.input.charCodeAt(t.position+1),o=t.line,63!==a&&58!==a||!jf(n)){if(!tp(t,r,Ef,!1,!0))break;if(t.line===o){for(a=t.input.charCodeAt(t.position);Nf(a);)a=t.input.charCodeAt(++t.position);if(58===a)jf(a=t.input.charCodeAt(++t.position))||Gf(t,"a whitespace character is expected after the key-value separator within a block mapping"),d&&(Kf(t,l,c,h,f,null),h=f=p=null),i=d=!(v=!0),h=t.tag,f=t.result;else{if(!v)return t.tag=s,t.anchor=u,1;Gf(t,"can not read an implicit mapping pair; a colon is missed")}}else{if(!v)return t.tag=s,t.anchor=u,1;Gf(t,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===a?(d&&(Kf(t,l,c,h,f,null),h=f=p=null),i=d=v=!0):d?i=!(d=!1):Gf(t,"incomplete explicit mapping pair; a key node is missed"),t.position+=1,a=n;if((t.line===o||t.lineIndent>e)&&(tp(t,e,Af,!0,i)&&(d?f=t.result:p=t.result),d||(Kf(t,l,c,h,f,p),h=f=p=null),Zf(t,!0,-1),a=t.input.charCodeAt(t.position)),t.lineIndent>e&&0!==a)Gf(t,"bad indentation of a mapping entry");else if(t.lineIndent<e)break}return d&&Kf(t,l,c,h,f,null),v&&(t.tag=s,t.anchor=u,t.kind="mapping",t.result=l),v}(t,f,h))||function(t,e){var r,n,i,o,a,s,u,l,c,h=!0,f=t.tag,p=t.anchor,d={},v=t.input.charCodeAt(t.position);if(91===v)s=!(i=93),n=[];else{if(123!==v)return;i=125,s=!0,n={}}for(null!==t.anchor&&(t.anchorMap[t.anchor]=n),v=t.input.charCodeAt(++t.position);0!==v;){if(Zf(t,!0,e),(v=t.input.charCodeAt(t.position))===i)return t.position++,t.tag=f,t.anchor=p,t.kind=s?"mapping":"sequence",t.result=n,1;h||Gf(t,"missed comma between flow collection entries"),c=null,o=a=!1,63===v&&jf(t.input.charCodeAt(t.position+1))&&(o=a=!0,t.position++,Zf(t,!0,e)),r=t.line,tp(t,e,wf,!1,!0),l=t.tag,u=t.result,Zf(t,!0,e),v=t.input.charCodeAt(t.position),!a&&t.line!==r||58!==v||(o=!0,v=t.input.charCodeAt(++t.position),Zf(t,!0,e),tp(t,e,wf,!1,!0),c=t.result),s?Kf(t,n,d,l,u,c):o?n.push(Kf(t,null,d,l,u,c)):n.push(u),Zf(t,!0,e),44===(v=t.input.charCodeAt(t.position))?(h=!0,v=t.input.charCodeAt(++t.position)):h=!1}Gf(t,"unexpected end of the stream within a flow collection")}(t,h)?v=!0:(a&&function(t,e){var r,n,i,o,a=kf,s=!1,u=e,l=0,c=!1,h=t.input.charCodeAt(t.position);if(124===h)n=!1;else{if(62!==h)return;n=!0}for(t.kind="scalar",t.result="";0!==h;)if(43===(h=t.input.charCodeAt(++t.position))||45===h)kf===a?a=43===h?Mf:Sf:Gf(t,"repeat of a chomping mode identifier");else{if(!(0<=(i=48<=(o=h)&&o<=57?o-48:-1)))break;0==i?Gf(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?Gf(t,"repeat of an indentation width identifier"):(u=e+i-1,s=!0)}if(Nf(h)){for(;Nf(h=t.input.charCodeAt(++t.position)););if(35===h)for(;!Pf(h=t.input.charCodeAt(++t.position))&&0!==h;);}for(;0!==h;){for(Xf(t),t.lineIndent=0,h=t.input.charCodeAt(t.position);(!s||t.lineIndent<u)&&32===h;)t.lineIndent++,h=t.input.charCodeAt(++t.position);if(!s&&t.lineIndent>u&&(u=t.lineIndent),Pf(h))l++;else{if(t.lineIndent<u){a===Mf?t.result+=Dh.repeat("\n",l):a===kf&&s&&(t.result+="\n");break}for(n?Nf(h)?(c=!0,t.result+=Dh.repeat("\n",l+1)):c?(c=!1,t.result+=Dh.repeat("\n",l+1)):0===l?s&&(t.result+=" "):t.result+=Dh.repeat("\n",l):t.result+=s?Dh.repeat("\n",l+1):Dh.repeat("\n",l),s=!0,l=0,r=t.position;!Pf(h)&&0!==h;)h=t.input.charCodeAt(++t.position);Wf(t,r,t.position,!1)}}return 1}(t,h)||function(t,e){var r,n,i=t.input.charCodeAt(t.position);if(39===i){for(t.kind="scalar",t.result="",t.position++,r=n=t.position;0!==(i=t.input.charCodeAt(t.position));)if(39===i){if(Wf(t,r,t.position,!0),39!==(i=t.input.charCodeAt(++t.position)))return 1;r=n=t.position,t.position++}else Pf(i)?(Wf(t,r,n,!0),Jf(t,Zf(t,!1,e)),r=n=t.position):t.position===t.lineStart&&$f(t)?Gf(t,"unexpected end of the document within a single quoted scalar"):(t.position++,n=t.position);Gf(t,"unexpected end of the stream within a single quoted scalar")}}(t,h)||function(t,e){var r,n,i,o,a,s,u,l,c,h=t.input.charCodeAt(t.position);if(34===h){for(t.kind="scalar",t.result="",t.position++,r=n=t.position;0!==(h=t.input.charCodeAt(t.position));){if(34===h)return Wf(t,r,t.position,!0),t.position++,1;if(92===h){if(Wf(t,r,t.position,!0),Pf(h=t.input.charCodeAt(++t.position)))Zf(t,!1,e);else if(h<256&&Hf[h])t.result+=Ff[h],t.position++;else if(0<(a=120===(c=h)?2:117===c?4:85===c?8:0)){for(i=a,o=0;0<i;i--)l=void 0,0<=(a=48<=(u=h=t.input.charCodeAt(++t.position))&&u<=57?u-48:97<=(l=32|u)&&l<=102?l-97+10:-1)?o=(o<<4)+a:Gf(t,"expected hexadecimal character");t.result+=(s=o)<=65535?String.fromCharCode(s):String.fromCharCode(55296+(s-65536>>10),56320+(s-65536&1023)),t.position++}else Gf(t,"unknown escape sequence");r=n=t.position}else Pf(h)?(Wf(t,r,n,!0),Jf(t,Zf(t,!1,e)),r=n=t.position):t.position===t.lineStart&&$f(t)?Gf(t,"unexpected end of the document within a double quoted scalar"):(t.position++,n=t.position)}Gf(t,"unexpected end of the stream within a double quoted scalar")}}(t,h)?v=!0:function(t){var e,r,n=t.input.charCodeAt(t.position);if(42===n){for(n=t.input.charCodeAt(++t.position),e=t.position;0!==n&&!jf(n)&&!Df(n);)n=t.input.charCodeAt(++t.position);return t.position===e&&Gf(t,"name of an alias node must contain at least one character"),r=t.input.slice(e,t.position),t.anchorMap.hasOwnProperty(r)||Gf(t,'unidentified alias "'+r+'"'),t.result=t.anchorMap[r],Zf(t,!0,-1),1}}(t)?(v=!0,null===t.tag&&null===t.anchor||Gf(t,"alias node should not have any properties")):function(t,e,r){var n,i,o,a,s,u,l,c=t.kind,h=t.result,f=t.input.charCodeAt(t.position);if(!jf(f)&&!Df(f)&&35!==f&&38!==f&&42!==f&&33!==f&&124!==f&&62!==f&&39!==f&&34!==f&&37!==f&&64!==f&&96!==f&&(63!==f&&45!==f||!(jf(n=t.input.charCodeAt(t.position+1))||r&&Df(n)))){for(t.kind="scalar",t.result="",i=o=t.position,a=!1;0!==f;){if(58===f){if(jf(n=t.input.charCodeAt(t.position+1))||r&&Df(n))break}else if(35===f){if(jf(t.input.charCodeAt(t.position-1)))break}else{if(t.position===t.lineStart&&$f(t)||r&&Df(f))break;if(Pf(f)){if(s=t.line,u=t.lineStart,l=t.lineIndent,Zf(t,!1,-1),t.lineIndent>=e){a=!0,f=t.input.charCodeAt(t.position);continue}t.position=o,t.line=s,t.lineStart=u,t.lineIndent=l;break}}a&&(Wf(t,i,o,!1),Jf(t,t.line-s),i=o=t.position,a=!1),Nf(f)||(o=t.position+1),f=t.input.charCodeAt(++t.position)}if(Wf(t,i,o,!1),t.result)return 1;t.kind=c,t.result=h}}(t,h,wf===r)&&(v=!0,null===t.tag&&(t.tag="?")),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):0===p&&(v=s&&Qf(t,f))),null!==t.tag&&"!"!==t.tag)if("?"===t.tag){for(u=0,l=t.implicitTypes.length;u<l;u+=1)if((c=t.implicitTypes[u]).resolve(t.result)){t.result=c.construct(t.result),t.tag=c.tag,null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);break}}else xf.call(t.typeMap,t.tag)?(c=t.typeMap[t.tag],null!==t.result&&c.kind!==t.kind&&Gf(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+c.kind+'", not "'+t.kind+'"'),c.resolve(t.result)?(t.result=c.construct(t.result),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):Gf(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")):Gf(t,"unknown tag !<"+t.tag+">");return null!==t.listener&&t.listener("close",t),null!==t.tag||null!==t.anchor||v}function ep(t,e){e=e||{},0!==(t=String(t)).length&&(10!==t.charCodeAt(t.length-1)&&13!==t.charCodeAt(t.length-1)&&(t+="\n"),65279===t.charCodeAt(0)&&(t=t.slice(1)));var r=new function(t,e){this.input=t,this.filename=e.filename||null,this.schema=e.schema||bf,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.documents=[]}(t,e);for(r.input+="\0";32===r.input.charCodeAt(r.position);)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)!function(t){var e,r,n,i,o=t.position,a=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap={},t.anchorMap={};0!==(i=t.input.charCodeAt(t.position))&&(Zf(t,!0,-1),i=t.input.charCodeAt(t.position),!(0<t.lineIndent||37!==i));){for(a=!0,i=t.input.charCodeAt(++t.position),e=t.position;0!==i&&!jf(i);)i=t.input.charCodeAt(++t.position);for(n=[],(r=t.input.slice(e,t.position)).length<1&&Gf(t,"directive name must not be less than one character in length");0!==i;){for(;Nf(i);)i=t.input.charCodeAt(++t.position);if(35===i){for(;0!==(i=t.input.charCodeAt(++t.position))&&!Pf(i););break}if(Pf(i))break;for(e=t.position;0!==i&&!jf(i);)i=t.input.charCodeAt(++t.position);n.push(t.input.slice(e,t.position))}0!==i&&Xf(t),xf.call(Vf,r)?Vf[r](t,r,n):qf(t,'unknown document directive "'+r+'"')}Zf(t,!0,-1),0===t.lineIndent&&45===t.input.charCodeAt(t.position)&&45===t.input.charCodeAt(t.position+1)&&45===t.input.charCodeAt(t.position+2)?(t.position+=3,Zf(t,!0,-1)):a&&Gf(t,"directives end mark is expected"),tp(t,t.lineIndent-1,Af,!1,!0),Zf(t,!0,-1),t.checkLineBreaks&&If.test(t.input.slice(o,t.position))&&qf(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&$f(t)?46===t.input.charCodeAt(t.position)&&(t.position+=3,Zf(t,!0,-1)):t.position<t.length-1&&Gf(t,"end of the stream or a document separator is expected")}(r);return r.documents}function rp(t,e,r){for(var n=ep(t,r),i=0,o=n.length;i<o;i+=1)e(n[i])}function np(t,e){var r=ep(t,e);if(0!==r.length){if(1===r.length)return r[0];throw new Hh("expected a single document in the stream, but found more")}}var ip={loadAll:rp,load:np,safeLoadAll:function(t,e,r){rp(t,e,Dh.extend({schema:vf},r))},safeLoad:function(t,e){return np(t,Dh.extend({schema:vf},e))}},op=Object.prototype.toString,ap=Object.prototype.hasOwnProperty,sp=9,up=10,lp=13,cp=32,hp=33,fp=34,pp=35,dp=37,vp=38,yp=39,gp=42,mp=44,_p=45,bp=58,xp=62,wp=63,Ep=64,Tp=91,Ap=93,kp=96,Sp=123,Mp=124,Op=125,Ip={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},Lp=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"];function Cp(t,e){for(var r,n=Dh.repeat(" ",e),i=0,o=-1,a="",s=t.length;i<s;)i=-1===(o=t.indexOf("\n",i))?(r=t.slice(i),s):(r=t.slice(i,o+1),o+1),r.length&&"\n"!==r&&(a+=n),a+=r;return a}function Rp(t,e){return"\n"+Dh.repeat(" ",t.indent*e)}function Pp(t){this.source=t,this.result="",this.checkpoint=0}function Np(t,e){if(""===t)return t;for(var r,n,i=/[^\s] [^\s]/g,o="",a=0,s=0,u=i.exec(t);u;)e<(r=u.index)-s&&(n=a!==s?a:r,o&&(o+="\n"),o+=t.slice(s,n),s=n+1),a=r+1,u=i.exec(t);return o&&(o+="\n"),s!==a&&t.length-s>e?o+=t.slice(s,a)+"\n"+t.slice(a+1):o+=t.slice(s),o}function jp(t){return!(32<=t&&t<=126||133===t||160<=t&&t<=55295||57344<=t&&t<=65533||65536<=t&&t<=1114111)}function Dp(t,e,r){for(var n,i,o,a=r?t.explicitTypes:t.implicitTypes,s=0,u=a.length;s<u;s+=1)if(((i=a[s]).instanceOf||i.predicate)&&(!i.instanceOf||"object"==typeof e&&e instanceof i.instanceOf)&&(!i.predicate||i.predicate(e))){if(t.tag=r?i.tag:"?",i.represent){if(o=t.styleMap[i.tag]||i.defaultStyle,"[object Function]"===op.call(i.represent))n=i.represent(e,o);else{if(!ap.call(i.represent,o))throw new Hh("!<"+i.tag+'> tag resolver accepts not "'+o+'" style');n=i.represent[o](e,o)}t.dump=n}return 1}}function zp(t,e,r,n,i,o){t.tag=null,t.dump=r,Dp(t,r,!1)||Dp(t,r,!0);var a=op.call(t.dump);n=n&&(t.flowLevel<0||t.flowLevel>e);var s,u,l="[object Object]"===a||"[object Array]"===a;if(l&&(u=-1!==(s=t.duplicates.indexOf(r))),(null!==t.tag&&"?"!==t.tag||u||2!==t.indent&&0<e)&&(i=!1),u&&t.usedDuplicates[s])t.dump="*ref_"+s;else{if(l&&u&&!t.usedDuplicates[s]&&(t.usedDuplicates[s]=!0),"[object Object]"===a)n&&0!==Object.keys(t.dump).length?(function(t,e,r,n){var i,o,a,s,u,l,c="",h=t.tag,f=Object.keys(r);if(!0===t.sortKeys)f.sort();else if("function"==typeof t.sortKeys)f.sort(t.sortKeys);else if(t.sortKeys)throw new Hh("sortKeys must be a boolean or a function");for(i=0,o=f.length;i<o;i+=1)l="",n&&0===i||(l+=Rp(t,e)),s=r[a=f[i]],zp(t,e+1,a,!0,!0,!0)&&((u=null!==t.tag&&"?"!==t.tag||t.dump&&1024<t.dump.length)&&(t.dump&&up===t.dump.charCodeAt(0)?l+="?":l+="? "),l+=t.dump,u&&(l+=Rp(t,e)),zp(t,e+1,s,!0,u)&&(t.dump&&up===t.dump.charCodeAt(0)?l+=":":l+=": ",c+=l+=t.dump));t.tag=h,t.dump=c||"{}"}(t,e,t.dump,i),u&&(t.dump="&ref_"+s+t.dump)):(function(t,e,r){for(var n,i,o,a="",s=t.tag,u=Object.keys(r),l=0,c=u.length;l<c;l+=1)o="",0!==l&&(o+=", "),i=r[n=u[l]],zp(t,e,n,!1,!1)&&(1024<t.dump.length&&(o+="? "),o+=t.dump+": ",zp(t,e,i,!1,!1)&&(a+=o+=t.dump));t.tag=s,t.dump="{"+a+"}"}(t,e,t.dump),u&&(t.dump="&ref_"+s+" "+t.dump));else if("[object Array]"===a)n&&0!==t.dump.length?(function(t,e,r,n){for(var i="",o=t.tag,a=0,s=r.length;a<s;a+=1)zp(t,e+1,r[a],!0,!0)&&(n&&0===a||(i+=Rp(t,e)),i+="- "+t.dump);t.tag=o,t.dump=i||"[]"}(t,e,t.dump,i),u&&(t.dump="&ref_"+s+t.dump)):(function(t,e,r){for(var n="",i=t.tag,o=0,a=r.length;o<a;o+=1)zp(t,e,r[o],!1,!1)&&(0!==o&&(n+=", "),n+=t.dump);t.tag=i,t.dump="["+n+"]"}(t,e,t.dump),u&&(t.dump="&ref_"+s+" "+t.dump));else{if("[object String]"!==a){if(t.skipInvalid)return;throw new Hh("unacceptable kind of an object to dump "+a)}"?"!==t.tag&&function(t,e,r,n){var i,o,a,s,u,l,c,h,f,p,d,v,y,g,m,_,b,x,w,E,T;if(0!==e.length)if(-1===Lp.indexOf(e)){for(i=!0,o=e.length?e.charCodeAt(0):0,a=cp===o||cp===e.charCodeAt(e.length-1),_p!==o&&wp!==o&&Ep!==o&&kp!==o||(i=!1),u=s=a||-1<t.flowLevel&&t.flowLevel<=r?(a&&(i=!1),!1):!n,l=!0,c=new Pp(e),h=!1,p=f=0,d=t.indent*r,-1===(v=t.lineWidth)&&(v=9007199254740991),d<40?v-=d:v=40,g=0;g<e.length;g++){if(y=e.charCodeAt(g),i){if(sp!==(T=y)&&up!==T&&lp!==T&&mp!==T&&Tp!==T&&Ap!==T&&Sp!==T&&Op!==T&&pp!==T&&vp!==T&&gp!==T&&hp!==T&&Mp!==T&&xp!==T&&yp!==T&&fp!==T&&dp!==T&&bp!==T&&!Ip[T]&&!jp(T))continue;i=!1}l&&y===yp&&(l=!1),m=Ip[y],_=jp(y),(m||_)&&(y!==up&&y!==fp&&y!==yp?u=s=!1:y===up&&(l=!(h=!0),0<g&&e.charCodeAt(g-1)===cp&&(s=u=!1),s&&(b=g-f,f=g,p<b&&(p=b))),y!==fp&&(l=!1),c.takeUpTo(g),c.escapeChar())}if(i&&function(t,e){for(var r=0,n=t.implicitTypes.length;r<n;r+=1)if(t.implicitTypes[r].resolve(e))return 1}(t,e)&&(i=!1),x="",(s||u)&&(w=0,e.charCodeAt(e.length-1)===up&&(w+=1,e.charCodeAt(e.length-2)===up&&(w+=1)),0===w?x="-":2===w&&(x="+")),(u&&p<v||null!==t.tag)&&(s=!1),h||(u=!1),i)t.dump=e;else if(l)t.dump="'"+e+"'";else if(s)E=function(t,e){var r,n="",i=0,o=t.length,a=/\n+$/.exec(t);for(a&&(o=a.index+1);i<o;)i=o<(r=t.indexOf("\n",i))||-1===r?(n&&(n+="\n\n"),n+=Np(t.slice(i,o),e),o):(n&&(n+="\n\n"),n+=Np(t.slice(i,r),e),r+1);return a&&"\n"!==a[0]&&(n+=a[0]),n}(e,v),t.dump=">"+x+"\n"+Cp(E,d);else if(u)x||(e=e.replace(/\n$/,"")),t.dump="|"+x+"\n"+Cp(e,d);else{if(!c)throw new Error("Failed to dump scalar value");c.finish(),t.dump='"'+c.result+'"'}}else t.dump="'"+e+"'";else t.dump="''"}(t,t.dump,e,o)}null!==t.tag&&"?"!==t.tag&&(t.dump="!<"+t.tag+"> "+t.dump)}return 1}function Hp(t,e){var r=new function(t){this.schema=t.schema||bf,this.indent=Math.max(1,t.indent||2),this.skipInvalid=t.skipInvalid||!1,this.flowLevel=Dh.isNothing(t.flowLevel)?-1:t.flowLevel,this.styleMap=function(t,e){var r,n,i,o,a,s,u;if(null===e)return{};for(r={},i=0,o=(n=Object.keys(e)).length;i<o;i+=1)a=n[i],s=String(e[a]),"!!"===a.slice(0,2)&&(a="tag:yaml.org,2002:"+a.slice(2)),(u=t.compiledTypeMap[a])&&ap.call(u.styleAliases,s)&&(s=u.styleAliases[s]),r[a]=s;return r}(this.schema,t.styles||null),this.sortKeys=t.sortKeys||!1,this.lineWidth=t.lineWidth||80,this.noRefs=t.noRefs||!1,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}(e=e||{});return r.noRefs||function(t,e){var r,n,i=[],o=[];for(function t(e,r,n){var i,o,a;if(null!==e&&"object"==typeof e)if(-1!==(o=r.indexOf(e)))-1===n.indexOf(o)&&n.push(o);else if(r.push(e),Array.isArray(e))for(o=0,a=e.length;o<a;o+=1)t(e[o],r,n);else for(o=0,a=(i=Object.keys(e)).length;o<a;o+=1)t(e[i[o]],r,n)}(t,i,o),r=0,n=o.length;r<n;r+=1)e.duplicates.push(i[o[r]]);e.usedDuplicates=new Array(n)}(t,r),zp(r,0,t,!0,!0)?r.dump+"\n":""}Pp.prototype.takeUpTo=function(t){var e;if(t<this.checkpoint)throw(e=new Error("position should be > checkpoint")).position=t,e.checkpoint=this.checkpoint,e;return this.result+=this.source.slice(this.checkpoint,t),this.checkpoint=t,this},Pp.prototype.escapeChar=function(){var t=this.source.charCodeAt(this.checkpoint),e=Ip[t]||function(t){var e,r,n=t.toString(16).toUpperCase();if(t<=255)e="x",r=2;else if(t<=65535)e="u",r=4;else{if(!(t<=4294967295))throw new Hh("code point within a string may not be greater than 0xFFFFFFFF");e="U",r=8}return"\\"+e+Dh.repeat("0",r-n.length)+n}(t);return this.result+=e,this.checkpoint+=1,this},Pp.prototype.finish=function(){this.source.length>this.checkpoint&&this.takeUpTo(this.source.length)};var Fp={dump:Hp,safeDump:function(t,e){return Hp(t,Dh.extend({schema:vf},e))}};function Bp(t){return function(){throw new Error("Function "+t+" is deprecated and cannot be used.")}}var Up={Type:qh,Schema:Yh,FAILSAFE_SCHEMA:Kh,JSON_SCHEMA:tf,CORE_SCHEMA:ef,DEFAULT_SAFE_SCHEMA:vf,DEFAULT_FULL_SCHEMA:bf,load:ip.load,loadAll:ip.loadAll,safeLoad:ip.safeLoad,safeLoadAll:ip.safeLoadAll,dump:Fp.dump,safeDump:Fp.safeDump,YAMLException:Hh,MINIMAL_SCHEMA:Kh,SAFE_SCHEMA:vf,DEFAULT_SCHEMA:bf,scan:Bp("scan"),parse:Bp("parse"),compose:Bp("compose"),addConstructor:Bp("addConstructor")},Gp=function(){function t(e,r){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;gn(this,t),this.url=e,!r||Li(r)&&!Li(this.url)?this.path=Ii(this.url):this.path=r,this.path_for_parent=r||this.path,this.parent=n,this.container=null,this.parent&&(this.parent.container?this.container=this.parent.container:this.parent.isContainer()&&(this.container=this.parent))}return _n(t,[{key:"load",value:function(){return t=this.url,new Promise(function(e,r){"string"==typeof t?Ai.io(t).then(function(t){try{var n=function(t){var e;try{e=Up.safeLoad(t,{json:!0})}catch(t){throw t}return e}(t);e(n)}catch(t){r(t)}},r):(t=Object.assign({},t),e(t))});var t}},{key:"resourceFor",value:function(t){return{url:this.urlFor(t),path:this.pathFor(t),type:this.typeFor(t)}}},{key:"urlFor",value:function(t){return qp(t)?t:Li(t)&&this.container?this.parent.urlFor(this.path_for_parent+t):function(t,e){if(!t||!Li(t))return t;var r,n="/"!==t[0];return e?(r=document.createElement("a")).href=e:r=window.location,n?Ii(r.href)+t:(r.origin||r.protocol+"//"+r.host)+t}(t,this.path)}},{key:"pathFor",value:Ii},{key:"typeFor",value:function(t){var e=(t=t.split("/").pop()).lastIndexOf(".");if(-1<e)return t.substring(e+1)}},{key:"isContainer",value:function(){return!1}}]),t}();function qp(t){return!(!t||"global."!==t.slice(0,7))}function Vp(t){return null!=t}function Wp(t){return"("+t+")"}function Yp(t){return"$"===t[0]?"context['"+t.substring(1)+"']":"context.feature.properties['"+t+"']"}function Kp(t,e){return Wp(("string"==typeof(r=e)?'"'+r+'"':r)+" === "+Yp(t));var r}function Xp(t,e){return Wp(t.filter(Vp).map(function(t){return Wp(t.join(" && "))}).join(" "+e+" "))}function Zp(t,e,r){return e&&0<e.length?Xp(e.map(function(t){return $p(t,r)}),"||"):"true"}function $p(t,e){var r=[];if("function"==typeof t)return[Wp(t.toString()+"(context)")];if(Array.isArray(t))return[Zp(0,t,e)];if(null==t)return["true"];for(var n,i,o,a,s,u,l,c,h=Object.keys(t),f=0;f<h.length;f++){var p=h[f],d=t[p],v=yn(d);if("string"===v||"number"===v)r.push(Kp(p,d));else if("boolean"===v)r.push((c=d,Wp(Yp(p)+(c?" != ":" == ")+"null")));else if("not"===p)r.push("!"+Wp($p(d,e).join(" && ")));else if("any"===p)r.push(Zp(0,d,e));else if("all"===p)r.push(function(t,e){return t&&0<t.length?Xp(t.map(function(t){return $p(t,e)}),"&&"):"true"}(d,e));else if("none"===p)r.push("!"+Wp(Zp(0,d,e)));else if(Array.isArray(d))r.push(function(t,e){return Wp(d.map(function(e){return Kp(t,e)}).join(" || "))}(p));else if("object"===v&&null!=d)(d.max||d.min)&&r.push((n=p,i=d,l=u=s=a=void 0,u=[],l=(o=e)&&"function"==typeof o.rangeTransform&&o.rangeTransform,i.max&&(a=l?l(i.max):i.max,u.push(Yp(n)+" < "+a)),i.min&&(s=l?s=l(i.min):i.min,u.push(Yp(n)+" >= "+s)),Wp(u.join(" && "))));else{if(null!=d)throw new Error("Unknown Query syntax: "+d);r.push(" true ")}}return 0===h.length?["true"]:r}function Jp(t,e){return null==t?function(){return!0}:new Function("context","return "+Wp($p(t,e).join(" && "))+";")}var Qp=["filter","draw","visible","enabled","data"],td={},ed=["any","all","not","none"],rd=function(){function t(e){var r,n=e.layer,i=e.name,o=e.parent,a=e.draw,s=e.visible,u=e.enabled,l=e.filter,c=e.styles;if(gn(this,t),this.id=t.id++,this.config_data=n.data,this.parent=o,this.name=i,this.full_name=this.parent?this.parent.full_name+":"+this.name:this.name,this.draw=a,this.filter=l,this.styles=c,this.is_built=!1,u=void 0===u?s:u,this.parent&&!1===this.parent.visible?this.enabled=!1:this.enabled=!1!==u,this.draw)for(var h in this.draw)this.draw[h]=null==this.draw[h]?{}:this.draw[h],"object"!==yn(this.draw[h])?(r="Draw group '".concat(h,"' for layer ").concat(this.full_name," is invalid, must be an object, "),Ei("warn",r+="but was set to `".concat(h,": ").concat(this.draw[h],"` instead")),delete this.draw[h]):this.draw[h].layer_name=this.full_name}return _n(t,[{key:"build",value:function(){Ei("trace","Building layer '".concat(this.full_name,"'")),this.buildFilter(),this.buildDraw(),this.is_built=!0}},{key:"buildDraw",value:function(){var t,e,r;this.draw=Ai.stringsToFunctions(this.draw,yo.wrapFunction),this.calculatedDraw=(r=[],(t=this).parent&&(e=t.parent.calculatedDraw||[],r.push.apply(r,Rn(e))),r.push(t.draw),r)}},{key:"buildFilter",value:function(){this.filter_original=this.filter,this.filter=Ai.stringsToFunctions(this.filter,yo.wrapFunction);var t=yn(this.filter);if(null==this.filter||"object"===t||"function"===t)try{this.buildZooms(),this.buildPropMatches(),null!=this.filter&&("function"==typeof this.filter||0<Object.keys(this.filter).length)?this.filter=Jp(this.filter,ad):this.filter=null}catch(t){var e="Filter for layer ".concat(this.full_name," is invalid, `filter: ").concat(JSON.stringify(this.filter),"` ");Ei("warn",e+="failed with error '".concat(t.message,"', stack trace: ").concat(t.stack))}else{var r="Filter for layer ".concat(this.full_name," is invalid, filter value must be an object or function, ");Ei("warn",r+="but was set to `filter: ".concat(this.filter,"` instead"))}}},{key:"buildZooms",value:function(){var t=this.filter&&this.filter.$zoom,e=yn(t);if(null!=t&&"function"!==e){if(this.zooms={},"number"===e)this.zooms[t]=!0;else if(Array.isArray(t))for(var r=0;r<t.length;r++)this.zooms[t[r]]=!0;else if("object"===e&&(null!=t.min||null!=t.max))for(var n=t.min||0,i=t.max||25,o=n;o<i;o++)this.zooms[o]=!0;delete this.filter.$zoom}}},{key:"buildPropMatches",value:function(){var t=this;this.filter&&!Array.isArray(this.filter)&&"function"!=typeof this.filter&&Object.keys(this.filter).forEach(function(e){if(-1===ed.indexOf(e)){var r=t.filter[e],n=yn(r),i=Array.isArray(r);if(!i&&"string"!==n&&"number"!==n)return;"$"===e[0]?(t.context_prop_matches=t.context_prop_matches||[],t.context_prop_matches.push([e.substring(1),i?r:[r]])):(t.feature_prop_matches=t.feature_prop_matches||[],t.feature_prop_matches.push([e,i?r:[r]])),delete t.filter[e]}})}},{key:"doPropMatches",value:function(t){if(this.feature_prop_matches)for(var e=0;e<this.feature_prop_matches.length;e++){var r=this.feature_prop_matches[e],n=t.feature.properties[r[0]];if(null==n||-1===r[1].indexOf(n))return!1}if(this.context_prop_matches)for(var i=0;i<this.context_prop_matches.length;i++){var o=this.context_prop_matches[i],a=t[o[0]];if(null==a||-1===o[1].indexOf(a))return!1}return!0}},{key:"doesMatch",value:function(t){if(!this.enabled)return!1;if(this.is_built||this.build(),null!=this.zooms&&!this.zooms[t.zoom])return!1;if(!this.doPropMatches(t))return!1;var e;if(this.filter instanceof Function)try{e=this.filter(t)}catch(e){var r="Filter for this ".concat(this.full_name,": `filter: ").concat(this.filter_original,"` ");Ei("error",r+="failed with error '".concat(e.message,"', stack trace: ").concat(e.stack),t.feature)}else e=null==this.filter;return!!e&&(this.children_to_parse&&(function(t,e,r){for(var n in e){var i,o=e[n];"object"!==yn(o)||Array.isArray(o)?(i="Layer value must be an object: cannot create layer '".concat(n,": ").concat(JSON.stringify(o),"'"),i+=", under parent layer '".concat(t.full_name,"'."),r[t.name]&&(i+=" The parent name '".concat(t.name,"' is also the name of a style, did you mean to create a 'draw' group"),t.parent&&(i+=" under '".concat(t.parent.name,"'")),i+=" instead?"),Ei("warn",i)):ud(n,o,t,r)}}(this,this.children_to_parse,this.styles),delete this.children_to_parse),!0)}}]),t}();rd.id=0;var nd,id=function(){En(e,rd);var t=In(e);function e(r){var n;return gn(this,e),(n=t.call(this,r)).is_leaf=!0,n}return e}(),od=function(){En(e,rd);var t=In(e);function e(r){var n;return gn(this,e),(n=t.call(this,r)).is_tree=!0,n.layers=r.layers||[],n}return _n(e,[{key:"addLayer",value:function(t){this.layers.push(t)}},{key:"buildDrawGroups",value:function(t){var e=[],r=[];if(function t(e,r,n,i){var o=!1;if(0!==r.length){for(var a=0;a<r.length;a++){var s=r[a];s.is_leaf?s.doesMatch(e)&&(o=!0,n.push(s),i.push(s.id)):s.is_tree&&s.doesMatch(e)&&(o=!0,t(e,s.layers,n,i)||(n.push(s),i.push(s.id)))}return o}}(t,[this],e,r),0<e.length){var n=function(t){if(1<t.length){for(var e=t[0],r=1;r<t.length;r++)e+="/"+t[r];return e}return t[0]}(r);if(void 0===td[n]){for(var i=e.map(function(t){return t&&!1!==t.visible&&t.calculatedDraw}),o={},a=0;a<i.length;a++){var s=i[a];if(s)for(var u=0;u<s.length;u++){var l=s[u];for(var c in l)o[c]=!0}}for(var h in o)td[n]=td[n]||{},td[n][h]=function(t,e){for(var r,n=0,i=0;i<t.length;i++)t[i].length>n&&(n=t[i].length);if(0===n)return null;for(var o={visible:!0},a=0;a<n;a++)!function(n){r=[],t.forEach(function(t){t[n]&&t[n][e]&&-1===r.indexOf(t[n][e])&&r.push(t[n][e])}),0!==r.length&&(r.sort(function(t,e){return(t&&t.layer_name)>(e&&e.layer_name)?1:-1}),da.apply(void 0,[o].concat(Rn(r))),delete o.layer_name)}(a);return!1===o.visible?null:o}(i,h),td[n][h]?(td[n][h].key=n+"/"+h,td[n][h].layers=e.map(function(t){return t&&t.full_name}),td[n][h].group=h):delete td[n][h];td[n]&&0===Object.keys(td[n]).length&&(td[n]=null)}return td[n]}}}]),e}(),ad={rangeTransform:function(t){return"string"==typeof t&&"px2"===t.trim().slice(-3)?"".concat(parseFloat(t)," * context.meters_per_pixel_sq"):t}};function sd(t){return-1<Qp.indexOf(t)}function ud(t,e,r,n){var i,o={name:t,layer:e=null==e?{}:e,parent:r,styles:n},a=Cn(function(t){var e={},r={};for(var n in t)sd(n)?e[n]=t[n]:r[n]=t[n];return[e,r]}(e),2),s=a[0],u=a[1],l=(i=u,0===Object.keys(i).length),c=new(l&&null!=r?id:od)(Object.assign(o,s));return c.enabled&&(r&&r.addLayer(c),c.children_to_parse=l?null:u),c}var ld=/^global\.(.+)$/,cd=nd={loadScene:function(t,e){var r=this,n=1<arguments.length&&void 0!==e?e:{},i=n.path,o=n.type,a=[];return this.loadSceneRecursive({url:t,path:i,type:o},null,a).then(function(t){return r.finalize(t)}).then(function(t){var e=t.config,n=t.bundle;return e?(0<a.length&&a.forEach(function(t){var e="Failed to import scene: ".concat(t.url);Ei("error",e,t),r.trigger("error",{type:"scene_import",message:e,error:t,url:t.url})}),{config:e,bundle:n}):Promise.reject(a[0])})},loadSceneRecursive:function(t,e,r){var n=this,i=t.url,o=t.path,a=(t.type,2<arguments.length&&void 0!==r?r:[]);if(!i)return Promise.resolve({});var s=new Gp(i,o,e);return s.load().then(function(t){if(null==t.import)return n.normalize(t,s),{config:t,bundle:s};Array.isArray(t.import)||(t.import=[t.import]);var e=[];return t.import.forEach(function(t){"object"===yn(t)&&(t=Ci(new Blob([JSON.stringify(t)]))),e.push(s.resourceFor(t))}),delete t.import,Promise.all(e.map(function(t){return n.loadSceneRecursive(t,s,a)})).then(function(e){e.forEach(function(t){return n.normalize(t.config,t.bundle)});var r=e.map(function(t){return t.config});return t=da.apply(void 0,Rn(r).concat([t])),n.normalize(t,s),{config:t,bundle:s}})}).catch(function(t){return t.url=i,a.push(t),{}})},normalize:function(t,e){return this.normalizeDataSources(t,e),this.normalizeFonts(t,e),this.normalizeTextures(t,e),this.hoistTextures(t,e),{config:t,bundle:e}},normalizeDataSources:function(t,e){for(var r in t.sources=t.sources||{},t.sources)this.normalizeDataSource(t.sources[r],e);return t},normalizeDataSource:function(t,e){if(t.url&&(t.url=e.urlFor(t.url)),t.scripts)for(var r in Array.isArray(t.scripts)&&(t.scripts=t.scripts.reduce(function(t,e){return t[e]=e,t},{})),t.scripts)t.scripts[r]=e.urlFor(t.scripts[r]);return t},normalizeFonts:function(t,e){for(var r in t.fonts=t.fonts||{},t.fonts){var n;Array.isArray(t.fonts[r])?t.fonts[r].forEach(function(t){t.url=t.url&&e.urlFor(t.url)}):(n=t.fonts[r]).url=n.url&&e.urlFor(n.url)}return t},normalizeTextures:function(t,e){if(t.textures=t.textures||{},t.textures)for(var r in t.textures){var n=t.textures[r];n.url&&(n.url=e.urlFor(n.url))}},hoistTextures:function(t,e){var r=this;if(t.styles)for(var n in t.styles)!function(n){var i=t.styles[n],o=i.texture;"string"!=typeof o||t.textures[o]||(i.texture=r.hoistTexture(o,t,e)),i.material&&["emission","ambient","diffuse","specular","normal"].forEach(function(n){var o=null!=i.material[n]&&i.material[n].texture;"string"!=typeof o||t.textures[o]||(i.material[n].texture=r.hoistTexture(o,t,e))})}(n);if(this.hoistStyleShaderUniformTextures(t,e,{include_globals:!1}),t.layers)for(var i=[t.layers];0<i.length;){var o=i.pop();if("object"===yn(o)&&!Array.isArray(o))for(var a in o)if("draw"===a){var s,u,l=o[a];for(var c in l)l[c].texture&&("string"!=typeof(s=l[c].texture)||t.textures[s]||(l[c].texture=this.hoistTexture(s,t,e))),l[c].outline&&l[c].outline.texture&&("string"!=typeof(u=l[c].outline.texture)||t.textures[u]||(l[c].outline.texture=this.hoistTexture(u,t,e)))}else{if(sd(a))continue;i.push(o[a])}}},hoistStyleShaderUniformTextures:function(t,e,r){var n=this,i=r.include_globals;if(t.styles)for(var o in t.styles){var a=t.styles[o];a.shaders&&a.shaders.uniforms&&Xo.parseUniforms(a.shaders.uniforms).forEach(function(r){var o=r.type,a=r.value,s=r.key,u=r.uniforms;"sampler2D"!==o||"string"!=typeof a||t.textures[a]||!i&&qp(a)||(u[s]=n.hoistTexture(a,t,e))})}},hoistTexture:function(t,e,r){var n=qp(t),i=n?t:r.urlFor(t),o=n?"texture-".concat(i):i;return e.textures[o]={url:i},o},applyGlobalProperties:function(t){if(!t.global||0===Object.keys(t.global).length)return t;var e=function t(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:".",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};for(var o in n=n?n+r:"",e){var a=n+o,s=e[o];"object"!==yn(i[a]=s)||Array.isArray(s)||t(s,r,a,i)}return i}(t.global);return function t(r){if("string"==typeof r){var n=function t(e,r,n){var i=2<arguments.length&&void 0!==n?n:[];if(-1<i.indexOf(e))Ei({level:"warn",once:!0},"Global properties: cyclical reference detected",i);else{i.push(e);var o=ld.exec(e);if(o){var a=o[1];if(a){var s=r[a];if(void 0!==s)return"string"==typeof s&&ld.exec(s)?t(s,r,i):s;Ei({level:"warn",once:!0},"Global property not found: "+e)}else Ei({level:"warn",once:!0},"Invalid global property reference: "+e)}}}(r,e);void 0!==n&&(r=n)}else if(Array.isArray(r))for(var i=0;i<r.length;i++)r[i]=t(r[i]);else if("object"===yn(r))for(var o in r)r[o]=t(r[o]);return r}(t)},finalize:function(t){var e=t.config,r=t.bundle;return e?(e.global=e.global||{},e.scene=e.scene||{},e.cameras=e.cameras||{},e.lights=e.lights||{},e.styles=e.styles||{},e.layers=e.layers||{},e.camera&&(e.cameras.default=e.camera),0===Object.keys(e.cameras).length&&(e.cameras.default={}),0!==Object.keys(e.lights).length&&!Object.keys(e.lights).every(function(t){return!1===e.lights[t].visible})||(e.lights.default_light={type:"directional"}),{config:e,bundle:r}):{}}};Mo(nd);var hd=function(){function t(){gn(this,t),this.coords={},this.max_proxy_descendant_depth=6,this.max_proxy_ancestor_depth=10}return _n(t,[{key:"sourceTiles",value:function(t,e){return this.coords[t.key]&&this.coords[t.key].sources&&this.coords[t.key].sources[e.name]}},{key:"addTile",value:function(t){var e=t.coords.key,r=this.coords[e];(r=r||(this.coords[e]={descendants:0})).sources||(r.sources={}),r.sources[t.source.name]||(r.sources[t.source.name]={});for(var n=(r.sources[t.source.name][t.style_zoom]=t).coords.z-1;0<=n;n--){var i=_a.coordinateAtZoom(t.coords,n);this.coords[i.key]||(this.coords[i.key]={descendants:0}),this.coords[i.key].descendants++}}},{key:"removeTile",value:function(t){var e=this.sourceTiles(t.coords,t.source),r=t.coords.key;e&&(delete e[t.style_zoom],0===Object.keys(e).length&&(delete this.coords[r].sources[t.source.name],0===Object.keys(this.coords[r].sources).length&&(delete this.coords[r].sources,0===this.coords[r].descendants&&delete this.coords[r])));for(var n=t.coords.z-1;0<=n;n--){var i=_a.coordinateAtZoom(t.coords,n);this.coords[i.key]&&0<this.coords[i.key].descendants&&(this.coords[i.key].descendants--,0!==this.coords[i.key].descendants||this.coords[i.key].sources||delete this.coords[i.key])}}},{key:"getAncestor",value:function(t,e){var r=t.coords,n=t.style_zoom,i=t.source,o=1<arguments.length&&void 0!==e?e:1;if(!(o>this.max_proxy_ancestor_depth)){if(n>i.max_coord_zoom){var a=this.sourceTiles(r,i);if(a)for(var s=n-1;s>=i.max_coord_zoom;s--)if(a[s]&&a[s].loaded)return a[s];n=i.max_coord_zoom}n--;var u=_a.coordinateAtZoom(r,r.z-1),l=this.sourceTiles(u,i);return l&&l[n]&&l[n].loaded?l[n]:0<u.z?this.getAncestor({coords:u,style_zoom:n,source:i},o+1):void 0}}},{key:"getDescendants",value:function(t,e){var r=t.coords,n=t.style_zoom,i=t.source,o=1<arguments.length&&void 0!==e?e:1,a=[];if(n>=i.max_coord_zoom){var s=this.sourceTiles(r,i);if(s)for(var u=Math.max(Qn.default_view_max_zoom,n+this.max_proxy_descendant_depth),l=n+1;l<=u;l++)if(s[l]&&s[l].loaded)return a.push(s[l]),a;return a}if(this.coords[r.key]&&0<this.coords[r.key].descendants){n++;for(var c=_a.childrenForCoordinate(r),h=0;h<c.length;h++){var f=c[h],p=this.sourceTiles(f,i);p&&p[n]&&p[n].loaded?a.push(p[n]):o<=this.max_proxy_descendant_depth&&f.z<=i.max_coord_zoom&&a.push.apply(a,Rn(this.getDescendants({coords:f,source:i,style_zoom:n},o+1)))}}return a}}]),t}(),fd=function(){function t(e,r,n,i){gn(this,t),Object.assign(this,e),this.placed=null,this._tile=i;var o=Qn.unitsPerMeter(i.coords.z)*Math.pow(2,n-i.style_zoom);this.layout=Object.assign({},e.layout),this.layout.repeat_scale=.75,this.layout.repeat_distance=this.layout.repeat_distance||0,this.layout.repeat_distance/=o,this.position=Qn.tileSpaceToMeters(this.position,i.coords.z,i.min),this._worldToScreen=r,this._screenSpaceBoundingBox=void 0,this._boundingCircles=void 0}return _n(t,[{key:"getTile",value:function(){return this._tile}},{key:"isFlat",value:function(){return this.is_flat}},{key:"getScreenSpaceBoundingBox",value:function(){var t,e,r,n,i,o,a;return this._screenSpaceBoundingBox||((t=this._worldToScreen(this.position,!0))[0]+=this.offset[0],t[1]+=this.offset[1],e=this.size[0]/2+this.layout.buffer[0],r=this.size[1]/2+this.layout.buffer[1],n=t[0]-e,i=t[0]+e,o=t[1]-r,a=t[1]+r,this._screenSpaceBoundingBox={left:n,bottom:a,right:i,top:o}),this._screenSpaceBoundingBox}},{key:"getBoundingCircles",value:function(){return this._boundingCircles||(this._boundingCircles="point"===this.type?this._convertSidesToScreenSpaceCircles():this._convertCirclesToScreenSpace()),this._boundingCircles}},{key:"_convertSidesToScreenSpaceCircles",value:function(){var t=this._tile.coords.z,e=this._tile.min,r=Qn.tileSpaceToMeters([this.sides[0],this.sides[1]],t,e),n=Qn.tileSpaceToMeters([this.sides[2],this.sides[3]],t,e),i=Cn(this._worldToScreen(r,!0),2),o=i[0],a=i[1],s=Cn(this._worldToScreen(n,!0),2);return xc(o,a,s[0],s[1],this.size[1]/2+this.layout.buffer[1])}},{key:"_convertCirclesToScreenSpace",value:function(){for(var t=[],e=this.circles,r=this._tile.coords.z,n=this._tile.min,i=0;i<e.length-2;i+=3){var o=Qn.tileSpaceToMeters([e[i],-e[i+1]],r,n),a=e[i+2]/Qn.unitsPerMeter(r),s=[o[0]+a,o[1]],u=this._worldToScreen(o,!0),l=this._worldToScreen(s,!0),c=$n.getLineLength(u[0],u[1],l[0],l[1]);t.push(u[0],u[1],c)}return t}}]),t}(),pd=function(t,e,r,n,i,o){vd=dd,dd={};var a={},s={},u=[],l=r.worldToScreen.bind(r),c=new md(o);for(var h in t.forEach(function(t){for(var r in t.meshes)t.meshes[r].forEach(function(r){if(r.labels){for(var n in c.trackMesh(r),r.labels["non-collision"]){var i=gd(r.labels["non-collision"][n],r,l,e,t);i.label.text_data&&c.insertLabel(i,t)}for(var o in r.labels.collision){var u;a[o]||(u=gd(r.labels.collision[o],r,l,e,t),a[o]=u.label,s[o]=u)}}})}),s){var f=s[h];f.linked&&(f.linked=s[f.linked]),u.push(f)}var p=r.getViewport(),d=p.width,v=p.height;return To.startTile("main",{apply_repeat_groups:!0,return_hidden:!0,grid_index:new Eo(d,v,30)}),To.addStyle("main","main"),To.collide(u,"main","main").then(function(t){return t.forEach(function(t){var e,r,i,o,a,s,u=t.mesh,l=t.label.getTile();u.valid&&(!(e=0)!==t.show||n&&t.label.breach&&!vd[t.label.id]||(e=1),e&&(dd[t.label.id]=!0),t.label.text_data&&c.insertLabel(t,l),r=u.vertex_layout.offset.a_shape,i=u.vertex_layout.stride,a=(o=u.vertex_layout.attribs.find(function(t){return"a_shape"===t.name})).byte_size/o.size,r+=3*a,s=!0,t.ranges.forEach(function(t){if(s){for(var n=0;n<t[1];n++){if(u.vertex_data[t[0]+n*i+r]===e)return void(s=!1);u.vertex_data[t[0]+n*i+r]=e}c.trackMesh(u)}}))}),c.createTextures(i).then(function(){return c.updateMeshes()})}).then(function(e){e.forEach(function(t){return t.valid&&t.upload()}),t.forEach(function(t){t.labeled=!0}),u=[],s={},a={}})},dd={},vd={},yd=120===new Uint8Array(new Uint32Array([305419896]).buffer)[0];function gd(t,e,r,n,i){var o=t.container,a=o.label,s=o.linked,u=t.ranges;return{label:new fd(a,r,n,i),linked:s,ranges:u,mesh:e}}var md=function(){function t(e){gn(this,t),this.textureManager=Lo(e),this.tiles={},this.meshes=[],this.containers=[]}return _n(t,[{key:"insertLabel",value:function(t,e){var r=t.label.text_data,n=r.text_settings_key,i=r.text,o=r.text_info;this.containers.push(t);var a=this._ensureTextSection(e,n);a[i]?t.label.text_data.text_info=a[i]:a[i]=o}},{key:"trackMesh",value:function(t){-1===this.meshes.indexOf(t)&&this.meshes.push(t)}},{key:"updateMeshes",value:function(){var t=this;return this.containers.forEach(function(e){var r,n,i,o,a,s,u,l,c,h;e.label.text_data&&(r=e.label.getTile(),(n=e.mesh).valid?(i=e.label.type,o=e.label.text_data.text_info,t.tiles[r.id]&&t.tiles[r.id].textures&&(a=t.tiles[r.id].textures[0],n.uniforms.u_texture=a,-1===n.textures.indexOf(a)&&n.textures.push(a),"point"===i||"straight"===i?(s="point"===i?o.align[e.label.align].texcoords:o.texcoords[i].texcoord,t.setTexCoords(n,e,s)):"curved"===i&&(u=o.segments.length,l=o.texcoords_stroke,c=o.texcoords.curved,t.setTexCoords(n,e,function(t){return t<u?l[t]:c[t-u].texcoord})))):t.tiles[r.id]&&t.tiles[r.id].textures&&(h=t.tiles[r.id].textures[0],t.textureManager.release(h)))}),this.meshes}},{key:"setTexCoords",value:function(t,e,r){var n,i,o,a,s,u,l=r instanceof Function;l||(i=(n=Cn(r,4))[0],o=n[1],a=n[2],s=n[3],u=[[i,o],[a,o],[a,s],[i,s]]);var c=t.vertex_layout.stride,h=new DataView(t.vertex_data.buffer),f=t.vertex_layout.offset.a_texcoord;e.ranges.forEach(function(t,e){var n,i,o,a,s,p=Cn(t,3),d=p[0],v=p[1],y=p[2];l&&(i=(n=Cn(r(e),4))[0],o=n[1],a=n[2],s=n[3],u=[[i,o],[a,o],[a,s],[i,s]]);for(var g=y?v/2:0;g<v;g++){var m=u[g%4],_=d+g*c;h.setUint16(_+f,65535*m[0],yd),h.setUint16(_+f+2,65535*m[1],yd)}})}},{key:"createTextures",value:function(t){var e=this;return Promise.all(Object.values(this.tiles).map(function(r){var n=r.id,i=r.key,o=r.texts;return e._createTexturesForTile(t,o,"labels-".concat(i,"-").concat(n),n,e.textureManager).then(function(t){t.length&&(t.forEach(function(t){e.textureManager.retain(t),1<e.textureManager.getRetainCount(t)&&e.textureManager.release(t)}),e.tiles[n].textures=t)})}))}},{key:"_createTexturesForTile",value:function(t,e,r,n,i){var o=new Lc,a=o.setTextureTextPositions(e);return o.rasterize(e,a,n,r,t,i)}},{key:"_ensureTile",value:function(t){var e=t.id,r=t.key;return this.tiles[e]||(this.tiles[e]={id:e,key:r,texts:{}}),this.tiles[e]}},{key:"_ensureTextSection",value:function(t,e){var r=this._ensureTile(t).texts;return r[e]||(r[e]={}),r[e]}}]),t}(),_d=function(){function t(e){var r=this,n=e.scene,i=e.view;gn(this,t),this._scene=n,this._view=i,this._visible_tiles={},this._pyramid=new hd,this._visible_coords={},this._building_tiles=null,this._renderable_tiles=[],this._active_styles=[],this._tile_visibility_counters={},this._update_labels_on_queue_check=!1,this._all_visible_tiles_are_cached=!1,this._debouncedUpdateLabels=Ti(this._updateLabels.bind(this),100,200),this._main_thread_target=["TileManager",this._scene.id].join("_"),li.addTarget(this._main_thread_target,this),this._keepCoordinate=this._keepCoordinate.bind(this),this._removeTilesFilter=this._removeTilesFilter.bind(this),this._removeCachedTilesFilter=this._removeCachedTilesFilter.bind(this),this._is_labeled=!1,this._tile_cache=new H.util.Cache(function(){var t=.1;return navigator&&navigator.deviceMemory?t=5*navigator.deviceMemory/100:window&&window.screen&&(t=window.screen.width/512*window.screen.height/512*.03*3,t=Math.min(t,1)),1024*t*1024*1024}(),function(t,e,n){r._visible_tiles[t]&&r._visible_tiles[t]===e||e.destroy()})}return _n(t,[{key:"destroy",value:function(){this._tile_cache.removeAll(),this.forEachVisibleTile(function(t){return t.destroy()}),this._visible_tiles={},this._pyramid=null,this._visible_coords={},this._scene=null,this._view=null}},{key:"keepTile",value:function(t){this._visible_tiles[t.key]=t,this._pyramid.addTile(t)}},{key:"hasTile",value:function(t){return void 0!==this._visible_tiles[t]}},{key:"_forgetTile",value:function(t){var e,r;this.hasTile(t)&&(e=this._visible_tiles[t],this._pyramid.removeTile(e),delete this._visible_tiles[t],e.loaded?this._tile_cache.add(e.key,e,function(t){var e=0;for(var r in t.meshes)for(var n=t.meshes[r],i=0;i<n.length;i++){var o=n[i];e+=o.buffer_size;for(var a=0;a<o.textures.length;a++)e+=t.textureManager.getByteLength(o.textures[a])}return e}(e)):(r=this._tile_cache.get(e.key))?this._tile_cache.drop(r.key):e.destroy(),this._tileBuildStop(e))}},{key:"removeTile",value:function(t){this._forgetTile(t),this._scene.requestRedraw()}},{key:"forEachVisibleTile",value:function(t){for(var e in this._visible_tiles)t(this._visible_tiles[e])}},{key:"removeTiles",value:function(t){for(var e in this._visible_tiles)t(this._visible_tiles[e])&&this.removeTile(e)}},{key:"removeCachedTiles",value:function(t){var e=this;this._tile_cache.forEach(function(r,n){t(n)&&e._tile_cache.drop(r)})}},{key:"updateTilesForView",value:function(t){var e=0<arguments.length&&void 0!==t&&t;this._visible_coords={};for(var r=this._view.findVisibleTileCoordinates(),n=0;n<r.length;n++){var i=r[n];this._visible_coords[i.key]=i}this.updateTileStates(e)}},{key:"updateTileStates",value:function(t){var e=0<arguments.length&&void 0!==t&&t;for(var r in this._all_visible_tiles_are_cached=!0,this._visible_coords)this._keepCoordinate(r,e);this._all_visible_tiles_are_cached&&(this._is_labeled=!1,this._debouncedUpdateLabels()),this._tile_cache.removeAll(this._removeCachedTilesFilter),this._updateProxyTiles(),this.removeTiles(this._removeTilesFilter),this._updateRenderableTiles(),this._updateActiveStyles()}},{key:"_removeTilesFilter",value:function(t){if(t.style_zoom===this._view.lookAtManipulator.getLookAtData().tile_level){if(this._visible_coords[t.coords.key])return!1;for(var e in this._visible_coords)if(_a.isDescendant(t.coords,this._visible_coords[e]))return!1}return!t.isProxy()}},{key:"_updateLabels",value:function(){var t,e=this;this._building_tiles&&0!==Object.keys(this._building_tiles).length||(Lc.pruneTextCache(),t=this._renderable_tiles.sort(bd),pd(t,function(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2,n=Math.pow(10,r);return Math.round(Math.floor(t*e)/e*n)/n}(this._view.lookAtManipulator.getLookAtData().zoom,2),this._view.lookAtManipulator,this.isLoadingVisibleTiles(),this._scene.gl,this._scene.id).then(function(){e._is_labeled=!Ao.hasPendingTasks(),e._scene.immediateRedraw(),e._update_labels_on_queue_check=!1}))}},{key:"_updateProxyTiles",value:function(){var t,e=this,r=this._view.lookAtManipulator.getZoomDirection();0!==r&&(t=!1,this.forEachVisibleTile(function(n){var i;if(n.setProxyFor(null),1===r)n.built||(i=e._pyramid.getAncestor(n))&&(i.setProxyFor(n),t=!0);else if(-1===r&&!n.built)for(var o=e._pyramid.getDescendants(n),a=0;a<o.length;a++)o[a].setProxyFor(n),t=!0}),t||this._view.lookAtManipulator.resetZoomDirection())}},{key:"getRenderableTiles",value:function(){return this._renderable_tiles}},{key:"_updateRenderableTiles",value:function(){for(var t in this._renderable_tiles=[],this._visible_tiles){var e=this._visible_tiles[t],r=this._tile_cache.get(t);e.loaded?(this._renderable_tiles.push(e),r&&r!==e&&this._tile_cache.drop(t)):r&&(r.generation===this._scene.generation?this._renderable_tiles.push(r):this._tile_cache.drop(t))}return this._renderable_tiles}},{key:"getWorkerForTile",value:function(t,e){return e.has_volatile_data?this._scene.getWorkers(1)[0]:e.tiled?this._scene.getWorkers(0)[Math.abs(t.x+t.y+t.z)%this._scene.num_workers]:this._scene.getWorkers(0)[e.id%this._scene.num_workers]}},{key:"getActiveStyles",value:function(){return this._active_styles}},{key:"_updateActiveStyles",value:function(){for(var t=this._renderable_tiles,e={},r=0;r<t.length;r++){var n=t[r];Object.keys(n.meshes).forEach(function(t){return e[t]=!0})}return this._active_styles=Object.keys(e),this._active_styles}},{key:"isLoadingVisibleTiles",value:function(){var t=!1;for(var e in this._visible_tiles)if(!this._visible_tiles[e].built){t=!0;break}return t}},{key:"updateTilesVisibilityCounters",value:function(){var t=this;Object.keys(this._visible_coords).forEach(function(e){e in t._tile_visibility_counters||(t._tile_visibility_counters[e]=0)});var e=[];Object.keys(this._tile_visibility_counters).forEach(function(r){r in t._visible_coords?(t._tile_visibility_counters[r]++,30<=t._tile_visibility_counters[r]&&e.push(t._visible_coords[r])):(t._tile_visibility_counters[r]--,t._tile_visibility_counters[r]<=0&&delete t._tile_visibility_counters[r])}),e.length&&this.loadCoordinates(e)}},{key:"loadCoordinates",value:function(t){var e=this;t.sort(function(t,r){var n=e._view.lookAtManipulator.getLookAtData().position,i=Qn.metersPerTile(t.z)/2,o=Qn.metersForTile(t);o.x+=i,o.y-=i;var a=Qn.metersForTile(r);a.x+=i,a.y-=i;var s=Math.abs(n[0]-o.x)+Math.abs(n[1]-o.y),u=Math.abs(n[0]-a.x)+Math.abs(n[1]-a.y);return(t.center_dist=s)<(r.center_dist=u)?-1:u===s?0:1}),t.forEach(function(t){return e.loadCoordinate(t)})}},{key:"_keepCoordinate",value:function(t,e){var r=1<arguments.length&&void 0!==e&&e,n=this._visible_coords[t];if(n.z===this._view.center_tile.z)for(var i in this._scene.sources){var o,a,s,u=this._scene.sources[i];u.builds_geometry_tiles&&u.includesTile(n,this._view.lookAtManipulator.getLookAtData().tile_level)&&(o=_a.normalizedKey(n,u,this._view.lookAtManipulator.getLookAtData().tile_level))&&!this.hasTile(o)&&((a=r&&this._tile_cache.get(o))||(this._all_visible_tiles_are_cached=!1),s=a||new _a({source:u,coords:n,worker:this.getWorkerForTile(n,u),style_zoom:Ai.zoomToTileLevel(n.z),view:this._view,sceneId:this._scene.id}),"ObjectSource"===u.config.type&&(s.syncedAt=u.getSyncedAt()),this.keepTile(s))}}},{key:"loadCoordinate",value:function(t){if(t.z===this._view.center_tile.z)for(var e in this._scene.sources){var r,n=this._scene.sources[e];n.builds_geometry_tiles&&n.includesTile(t,this._view.lookAtManipulator.getLookAtData().tile_level)&&(r=_a.normalizedKey(t,n,this._view.lookAtManipulator.getLookAtData().tile_level),this.hasTile(r)&&this.buildTile(this._visible_tiles[r]))}}},{key:"buildTile",value:function(t,e){this._building_tiles&&this._building_tiles[t.key]||t.built&&t.generation===this._scene.generation||(this._tileBuildStart(t.key),t.build(this._scene.generation,e))}},{key:"buildTileStylesCompleted",value:function(t){var e=t.tile,r=t.progress;if(null==this._visible_tiles[e.key])_a.abortBuild(e,this._scene.id);else if(e.generation!==this._scene.generation)_a.abortBuild(e,this._scene.id);else{if(e.id<this._visible_tiles[e.key].id)return void _a.abortBuild(e,this._scene.id);e=this._visible_tiles[e.key].merge(e),r.done&&(e.built=!0),e.buildMeshes(this._scene.styles,r),this.updateTileStates(),this._scene.requestRedraw()}r.done&&this._tileBuildStop(e)}},{key:"buildTileError",value:function(t){this._forgetTile(t.key),_a.abortBuild(t,this._scene.id)}},{key:"_tileBuildStart",value:function(t){this._is_labeled=!1,this._building_tiles=this._building_tiles||{},this._building_tiles[t]=!0}},{key:"_tileBuildStop",value:function(t){this._building_tiles&&(t.source&&t.source.hasLabeledData()&&(this._update_labels_on_queue_check=!0),delete this._building_tiles[t.key],Ao.removeForTile(t.id),this.checkBuildQueue())}},{key:"isReady",value:function(){return this._is_labeled&&!this.isLoadingVisibleTiles()}},{key:"checkBuildQueue",value:function(){this._building_tiles&&0!==Object.keys(this._building_tiles).length||(this._building_tiles=null,this._update_labels_on_queue_check?this._updateLabels():(this._is_labeled=!Ao.hasPendingTasks(),this._scene.immediateRedraw()))}},{key:"_removeCachedTilesFilter",value:function(t,e){var r=e.source;return!this._visible_tiles[t]&&(e.generation!==this._scene.generation||"ObjectSource"===r.config.type&&r.getSyncedAt()>e.syncedAt)}}]),t}();function bd(t,e){var r=t.coords,n=e.coords;return r.z-n.z||r.x-n.x||r.y-n.y}function xd(t){gn(this,xd),this.defaults={},this.defaults.culling=!0,this.defaults.culling_face=t.BACK,this.defaults.blending=!1,this.defaults.blending_src=t.ONE_MINUS_SRC_ALPHA,this.defaults.blending_dst=t.ONE_MINUS_SRC_ALPHA,this.defaults.blending_src_alpha=t.ONE,this.defaults.blending_dst_alpha=t.ONE_MINUS_SRC_ALPHA,this.defaults.depth_write=!0,this.defaults.depth_test=!0,t.depthFunc(t.LESS),this.culling=new wd({cull:this.defaults.culling,face:this.defaults.culling_face},function(e){e.cull?(t.enable(t.CULL_FACE),t.cullFace(e.face)):t.disable(t.CULL_FACE)}),this.blending=new wd({blend:this.defaults.blending,src:this.defaults.blending_src,dst:this.defaults.blending_dst,src_alpha:this.defaults.blending_src_alpha,dst_alpha:this.defaults.blending_dst_alpha},function(e){e.blend?(t.enable(t.BLEND),e.src_alpha&&e.dst_alpha?t.blendFuncSeparate(e.src,e.dst,e.src_alpha,e.dst_alpha):t.blendFunc(e.src,e.dst)):t.disable(t.BLEND)}),this.depth_write=new wd({depth_write:this.defaults.depth_write},function(e){t.depthMask(e.depth_write)}),this.depth_test=new wd({depth_test:this.defaults.depth_test},function(e){e.depth_test?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST)})}var wd=function(){function t(e,r){gn(this,t),r(e),this.value=e,this.setup=r}return _n(t,[{key:"get",value:function(){return this.value}},{key:"set",value:function(t){JSON.stringify(this.value)!==JSON.stringify(t)&&(this.setup(t),this.value=t)}}]),t}(),Ed=function(){function t(){gn(this,t),this.canvas=null,this.gl=null,this.screenshot_canvas=null,this.screenshot_context=null,this.queue_screenshot=null,this.video_capture=null}return _n(t,[{key:"setCanvas",value:function(t,e){this.canvas=t,this.gl=e}},{key:"screenshot",value:function(t){var e=this,r=(0<arguments.length&&void 0!==t?t:{}).background;return null!=this.queue_screenshot||(this.queue_screenshot={background:r},this.queue_screenshot.promise=new Promise(function(t,r){e.queue_screenshot.resolve=t,e.queue_screenshot.reject=r})),this.queue_screenshot.promise}},{key:"completeScreenshot",value:function(){if(null!=this.queue_screenshot){var t=this.canvas.width,e=this.canvas.height,r=new Uint8Array(t*e*4);this.gl.readPixels(0,0,t,e,this.gl.RGBA,this.gl.UNSIGNED_BYTE,r);for(var n=(n=this.queue_screenshot.background)&&"transparent"!==n?yo.parseColor(n).slice(0,3).map(function(t){return 255*t}):null,i=new Uint8ClampedArray(t*e*4),o=0;o<e;o++)for(var a=0;a<t;a++){var s=4*((e-o-1)*t+a),u=4*(o*t+a),l=r[3+s];i[0+u]=255*r[0+s]/l,i[1+u]=255*r[1+s]/l,i[2+u]=255*r[2+s]/l,i[3+u]=l,n&&(l/=255,i[0+u]=i[0+u]*l+n[0]*(1-l),i[1+u]=i[1+u]*l+n[1]*(1-l),i[2+u]=i[2+u]*l+n[2]*(1-l),i[3+u]=255)}this.screenshot_canvas=this.screenshot_canvas||document.createElement("canvas");var c=this.screenshot_canvas;c.width=t,c.height=e,this.screenshot_context=this.screenshot_context||c.getContext("2d");var h=this.screenshot_context,f=new ImageData(i,t,e);h.putImageData(f,0,0);for(var p=c.toDataURL("image/png"),d=atob(p.slice(22)),v=new Uint8Array(d.length),y=0;y<d.length;++y)v[y]=d.charCodeAt(y);var g=new Blob([v],{type:"image/png"});this.queue_screenshot.resolve({url:p,blob:g,type:"png"}),this.queue_screenshot=null}}},{key:"startVideoCapture",value:function(){var t=this;if("function"!=typeof window.MediaRecorder||!this.canvas||"function"!=typeof this.canvas.captureStream)return Ei("warn","Video capture (Canvas.captureStream and/or MediaRecorder APIs) not supported by browser"),!1;if(this.video_capture)return Ei("warn","Video capture already in progress, call Scene.stopVideoCapture() first"),!1;try{var e=this.video_capture={};e.chunks=[],e.stream=this.canvas.captureStream(),e.options={mimeType:"video/webm"},e.media_recorder=new MediaRecorder(e.stream,e.options),e.media_recorder.ondataavailable=function(r){var n,i;0<r.data.size&&e.chunks.push(r.data),e.resolve&&(i=Ci(n=new Blob(e.chunks,{type:e.options.mimeType})),e.stream&&(e.stream.getTracks()||[]).forEach(function(t){t.stop(),e.stream.removeTrack(t)}),e.stream=null,e.media_recorder=null,t.video_capture=null,e.resolve({url:i,blob:n,type:"webm"}))},e.media_recorder.start()}catch(t){return this.video_capture=null,Ei("error","Scene video capture failed",t),!1}return!0}},{key:"stopVideoCapture",value:function(){var t=this;return this.video_capture?(this.video_capture.promise=new Promise(function(e,r){t.video_capture.resolve=e,t.video_capture.reject=r}),this.video_capture.media_recorder.stop(),this.video_capture.promise):(Ei("warn","No scene video capture in progress, call Scene.startVideoCapture() first"),Promise.resolve({}))}}]),t}(),Td=function(){function t(){gn(this,t),this.sources={},this.styles={},this.layers={},this.tiles={},this._isConfigured=!1}return _n(t,[{key:"init",value:function(t,e,r,n,i,o,a){return this.setMeshVariantMaxLife(a),this.scene_id=t,this.textureManager=Lo(t),this._worker_id=e,Ei.setLevel(r),Ai.device_pixel_ratio=n,ol.setElementIndexUint(i),Ko.setPrefix(this._worker_id),this._style_manager=new Nh,this._importExternalScripts(o),dc.id_prefix=e,this._isConfigured=!1,e}},{key:"dispose",value:function(){this._last_config_sources=null,this._config_sources=null,this.sources=null,this._style_manager=null,this.styles=null,this.layers=null,this.tiles=null}},{key:"_importExternalScripts",value:function(t){var e;0!==t.length&&(Ei("debug","loading custom data source scripts in worker:",t),e=Object.getOwnPropertyNames(window),importScripts.apply(void 0,Rn(t)),Object.getOwnPropertyNames(window).forEach(function(t){-1===e.indexOf(t)&&(self[t]=window[t])}))}},{key:"updateConfig",value:function(t,e){var r,n=t.config,i=t.generation,o=t.introspection;n=JSON.parse(n);for(var a in r=e,Object.assign(Vu,r),this._generation=i,this._isConfigured=!1,n.layers)n.layers[a]&&(n.layers[a].data=Ai.stringsToFunctions(n.layers[a].data));this.global=Ai.stringsToFunctions(n.global),this._createDataSources(n),n.styles=Ai.stringsToFunctions(n.styles,yo.wrapFunction),this.styles=this._style_manager.build(n.styles),self.is_fake_worker=ui.is_main,this._style_manager.initStyles({generation:this._generation,styles:this.styles,sources:this.sources,introspection:o,id:this.scene_id}),delete self.is_fake_worker,this.layers=function(t,e){td={};var r={};for(var n in t){var i=t[n];i&&(r[n]=ud(n,i,null,e))}return r}(n.layers,this._style_manager.styles),this._configuring=this._syncTextures(n.textures)}},{key:"setMeshVariantMaxLife",value:function(t){this.meshVariantMaxLife=t}},{key:"_createDataSources",value:function(t){var e=this;this._last_config_sources=this._config_sources||{},this._config_sources=t.sources;var r=this.sources,n=[];for(var i in t.sources=Ai.stringsToFunctions(t.sources),this.sources={},self.is_fake_worker=ui.is_main,t.sources)if(JSON.stringify(this._last_config_sources[i])!==JSON.stringify(t.sources[i])){var o=void 0;try{o=Ri.create(Object.assign({},t.sources[i],{name:i}),this.sources)}catch(r){Ei("error","Error creating source.",r.message,t.sources[i]);continue}o&&(this.sources[i]=o,n.push(i))}else this.sources[i]=r[i];delete self.is_fake_worker,n.forEach(function(t){for(var r in e.tiles)e.tiles[r].source===t&&delete e.tiles[r]})}},{key:"awaitConfiguration",value:function(){return this._configuring}},{key:"_onConfig",value:function(t){var e=this;if((this._isConfigured=!0)!==t.loaded)t.loading=!0,t.loaded=!1,t.error=null,this._loadTileSourceData(t).then(function(){if(e.getTile(t.id)){t.loading=!1,t.loaded=!0;try{_a.buildGeometry(t,e)}catch(r){t.error=r.toString(),li.postMessage("TileManager_".concat(e.scene_id,".buildTileError"),_a.slice(t))}}else Ei("trace","stop tile build after data source load because tile was removed. Key: ".concat(t.key,", id: ").concat(t.id))},function(r){t.loading=!1,t.loaded=!1,t.error=r.stack,Ei("error","tile load error for tile with key ".concat(t.key," and id ").concat(t.id,": ").concat(t.error)),li.postMessage("TileManager_".concat(e.scene_id,".buildTileError"),_a.slice(t))});else{Ei("trace","used worker cache for tile with key ".concat(t.key," and id ").concat(t.id));try{_a.buildGeometry(t,this)}catch(e){t.error=e.toString(),li.postMessage("TileManager_".concat(this.scene_id,".buildTileError"),_a.slice(t))}}}},{key:"buildTile",value:function(t){var e,r=t.tile,n=this.getTile(r.id);n&&n.loading||(r=this.tiles[r.id]=Object.assign(n||{},r),this._isConfigured?this._onConfig(r):(e=this).awaitConfiguration().then(function(){return e._onConfig(r)}))}},{key:"_loadTileSourceData",value:function(t){return this.sources[t.source]?this.sources[t.source].load(t):(t.source_data={},Promise.resolve(t))}},{key:"getTile",value:function(t){return this.tiles[t]}},{key:"removeTile",value:function(t){var e=this.tiles[t];null!=e&&(!0===e.loading&&(Ei("trace","cancel tile load for tile id ".concat(t)),e.loading=!1,_a.cancel(e)),delete this.tiles[t],Ei("trace","remove tile from cache, tile id: ".concat(t)))}},{key:"queryFeatures",value:function(t){var e=this,r=t.filter,n=t.visible,i=t.geometry,o=[],a=t.tile_ids.map(function(t){return e.tiles[t]}).filter(function(t){return t});return null!=r&&(r=-1<["{","["].indexOf(r[0])?JSON.parse(r):r,r=Ai.stringsToFunctions(r,yo.wrapFunction)),r=Jp(r,ad),a.forEach(function(t){for(var a in t.source_data.layers)!function(a){t.source_data.layers[a].features.forEach(function(s){var u,l;!0===n&&s.generation!==e._generation||!1===n&&s.generation===e._generation||((u=yo.getFeatureParseContext(s,t,e.global)).source=t.source,u.layer=a,r(u)&&(l={type:s.type,properties:s.properties},!0===i&&(l.geometry=Qn.copyGeometry(s.geometry),Qn.tileSpaceToLatlng(l.geometry,t.coords.z,t.min)),o.push(l)))})}(a)}),o}},{key:"resetFeatureSelection",value:function(){Ko.reset()}},{key:"_syncTextures",value:function(t){var e=[];return t&&e.push.apply(e,Rn(Object.keys(t))),Ei("trace","sync textures to worker:",e),0<e.length?this.textureManager.syncTexturesToWorker(e):Promise.resolve()}},{key:"profile",value:function(t){console.profile("worker ".concat(this._worker_id,": ").concat(t))}},{key:"profileEnd",value:function(t){console.profileEnd("worker ".concat(this._worker_id,": ").concat(t))}},{key:"terminate",value:function(){this.dispose()}}]),t}();(ui.is_worker||self.H&&self.H.DEBUG)&&li.addTarget("self",new Td);var Ad=function(){function e(t,r){gn(this,e),r=r||{},Mo(this),this.id=e.id++,this.textureManager=Lo(this.id),this.initialized=!1,this.initializing=null,this.sources={},this.view=new yh(this,r),this.tile_manager=new _d({scene:this,view:this.view}),this.num_workers=r.numWorkers||2,!0===r.disableVertexArrayObjects&&(ia.disabled=!0),Ai.device_pixel_ratio=r.devicePixelRatio,this.config=null,this.config_source=t,this.config_bundle=null,this.last_valid_config_source=null,this.styles=null,this.style_manager=new Nh,this.building=null,this.dirty=!0,r.preUpdate&&this.subscribe({pre_update:r.preUpdate}),r.postUpdate&&this.subscribe({post_update:r.postUpdate}),this.render_loop=!r.disableRenderLoop,this.render_loop_active=!1,this.render_loop_stop=!1,this.render_count=0,this.last_render_count=0,this.render_count_changed=!1,this.frame=0,this.last_main_render=-1,this.last_selection_render=-1,this.media_capture=new Ed,this.selection=null,this.introspection=!0===r.introspection,this.viewport=r.viewport,this.adjustMeshVariantMaxLife(),this.container=r.container,this.canvas=null,this.contextOptions=r.webGLContextOptions,this.lights=null,this.background=null,this.createListeners(),this.updating=0,this.generation=e.generation,this.last_complete_generation=e.generation,this.log_level=r.logLevel||"warn",Ei.setLevel(this.log_level),Ei.reset()}return _n(e,[{key:"load",value:function(t,e){var r=this,n=0<arguments.length&&void 0!==t?t:null,i=1<arguments.length&&void 0!==e?e:{};return this.initializing||(Ei.reset(),this.updating++,this.initialized=!1,this.initial_build_time=null,(i="string"==typeof i?{base_path:i}:i).blocking=void 0===i.blocking||i.blocking,!1!==this.render_loop&&this.setupRenderLoop(),this.createCanvas(),this.textureManager.destroy(this.gl),this.initializing=this.loadScene(n,i).then(function(){return r.createWorkers()}).then(function(){r.resetFeatureSelection();var t="object"===yn(r.config_source)||r.hasSubscribersFor("load"),e=r.updateConfig({serialize_funcs:t,normalize:!1,load_event:!0,fade_in:!0});if(!0===i.blocking)return e}).then(function(){r.updating--,r.initializing=null,r.initialized=!0,r.last_valid_config_source=r.config_source,r.last_valid_options={base_path:i.base_path,file_type:i.file_type},r.requestRedraw()}).catch(function(t){var e,n;if(r.initializing=null,r.updating=0,n="YAMLException"===t.name?(e="yaml","Error parsing scene YAML"):"Error initializing scene",r.trigger("error",{type:e,message:n,error:t,url:r.config_source}),n="Scene.load() failed to load ".concat(r.config_source,": ").concat(t.message),r.last_valid_config_source)return Ei("warn",n,t),Ei("info","Scene.load() reverting to last valid configuration"),r.load(r.last_valid_config_source,r.last_valid_base_path);throw Ei("error",n,t),t})),this.initializing}},{key:"destroy",value:function(){var t;this.initialized=!1,this.render_loop_stop=!0,this.destroyListeners(),this.canvas&&this.canvas.parentNode&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),this.container=null,this.selection&&this.selection.destroy(),this.gl&&(this.textureManager.destroy(this.gl),this.style_manager.destroy(this.gl),this.styles={},ra.reset(),(t=this.gl.getExtension("WEBGL_lose_context"))&&t.loseContext(),this.gl=null),this.sources={},this.tile_manager.destroy(),this.tile_manager=null,this.destroyWorkers(),Ei.reset()}},{key:"createCanvas",value:function(){if(!this.canvas){this.container=this.container||document.body,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.top=0,this.canvas.style.left=0,this.container.style.backgroundColor="transparent",this.container.appendChild(this.canvas);try{this.gl=Ju.getContext(this.canvas,Object.assign({alpha:!0,premultipliedAlpha:!1,stencil:!0,device_pixel_ratio:Ai.device_pixel_ratio},this.contextOptions)),navigator.appVersion.includes("iPhone")&&this.gl.depthRange(.994,1)}catch(t){throw new Error("Couldn't create WebGL context. Your browser may not support WebGL, or it's turned off? Visit http://webglreport.com/ for more info.")}this.handleViewportUpdate(),ia.init(this.gl),this.render_states=new xd(this.gl),this.media_capture.setCanvas(this.canvas,this.gl)}}},{key:"getWorkerUrl",value:function(){var e,i;if(void 0!==t&&(i="("+t+")()",n&&""!==r&&(i+="\n//# sourceMappingURL="+n.slice(0,n.lastIndexOf("/")+1)+r),e=Ci(new Blob([i],{type:"application/javascript"}))),!e)throw new Error("Couldn't find internal Tangram source variable (may indicate the library did not build correctly)");return e}},{key:"updateExternalScripts",value:function(){var t=Rn(this.external_scripts||[]),e=[];if(this.config.scene.scripts)for(var r in this.config.scene.scripts)-1===e.indexOf(this.config.scene.scripts[r])&&e.push(this.config.scene.scripts[r]);for(var n in this.config.sources){var i=this.config.sources[n];if(i.scripts)for(var o in i.scripts)-1===e.indexOf(i.scripts[o])&&e.push(i.scripts[o])}return this.external_scripts=e,!(this.external_scripts.length===t.length&&this.external_scripts.every(function(e,r){return e===t[r]}))}},{key:"createWorkers",value:function(){return this.updateExternalScripts()&&this.destroyWorkers(),this._workers?Promise.resolve():this.makeWorkers(this.getWorkerUrl())}},{key:"makeWorkers",value:function(t){var e=this,r=!!this.gl.getExtension("OES_element_index_uint"),n=[];this._workers=[];for(var i=0;i<this.num_workers;i++)!function(){var o=new Worker(t);e._workers[i]=o,li.addWorker(o),Ei("debug","Scene.makeWorkers: initializing worker ".concat(i));var a=i;n.push(li.postMessage(o,"self.init",e.id,i,e.log_level,Ai.device_pixel_ratio,r,e.external_scripts,e.meshVariantMaxLife).then(function(t){return Ei("debug","Scene.makeWorkers: initialized worker ".concat(t)),t},function(t){return Ei("error","Scene.makeWorkers: failed to initialize worker ".concat(a,":"),t),Promise.reject(t)}))}();var o=new Td;return this._workers.push(o),n.push(o.init(this.id,i,this.log_level,Ai.device_pixel_ratio,r,[],this.meshVariantMaxLife)),this.next_worker=0,Promise.all(n).then(function(){var r;Ei.setWorkers(e._workers.slice(0,e.num_workers)),r=t,void 0===Si&&"function"!=typeof(Si=window.URL&&window.URL.revokeObjectURL||window.webkitURL&&window.webkitURL.revokeObjectURL)&&(Si=null,Ei("warn","window.URL.revokeObjectURL (or vendor prefix) not found, unable to create local blob URLs")),Si&&Si(r)})}},{key:"getWorkers",value:function(t){return this._workers.filter(function(e){switch(t){case 0:return e instanceof Worker;case 1:return e instanceof Td;default:return!0}})}},{key:"destroyWorkers",value:function(){this.selection=null,Array.isArray(this._workers)&&(Ei.setWorkers(null),this._workers.forEach(function(t){t.terminate()}),this._workers=null)}},{key:"ready",value:function(){return!(!this.view.ready()||0===Object.keys(this.sources).length)}},{key:"handleViewportUpdate",value:function(){var t=this.viewport,e=t.width,r=t.height;0<e&&0<r&&(this.dirty=!0,this.view.handleViewportUpdate(),this.gl&&Ju.resize(this.gl,e,r,Ai.device_pixel_ratio)),this.adjustMeshVariantMaxLife()&&this.syncMeshVariantMaxLife()}},{key:"adjustMeshVariantMaxLife",value:function(){var t=this.viewport,e=t.width,r=t.height,n=Ai.device_pixel_ratio,i=e/n/256*(r/n/256),o=Math.max(Math.ceil(2*i),8);if(this.meshVariantMaxLife!==o)return this.meshVariantMaxLife=o,!0}},{key:"syncMeshVariantMaxLife",value:function(){this._workers&&li.postMessage(this._workers,"self.setMeshVariantMaxLife",this.meshVariantMaxLife)}},{key:"requestRedraw",value:function(){this.dirty=!0}},{key:"immediateRedraw",value:function(){this.dirty=!0,this.update()}},{key:"renderLoop",value:function(){this.render_loop_active=!0,this.initialized&&this.update(),Ao.setState({user_moving_view:this.view.user_input_active}),Ao.processAll(),this.render_loop_stop?(this.render_loop_stop=!1,this.render_loop_active=!1):window.requestAnimationFrame(this.renderLoop.bind(this))}},{key:"setupRenderLoop",value:function(){var t=this;this.render_loop_active||setTimeout(function(){t.renderLoop()},0)}},{key:"update",value:function(){var t=this.dirty,e=!!this.selection&&this.selection.hasPendingRequests(),r=!(!1===t&&!1===e||!1===this.initialized||0<this.updating||!1===this.ready());return this.trigger("pre_update",r),this.view.update(),r&&(this.dirty=!1,this.render({main:t,selection:e}),this.updateViewComplete(),this.media_capture.completeScreenshot(),this.trigger("post_update",r),!0!==this.animated&&!this.view.isAnimating()||(this.dirty=!0),this.frame++,Ei("trace","Scene.render()"),!0)}},{key:"render",value:function(t){var e=this,r=t.main,n=t.selection,i=this.gl;if(Object.keys(this.lights).forEach(function(t){return e.lights[t].update()}),r&&(this.render_count=this.renderPass(),this.last_main_render=this.frame),n){if(this.view.panning||this.view.user_input_active)return void this.selection.clearPendingRequests();(this.last_selection_render<this.last_main_render||this.selection.has_dirty_buffer)&&(this.selection.bind(),this.renderPass("selection_program",{allow_blend:!1}),i.bindFramebuffer(i.FRAMEBUFFER,null),i.viewport(0,0,this.canvas.width,this.canvas.height),i.clearColor.apply(i,Rn(this.background.color)),this.last_selection_render=this.frame,this.selection.has_dirty_buffer=!1),this.selection.read(this.tile_manager.getRenderableTiles()),this.selection.has_dirty_buffer&&this.render({main:!1,selection:n})}return this.render_count_changed=!1,this.render_count!==this.last_render_count&&(this.render_count_changed=!0),this.last_render_count=this.render_count,!0}},{key:"renderPass",value:function(t,e){var r=this,n=0<arguments.length&&void 0!==t?t:"program",i=(1<arguments.length&&void 0!==e?e:{}).allow_blend,o=this.gl;i=null==i||i;this.clearFrame();for(var a,s=ya.sortByBlendOrderWithinLayers(this.tile_manager.getActiveStyles().map(function(t){return r.styles[t]}).filter(function(t){return t})),u=0,l=0,c=0;c<s.length;c++){var h,f,p=s[c],d=l-(h=parseInt(p.name));(p.clean_depth||d)&&(this.render_states.depth_write.value.depth_write?o.clear(o.DEPTH_BUFFER_BIT):(o.depthMask(!0),o.clear(o.DEPTH_BUFFER_BIT),o.depthMask(!1)),d&&(l=h)),p.blend!==a&&(f=Object.assign({},ya.render_states[p.blend],{blend:i&&p.blend}),this.setRenderState(f));var v="translucent"===p.blend&&"program"===n;v&&(this.gl.colorMask(!1,!1,!1,!1),this.renderStyle(p.name,n),this.gl.colorMask(!0,!0,!0,!0),this.gl.depthFunc(this.gl.EQUAL),this.gl.enable(this.gl.STENCIL_TEST),this.gl.clear(this.gl.STENCIL_BUFFER_BIT),this.gl.stencilFunc(this.gl.EQUAL,this.gl.ZERO,255),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.INCR)),u+=this.renderStyle(p.name,n),v&&(this.gl.disable(this.gl.STENCIL_TEST),this.gl.depthFunc(this.gl.LESS)),a=p.blend}return u}},{key:"renderStyle",value:function(t,e){for(var r,n=this,i=this.styles[t],o=!0,a=0,s=this.tile_manager.getRenderableTiles(),u=Math.max.apply(Math,Rn(s.map(function(e){return e.meshes[t]?Math.max.apply(Math,Rn(e.meshes[t].map(function(t){return t.variant.order}))):-1}))),l=0;l<u+1;l++){var c=function(u){for(var l=0;l<s.length;l++){var c=s[l];if(null!=c.meshes[t]&&c.shouldProxyForStyle(t))for(var h=c.meshes[t].filter(function(t){return t.variant.order===u}),f=0,p=h.length;f<p;f+=1){var d=h[f];if(!0===o&&(o=!1,!(r=n.setupStyle(i,e))))return{v:0};n.view.setupTile(c,r),n.selection.setupDiscards(r),i.render(d)&&n.requestRedraw(),a+=d.geometry_count}}}(l);if("object"===yn(c))return c.v}return a}},{key:"setupStyle",value:function(t,e){var r;try{if(!(r=t.getProgram(e)))return}catch(e){return void this.trigger("warning",{type:"styles",message:"Error compiling style ".concat(t.name),style:t,shader_errors:t.program&&t.program.shader_errors})}for(var n in r.use(),t.setup(),this.view.setupProgram(r),this.lights)this.lights[n].setupProgram(r);return r}},{key:"clearFrame",value:function(){this.initialized&&(this.render_states.depth_write.set({depth_write:!0}),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT))}},{key:"setRenderState",value:function(t){var e,r,n=0<arguments.length&&void 0!==t?t:{},i=n.depth_test,o=n.depth_write,a=n.cull_face,s=n.blend;this.initialized&&(e=this.render_states,i=!1!==i&&e.defaults.depth_test,o=!1!==o&&e.defaults.depth_write,a=!1!==a&&e.defaults.culling,s=null!=s?s:e.defaults.blending,r=this.gl,e.depth_test.set({depth_test:i}),e.depth_write.set({depth_write:o}),e.culling.set({cull:a,face:e.defaults.culling_face}),s&&"opaque"!==s?"overlay"===s||"inlay"===s||"translucent"===s?e.blending.set({blend:!0,src:r.SRC_ALPHA,dst:r.ONE_MINUS_SRC_ALPHA,src_alpha:r.ONE,dst_alpha:r.ONE_MINUS_SRC_ALPHA}):"add"===s?e.blending.set({blend:!0,src:r.ONE,dst:r.ONE}):"multiply"===s&&e.blending.set({blend:!0,src:r.ZERO,dst:r.SRC_COLOR}):e.blending.set({blend:!1}))}},{key:"getFeatureAt",value:function(t,e,r){var n,i=e.radius,o=e.top_most_only;this.initialized?(n={x:t.x/this.view.size.css.width,y:t.y/this.view.size.css.height},i=0<i?{x:i/this.view.size.css.width,y:i/this.view.size.css.height}:null,this.selection.getFeatureAt(n,{radius:i,top_most_only:o},r)):Ei("debug","Scene.getFeatureAt() called before scene was initialized")}},{key:"queryFeatures",value:function(t){var e=0<arguments.length&&void 0!==t?t:{},r=e.filter,n=e.unique,i=void 0===n||n,o=e.group_by,a=void 0===o?null:o,s=e.visible,u=void 0===s?null:s,l=e.geometry,c=void 0!==l&&l,h=(r=Ai.serializeWithFunctions(r),this.tile_manager.getRenderableTiles().map(function(t){return t.id}));return li.postMessage(this._workers,"self.queryFeatures",{filter:r,visible:u,geometry:c,tile_ids:h}).then(function(t){var e=[],r={},n={},o=(i="string"==typeof i?[i]:i)&&function(t){return JSON.stringify(Array.isArray(i)?Zu(t,i):t)},s=(a=("string"==typeof a||Array.isArray(a))&&a)&&function(t){return Array.isArray(a)?JSON.stringify(Zu(t,a)):t[a]};return t.forEach(function(t){return t.forEach(function(t){if(o){var i=o(t);if(r[i])return;r[i]=!0}var a;s?(a=s(t.properties),n[a]=n[a]||[],n[a].push(t)):e.push(t)})}),s?n:e})}},{key:"loadScene",value:function(t,e){var r=this,n=0<arguments.length&&void 0!==t?t:null,i=1<arguments.length&&void 0!==e?e:{},o=i.base_path,a=i.file_type;return this.config_source=n||this.config_source,"string"==typeof this.config_source?this.base_path=Ii(o||this.config_source):this.base_path=Ii(o),this.config_path=this.base_path,cd.loadScene(this.config_source,{path:this.base_path,type:a}).then(function(t){var e=t.config,n=t.bundle;return r.config=e,r.config_bundle=n,r.config})}},{key:"createDataSources",value:function(){var t=this,e=[],r=Object.keys(this.sources),n=0;for(var i in this.config.sources){var o=this.config.sources[i],a=this.sources[i];try{var s=Object.assign({},o,{name:i,id:n++});if(this.sources[i]=Ri.create(s,this.sources),!this.sources[i])throw{}}catch(r){delete this.sources[i];var u="Could not create data source: ".concat(r.message);Ei("warn","Scene: ".concat(u),o),this.trigger("warning",{type:"sources",source:o,message:u})}Ri.sameConfig(this.sources[i],a)||e.push(i)}for(var l in r.forEach(function(r){t.config.sources[r]||(delete t.sources[r],e.push(r))}),0<e.length&&this.tile_manager.removeTiles(function(t){return-1<e.indexOf(t.source.name)}),this.config.layers){var c=this.config.layers[l];!1!==c.enabled&&c.data&&this.sources[c.data.source]&&(this.sources[c.data.source].builds_geometry_tiles=!0)}}},{key:"loadTextures",value:function(){var t=this;return this.textureManager.createFromObject(this.gl,this.config.textures).then(function(){return t.textureManager.createDefault(t.gl)})}},{key:"updateStyles",value:function(){if(!this.initialized&&!this.initializing)throw new Error("Scene.updateStyles() called before scene was initialized");for(var t in this.styles=this.style_manager.build(this.config.styles),this.style_manager.initStyles(this),this.styles)this.styles[t].setGL(this.gl);this.dirty=!0}},{key:"createLights",value:function(){for(var t in this.lights={},this.config.lights){var e;this.config.lights[t]&&"object"===yn(this.config.lights[t])&&((e=this.config.lights[t]).name=t.replace("-","_"),e.visible=!1!==e.visible,e.visible&&(this.lights[e.name]=la.create(this.view,e)))}la.inject(this.lights)}},{key:"setBackground",value:function(){var t,e=this.config.scene.background;this.background={},e&&e.color&&(this.background.color=yo.parseColor(e.color)),this.background.color||(this.background.color=[0,0,0,0]),1===this.background.color[3]?this.canvas.style.backgroundColor="rgba(".concat(this.background.color.map(function(t){return Math.floor(255*t)}).join(", "),")"):this.canvas.style.backgroundColor="transparent",(t=this.gl).clearColor.apply(t,Rn(this.background.color))}},{key:"setIntrospection",value:function(t){var e=this;return t!==this.introspection?(this.introspection=t||!1,this.updating++,this.updateConfig({normalize:!1}).then(function(){return e.updating--})):Promise.resolve()}},{key:"updateConfig",value:function(t){var r=0<arguments.length&&void 0!==t?t:{},n=r.load_event,i=void 0!==n&&n,o=r.serialize_funcs,a=r.normalize,s=void 0===a||a;r.fade_in,this.generation=++e.generation,this.updating++,this.config=cd.applyGlobalProperties(this.config),s?cd.normalize(this.config,this.config_bundle):(cd.hoistStyleShaderUniformTextures(this.config,this.config_bundle,{include_globals:!0}),cd.normalizeTextures(this.config,this.config_bundle)),this.trigger(i?"load":"update",{config:this.config}),this.style_manager.init(),this.createLights(),this.createDataSources(),this.loadTextures(),this.setBackground(),Ic.loadFonts(this.config.fonts),this.updateStyles();var u=this.syncConfigToWorker({serialize_funcs:o});return this.updating--,this.view.updateBounds(),this.requestRedraw(),u}},{key:"syncConfigToWorker",value:function(t){var e=(0<arguments.length&&void 0!==t?t:{}).serialize_funcs,r=void 0===e||e?Ai.serializeWithFunctions(this.config):JSON.stringify(this.config);return li.postMessage(this._workers,"self.updateConfig",{config:r,generation:this.generation,introspection:this.introspection},Xu)}},{key:"createListeners",value:function(){var t=this;this.listeners={},this.listeners.view={move:function(){return t.trigger("move")}},this.view.subscribe(this.listeners.view),this.listeners.texture={update:function(){return t.dirty=!0},warning:function(e){return t.trigger("warning",Object.assign({type:"textures"},e))}},this.textureManager.subscribe(this.listeners.texture),this.listeners.scene_loader={error:function(e){return t.trigger("error",Object.assign({type:"scene"},e))}},cd.subscribe(this.listeners.scene_loader)}},{key:"destroyListeners",value:function(){this.unsubscribeAll(),this.view.unsubscribe(this.listeners.view),this.textureManager.unsubscribe(this.listeners.texture),cd.unsubscribe(this.listeners.scene_loader),this.listeners=null}},{key:"resetFeatureSelection",value:function(){this.selection?this._workers&&li.postMessage(this._workers,"self.resetFeatureSelection"):this.selection=new Ko(this.gl,this.id)}},{key:"updateViewComplete",value:function(){(this.render_count_changed||this.generation!==this.last_complete_generation)&&this.tile_manager.isReady()&&(this.last_complete_generation=this.generation,this.trigger("view_complete"))}},{key:"resetViewComplete",value:function(){this.last_complete_generation=null}},{key:"screenshot",value:function(t){var e=(0<arguments.length&&void 0!==t?t:{}).background,r=void 0===e?"white":e;return this.requestRedraw(),this.media_capture.screenshot({background:r})}},{key:"pixelRatio",value:function(){return Ai.device_pixel_ratio}},{key:"startVideoCapture",value:function(){return this.requestRedraw(),this.media_capture.startVideoCapture()}},{key:"stopVideoCapture",value:function(){return this.media_capture.stopVideoCapture()}},{key:"_profile",value:function(t){console.profile("main thread: ".concat(t)),li.postMessage(this._workers,"self.profile",t)}},{key:"_profileEnd",value:function(t){console.profileEnd("main thread: ".concat(t)),li.postMessage(this._workers,"self.profileEnd",t)}},{key:"getCameraMatrix",value:function(){return this.view.lookAtManipulator.getCameraMatrix()}},{key:"animated",get:function(){var t=this;return void 0!==this.config.scene.animated?this.config.scene.animated:this.tile_manager.getActiveStyles().some(function(e){return t.styles[e]&&t.styles[e].animated})}}],[{key:"create",value:function(t,r){return new e(t,1<arguments.length&&void 0!==r?r:{})}}]),e}();Ad.id=0,Ad.generation=0;var kd=function(){En(e,So);var t=In(e);function e(r,n,i){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};gn(this,e);var a=Math.pow(2,o.coords.z),s=Math.abs(Math.floor(o.coords.x/a)),u=Math.abs(a*s-Math.abs(o.coords.x)),l=o.coords;return o.coords={x:u,y:l.y,z:l.z},t.call(this,r,n,i,o)}return _n(e,[{key:"load",value:function(t){var r=this;if(!t||!t.uid)return Ln(Tn(e.prototype),"load",this).call(this,t);var n=t.coords,i=new Uint8Array([0,0,0,0]);return this.loading=new Promise(function(e,o){var a=H.map.DataModel.invoke(t.uid,"requestTileAsPromise",[n.x,n.y,n.z])||null;a?a.then(function(e){var n=e.data;r.loaded=!0,!n||n instanceof ArrayBuffer||"IMG"!==n.tagName.toUpperCase()&&"CANVAS"!==n.tagName.toUpperCase()?r.setData(1,1,i,{filtering:"nearest"}):r.setElement(n,t)},function(){r.loaded=!1}).then(e,function(t){return o(t)}):o(new Error("Unable to invoke on target "+t.uid))}),this.loading}}]),e}();Oo.register(kd,function(t){return t&&t.uid});var Sd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",Md=[62,-1,-1,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,63,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Od="undefined"!=typeof BigInt?BigInt:Number;function Id(t){var e=t;return e&Od(1)&&(e=~e),+(e>>=Od(1)).toString()}function Ld(t){for(var e="",r=Od(t);31<r;){var n=r&Od(31)|Od(32);e+=Sd[n],r>>=Od(5)}return e+Sd[r]}function Cd(t){var e=Od(t),r=e<0;return e<<=Od(1),r&&(e=~e),Ld(e)}var Rd={encode:function(t){var e=t.precision,r=void 0===e?5:e,n=t.thirdDim,i=void 0===n?0:n,o=t.thirdDimPrecision,a=void 0===o?0:o,s=t.polyline,u=Math.pow(10,r),l=Math.pow(10,a),c=function(t,e,r){if(t<0||15<t)throw new Error("precision out of range. Should be between 0 and 15");if(r<0||15<r)throw new Error("thirdDimPrecision out of range. Should be between 0 and 15");if(e<0||7<e||4===e||5===e)throw new Error("thirdDim should be between 0, 1, 2, 3, 6 or 7");var n=r<<7|e<<4|t;return Ld(1)+Ld(n)}(r,i,a),h=[],f=Od(0),p=Od(0),d=Od(0);return s.forEach(function(t){var e=Od(Math.round(t[0]*u));h.push(Cd(e-f)),f=e;var r,n=Od(Math.round(t[1]*u));h.push(Cd(n-p)),p=n,i&&(r=Od(Math.round(t[2]*l)),h.push(Cd(r-d)),d=r)}),[].concat(Rn(c),h).join("")},decode:function(t){for(var e=function(t){var e=Od(0),r=Od(0),n=[];if(t.split("").forEach(function(t){var i,o=Od((i=t.charCodeAt(0),Md[i-45]));e|=(o&Od(31))<<r,(o&Od(32))===Od(0)?(n.push(e),e=Od(0),r=Od(0)):r+=Od(5)}),0<r)throw new Error("Invalid encoding");return n}(t),r=function(t,e){if(1!=+t.toString())throw new Error("Invalid format version");var r=+e.toString();return{precision:15&r,thirdDim:r>>4&7,thirdDimPrecision:r>>7&15}}(e[0],e[1]),n=Math.pow(10,r.precision),i=Math.pow(10,r.thirdDimPrecision),o=r.thirdDim,a=0,s=0,u=0,l=[],c=2;c<e.length;)a+=Id(e[c])/n,s+=Id(e[c+1])/n,o?(u+=Id(e[c+2])/i,l.push([a,s,u]),c+=3):(l.push([a,s]),c+=2);if(c!==e.length)throw new Error("Invalid encoding. Premature ending reached");return wn(wn({},r),{},{polyline:l})},ABSENT:0,LEVEL:1,ALTITUDE:2,ELEVATION:3};self.H=self.H||{},self.H.gl={DataSource:Ri,Geo:Qn,MathUtils:$n,Scene:Ad,Task:Ao,Tile:_a,WorkerBroker:li,log:Ei,SceneLoader:cd,yaml:Up,flexpolyline:Rd}}()},e(),this.H=this.H||{},this.H.venues=function(t){function e(t,e){void 0===e&&(e={});var r,n=e.insertAt;t&&"undefined"!=typeof document&&(r=document.head||document.getElementsByTagName("head")[0],(e=document.createElement("style")).type="text/css","top"===n&&r.firstChild?r.insertBefore(e,r.firstChild):r.appendChild(e),e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t)))}function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach(function(e){a(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function p(t,e,r){return(p=f()?Reflect.construct:function(t,e,r){var n=[null];return n.push.apply(n,e),n=new(Function.bind.apply(t,n)),r&&h(n,r.prototype),n}).apply(null,arguments)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t){var e=f();return function(){var r,n=c(t);return r=e?(r=c(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments),n=this,!(r=r)||"object"!=typeof r&&"function"!=typeof r?d(n):r}}function y(t,e,r){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){if(t=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e))return(e=Object.getOwnPropertyDescriptor(t,e)).get?e.get.call(r):e.value})(t,e,r||t)}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}}(t,e)||_(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t){return function(t){if(Array.isArray(t))return b(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||_(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){if(t){if("string"==typeof t)return b(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(t,e):void 0}}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}e(".H_l_right .venues-ui__drawings .trigger.button--active .arrow {\n  transform: rotate(90deg); }\n\n.H_l_right .venues-ui__drawings .drawings {\n  right: 45px;\n  left: initial; }\n");var x=function(){l(e,H.map.Feature);var t=v(e);function e(r){var i;return n(this,e),(i=t.call(this)).id=r.id,i.model=r,i}return o(e,[{key:"getData",value:function(){return this.model}},{key:"getAddress",value:function(){return this.model.getInternalAddress()}},{key:"getCenter",value:function(){var t=(e=g(this.model.getCenter(),2))[0],e=e[1];return new H.geo.Point(e,t)}},{key:"getId",value:function(){return this.model.getId()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"toGeoJSON",value:function(){return this.model.toJSON()}},{key:"getLevel",value:function(){return this.getParentEventTarget()}},{key:"getVenue",value:function(){return this.getLevel().getDrawing().getParentEventTarget()}}]),e}(),w=function(){l(e,H.map.Feature);var t=v(e);function e(r){var i;return n(this,e),(i=t.call(this)).id=r.id,i.model=r,i}return o(e,[{key:"getData",value:function(){return this.model}},{key:"getBoundingBox",value:function(){return p(H.geo.Rect,m(this.model.getBoundingBox()))}},{key:"getCenter",value:function(){var t=(e=g(this.model.getCenter(),2))[0],e=e[1];return new H.geo.Point(e,t)}},{key:"getId",value:function(){return this.model.getId()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"getLevel",value:function(t){return this.getLevels().find(function(e){return e.id===t})}},{key:"getLevels",value:function(){var t=this.getData().getLevels().map(function(t){return t.getId()});return this.getVenue().getLevels().filter(function(e){return-1!==t.indexOf(e.id)})}},{key:"getMainLevel",value:function(){return this.getLevel(this.model.getMainLevel().getId())}},{key:"getVenue",value:function(){return this.getParentEventTarget()}}]),e}(),E=function(){l(e,H.map.Feature);var t=v(e);function e(r){var i;return n(this,e),(i=t.call(this)).id=r.id,i.model=r,i}return o(e,[{key:"getGeometry",value:function(t){return this.getGeometries().find(function(e){return e.id===t})}},{key:"getGeometries",value:function(){var t=this.getData().getGeometries().map(function(t){return t.getId()});return this.getDrawing().getVenue().getGeometries().filter(function(e){return-1!==t.indexOf(e.id)})}},{key:"getData",value:function(){return this.model}},{key:"getId",value:function(){return this.model.getId()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"getShortName",value:function(){return this.model.getShortName()}},{key:"getZIndex",value:function(){return this.model.getZIndex()}},{key:"isMain",value:function(){return this.model.isMain()}},{key:"getDrawing",value:function(){return this.getParentEventTarget()}},{key:"getVenue",value:function(){return this.getDrawing().getParentEventTarget()}}]),e}();function T(t,e,r,n){return function(t){var e=t.geometry,r=t.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)A(t,e);else if("Polygon"===r||"MultiLineString"===r)for(var n=0;n<e.length;n++)A(t,e[n]);else if("MultiPolygon"===r)for(n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++)A(t,e[n][i])}(n={id:void 0===t?null:t,type:e,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),n}function A(t,e){for(var r=0;r<e.length;r+=3)t.minX=Math.min(t.minX,e[r]),t.minY=Math.min(t.minY,e[r+1]),t.maxX=Math.max(t.maxX,e[r]),t.maxY=Math.max(t.maxY,e[r+1])}function k(t,e,r,n){if(e.geometry){var i=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],u=e.id;if(r.promoteId?u=e.properties[r.promoteId]:r.generateId&&(u=n||0),"Point"===o)S(i,s);else if("MultiPoint"===o)for(var l=0;l<i.length;l++)S(i[l],s);else if("LineString"===o)M(i,s,a,!1);else if("MultiLineString"===o){if(r.lineMetrics){for(l=0;l<i.length;l++)s=[],M(i[l],s,a,!1),t.push(T(u,"LineString",s,e.properties));return}O(i,s,a,!1)}else if("Polygon"===o)O(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"!==o)throw new Error("Input data is not a valid GeoJSON object.");for(l=0;l<e.geometry.geometries.length;l++)k(t,{id:u,geometry:e.geometry.geometries[l],properties:e.properties},r,n);return}for(l=0;l<i.length;l++){var c=[];O(i[l],c,a,!0),s.push(c)}}t.push(T(u,o,s,e.properties))}}function S(t,e){e.push(I(t[0])),e.push(L(t[1])),e.push(0)}function M(t,e,r,n){for(var i,o,a=0,s=0;s<t.length;s++){var u=I(t[s][0]),l=L(t[s][1]);e.push(u),e.push(l),e.push(0),0<s&&(a+=n?(i*l-u*o)/2:Math.sqrt(Math.pow(u-i,2)+Math.pow(l-o,2))),i=u,o=l}var c=e.length-3;e[2]=1,function t(e,r,n,i){for(var o,a=i,s=n-r>>1,u=n-r,l=e[r],c=e[r+1],h=e[n],f=e[n+1],p=r+3;p<n;p+=3){var d=function(t,e,r,n,i,o){var a,s=h-r,u=f-n;return 0===s&&0===u||(1<(a=((t-r)*s+(e-n)*u)/(s*s+u*u))?(r=h,n=f):0<a&&(r+=s*a,n+=u*a)),(s=t-r)*s+(u=e-n)*u}(e[p],e[p+1],l,c);a<d?(o=p,a=d):d!==a||(d=Math.abs(p-s))<u&&(o=p,u=d)}i<a&&(3<o-r&&t(e,r,o,i),e[o+2]=a,3<n-o&&t(e,o,n,i))}(e,0,c,r),e[2+c]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function O(t,e,r,n){for(var i=0;i<t.length;i++){var o=[];M(t[i],o,r,n),e.push(o)}}function I(t){return t/360+.5}function L(t){return t=Math.sin(t*Math.PI/180),(t=.5-.25*Math.log((1+t)/(1-t))/Math.PI)<0?0:1<t?1:t}function C(t,e,r,n,i,o,a,s){if(n/=e,(r/=e)<=o&&a<n)return t;if(a<r||n<=o)return null;for(var u=[],l=0;l<t.length;l++){var c=t[l],h=c.geometry,f=c.type,p=0===i?c.minX:c.minY,d=0===i?c.maxX:c.maxY;if(r<=p&&d<n)u.push(c);else if(!(d<r||n<=p)){var v=[];if("Point"===f||"MultiPoint"===f)!function(t,e,r,n,i){for(var o=0;o<t.length;o+=3){var a=t[o+i];r<=a&&a<=n&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}(h,v,r,n,i);else if("LineString"===f)R(h,v,r,n,i,!1,s.lineMetrics);else if("MultiLineString"===f)N(h,v,r,n,i,!1);else if("Polygon"===f)N(h,v,r,n,i,!0);else if("MultiPolygon"===f)for(var y=0;y<h.length;y++){var g=[];N(h[y],g,r,n,i,!0),g.length&&v.push(g)}if(v.length)if(s.lineMetrics&&"LineString"===f)for(y=0;y<v.length;y++)u.push(T(c.id,f,v[y],c.tags));else"LineString"!==f&&"MultiLineString"!==f||(1===v.length?(f="LineString",v=v[0]):f="MultiLineString"),"Point"!==f&&"MultiPoint"!==f||(f=3===v.length?"Point":"MultiPoint"),u.push(T(c.id,f,v,c.tags))}}return u.length?u:null}function R(t,e,r,n,i,o,a){for(var s,u,l=P(t),c=0===i?D:z,h=t.start,f=0;f<t.length-3;f+=3){var p=t[f],d=t[f+1],v=t[f+2],y=t[f+3],g=t[f+4],m=0===i?p:d,_=0===i?y:g,b=!1;a&&(s=Math.sqrt(Math.pow(p-y,2)+Math.pow(d-g,2))),m<r?r<_&&(u=c(l,p,d,y,g,r),a&&(l.start=h+s*u)):n<m?_<n&&(u=c(l,p,d,y,g,n),a&&(l.start=h+s*u)):j(l,p,d,v),_<r&&r<=m&&(u=c(l,p,d,y,g,r),b=!0),n<_&&m<=n&&(u=c(l,p,d,y,g,n),b=!0),!o&&b&&(a&&(l.end=h+s*u),e.push(l),l=P(t)),a&&(h+=s)}var x=t.length-3;p=t[x],d=t[1+x],v=t[2+x];r<=(m=0===i?p:d)&&m<=n&&j(l,p,d,v),x=l.length-3,o&&3<=x&&(l[x]!==l[0]||l[1+x]!==l[1])&&j(l,l[0],l[1],l[2]),l.length&&e.push(l)}function P(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function N(t,e,r,n,i,o){for(var a=0;a<t.length;a++)R(t[a],e,r,n,i,o,!1)}function j(t,e,r,n){t.push(e),t.push(r),t.push(n)}function D(t,e,r,n,i,o){return e=(o-e)/(n-e),t.push(o),t.push(r+(i-r)*e),t.push(1),e}function z(t,e,r,n,i,o){return r=(o-r)/(i-r),t.push(e+(n-e)*r),t.push(o),t.push(1),r}function F(t,e){for(var r=[],n=0;n<t.length;n++){var i,o=t[n],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)i=B(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){i=[];for(var s=0;s<o.geometry.length;s++)i.push(B(o.geometry[s],e))}else if("MultiPolygon"===a)for(i=[],s=0;s<o.geometry.length;s++){for(var u=[],l=0;l<o.geometry[s].length;l++)u.push(B(o.geometry[s][l],e));i.push(u)}r.push(T(o.id,a,i,o.tags))}return r}function B(t,e){var r=[];r.size=t.size,void 0!==t.start&&(r.start=t.start,r.end=t.end);for(var n=0;n<t.length;n+=3)r.push(t[n]+e,t[n+1],t[n+2]);return r}function U(t,e){if(t.transformed)return t;for(var r,n=1<<t.z,i=t.x,o=t.y,a=0;a<t.features.length;a++){var s=t.features[a],u=s.geometry,l=s.type;if(s.geometry=[],1===l)for(r=0;r<u.length;r+=2)s.geometry.push(G(u[r],u[r+1],e,n,i,o));else for(r=0;r<u.length;r++){for(var c=[],h=0;h<u[r].length;h+=2)c.push(G(u[r][h],u[r][h+1],e,n,i,o));s.geometry.push(c)}}return t.transformed=!0,t}function G(t,e,r,n,i,o){return[Math.round(r*(t*n-i)),Math.round(r*(e*n-o))]}function q(t,e,r,n,i){for(var o=e===i.maxZoom?0:i.tolerance/((1<<e)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,function(t,e,r,n){var i=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)V(a,i,t,r,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)V(a,i[s],t,r,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var u=0;u<i.length;u++){var l=i[u];for(s=0;s<l.length;s++)V(a,l[s],t,r,!0,0===s)}if(a.length){var c=e.tags||null;if("LineString"===o&&n.lineMetrics){for(var h in c={},e.tags)c[h]=e.tags[h];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}n={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c},null!==e.id&&(n.id=e.id),t.features.push(n)}}(a,t[s],o,i);var u=t[s].minX,l=t[s].minY,c=t[s].maxX,h=t[s].maxY;u<a.minX&&(a.minX=u),l<a.minY&&(a.minY=l),c>a.maxX&&(a.maxX=c),h>a.maxY&&(a.maxY=h)}return a}function V(t,e,r,n,i,o){var a=n*n;if(0<n&&e.size<(i?a:n))r.numPoints+=e.length/3;else{for(var s=[],u=0;u<e.length;u+=3)(0===n||e[u+2]>a)&&(r.numSimplified++,s.push(e[u]),s.push(e[u+1])),r.numPoints++;i&&function(t,e){for(var r=0,n=0,i=t.length,o=i-2;n<i;o=n,n+=2)r+=(t[n]-t[o])*(t[n+1]+t[o+1]);if(0<r===e)for(n=0,i=t.length;n<i/2;n+=2){var a=t[n],s=t[n+1];t[n]=t[i-2-n],t[n+1]=t[i-1-n],t[i-2-n]=a,t[i-1-n]=s}}(s,o),t.push(s)}}function W(t,e){var r=(e=this.options=function(t,e){for(var r in e)t[r]=e[r];return t}(Object.create(this.options),e)).debug;if(e.maxZoom<0||24<e.maxZoom)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var n,i,o,a,s=function(t,e){var r=[];if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)k(r,t.features[n],e,n);else"Feature"===t.type?k(r,t,e):k(r,{geometry:t},e);return r}(t,e);this.tiles={},this.tileCoords=[],r&&(this.stats={},this.total=0),t=C(a=n=s,1,-1-(o=(i=e).buffer/i.extent),o,0,-1,2,i),e=C(n,1,1-o,2+o,0,-1,2,i),(t||e)&&(a=C(n,1,-o,1+o,0,-1,2,i)||[],t&&(a=F(t,1).concat(a)),e&&(a=a.concat(F(e,-1)))),(s=a).length&&this.splitTile(s,0,0,0),r&&s.length}function Y(t,e,r){return 32*((1<<t)*r+e)+t}function K(t){for(var e,r=[],n=[],i=0,o=t.coordinates.length;i<o;i+=1){var a=t.coordinates[i],s=function(t){return 0<(t=function(t){for(var e=0,r=t.length,n=0;n<r-1;n+=1){var i=t[n],o=t[n+1];e+=i[0]*o[1]-o[0]*i[1]}return e+(t[r-1][0]*t[0][1]-t[0][0]*t[r-1][1])}(t))?at:t<0?st:void 0}(a);null!==s&&(s===(e=e||s)&&n.length&&(r.push(n),n=[]),n.push(a))}return 0<n.length&&r.push(n),1===r.length?(t.type=$,t.coordinates=r[0]):1<r.length?(t.type=Q,t.coordinates=r):t=null,t}function X(t,e,r,n,i){var o;return i=(o=r,r=n,n=i,e=1<<(i=e),(i=[])[0]=((t=t)[0]/n+o)/e,i[1]=(t[1]/n+r)/e,e=r={x:i[0],y:i[1]}).x,r=e.y,e=360*(i-.5),i=Math.exp(Math.PI*(.5-r)/.25)-1,r=Math.exp(Math.PI*(.5-r)/.25)+1,[e,180*Math.asin(i/r)/Math.PI]}W.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},W.prototype.splitTile=function(t,e,r,n,i,o,a){for(var s=[t,e,r,n],u=this.options,l=u.debug;s.length;){n=s.pop(),r=s.pop(),e=s.pop(),t=s.pop();var c,h,f,p,d,v,y,g,m=1<<e,_=Y(e,r,n),b=this.tiles[_];if(b||(b=this.tiles[_]=q(t,e,r,n,u),this.tileCoords.push({z:e,x:r,y:n}),l&&(g="z"+e,this.stats[g]=(this.stats[g]||0)+1,this.total++)),b.source=t,i){if(e===u.maxZoom||e===i)continue;var x=1<<i-e;if(r!==Math.floor(o/x)||n!==Math.floor(a/x))continue}else if(e===u.indexMaxZoom||b.numPoints<=u.indexMaxPoints)continue;b.source=null,0!==t.length&&(h=.5-(c=.5*u.buffer/u.extent),f=1+c,y=p=d=v=null,g=C(t,m,r-c,r+(_=.5+c),0,b.minX,b.maxX,u),x=C(t,m,r+h,r+f,0,b.minX,b.maxX,u),t=null,g&&(y=C(g,m,n-c,n+_,1,b.minY,b.maxY,u),p=C(g,m,n+h,n+f,1,b.minY,b.maxY,u),g=null),x&&(d=C(x,m,n-c,n+_,1,b.minY,b.maxY,u),v=C(x,m,n+h,n+f,1,b.minY,b.maxY,u),x=null),s.push(y||[],e+1,2*r,2*n),s.push(p||[],e+1,2*r,2*n+1),s.push(d||[],e+1,2*r+1,2*n),s.push(v||[],e+1,2*r+1,2*n+1))}},W.prototype.getTile=function(t,e,r){var n=this.options,i=n.extent;if(n.debug,t<0||24<t)return null;if(n=Y(t,e=(e%(n=1<<t)+n)%n,r),this.tiles[n])return U(this.tiles[n],i);for(var o,a=t,s=e,u=r;!o&&0<a;)a--,s=Math.floor(s/2),u=Math.floor(u/2),o=this.tiles[Y(a,s,u)];return o&&o.source?(this.splitTile(o.source,a,s,u,t,e,r),this.tiles[n]?U(this.tiles[n],i):null):null};var Z="Point",$="Polygon",J="MultiLineString",Q="MultiPolygon",tt="#e0e0e0",et="#829DB4",rt=1,nt=13,it={fillColor:"#F2F285",outlineColor:"#0088BF",outlineWidth:1.2},ot={FOOTPRINT:"FOOTPRINT",ICON:"ICON",TEXT:"TEXT",VECTOR:"VECTOR"},at="CW",st="CCW";function ut(t){var e=void 0===(o=t.addressList)?[]:o,r=void 0===(i=t.geometries)?[]:i,i=void 0===(o=t.entity)?null:o,o=void 0===(o=t.name)?"":o;t=void 0===(t=t.icon)?"":t;n(this,ut),this.addressList=e,this.geometries=r,this.icon=t,this.entity=i,this.name=o}var lt,ct,ht=((lt={exports:{}}).exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==r(t)&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){function i(t){return(i="function"==typeof Symbol&&"symbol"==r(Symbol.iterator)?function(t){return r(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":r(t)})(t)}var o=n(1),a=(n=n(7)).get,s=(n.deepValue,n.isArray);function u(t,e){var r=void 0===(f=e.location)?0:f,n=void 0===(b=e.distance)?100:b,i=void 0===(p=e.threshold)?.6:p,o=void 0===(g=e.maxPatternLength)?32:g,s=void 0!==(d=e.caseSensitive)&&d,l=void 0===(_=e.tokenSeparator)?/ +/g:_,c=void 0!==(v=e.findAllMatches)&&v,h=void 0===(m=e.minMatchCharLength)?1:m,f=void 0===(y=e.id)?null:y,p=void 0===(b=e.keys)?[]:b,d=void 0===(g=e.shouldSort)||g,v=void 0===(_=e.getFn)?a:_,y=void 0===(m=e.sortFn)?function(t,e){return t.score-e.score}:m,g=void 0!==(b=e.tokenize)&&b,m=void 0!==(_=e.matchAllTokens)&&_,_=void 0!==(b=e.includeMatches)&&b,b=void 0!==(b=e.includeScore)&&b;e=void 0!==(e=e.verbose)&&e,function(t){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}(this),this.options={location:r,distance:n,threshold:i,maxPatternLength:o,isCaseSensitive:s,tokenSeparator:l,findAllMatches:c,minMatchCharLength:h,id:f,keys:p,includeMatches:_,includeScore:b,shouldSort:d,getFn:v,sortFn:y,verbose:e,tokenize:g,matchAllTokens:m},this.setCollection(t),this._processKeys(p)}(function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}})(u.prototype,[{key:"setCollection",value:function(t){return this.list=t}},{key:"_processKeys",value:function(t){if(this._keyWeights={},this._keyNames=[],t.length&&"string"==typeof t[0])for(var e=0,r=t.length;e<r;e+=1){var n=t[e];this._keyWeights[n]=1,this._keyNames.push(n)}else{for(var i=0,o=0,a=t.length;o<a;o+=1){var s=t[o];if(!s.hasOwnProperty("name"))throw new Error('Missing "name" property in key object');var u=s.name;if(this._keyNames.push(u),!s.hasOwnProperty("weight"))throw new Error('Missing "weight" property in key object');if((s=s.weight)<0||1<s)throw new Error('"weight" property in key must bein the range of [0, 1)');i+=this._keyWeights[u]=s}if(1<i)throw new Error("Total of weights cannot exceed 1")}}},{key:"search",value:function(t,e){var r=1<arguments.length&&void 0!==e?e:{limit:!1};return this._log('---------\nSearch pattern: "'.concat(t,'"')),t=(e=this._prepareSearchers(t)).tokenSearchers,e=e.fullSearcher,e=this._search(t,e),this._computeScore(e),this.options.shouldSort&&this._sort(e),r.limit&&"number"==typeof r.limit&&(e=e.slice(0,r.limit)),this._format(e)}},{key:"_prepareSearchers",value:function(t){t=0<arguments.length&&void 0!==t?t:"";var e=[];if(this.options.tokenize)for(var r=t.split(this.options.tokenSeparator),n=0,i=r.length;n<i;n+=1)e.push(new o(r[n],this.options));return{tokenSearchers:e,fullSearcher:new o(t,this.options)}}},{key:"_search",value:function(t,e){var r=0<arguments.length&&void 0!==t?t:[],n=1<arguments.length?e:void 0,i=this.list,o={},a=[];if("string"==typeof i[0]){for(var s=0,u=i.length;s<u;s+=1)this._analyze({key:"",value:i[s],record:s,index:s},{resultMap:o,results:a,tokenSearchers:r,fullSearcher:n});return a}for(var l=0,c=i.length;l<c;l+=1)for(var h=i[l],f=0,p=this._keyNames.length;f<p;f+=1){var d=this._keyNames[f];this._analyze({key:d,value:this.options.getFn(h,d),record:h,index:l},{resultMap:o,results:a,tokenSearchers:r,fullSearcher:n})}return a}},{key:"_analyze",value:function(t,e){var r=this,n=t.key,i=void 0===(u=t.arrayIndex)?-1:u,o=t.value,a=t.record,u=t.index,l=void 0===(t=e.tokenSearchers)?[]:t,c=e.fullSearcher,h=void 0===(t=e.resultMap)?{}:t,f=void 0===(e=e.results)?[]:e;!function t(e,i,o,a){if(null!=i)if("string"==typeof i){var u=!1,p=-1,d=0;r._log("\nKey: ".concat(""===n?"--":n));var v=c.search(i);if(r._log('Full text: "'.concat(i,'", score: ').concat(v.score)),r.options.tokenize){for(var y=i.split(r.options.tokenSeparator),g=y.length,m=[],_=0,b=l.length;_<b;_+=1){var x=l[_];r._log('\nPattern: "'.concat(x.pattern,'"'));for(var w=!1,E=0;E<g;E+=1){var T=y[E],A=x.search(T),k={};A.isMatch?(k[T]=A.score,w=u=!0,m.push(A.score)):(k[T]=1,r.options.matchAllTokens||m.push(1)),r._log('Token: "'.concat(T,'", score: ').concat(k[T]))}w&&(d+=1)}p=m[0];for(var S=m.length,M=1;M<S;M+=1)p+=m[M];p/=S,r._log("Token score average:",p)}var O=v.score;-1<p&&(O=(O+p)/2),r._log("Score average:",O);var I=!r.options.tokenize||!r.options.matchAllTokens||d>=l.length;r._log("\nCheck Matches: ".concat(I)),(u||v.isMatch)&&I&&(O={key:n,arrayIndex:e,value:i,score:O},r.options.includeMatches&&(O.matchedIndices=v.matchedIndices),(v=h[a])?v.output.push(O):(h[a]={item:o,output:[O]},f.push(h[a])))}else if(s(i))for(var L=0,C=i.length;L<C;L+=1)t(L,i[L],o,a)}(i,o,a,u)}},{key:"_computeScore",value:function(t){this._log("\n\nComputing score:\n");for(var e=this._keyWeights,r=!!Object.keys(e).length,n=0,i=t.length;n<i;n+=1){for(var o=t[n],a=o.output,s=a.length,u=1,l=0;l<s;l+=1){var c=(f=a[l]).key,h=r?e[c]:1,f=0===f.score&&e&&0<e[c]?Number.EPSILON:f.score;u*=Math.pow(f,h)}o.score=u,this._log(o)}}},{key:"_sort",value:function(t){this._log("\n\nSorting...."),t.sort(this.options.sortFn)}},{key:"_format",value:function(t){var e,r=[];this.options.verbose&&(e=[],this._log("\n\nOutput:\n\n",JSON.stringify(t,function(t,r){if("object"===i(r)&&null!==r){if(-1!==e.indexOf(r))return;e.push(r)}return r},2)),e=null);var n=[];this.options.includeMatches&&n.push(function(t,e){var r=t.output;e.matches=[];for(var n=0,i=r.length;n<i;n+=1){var o,a=r[n];0!==a.matchedIndices.length&&(o={indices:a.matchedIndices,value:a.value},a.key&&(o.key=a.key),a.hasOwnProperty("arrayIndex")&&-1<a.arrayIndex&&(o.arrayIndex=a.arrayIndex),e.matches.push(o))}}),this.options.includeScore&&n.push(function(t,e){e.score=t.score});for(var o=0,a=t.length;o<a;o+=1){var s=t[o];if(this.options.id&&(s.item=this.options.getFn(s.item,this.options.id)[0]),n.length){for(var u={item:s.item},l=0,c=n.length;l<c;l+=1)n[l](s,u);r.push(u)}else r.push(s.item)}return r}},{key:"_log",value:function(){var t;this.options.verbose&&(t=console).log.apply(t,arguments)}}]),n=u,t.exports=n},function(t,e,r){var n=r(2),i=r(3),o=r(6);function a(t,e){var r=void 0===(h=e.location)?0:h,n=void 0===(u=e.distance)?100:u,i=void 0===(c=e.threshold)?.6:c,s=void 0===(l=e.maxPatternLength)?32:l,u=void 0!==(h=e.isCaseSensitive)&&h,l=void 0===(c=e.tokenSeparator)?/ +/g:c,c=void 0!==(h=e.findAllMatches)&&h,h=void 0===(h=e.minMatchCharLength)?1:h;e=void 0!==(e=e.includeMatches)&&e,function(t){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}(this),this.options={location:r,distance:n,threshold:i,maxPatternLength:s,isCaseSensitive:u,tokenSeparator:l,findAllMatches:c,includeMatches:e,minMatchCharLength:h},this.pattern=u?t:t.toLowerCase(),this.pattern.length<=s&&(this.patternAlphabet=o(this.pattern))}(function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}})(a.prototype,[{key:"search",value:function(t){var e=(u=this.options).isCaseSensitive,r=u.includeMatches;if(e||(t=t.toLowerCase()),this.pattern===t){var o={isMatch:!0,score:0};return r&&(o.matchedIndices=[[0,t.length-1]]),o}var a=this.options,s=a.maxPatternLength,u=a.tokenSeparator;return this.pattern.length>s?n(t,this.pattern,u):(o=(e=this.options).location,a=e.distance,s=e.threshold,u=e.findAllMatches,e=e.minMatchCharLength,i(t,this.pattern,this.patternAlphabet,{location:o,distance:a,threshold:s,findAllMatches:u,minMatchCharLength:e,includeMatches:r}))}}]),r=a,t.exports=r},function(t,e){var r=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;t.exports=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:/ +/g,i=(n=new RegExp(e.replace(r,"\\$&").replace(n,"|")),t.match(n)),o=[];if(n=!!i)for(var a=0,s=i.length;a<s;a+=1){var u=i[a];o.push([t.indexOf(u),u.length-1])}return{score:n?.5:1,isMatch:n,matchedIndices:o}}},function(t,e,r){var n=r(4),i=r(5);t.exports=function(t,e,r,o){for(var a=void 0===(c=o.location)?0:c,s=void 0===(u=o.distance)?100:u,u=void 0===(c=o.threshold)?.6:c,l=void 0!==(c=o.findAllMatches)&&c,c=void 0===(c=o.minMatchCharLength)?1:c,h=(o=void 0!==(o=o.includeMatches)&&o,a),f=t.length,p=u,d=t.indexOf(e,h),v=e.length,y=[],g=0;g<f;g+=1)y[g]=0;-1!==d&&(u=n(e,{errors:0,currentLocation:d,expectedLocation:h,distance:s}),p=Math.min(u,p),-1!==(d=t.lastIndexOf(e,h+v))&&(L=n(e,{errors:0,currentLocation:d,expectedLocation:h,distance:s}),p=Math.min(L,p))),d=-1;for(var m=[],_=1,b=v+f,x=1<<(v<=31?v-1:30),w=0;w<v;w+=1){for(var E=0,T=b;E<T;)n(e,{errors:w,currentLocation:h+T,expectedLocation:h,distance:s})<=p?E=T:b=T,T=Math.floor((b-E)/2+E);b=T;var A=Math.max(1,h-T+1),k=l?f:Math.min(h+T,f)+v,S=Array(k+2);S[k+1]=(1<<w)-1;for(var M=k;A<=M;--M){var O=M-1,I=r[t.charAt(O)];if(I&&(y[O]=1),S[M]=(S[M+1]<<1|1)&I,0!==w&&(S[M]|=(m[M+1]|m[M])<<1|1|m[M+1]),S[M]&x&&(_=n(e,{errors:w,currentLocation:O,expectedLocation:h,distance:s}))<=p){if(p=_,(d=O)<=h)break;A=Math.max(1,2*h-d)}}if(n(e,{errors:w+1,currentLocation:h,expectedLocation:h,distance:s})>p)break;m=S}var L={isMatch:0<=d,score:0===_?.001:_};return o&&(L.matchedIndices=i(y,c)),L}},function(t,e){t.exports=function(t,e){var r=void 0===(n=e.errors)?0:n,n=void 0===(i=e.currentLocation)?0:i,i=void 0===(i=e.expectedLocation)?0:i;return e=void 0===(e=e.distance)?100:e,t=r/t.length,n=Math.abs(i-n),e?t+n/e:n?1:t}},function(t,e){t.exports=function(){for(var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=[],i=-1,o=0,a=e.length;o<a;o+=1){var s=e[o];s&&-1===i?i=o:s||-1===i||((t=o-1)-i+1>=r&&n.push([i,t]),i=-1)}return e[o-1]&&r<=o-i&&n.push([i,o-1]),n}},function(t,e){t.exports=function(t){for(var e={},r=t.length,n=0;n<r;n+=1)e[t.charAt(n)]=0;for(var i=0;i<r;i+=1)e[t.charAt(i)]|=1<<r-i-1;return e}},function(t,e){function r(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}function n(t){return null==t?"":function(){if("string"==typeof t)return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}()}function i(t){return"string"==typeof t}function o(t){return"number"==typeof t}t.exports={get:function(t,e){var a=[];return function t(e,s){if(s){var u=s.indexOf("."),l=s,c=null;-1!==u&&(l=s.slice(0,u),c=s.slice(u+1));var h=e[l];if(null!=h)if(c||!i(h)&&!o(h))if(r(h))for(var f=0,p=h.length;f<p;f+=1)t(h[f],c);else c&&t(h,c);else a.push(n(h))}else a.push(e)}(t,e),a},isArray:r,isString:i,isNum:o,toString:n}}]),lt.exports),ft=(ct=ht)&&ct.__esModule&&Object.prototype.hasOwnProperty.call(ct,"default")?ct.default:ct,pt=(ht.Fuse,{keys:[{name:"name",weight:.6},{name:"addressList",weight:.4}],threshold:.2}),dt=function(){function t(e){n(this,t),this.fuseSearch=null,this.levels_=null,this.searchListEntities_=[],this.searchListIcons_=[],this.searchList_=[],this.venueModel=e,this.init()}return o(t,[{key:"init",value:function(){var t=this.venueModel.getGeometries().reduce(function(t,e){return t[e.getId()]=e,t},{});this.initEntityList(this.venueModel.entities),this.initIconList(t),this.levels_=this.venueModel.getLevels().map(function(t){return{levelId:t.getId(),levelName:t.getName(),drawingId:t.getDrawing().getId(),drawingName:t.getDrawing().getName()}}),t=[].concat(m(this.searchListEntities_),m(this.searchListIcons_)),this.searchList_=t.sort(function(t,e){return t.name.localeCompare(e.name)}),this.fuseSearch_=new ft(this.searchList_,pt)}},{key:"initEntityList",value:function(t){t=(0<arguments.length&&void 0!==t?t:[]).map(function(t){return new ut({geometries:t.getGeometries(),addressList:t.getInternalAddress()||[],name:t.getName()||"",entity:t})}),this.searchListEntities_=t}},{key:"initIconList",value:function(t){t=0<arguments.length&&void 0!==t?t:{},this.searchListIcons_=Object.values(t).filter(function(t){return t.getIcon()}).map(function(t){var e=t.getIcon();return new ut({geometries:[t],icon:e.getSVG(),name:e.ar||""})})}},{key:"all",value:function(){return this.searchList_}},{key:"allIconTypes",value:function(){var t=this.searchListIcons_.reduce(function(t,e){return t[e.name]=e.name,t},{});return Object.keys(t)}},{key:"find",value:function(t){return""===(t=0<arguments.length&&void 0!==t?t:"")?this.searchList_:this.fuseSearch_.search(t)}},{key:"groupByLevel",value:function(t){var e=0<arguments.length&&void 0!==t?t:this.searchList_;return this.levels_?m(this.levels_.flatMap(function(t){return u(u({},t),{},{results:e.filter(function(e){return r=t,0<(e=e).geometries.length&&e.geometries.find(function(t){return Number(t.getLevel().getId())===Number(r.levelId)});var r})})})):[]}}]),t}(),vt="LineString",yt="Polygon",gt="MultiPoint",mt="MultiLineString",_t="MultiPolygon",bt=Object.freeze({STANDARD:"STANDARD",FLATTEN:"FLATTEN",OUTDOOR_MAIN:"OUTDOOR_MAIN",INDOOR_MAIN:"INDOOR_MAIN",NO_OUTDOORS:"NO_OUTDOORS",FLATTEN_INDOOR_MAIN:"FLATTEN_INDOOR_MAIN",FLATTEN_OUTDOOR_COPY:"FLATTEN_OUTDOOR_COPY"}),xt=Object.freeze({THEME:"THEME",THEME_MAP:"THEME_MAP",PRESETS:"PRESETS",SDK_STRINGS:"SDK_STRINGS",ICON_FILE:"ICON_FILE",INPUT_COLORS:"INPUT_COLORS",BASE_MAP_INFO:"BASE_MAP_INFO",CONFIG_PROFILE:"CONFIG_PROFILE",NAV_THEME:"NAV_THEME",NAV_NAME_THEME:"NAV_NAME_THEME",NAV_PROP_MAP:"NAV_PROP_MAP",NAV_STRINGS:"NAV_STRINGS",NAV_THEME_MAP:"NAV_THEME_MAP",NAV_NAME_THEME_MAP:"NAV_NAME_THEME_MAP",V4_THEME_FAMILY:"V4_THEME_FAMILY",V4_MAPTYPE_THEME:"V4_MAPTYPE_THEME",ICON:"ICON",MARKER:"MARKER",PERMISSIONS:"PERMISSIONS",NAICS_ARRAY:"NAICS_ARRAY",NAICS_MAP:"NAICS_MAP"}),wt=Object.freeze((a(Te={},xt.THEME,"themeUrls"),a(Te,xt.THEME_MAP,"themeMapUrl"),a(Te,xt.PRESETS,"presetsUrl"),a(Te,xt.SDK_STRINGS,"stringsUrl"),Te)),Et=Object.freeze((a(Ne={},xt.THEME,"themeOverrides"),a(Ne,xt.THEME_MAP,"themeMapOverrides"),a(Ne,xt.PRESETS,"presetOverrides"),a(Ne,xt.SDK_STRINGS,"stringsOverrides"),a(Ne,xt.INPUT_COLORS,"inputColorOverrides"),Ne)),Tt=(Object.freeze((a(kt={},xt.THEME,["Modern","Standard","Factory","Navteq","TheBase","Westfield_noLabels","Westfield","TDM_noLabel"]),a(kt,xt.SDK_STRINGS,["Standard","SDK","sdk/standard"]),a(kt,xt.V4_THEME_FAMILY,["modern","standard"]),a(kt,xt.V4_MAPTYPE_THEME,["Airport Terminal","Airport","Casino","College Building","College Campus","Convention","General","Hospital","Outdoor","Retail","School Building","School Campus","Shopping Mall","Traffic","Train Station"]),a(kt,xt.NAV_THEME,["Factory","MapEditor"]),a(kt,xt.ICON,["Multicolor","Standard","TheBase","Factory"]),kt)),Object.freeze((a(Te={},xt.THEME,"Modern"),a(Te,xt.THEME_MAP,"Standard"),a(Te,xt.PRESETS,"Standard"),a(Te,xt.SDK_STRINGS,"Standard"),a(Te,xt.ICON_FILE,"Standard"),a(Te,xt.INPUT_COLORS,"Standard"),a(Te,xt.BASE_MAP_INFO,"Standard"),a(Te,xt.CONFIG_PROFILE,"factory"),a(Te,xt.NAV_THEME,"Factory"),a(Te,xt.NAV_NAME_THEME,"FactoryName"),a(Te,xt.NAV_PROP_MAP,"Standard"),a(Te,xt.NAV_STRINGS,"Standard"),a(Te,xt.NAV_THEME_MAP,"Standard"),a(Te,xt.NAV_NAME_THEME_MAP,"StandardName"),a(Te,xt.V4_THEME_FAMILY,"Standard"),a(Te,xt.V4_MAPTYPE_THEME,"Standard"),a(Te,xt.ICON,"Multicolor"),a(Te,xt.MARKER,"Standard"),Te))),At=Object.freeze({GEO_JSON:"GEO_JSON",V5_MAP:"V5_MAP",V5_NAV:"V5_NAV",V5_INFO:"V5_INFO",KML:"KML",SVG:"SVG",PNG:"PNG"}),kt=Object.freeze((a(Ne={},At.V5_MAP,{COMMUNITY_MAP:"COMMUNITY_MAP",COMMUNITY_DIRECTORY:"COMMUNITY_DIRECTORY",COMMUNITY_DETAIL:"COMMUNITY_DETAIL",LEVEL_GEOMETRY:"LEVEL_GEOMETRY",DRAWING_ENTITY:"DRAWING_ENTITY"}),a(Ne,At.GEO_JSON,{COMMUNITY_MAP:"COMMUNITY_MAP",COMMUNITY_ENTITY:"COMMUNITY_ENTITY",PATH_LEVEL_GEOMETRY:"PATH_LEVEL_GEOMETRY",GEOJSON_LEVEL_GEOMETRY:"GEOJSON_LEVEL_GEOMETRY"}),a(Ne,At.V5_NAV,{JSON_NAV:"JSON_NAV",BINARY_NAV:"BINARY_NAV",JSON_ENHANCED_NAV:"JSON_ENHANCED_NAV",BINARY_ENHANCED_NAV:"BINARY_ENHANCED_NAV"}),a(Ne,At.V5_INFO,{GEOMETRY_INFO:"GEOMETRY_INFO"}),a(Ne,At.SVG,{PLAIN:"PLAIN",PRETTY:"PRETTY",PRETTY_HORIZONTAL_LABEL:"PRETTY_HORIZONTAL_LABEL"}),a(Ne,At.KML,{RASTER:"RASTER",VECTOR:"VECTOR",RASTER_HORIZONTAL:"RASTER_HORIZONTAL",VECTOR_HORIZONTAL:"VECTOR_HORIZONTAL"}),a(Ne,At.PNG,{LOW_RESOLUTION:"LOW_RESOLUTION",HIGH_RESOLUTION:"HIGH_RESOLUTION",LOW_RESOLUTION_GEO:"LOW_RESOLUTION_GEO",HIGH_RESOLUTION_GEO:"HIGH_RESOLUTION_GEO",LOW_RESOLUTION_HORIZONTAL:"LOW_RESOLUTION_HORIZONTAL",HIGH_RESOLUTION_HORIZONTAL:"HIGH_RESOLUTION_HORIZONTAL",LOW_RESOLUTION_HORIZONTAL_GEO:"LOW_RESOLUTION_HORIZONTAL_GEO",HIGH_RESOLUTION_HORIZONTAL_GEO:"HIGH_RESOLUTION_HORIZONTAL_GEO"}),Ne));function St(){}function Mt(){Mt.init.call(this)}function Ot(t){return void 0===t._maxListeners?Mt.defaultMaxListeners:t._maxListeners}function It(t,e,r,n){var i,o;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');return(i=t._events)?(i.newListener&&(t.emit("newListener",e,r.listener||r),i=t._events),o=i[e]):(i=t._events=new St,t._eventsCount=0),o?("function"==typeof o?o=i[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),o.warned||(n=Ot(t))&&0<n&&o.length>n&&(o.warned=!0,(n=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",n.emitter=t,n.type=e,n.count=o.length,console.warn)):(o=i[e]=r,++t._eventsCount),t}function Lt(t,e,r){var n=!1;function i(){t.removeListener(e,i),n||(n=!0,r.apply(t,arguments))}return i.listener=r,i}function Ct(t){var e=this._events;if(e){if("function"==typeof(t=e[t]))return 1;if(t)return t.length}return 0}function Rt(t,e){for(var r=new Array(e);e--;)r[e]=t[e];return r}St.prototype=Object.create(null),(Mt.EventEmitter=Mt).usingDomains=!1,Mt.prototype.domain=void 0,Mt.prototype._events=void 0,Mt.prototype._maxListeners=void 0,Mt.defaultMaxListeners=10,Mt.init=function(){this.domain=null,Mt.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new St,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Mt.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},Mt.prototype.getMaxListeners=function(){return Ot(this)},Mt.prototype.emit=function(t,e,r,n){var i,o,a,s="error"===t,u=this._events;if(u)s=s&&null==u.error;else if(!s)return!1;if(l=this.domain,s){if(s=e,l)return(s=s||new Error('Uncaught, unspecified "error" event')).domainEmitter=this,s.domain=l,s.domainThrown=!1,l.emit("error",s),!1;if(s instanceof Error)throw s;var l=new Error('Uncaught, unspecified "error" event. ('+s+")");throw l.context=s,l}if(!(i=u[t]))return!1;var c,h="function"==typeof i;switch(c=arguments.length){case 1:!function(t,e,r){if(h)t.call(r);else for(var n=t.length,i=Rt(t,n),o=0;o<n;++o)i[o].call(r)}(i,0,this);break;case 2:!function(t,e,r,n){if(h)t.call(r,n);else for(var i=t.length,o=Rt(t,i),a=0;a<i;++a)o[a].call(r,n)}(i,0,this,e);break;case 3:!function(t,e,r,n,i){if(h)t.call(r,n,i);else for(var o=t.length,a=Rt(t,o),s=0;s<o;++s)a[s].call(r,n,i)}(i,0,this,e,r);break;case 4:!function(t,e,r,n,i,o){if(h)t.call(r,n,i,o);else for(var a=t.length,s=Rt(t,a),u=0;u<a;++u)s[u].call(r,n,i,o)}(i,0,this,e,r,n);break;default:for(o=new Array(c-1),a=1;a<c;a++)o[a-1]=arguments[a];!function(t,e,r,n){if(h)t.apply(r,n);else for(var i=t.length,o=Rt(t,i),a=0;a<i;++a)o[a].apply(r,n)}(i,0,this,o)}return!0},Mt.prototype.addListener=function(t,e){return It(this,t,e,!1)},Mt.prototype.on=Mt.prototype.addListener,Mt.prototype.prependListener=function(t,e){return It(this,t,e,!0)},Mt.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,Lt(this,t,e)),this},Mt.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,Lt(this,t,e)),this},Mt.prototype.removeListener=function(t,e){var r,n,i,o,a;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[t]))return this;if(r===e||r.listener&&r.listener===e)0==--this._eventsCount?this._events=new St:(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,o=r.length;0<o--;)if(r[o]===e||r[o].listener&&r[o].listener===e){a=r[o].listener,i=o;break}if(i<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new St,this;delete n[t]}else!function(t,e){for(var r=e,n=r+1,i=t.length;n<i;r+=1,n+=1)t[r]=t[n];t.pop()}(r,i);n.removeListener&&this.emit("removeListener",t,a||e)}return this},Mt.prototype.removeAllListeners=function(t){var e,r=this._events;if(!r)return this;if(!r.removeListener)return 0===arguments.length?(this._events=new St,this._eventsCount=0):r[t]&&(0==--this._eventsCount?this._events=new St:delete r[t]),this;if(0===arguments.length){for(var n,i=Object.keys(r),o=0;o<i.length;++o)"removeListener"!==(n=i[o])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new St,this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(e)for(;this.removeListener(t,e[e.length-1]),e[0];);return this},Mt.prototype.listeners=function(t){var e=this._events,r=e&&(r=e[t])?"function"==typeof r?[r.listener||r]:function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(r):[];return r},Mt.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):Ct.call(t,e)},Mt.prototype.listenerCount=Ct,Mt.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};var Pt="venues-ui-button--active",Nt="venues-ui-button",jt="venues-ui__drawings",Dt="data-drawing",zt=function(){function t(e,r,i){var o=this;n(this,t),this.clickHandler=i,this.containerDiv=document.createElement("div"),this.containerDiv.setAttribute("class",jt);var a=document.createElement("div");a.setAttribute("class","trigger ".concat(Nt)),(i=document.createElement("div")).setAttribute("class","arrow arrow--down"),a.appendChild(i),a.addEventListener("click",function(){a.classList.toggle(Pt),o.containerButtons.classList.toggle("drawings--open")}),this.containerDiv.appendChild(a),this.containerButtons=document.createElement("div"),this.containerButtons.setAttribute("class","drawings"),this.containerDiv.appendChild(this.containerButtons),r&&this.update(r),e.appendChild(this.containerDiv)}return o(t,[{key:"drawButton",value:function(t,e,r){var n=this,i=document.createElement("div");r=Number(r)===Number(t);i.setAttribute("class",r?"".concat(Nt," ").concat(Pt):Nt),i.innerHTML=e,i.setAttribute(Dt,t),i.addEventListener("click",function(){n.switch(t),n.clickHandler(t)}),this.containerButtons.appendChild(i)}},{key:"switch",value:function(t){this.containerButtons.querySelectorAll(".".concat(jt," .").concat(Pt)).forEach(function(t){return t.setAttribute("class",Nt)}),(t=this.containerButtons.querySelector("[".concat(Dt,"='").concat(t,"']")))&&t.setAttribute("class","".concat(Nt," ").concat(Pt))}},{key:"update",value:function(t){var e=this;this.containerButtons.innerHTML="";var r=function(t){return t=t.getDrawings(),new Map(t.map(function(t){var e=t.getDisplayName()||t.getName();return[t.getId(),e]}))}(t);0<r.size&&r.forEach(function(r,n){return e.drawButton(n,r,t.getRootDrawing().getId())})}}]),t}(),Ht="venues-ui-button--active",Ft="venues-ui-button",Bt="levels",Ut="data-level",Gt="venues-ui__levels",qt=4,Vt=function(){function t(e,r,i,o){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:qt;n(this,t),this.clickHandler=o,this.levelButtonCount=a,this.currentScrollIndex=0,this.containerUI=document.createElement("div"),this.containerUI.setAttribute("class","".concat(Gt)),this.containerButtons=document.createElement("div"),this.containerButtons.setAttribute("class",Bt),this.containerUI.appendChild(this.containerButtons),r&&this.update(r,i),e.appendChild(this.containerUI)}return o(t,[{key:"clear",value:function(){this.containerButtons.innerHTML="",this.buttonScrollUp&&(this.containerUI.removeChild(this.buttonScrollUp),this.buttonScrollUp=null),this.buttonScrollDown&&(this.containerUI.removeChild(this.buttonScrollDown),this.buttonScrollDown=null)}},{key:"drawLevelButton",value:function(t,e){var r=this,n=document.createElement("div");n.innerHTML=e,n.style.fontSize="".concat(Math.max(Math.min(28.8/e.length,11.52),10),"px"),n.style.display="block",n.setAttribute("class",Ft),n.setAttribute(Ut,t),n.addEventListener("click",function(){r.switch(t),r.clickHandler(t)}),this.containerButtons.appendChild(n)}},{key:"drawScrollButtons",value:function(){var t=this;this.buttonScrollUp=document.createElement("div"),this.buttonScrollUp.setAttribute("class","".concat(Ft," ").concat(Ft,"--up"));var e=document.createElement("div");e.setAttribute("class","arrow arrow--up"),this.buttonScrollUp.appendChild(e),this.buttonScrollUp.addEventListener("click",function(){return t.scroll(1)}),this.containerUI.insertBefore(this.buttonScrollUp,this.containerButtons),this.buttonScrollDown=document.createElement("div"),this.buttonScrollDown.setAttribute("class","".concat(Ft," ").concat(Ft,"--down")),(e=document.createElement("div")).setAttribute("class","arrow arrow--down"),this.buttonScrollDown.appendChild(e),this.buttonScrollDown.addEventListener("click",function(){return t.scroll(-1)}),this.containerUI.appendChild(this.buttonScrollDown)}},{key:"scroll",value:function(t){var e,r=0<arguments.length&&void 0!==t?t:0,n=Array.from(this.containerButtons.querySelectorAll(".".concat(Ft))).reverse(),i=[];0<=r?(this.currentScrollIndex=Math.min(this.currentScrollIndex+r,n.length-this.levelButtonCount),t=Math.min(this.currentScrollIndex,n.length-this.levelButtonCount),e=Math.min(this.currentScrollIndex+this.levelButtonCount,n.length),i=n.slice(t,e)):r<0&&(this.currentScrollIndex=Math.max(this.currentScrollIndex+r,0),e=Math.max(0,this.currentScrollIndex),r=Math.min(n.length,this.currentScrollIndex+this.levelButtonCount),i=n.slice(e,r)),n.forEach(function(t){-1!==i.indexOf(t)?t.style.display="block":t.style.display="none"}),this.buttonScrollDown&&(0===this.currentScrollIndex?this.buttonScrollDown.setAttribute("disabled","disabled"):this.buttonScrollDown.removeAttribute("disabled")),this.buttonScrollUp&&(this.currentScrollIndex===n.length-this.levelButtonCount?this.buttonScrollUp.setAttribute("disabled","disabled"):this.buttonScrollUp.removeAttribute("disabled"))}},{key:"switch",value:function(t){this.containerButtons.querySelectorAll(".".concat(Ht)).forEach(function(t){return t.setAttribute("class",Ft)});var e=this.containerButtons.querySelector(".".concat(Gt," [").concat(Ut,"='").concat(t,"']"));e&&(t=Array.from(this.containerButtons.querySelectorAll(".".concat(Ft))).reverse(),e.setAttribute("class","".concat(Ft," ").concat(Ht)),((e=t.indexOf(e))<this.currentScrollIndex||e>=this.currentScrollIndex+qt)&&this.scroll(e-this.currentScrollIndex))}},{key:"update",value:function(t,e){var r=this,n=(e=function(t){return new Map((0<arguments.length&&void 0!==t?t:[]).map(function(t){return[t.getZIndex(),t.getShortName()||t.getDisplayName()||t.getName()]}))}(function(t,e){return e!==bt.FLATTEN?t.getLevels():(t=t.getVenueModel().getLevelMapFlattenedByZIndex_(),Object.values(t).map(function(t){return t[0]}))}(t,e).sort(function(t,e){return e.getZIndex()-t.getZIndex()})),t.getMainLevel().getZIndex());this.clear(),e.forEach(function(t,e){return r.drawLevelButton(e,t)}),e.size>this.levelButtonCount&&(e.size>this.levelButtonCount+1?this.currentScrollIndex=Math.min(Array.from(e).reverse().findIndex(function(t){return t[0]===n}),e.size-this.levelButtonCount):this.currentScrollIndex=0,this.drawScrollButtons(),this.scroll(0)),this.switch(n)}}]),t}(),Wt={VENUE_DATA_LOADED:"VENUE_DATA_LOADED",VENUE_MAP_DATA_LOADED:"VENUE_MAP_DATA_LOADED",VENUE_ENTITY_DATA_LOADED:"VENUE_ENTITY_DATA_LOADED",VENUE_DATA_MODEL_LOADED:"VENUE_DATA_MODEL_LOADED",VENUE_NAV_DATA_LOADED:"VENUE_NAV_DATA_LOADED",META_DATA_LOADED:"META_DATA_LOADED",META_DATA_MODEL_LOADED:"META_DATA_MODEL_LOADED",META_DATA_MODEL_UPDATED:"META_DATA_MODEL_UPDATED",VENUE_ICONS_LOADED:"VENUE_ICONS_LOADED"},Yt=(Object.freeze((a(Te={},Wt.VENUE_DATA_LOADED,{description:"event fired when all requested files along with metadata & overrides are loaded",emitTemplate:{}}),a(Te,Wt.VENUE_MAP_DATA_LOADED,{description:"event fired when requested levels, drawings & community files are loaded",emitTemplate:{}}),a(Te,Wt.VENUE_ENTITY_DATA_LOADED,{description:"event fired when requested entity data is loaded",emitTemplate:{}}),a(Te,Wt.VENUE_DATA_MODEL_LOADED,{description:"event fired when a map file is loaded",emitTemplate:{}}),a(Te,Wt.VENUE_NAV_DATA_LOADED,{description:"event fired when requested navigation product is loaded",emitTemplate:{}}),a(Te,Wt.META_DATA_LOADED,{description:"event fired when all requested meta files are loaded except icon & marker",emitTemplate:{}}),a(Te,Wt.META_DATA_MODEL_LOADED,{description:"event fired when a specific model is loaded except icon & marker",emitTemplate:{}}),a(Te,Wt.META_DATA_MODEL_UPDATED,{description:"event fired when a specific meta override is added or removed",emitTemplate:{}}),a(Te,Wt.VENUE_ICONS_LOADED,{description:"event fired when all icons of venue are loaded",emitTemplate:{}}),Te)),new Mt);function Kt(t,e){var r,n,i,o,a=0;Object.keys(e).forEach(function(s){for(r=e[s],null==(i=r.priority)&&(i=0),o=!1;!o;)a<t.length?null==(n=(n=t[a]).priority)&&(n=0):n=Number.MAX_VALUE,i<=n&&(t.splice(a,0,r),o=!0),a+=1})}Yt.EVENT_NAME=Wt,Yt.on("newListener",function(t){});var Xt=Math.PI/180,Zt=180/Math.PI,$t=function(){function t(){n(this,t)}return o(t,null,[{key:"toRadians",value:function(t){return t*Xt}},{key:"toDegrees",value:function(t){return t*Zt}},{key:"getInverseTransform",value:function(t){var e=t[0]*t[3]-t[1]*t[2];return(e=[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,0,0])[4]=-(e[0]*t[4]+e[2]*t[5]),e[5]=-(e[1]*t[4]+e[3]*t[5]),e}},{key:"applyTransformToPoint",value:function(t,e){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]}},{key:"transformProduct",value:function(t,e){var r=[0,0,0,0,0,0];return r[0]=e[0]*t[0]+e[2]*t[1],r[1]=e[1]*t[0]+e[3]*t[1],r[2]=e[0]*t[2]+e[2]*t[3],r[3]=e[1]*t[2]+e[3]*t[3],r[4]=e[0]*t[4]+e[2]*t[5]+e[4],r[5]=e[1]*t[4]+e[3]*t[5]+e[5],r}},{key:"convertLonLatToMerc",value:function(t){var e=t[0]*Xt;t=t[1]*Xt,t=Math.sin(t);return[.5+e/(2*Math.PI),.5-Math.log((1+t)/(1-t))/(4*Math.PI)]}},{key:"convertMercToLatLon",value:function(t){var e=2*Math.PI*(t[0]-.5);t=Math.atan(Math.sinh(2*Math.PI*(.5-t[1])));return[e/Xt,t/Xt]}},{key:"getTransformScale",value:function(t){return Math.sqrt(t[0]*t[3]-t[1]*t[2])}},{key:"getLonLatToMercTransform",value:function(e){var r=[1/360,0,0,-1/(360*Math.cos(e[1]*Xt)),0,0],n=t.applyTransformToPoint(r,e);e=t.convertLonLatToMerc(e);return r[4]=e[0]-n[0],r[5]=e[1]-n[1],r}},{key:"getNatToMercTransform",value:function(e){var r=[e[4],e[5]];r=t.getLonLatToMercTransform(r);return t.transformProduct(e,r)}},{key:"convertMxMy2LonLat",value:function(e,r){return e.length&&r.length?t.applyTransformToPoint(e,r):[]}},{key:"convertLonLat2MxMy",value:function(e,r){return e.length&&r.length?(e=t.getInverseTransform(e),t.applyTransformToPoint(e,r)):[]}},{key:"getFlattenedQuadraticBezierCurve",value:function(t,e,r,n){var i=[],o=3<arguments.length&&void 0!==n?n:10;o<1&&(o=6);for(var a=0;a<=o;a+=1){var s=(1-(c=a/o))*(1-c),u=2*c*(1-c),l=c*c,c=s*t[0]+u*e[0]+l*r[0];l=s*t[1]+u*e[1]+l*r[1];i.push([c,l])}return i}},{key:"getFlattenedCubicBezierCurve",value:function(t,e,r,n,i){var o=[],a=4<arguments.length&&void 0!==i?i:10;a<1&&(a=6);for(var s=0;s<=a;s+=1){var u=(1-(f=s/a))*(1-f)*(1-f),l=3*f*(1-f)*(1-f),c=3*f*f*(1-f),h=f*f*f,f=u*t[0]+l*e[0]+c*r[0]+h*n[0];h=u*t[1]+l*e[1]+c*r[1]+h*n[1];o.push([f,h])}return o}},{key:"getRectangularCoordinatesOfLabelArea",value:function(e,r,n){var i=!(2<arguments.length&&void 0!==n)||n,o=(l=g(e,6))[0],a=l[1],s=l[2],u=l[3],l=(n=l[5],t.getDeltaLonLatForMeterAtGivenLonLat(o,a));e=e[4];return i?(n&&(e*=-1),null!=r&&(e=(e+=r<0?2*Math.PI+r:r)<0?2*Math.PI+e:e)):e=0,t.getRectVerticesFromSignatureRectRepresentation([o,a],{xLength:s,yLength:u},e,l)}},{key:"getRotatedPoint",value:function(t,e,r,n){var i=!(2<arguments.length&&void 0!==r)||r,o=3<arguments.length&&void 0!==n?n:[0,0],a=Math.cos(e);r=Math.sin(e),n=t[0]-o[0],e=t[1]-o[1],t=[];return[(t=i?[n*a+e*r,e*a-n*r]:[n*a-e*r,e*a+n*r])[0]+o[0],t[1]+o[1]]}},{key:"getRectVerticesFromSignatureRectRepresentation",value:function(e,r,n,i,o){var a=r.xLength,s=(r=r.yLength,!(4<arguments.length&&void 0!==o)||o),u=(e=g(e,2))[0],l=e[1],c=a/2,h=r/2,f=(i=g(i,2))[0],p=i[1];return[[1,1],[-1,1],[-1,-1],[1,-1]].map(function(t){return[t[0]*c,t[1]*h]}).map(function(e){return t.getRotatedPoint(e,n,s)}).map(function(t){return[t[0]*f,t[1]*p]}).map(function(t){return[t[0]+u,t[1]+l]})}},{key:"getScaleFactorForRectInSpace",value:function(t,e,r,n){return(n=e/n)<(r=t/r)?n:r}},{key:"getDeltaLonLatForMeterAtGivenLonLat",value:function(t,e){return[1/6371e3*(180/Math.PI)/Math.cos(e*Math.PI/180),1/6371e3*(180/Math.PI)]}},{key:"getBoundingBoxVertices",value:function(t){var e=0<arguments.length&&void 0!==t?t:[];t=[[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY]];return e.reduce(function(t,e){return[[Math.min(e[0],t[0][0]),Math.min(e[1],t[0][1])],[Math.max(e[0],t[1][0]),Math.max(e[1],t[1][1])]]},t)}},{key:"isPointInBoundingBox",value:function(t,e){if(t&&e){var r=(i=g(t,2))[0],n=i[1],i=(t=g((o=g(e,2))[0],2))[0],o=(e=t[1],(t=g(o[1],2))[0]);t=t[1];return r<=o&&i<=r&&n<=t&&e<=n}}},{key:"isPointOnLineSegment",value:function(t,e,r){var n=(o=g(t,2))[0],i=o[1],o=(t=(a=g(e,2))[0],a[1]),a=(e=g(r,2))[0];e=(o-i)*((r=e[1])-i)<=0;return t===a?t===n&&e:i-r==(r-o)/(a-t)*(n-a)&&e}},{key:"rayIntersectLineSegment",value:function(t,e,r){var n=(o=g(t,2))[0],i=o[1],o=(t=g(e,2))[0];e=t[1],r=(t=g(r,2))[0],t=t[1];return o!==r&&(0<=(o=(n-o)/(r-o))&&o<1&&i<(t-e)*o+e)}},{key:"isPointInPolygon",value:function(e,r){var n=(e=g(e,2))[0],i=e[1];if((e=r.length)<3)return!1;var o=0,a=r[e-1];return r.forEach(function(e){t.rayIntersectLineSegment([n,i],a,e)&&(o+=1),a=e}),o%2!=0}},{key:"isPointOnLineString",value:function(e,r){var n=(e=g(e,2))[0],i=e[1],o=r.length;if(o<2)return!1;for(var a=r[o-1],s=0;s<o;s+=1){var u=r[s];if(t.isPointOnLineSegment([n,i],a,u))return!0;a=r[s]}return!1}},{key:"getAreaOfPolygon",value:function(t){var e=t.length;if(e<3)return null;var r=0,n=t[e-1];return t.forEach(function(t){var e,i,o,a;r+=.5*(i=t,a=(o=g(n,2))[0],e=o[1],i=(o=g(i,2))[0],a*o[1]-e*i),n=t}),r}},{key:"getDistanceBetweenPoints",value:function(t,e){t=(r=g(t,2))[0];var r=r[1];t-=(e=g(e,2))[0],e=r-e[1];return Math.sqrt(t*t+e*e)}}]),t}(),Jt=function(){function t(){n(this,t)}return o(t,null,[{key:"get",value:function(t,e){return fetch(t,1<arguments.length&&void 0!==e?e:{method:"GET"}).then(function(e){return e.ok?e.json():Promise.reject(new Error("Call failed for ".concat(t," : ").concat(e.status," ").concat(e.statusText)))})}}]),t}(),Qt=!1,te=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Qt;n(this,t),e&&Object.assign(this,e),this.splitIconGeomBasisGeomType_=r,this.splitIconGeomBasisGeomType_&&this.splitMultiGeom()}return o(t,[{key:"flattenIconShape",value:function(t){var e,r=0<arguments.length&&void 0!==t&&t;this.isFlattened||(e=[],(t=this.g)&&t.forEach(function(t){var r,n=[];t.shp&&t.shp.forEach(function(t){var e,i=g(t,7),o=i[0],a=i[1],s=i[2],u=i[3],l=i[4],c=i[5],h=i[6];switch(o){case 0:case 1:n.push(t),r=[a,s];break;case 2:e=$t.getFlattenedQuadraticBezierCurve(r,[a,s],[u,l]),r=[u,l];break;case 3:e=$t.getFlattenedCubicBezierCurve(r,[a,s],[u,l],[c,h]),r=[c,h];break;case 4:n.push(t),r=void 0}e&&(e.splice(0,2),e.forEach(function(t){n.push([1].concat(m(t)))}))}),e.push(u(u({},t),{shp:n}))}),r&&(this.g_original=t),this.g=e,this.isFlattened=!0)}},{key:"splitMultiGeom",value:function(){var e=this;if(this.isIconGeomSplittedBasisGeomType)return this.isIconWithHole;this.splitIconGeomBasisGeomType_||(this.splitIconGeomBasisGeomType_=!0);var r=this.g,n=[],i=[],o=!1,a=!0,s=-1;return!!r&&(r.forEach(function(r){var l,c=[],h=[];3===r.gt||(r.shp.forEach(function(t){var e=g(t,7),o=e[0],f=e[1],p=e[2],d=e[3],v=e[4],y=e[5],_=e[6],b=null;switch(o){case 0:c.push([f,p]),l=[f,p],a||1!==s&&0!==s||n.push(u(u({},r),{},{st:2},{gt:s,shp:i})),s=0,a=!(i=[]),i.push(t);break;case 1:c.push([f,p]),l=[f,p],2===s||0!==s&&1!==s||(s=1,i.push(t));break;case 2:(b=$t.getFlattenedQuadraticBezierCurve(l,[f,p],[d,v],15)).splice(0,2),c.push.apply(c,m(b)),l=[d,v],2===s||0!==s&&1!==s||(s=1,i.push(t));break;case 3:(b=$t.getFlattenedCubicBezierCurve(l,[f,p],[d,v],[y,_],15)).splice(0,2),c.push.apply(c,m(b)),l=[y,_],2===s||0!==s&&1!==s||(s=1,i.push(t));break;case 4:i.push(t),s=2,a=!0,2<c.length&&h.push({shp:i,area:$t.getAreaOfPolygon(c),points:c,children:[]}),l=void 0,c=[]}},e),t.getLinkedParentChildPolygonArray(h).forEach(function(t){var e=[];e.push.apply(e,m(t.shp)),t.children.forEach(function(t){o=!0,e.push.apply(e,m(t.shp))}),n.push(u(u({},r),{},{st:2},{gt:2,shp:e}))}))},this),this.g=n,this.isIconGeomSplittedBasisGeomType=!0,this.isIconWithHole=o,this.isIconWithHole)}},{key:"getIconWithOriginTranslatedToIconCenter",value:function(){var e=new t(this,this.splitIconGeomBasisGeomType_),r=Number.parseInt(e.w,10)/2*1,n=Number.parseInt(e.h,10)/2*1;return e.g=[],this.g&&this.g.forEach(function(t){var i=[];t.shp&&t.shp.forEach(function(t){var e=g(t,7),o=e[0],a=e[1],s=e[2],u=e[3],l=e[4],c=e[5],h=e[6];switch(o){case 0:case 1:i.push([o,a-r,s-n]);break;case 2:i.push([o,a-r,s-n,u-r,l-n]);break;case 3:i.push([o,a-r,s-n,u-r,l-n,c-r,h-n]);break;case 4:i.push(t)}}),e.g.push(u(u({},t),{shp:i}))}),e}},{key:"getTransformedIconThatFitsInLabelArea",value:function(e,r,n){var i=1<arguments.length&&void 0!==r?r:0,o=(r=!(2<arguments.length&&void 0!==n)||n,n=new t(this,this.splitIconGeomBasisGeomType_),t.getParamForTransformedIconThatFitsInLabelArea(n,e,i,r));r=o.scaleFactor;n.w=r,n.h=r;var a=[];return n.g&&n.g.forEach(function(e){var r=[];e.shp&&e.shp.forEach(function(e){var n=(c=g(e,7))[0],i=c[1],a=c[2],s=c[3],u=c[4],l=c[5],c=c[6],h=(a=g(t.getTransformedIconPointThatFitsInLabelArea([i,a],o),2))[0],f=a[1],p=(u=g(t.getTransformedIconPointThatFitsInLabelArea([s,u],o),2))[0],d=u[1],v=(c=g(t.getTransformedIconPointThatFitsInLabelArea([l,c],o),2))[0],y=c[1];switch(n){case 0:case 1:r.push([n,h,f]);break;case 2:r.push([n,h,f,p,d]);break;case 3:r.push([n,h,f,p,d,v,y]);break;case 4:r.push(e)}}),a.push(u(u({},e),{shp:r}))}),n.g=a,n}},{key:"getSVG",value:function(t){var e,r,n='<?xml version="1.0" encoding="utf-8"?>',i=this.w||50,o=this.h||50,s=this.g;if(n+='<svg viewBox="0 0 '.concat(i," ").concat(o,'" xmlns="http://www.w3.org/2000/svg" width="').concat(i,'" height="').concat(o,'">'),n+="<g>",s&&0<s.length)for(var u=0;u<s.length;u+=1){n+="<path ",s[u].gw&&(n+=' stroke-width="'.concat(s[u].gw,'"')),t?n+=' fill="'.concat(t,'"'):s[u].os&&s[u].os.m?n+=' fill="'.concat(s[u].os.m,'"'):n+=0===u?' fill="#006BB7"':' fill="#ffffff"',n+=' d="';for(var l=0;l<s[u].shp.length;l+=1)for(var c=0;c<s[u].shp[l].length;c+=1)n+=0===c?(e=s[u].shp[l][c],r=void 0,(a(r={},0,"M"),a(r,1,"L"),a(r,2,"Q"),a(r,3,"C"),a(r,4,"Z"),r)[e]):s[u].shp[l][c],0===c||c+1===s[u].shp[l][c].length?n+="":n+=" ";n+='" ></path>'}return(n+="</g>")+"</svg>"}}],[{key:"getParamForTransformedIconThatFitsInLabelArea",value:function(t,e,r,n){var i=2<arguments.length&&void 0!==r?r:0,o=!(3<arguments.length&&void 0!==n)||n,a=(u=g(e,5))[0],s=u[1],u=(r=u[2],n=u[3],e=u[4],(o?0:e)+i);e=(o=g($t.getDeltaLonLatForMeterAtGivenLonLat(a,s),2))[0],i=o[1];return{labelCenterX:a,labelCenterY:s,iconWidth:t=(o=[Number.parseInt(t.w,10),Number.parseInt(t.h,10)])[0],iconHeight:o=o[1],deltaLonPerMeter:e,deltaLatPerMeter:i,scaleFactor:$t.getScaleFactorForRectInSpace(r,n,t,o),effectiveRotation:u}}},{key:"getTransformedIconPointThatFitsInLabelArea",value:function(t,e){var r=(l=g(t,2))[0],n=l[1];if(void 0===r||void 0===n||null===r||null===n)return[];var i=e.labelCenterX,o=e.labelCenterY,a=e.iconWidth,s=e.iconHeight,u=e.deltaLonPerMeter,l=(t=e.deltaLatPerMeter,e.scaleFactor);e=e.effectiveRotation,r=r,n=n;return r-=+a/2,n-=+s/2,n*=-1,u=r*=l*u,t=n*=l*t,r=u*Math.cos(e)+t*Math.sin(e),n=t*Math.cos(e)-u*Math.sin(e),[r+=i,n+=o]}},{key:"getWebGLSuitableCoordinatesOfIconSubGeom",value:function(t){var e,r=t.st,n=t.gt,i=t.shp,o=[];if(2!==r||!i||!n)return o;switch(n){case 2:i.forEach(function(t){var r=g(t,3),n=(t=r[0],r[1]),i=r[2];switch(t){case 0:(e=[]).push([n,i]);break;case 1:e.push([n,i]);break;case 4:o.push(e)}});break;case 1:i.forEach(function(t){t=(e=g(t,3))[1];var e=e[2];o.push([t,e])})}return o}},{key:"getLinkedParentChildPolygonArray",value:function(t){var e=[];t.sort(function(t,e){return Math.abs(e.area)-Math.abs(t.area)});for(var r=0;r<t.length;r+=1){for(var n=null,i=t[r],o=i.points[0],a=r-1;0<=a;--a){var s=t[a];if(i.area*s.area<0&&($t.isPointInPolygon(o,s.points)||$t.isPointOnLineString(o,s.points))){n=s;break}}(n?n.children:e).push(i)}return e}}]),t}(),ee=Object.freeze({TEXT:"",ICON:"icon:",IMAGE:"icon:"}),re=Object.freeze({VALUE:"<value>",SHORT:"<short>",LONG:"<long>",FULL:"<full>"}),ne=Object.freeze({NONE:0,TEXT:1,ICON:2,IMAGE:3}),ie=Yt.EVENT_NAME,oe=["resetBaseMetaFileRules_","updateOverridableComponents"],ae=function(t){var e=[];return oe.forEach(function(r){t[r]||e.push(r)}),0<e.length?e:null},se=function(){function t(e,r,i){if(n(this,t),!e)throw new Error("one should not instantiate object of this class without apt payload");var o=ae(this);if(o)throw new Error("function definition missing in the implementation ".concat(o.join()));this.metaFileIdentifier=r,this.metaInformation_=i,this.basedata_=u({},e),this.baseOverrides_=[],this.customOverrides_=[],this.resetBaseMetaFileRules_()}return o(t,[{key:"applyOverride",value:function(t,e,r){var n=!(1<arguments.length&&void 0!==e)||e;e=2<arguments.length&&void 0!==r&&r;t&&(e||(n?this.customOverrides_:this.baseOverrides_).push(t),this.updateOverridableComponents(t),r=this.getMetaInformation(),!e&&r&&r.config.emitEventOnOverrideUpdate&&(t={applyOverride:!0,metaFileIdentifier:this.metaFileIdentifier,isCustomOverride:n,metaInformation:r,overrideJson:t},Yt.emit(ie.META_DATA_MODEL_UPDATED,t)))}},{key:"undoOverride",value:function(){var t,e,r=this;0!==this.customOverrides_.length&&(e=this.customOverrides_.pop(),this.resetBaseMetaFileRules_(),this.baseOverrides_.forEach(function(t){return r.applyOverride(t,!1,!0)}),this.customOverrides_.forEach(function(t){return r.applyOverride(t,!0,!0)}),(t=this.getMetaInformation())&&t.config.emitEventOnOverrideUpdate&&(e={metaFileIdentifier:this.metaFileIdentifier,undoOverride:!0,metaInformation:t,overrideJson:e},Yt.emit(ie.META_DATA_MODEL_UPDATED,e)))}},{key:"getMetaInformation",value:function(){return this.metaInformation_}},{key:"basedata_",get:function(){return this.basedata__},set:function(t){this.basedata__||(this.basedata__=t)}}]),t}(),ue=xt.PRESETS,le=function(){l(e,se);var t=v(e);function e(r,i){return n(this,e),t.call(this,r,ue,i)}return o(e,[{key:"resetBaseMetaFileRules_",value:function(){this.property_trees=null,this.named_groups=null,this.named_keys=null,this.updateOverridableComponents(this.basedata_)}},{key:"updateOverridableComponents",value:function(t){this.property_trees=t.property_trees,this.named_groups=t.named_groups,this.named_keys=t.named_keys}},{key:"getPropertyTree",value:function(t){var e,r=this,n=[];return(t=this.property_trees[t]).forEach(function(t){switch(t.input){case"named_group":e=r.getNamedGroup(r.getKeyKey(t)),n=[].concat(m(n),m(e));break;case"named_key":var i;(e=r.getKeyName(t))?((i=r.getNamedKey(e)).k=r.getKeyKey(t),i.name=e,n.push(i)):n.push(r.getNamedKey(r.getKeyKey(t)));break;default:n.push(t)}},this),n}},{key:"getNamedGroup",value:function(t){return this.named_groups[t]}},{key:"getNamedKey",value:function(t){return this.named_keys[t]}}],[{key:"getMetaFileIdentifier",value:function(){return ue}}]),e}(),ce=xt.SDK_STRINGS,he=function(){l(e,se);var t=v(e);function e(r,i){return n(this,e),t.call(this,r,ce,i)}return o(e,[{key:"resetBaseMetaFileRules_",value:function(){this.stringsTable={},this.updateOverridableComponents(this.basedata_)}},{key:"updateOverridableComponents",value:function(t){t&&this.updateTranslationsStringMap(t.translations)}},{key:"updateTranslationsStringMap",value:function(t){var e=this;t&&Object.keys(t).forEach(function(r){e.addToStringsTable(r,t[r])},this)}},{key:"addToStringsTable",value:function(t,e){this.stringsTable[t]=e}},{key:"translate",value:function(t,e){var r,n=e;return!this.stringsTable||(r=this.stringsTable[t])&&(n=r.en||r.en||(0<(t=Object.keys(r)).length?r[t.pop()]:e)),n}}],[{key:"getMetaFileIdentifier",value:function(){return ce}}]),e}(),fe=xt.THEME,pe=function(){l(e,se);var t=v(e);function e(r,i){return n(this,e),t.call(this,r,fe,i)}return o(e,[{key:"resetBaseMetaFileRules_",value:function(){var t=this.basedata_;this.ft=t.ft,this.name=t.nm,this.iurl=t.iurl,this.styleMap={},this.iconInfoMap={},this.labelStyleMap={},this.markerMap={},this.updateOverridableComponents(t)}},{key:"updateOverridableComponents",value:function(t){t&&(this.updateStyleMap(t.s),this.updateIconInfoMap(t.i,t.iurl),this.updateLabelStyleMap(t.l),this.updateMarkerMap(t.m))}},{key:"updateStyleMap",value:function(t){this.styleMap=u(u({},this.styleMap),t)}},{key:"updateIconInfoMap",value:function(t,e){var r=this;t&&Object.keys(t).forEach(function(n){var i=t[n],o=e||r.iurl;o&&i.rurl&&(i.url=o+i.rurl),r.iconInfoMap[n]=i},this)}},{key:"updateLabelStyleMap",value:function(t){this.labelStyleMap=u(u({},this.labelStyleMap),t)}},{key:"updateMarkerMap",value:function(t){this.markerMap=u(u({},this.markerMap),t)}},{key:"getStyleMap",value:function(){return this.styleMap}},{key:"getGeometryStyle",value:function(t){return this.styleMap?this.styleMap[t]:null}},{key:"getGeometryDefaultStyle",value:function(){return this.styleMap?this.styleMap.Object:null}},{key:"getLabelStyle",value:function(t){return this.labelStyleMap?this.labelStyleMap[t]:null}},{key:"getLabelDefaultStyle",value:function(){return this.labelStyleMap?this.labelStyleMap.default:null}},{key:"getMarker",value:function(t){return this.markerMap&&t?this.markerMap[t]:null}},{key:"getIconInfo",value:function(t){return this.iconInfoMap&&t?this.iconInfoMap[t]:null}}],[{key:"getMetaFileIdentifier",value:function(){return fe}}]),e}(),de=function(){function t(){n(this,t)}return o(t,null,[{key:"createShortAddress",value:function(t){return t&&Array.isArray(t)?t[1]:null}},{key:"createLongAddress",value:function(t){return t&&Array.isArray(t)?t[0]+" "+t[1]:null}},{key:"createFullAddress",value:function(t){return t&&Array.isArray(t)?(3===t.length?t[2]+" ":"")+(t[0]+" ")+t[1]:null}}]),t}(),ve=xt.THEME_MAP,ye=function(){l(e,se);var t=v(e);function e(r,i){return n(this,e),t.call(this,r,ve,i)}return o(e,[{key:"resetBaseMetaFileRules_",value:function(){var t=this.basedata_;this.ft=t.ft,this.styleTreeList=[],this.labelTreeList=[],this.updateOverridableComponents(t)}},{key:"updateOverridableComponents",value:function(t){this.updateLabelTreeList(t.label),this.updateStyleTreeList(t.style)}},{key:"updateLabelTreeList",value:function(t){t&&Kt(this.labelTreeList,t)}},{key:"updateStyleTreeList",value:function(t){t&&Kt(this.styleTreeList,t)}}],[{key:"getMetaFileIdentifier",value:function(){return ve}},{key:"extractThemeMapPayload",value:function(t){return{labelType:t.lt,labelRef:t.r,styleName:t.n}}},{key:"getGeomStyleLookupTag",value:function(t,e){return(t=t?t.styleName:null)===re.VALUE?e:t}},{key:"getLabelRefConstructed",value:function(t,e,r){var n=t;switch(t){case re.VALUE:n=r;break;case re.SHORT:n=de.createShortAddress(e);break;case re.LONG:n=de.createLongAddress(e);break;case re.FULL:n=de.createFullAddress(e)}return n}},{key:"getLabelInfoConstructed",value:function(t,e,r,n){var i={lt:t,entry:r};switch(t){case ne.NONE:break;case ne.TEXT:r.trans?i.ar=e:i.r=e;break;case ne.ICON:i.iconIdentifier=e,n?i=u(u({},n),i):i.error=!0;break;case ne.IMAGE:i.url=e;break;default:i=null}return i}}]),e}(),ge=xt.THEME,me=xt.THEME_MAP,_e=xt.PRESETS,be=xt.SDK_STRINGS,xe=function(){function t(){n(this,t),this.config=Object.seal({emitEventOnOverrideUpdate:!0}),this.iconCache={},this.imageCache={},this.releaseSettings_={}}return o(t,[{key:"instantiateMetaFileAccessor_",value:function(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];switch(t){case ge:this[ge]=p(pe,r.concat([this]));break;case me:this[me]=p(ye,r.concat([this]));break;case _e:this[_e]=p(le,r.concat([this]));break;case be:this[be]=p(he,r.concat([this]));break;default:return null}return this[t]}},{key:"applyOverride",value:function(t,e){this[t]&&this[t].applyOverride(e)}},{key:"undoOverride",value:function(t){this[t]&&this[t].undoOverride()}},{key:"getTheme",value:function(){return this[ge]||{}}},{key:"getThemeMap",value:function(){return this[me]||{}}},{key:"getPresets",value:function(){return this[_e]||{}}},{key:"getStrings",value:function(){return this[be]||{}}},{key:"getIcon",value:function(t){return t&&t.iconIdentifier?this.iconCache[t.iconIdentifier]:null}},{key:"getImage",value:function(t){return this.imageCache[t]}},{key:"extractGeomStyle",value:function(t){var e=t.valueEntry;t=t.value,e=ye.extractThemeMapPayload(e),t=ye.getGeomStyleLookupTag(e,t);return this.getTheme()?this.getTheme().getGeometryStyle(t):null}},{key:"getStyle",value:function(t,e){var r=this,n=1<arguments.length&&void 0!==e&&e,i=this.getThemeMap().styleTreeList,o=this.processValueEntry_.bind(this);if(null===i||0===i.length||!this.getTheme())return null;e=this.getTheme().getGeometryDefaultStyle();var a=this.extractGeomStyle.bind(this),s=t.getAddress(),u=t.getEntities(),l=null,c=null,h={};return u&&0<u.length?i.find(function(e){return c=u.find(function(r){return l=o({geometry:t,entity:r,address:s,valueEntry:e,value:void 0,returnValueFunction:a,valueEntryIdentified:h})},r)},this):i.find(function(e){return l=o({geometry:t,entity:c,address:s,valueEntry:e,value:void 0,returnValueFunction:a,valueEntryIdentified:h})},this),l||n||(l=e),l?JSON.parse(JSON.stringify(l)):void 0}},{key:"getLabelValue",value:function(t){var e=t.address,r=t.valueEntry,n=t.value,i=(t=(i=ye.extractThemeMapPayload(r)).labelType,i.labelRef);e=ye.getLabelRefConstructed(i,e,n),n=t===ne.ICON?this.getTheme().getIconInfo(e):null;return(n=ye.getLabelInfoConstructed(t,e,r,n))?JSON.parse(JSON.stringify(n)):void 0}},{key:"convertLabelToText",value:function(t){if(t){var e,r=t.r,n=t.ar;t=t.lt;if(r)return r;if(n){switch(t){case ne.TEXT:e=ee.TEXT+n;break;case ne.ICON:e=ee.ICON+n;break;case ne.IMAGE:e=ee.IMAGE+n;break;default:return null}return this.getStrings().translate(e,n)}}return null}},{key:"getLabelStyle",value:function(t,e){var r,n=1<arguments.length&&void 0!==e&&e,i=this.getTheme(),o=i.getLabelDefaultStyle(),a={};return t&&(r=t.t,e=t.zmin,t=t.l,r&&(a.t=r),e&&(a.zmin=e),(t=i.getLabelStyle(t))&&(a=u(u({},a),t))),a||n||(a=o),a}},{key:"getLabelConstantsSet_",value:function(){var t=this.getThemeMap().labelTreeList,e=this.processValueEntry_.bind(this);return null==t||0===t.length?{isInsufficientInput:!0}:{labelTreeList:t,returnValueFunction:this.getLabelValue.bind(this),processValueEntry:e}}},{key:"getGeometryLabelInfo",value:function(t){var e=this,r=this.getLabelConstantsSet_(),n=r.isInsufficientInput,i=r.labelTreeList,o=r.returnValueFunction,a=r.processValueEntry;if(n)return null;var s=t.getAddress(),u=null;return i.find(function(r){return(u=a({geometry:t,address:s,valueEntry:r,returnValueFunction:o}))&&(u.r=e.convertLabelToText(u)),u}),u?JSON.parse(JSON.stringify(u)):void 0}},{key:"getEntityLabelInfo",value:function(t){var e=this.getLabelConstantsSet_(),r=e.isInsufficientInput,n=e.labelTreeList,i=e.returnValueFunction,o=e.processValueEntry;if(r)return null;var a=null;return n.find(function(e){return a=o({entity:t,valueEntry:e,returnValueFunction:i})}),a?JSON.parse(JSON.stringify(a)):void 0}},{key:"getLabelInfo",value:function(t){var e=this,r=this.getLabelConstantsSet_(),n=r.isInsufficientInput,i=r.labelTreeList,o=r.returnValueFunction,a=r.processValueEntry;if(n)return null;var s,u,l=t.getAddress(),c=t.getEntities(),h=null;return c&&1<c.length?(s=null,i.find(function(r){var n,i=null,u=!1;return c.forEach(function(t){n=a({entity:t,valueEntry:r,returnValueFunction:o}),(i=e.convertLabelToText(n))&&0<i.length&&(s?s+=", "+i:(s=i,u=!0))},e),u||(n=a({geometry:t,address:l,valueEntry:r,returnValueFunction:o}),(i=e.convertLabelToText(n))&&0<i.length&&(s?s+=", "+i:s=i,u=!0)),u&&(h={lt:e.TEXT_LABEL_TYPE,r:s}),u},this)):(u=c?c[0]:null,i.find(function(r){return(h=a({geometry:t,entity:u,address:l,valueEntry:r,returnValueFunction:o}))&&(h.r=e.convertLabelToText(h)),h},this)),h?JSON.parse(JSON.stringify(h)):void 0}},{key:"processValueEntry_",value:function(t){var e=this,r=t.geometry,n=t.entity,i=t.address,o=t.valueEntry,a=t.value,s=t.returnValueFunction,u=null;return void 0!==(t=o.ks)&&t.find(function(t){var o;if(t.gk&&r?(a=t.gk,o=r.properties[a]):t.ek&&n?(a=t.ek,o=n.properties[a]):t.ak&&i&&(a=t.ak)===i[0]&&(o=g(i,2)[1]),void 0!==o){if(t.v){var a=t.v[o];if(void 0!==a&&void 0!==(u=e.processValueEntry_({geometry:r,entity:n,address:i,valueEntry:a,value:o,returnValueFunction:s})))return!0}if(void 0!==(u=s({geometry:r,entity:n,address:i,valueEntry:t,value:o})))return!0}return!1},this)?u:s?s({geometry:r,entity:n,address:i,valueEntry:o,value:a}):u}},{key:"setIcon",value:function(t,e){t&&e&&(this.iconCache[t]=e)}},{key:"setReleaseSettings_",value:function(t){this.releaseSettings_=t}}]),t}(),we=(Ne={NODES_LB:"mfs.micello.com",US_1:"mfs-us-1.micello.com",US_2:"mfs-us-2.micello.com",AU_1:"mfs-au-1.micello.com",AU_2:"mfs-au-2.micello.com",EU_1:"mfs-eu-1.micello.com",SG_1:"mfs-sg-1.micello.com",HUB:"mfs-hub-master.micello.com",PREVIEW:"preview.micello.com/mfs",FACTORY:"factory-mfs.micello.com",CIT:"integration.mfs.hub.venues.ext.here.com",STG:"alpha.mfs.hub.venues.ext.here.com"}).HUB,Ee=Object.freeze({MFILE:"MFILE",MVAR:"MVAR",MPATH:"MPATH",MKEY:"MKEY",MPATTERN:"MPATTERN",MPACKAGE:"MPACKAGE"}),Te=(Object.freeze((a(Te={},Ee.MFILE,"/mfile"),a(Te,Ee.MVAR,"/mvar"),a(Te,Ee.MPATH,"/mpath"),a(Te,Ee.MKEY,"/mkey"),a(Te,Ee.MPATTERN,"/mpattern"),a(Te,Ee.MPACKAGE,"/mpackage"),Te)),Object.freeze(Object.values(Ne).reduce(function(t,e){return u(u({},t),{},a({},e,{key:null}))},{}))),Ae=Object.freeze({apiKey:null,dataApiType:"MFS",fileHost:we,queryParamMap:Te}),ke=At.GEO_JSON,Se=(Ne=kt[ke]).COMMUNITY_MAP,Me=Ne.COMMUNITY_ENTITY,Oe=Ne.GEOJSON_LEVEL_GEOMETRY,Ie=function(){function t(e){n(this,t),this.baseApi=e}return o(t,[{key:"getBaseAPI",value:function(){return this.baseApi}},{key:"getCommunityMap",value:function(t,e,r){return this.baseApi.fetch(this.baseApi.getMapProductFileUrl(t,ke,Se,null,e,r))}},{key:"getCommunityEntity",value:function(t,e,r){return this.baseApi.fetch(this.baseApi.getMapProductFileUrl(t,ke,Me,null,e,r))}},{key:"getGeoJsonLevelGeometry",value:function(t,e,r,n){return e="/".concat(e),this.baseApi.fetch(this.baseApi.getMapProductFileUrl(t,ke,Oe,e,r,n))}}]),t}(),Le=Object.freeze({MAP:"MAP",META:"META",CUSTOMER:"CUSTOMER"}),Ce=Object.freeze((a(Te={},Le.MAP,"/map"),a(Te,Le.META,"/meta"),a(Te,Le.CUSTOMER,"/customer"),Te)),Re=Object.freeze({METACONFIG:"METACONFIG",OVERRIDES:"OVERRIDES",DATAHOSTS:"DATAHOSTS"}),Pe=Object.freeze((a(kt={},Re.METACONFIG,"/metaConfig"),a(kt,Re.OVERRIDES,"/overrides"),a(kt,Re.DATAHOSTS,"/map/dataHosts"),kt)),Ne=Object.freeze({V4:"V4",V5:"V5"}),je=(Object.freeze((a(Te={},Ne.V4,"/v4"),a(Te,Ne.V5,"/v5"),Te)),Object.freeze((a(kt={},xt.THEME,"/theme/v5"),a(kt,xt.THEME_MAP,"/thememap/v5"),a(kt,xt.PRESETS,"/presets/v5"),a(kt,xt.SDK_STRINGS,"/strings/v5"),a(kt,xt.ICON_FILE,"/iconfile/v5"),a(kt,xt.INPUT_COLORS,"/miceditor/inputcolors"),a(kt,xt.BASE_MAP_INFO,"/miceditor/basemapinfo"),a(kt,xt.CONFIG_PROFILE,"/miceditor/configprofile"),a(kt,xt.NAV_THEME,"/navtheme/v5"),a(kt,xt.NAV_NAME_THEME,"/navtheme/v5"),a(kt,xt.NAV_PROP_MAP,"/navpropmap/v5"),a(kt,xt.NAV_STRINGS,"/strings/v5/nav"),a(kt,xt.NAV_THEME_MAP,"/navthememap/v5"),a(kt,xt.NAV_NAME_THEME_MAP,"/navthememap/v5"),a(kt,xt.V4_THEME_FAMILY,"/theme/v4"),a(kt,xt.V4_MAPTYPE_THEME,"/theme/v4"),a(kt,xt.ICON,"/theme/icon/v5"),a(kt,xt.MARKER,"/theme/marker"),a(kt,xt.PERMISSIONS,"/auth/stringroles"),a(kt,xt.NAICS_ARRAY,"/naics/2012/array"),a(kt,xt.NAICS_MAP,"/naics/2012/map"),kt))),De=Object.freeze((a(Ne={},At.GEO_JSON,"/geojson"),a(Ne,At.V5_MAP,"/v5_map"),a(Ne,At.V5_NAV,"/v5_nav"),a(Ne,At.V5_INFO,"/v5_info"),a(Ne,At.KML,"/kml"),a(Ne,At.SVG,"/svg"),a(Ne,At.PNG,"/png"),Ne)),ze=Object.freeze((a(Te={},At.V5_MAP,{COMMUNITY_MAP:"/com-map",COMMUNITY_DIRECTORY:"/com-dir",COMMUNITY_DETAIL:"/com-detail",LEVEL_GEOMETRY:"/level-geom",DRAWING_ENTITY:"/drawing-entity"}),a(Te,At.GEO_JSON,{COMMUNITY_MAP:"/com-map",COMMUNITY_ENTITY:"/com-entity",PATH_LEVEL_GEOMETRY:"/path-level-geom",GEOJSON_LEVEL_GEOMETRY:"/geojson-level-geom"}),a(Te,At.V5_NAV,{JSON_NAV:"/json",BINARY_NAV:"/bin",JSON_ENHANCED_NAV:"/json-enh",BINARY_ENHANCED_NAV:"/bin-enh"}),a(Te,At.V5_NAV,{JSON_NAV:"/json",BINARY_NAV:"/bin",JSON_ENHANCED_NAV:"/json-enh",BINARY_ENHANCED_NAV:"/bin-enh"}),a(Te,At.V5_INFO,{GEOMETRY_INFO:"/geom-info"}),a(Te,At.SVG,{PLAIN:"/plain",PRETTY:"/pretty",PRETTY_HORIZONTAL_LABEL:"/pretty"}),a(Te,At.KML,{RASTER:"/raster",RASTER_HORIZONTAL:"/raster",VECTOR:"/vector",VECTOR_HORIZONTAL:"/vector"}),a(Te,At.PNG,{LOW_RESOLUTION:"/lo-res",HIGH_RESOLUTION:"/high-res",LOW_RESOLUTION_GEO:"/lo-res-geo",HIGH_RESOLUTION_GEO:"/high-res-geo",LOW_RESOLUTION_HORIZONTAL:"/lo-res",HIGH_RESOLUTION_HORIZONTAL:"/high-res",LOW_RESOLUTION_HORIZONTAL_GEO:"/lo-res-geo",HIGH_RESOLUTION_HORIZONTAL_GEO:"/high-res-geo"}),Te)),He=Object.freeze({venueId:null,language:"-",mapVersion:"-",entityVersion:"-",fileVersion:null,themeName:Tt[xt.THEME]}),Fe=Object.freeze({MFILE:"MFILE",MPATH:"MPATH",MVAR:"MVAR"}),Be=Object.freeze((a(kt={},Fe.MFILE,"/mfile"),a(kt,Fe.MPATH,"/mpath"),a(kt,Fe.MVAR,"/mvar"),kt)),Ue=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};n(this,t),this.productAPI={},this.hostConfig_=e,this.isHostCustom=!1}return o(t,[{key:"getBaseUrl",value:function(t){return t=!(0<arguments.length&&void 0!==t)||t,(t="".concat(this.hostConfig_.fileHost).concat(t?"/ms/v1":"")).startsWith("https://")||t.startsWith("http://")||(t="https://".concat(t)),t}},{key:"getFileServiceBaseUrl",value:function(t){if(t=0<arguments.length&&void 0!==t?t:Fe.MFILE,Fe[t])return"".concat(this.getBaseUrl()).concat(Be[t])}},{key:"getGlobalMetaBaseUrl",value:function(t){var e=Ce[Le.META];t=this.getFileServiceBaseUrl(t);return"".concat(t).concat(e)}},{key:"getVenueMapBaseUrl",value:function(t){var e=this.getFileServiceBaseUrl(t);t=Ce[Le.MAP];return"".concat(e).concat(t)}},{key:"getGlobalMetaFileUrl",value:function(t,e,r,n){e=1<arguments.length&&void 0!==e?e:Tt[t];var i=2<arguments.length?r:void 0,o=(n=3<arguments.length?n:void 0,this.getGlobalMetaBaseUrl(n)),a=je[t],s=null===e||""===e?"":"/".concat(e);switch(t){case xt.THEME:case xt.THEME_MAP:case xt.PRESETS:case xt.SDK_STRINGS:case xt.ICON_FILE:case xt.INPUT_COLORS:case xt.BASE_MAP_INFO:case xt.CONFIG_PROFILE:case xt.NAV_THEME:case xt.NAV_NAME_THEME:case xt.NAV_PROP_MAP:case xt.NAV_STRINGS:case xt.NAV_THEME_MAP:case xt.NAV_NAME_THEME_MAP:case xt.V4_THEME_FAMILY:o+="".concat(a).concat(s);break;case xt.ICON:case xt.MARKER:case xt.V4_MAPTYPE_THEME:o+=0<s.length&&i&&0<i.length?"".concat(a).concat(s,"/").concat(i):"".concat(a);break;case xt.PERMISSIONS:case xt.NAICS_ARRAY:case xt.NAICS_MAP:o+="".concat(a)}return o}},{key:"getGeoJsonApi",value:function(){return this.productAPI[At.GEO_JSON]||(this.productAPI[At.GEO_JSON]=new Ie(this)),this.productAPI[At.GEO_JSON]}},{key:"getMapProductUrlPath",value:function(t,e,r,n){return e=!(1<arguments.length&&void 0!==e)||e,r=2<arguments.length?r:void 0,n=3<arguments.length?n:void 0,n=this.getVersionedVenueUrl(t,e,n),r&&(n+="".concat(De[r])),n}},{key:"getMapProductFileUrl",value:function(t,e,r,n,i,o){var a=ze[At[e]][r];i=this.getMapProductUrlPath(t,!0,e,i);return r&&(i+="".concat(a)),n&&(i+="".concat(n)),!o&&0!==o||(i+="/fv/".concat(o)),i}},{key:"getMetaConfigUrl",value:function(t,e){var r=Pe[Re.METACONFIG];return(e=this.getVersionedVenueUrl(t,!0,e))+"".concat(r)}},{key:"getMetaFileUrl",value:function(t,e,n){var i;if(n=2<arguments.length&&void 0!==n?n:Tt[e],t)return"object"===r(t[e=wt[e]])&&t[e][n]?i=new URL(t[e][n]):"string"==typeof t[e]&&(i=new URL(t[e])),i?this.isHostCustom?"".concat(this.getBaseUrl(!1)).concat(i.pathname):i.toString():null}},{key:"getMetaOverrideFileUrls",value:function(t,e,r,n){return n=3<arguments.length&&void 0!==n?n:Tt[r],e&&e.communityOverrides&&e.communityOverrides[t]?(r=Et[r],r=e.communityOverrides[t][r]||{},Array.isArray(r)?r:r[n]||[]):[]}},{key:"getVersionedVenueUrl",value:function(e,r,n){return n=2<arguments.length?n:void 0,(n=1<arguments.length&&void 0!==r&&!r?"":this.getFileServiceBaseUrl(n))+t.getVersionedVenuePathSegment(e)}},{key:"getNormalizedUrl",value:function(t){if(this.isHostCustom){var e=new URL(t);return"".concat(this.getBaseUrl(!1)).concat(e.pathname)}return t}},{key:"getMetaConfig",value:function(t){var e=this;if(!t)return null;var n={venueId:t.cid};Object.values(wt).forEach(function(e){t[e]&&("string"==typeof t[e]?n[e]=t[e]:(n[e]={},Object.keys(t[e]).forEach(function(r){n[e][r]=t[e][r]})))});var i={},o=t.communityOverrides[n.venueId];return Object.keys(o).forEach(function(t){var n;Array.isArray(o[t])?i[t]=o[t].map(function(t){return"".concat(e.getFileServiceBaseUrl()).concat(t)}):"object"===r(o[t])&&(n={},Object.keys(o[t]).forEach(function(r){Array.isArray(o[t][r])&&(n[r]=o[t][r].map(function(t){return"".concat(e.getFileServiceBaseUrl()).concat(t)}))}),i[t]=n)}),n.communityOverrides=a({},n.venueId,i),u(u({},t),n)}}],[{key:"getVersionedVenuePathSegment",value:function(t,e,r){var n=1<arguments.length&&void 0!==e?e:"-";e=2<arguments.length&&void 0!==r?r:"-",r=Ce[Le.MAP];return"".concat(r,"/").concat(t,"/mv/").concat(n,"/ev/").concat(e)}},{key:"getVenueConfig",value:function(t){return(t=u(u({},He),t)).mapVersion=Number(t.mapVersion)||"-",t.entityVersion=Number(t.entityVersion)||"-",t.fileVersion=Number(t.fileVersion)||null,t.venueId=Number(t.venueId),t}}]),t}(),Ge=function(){l(e,Ue);var t=v(e);function e(r){var i;return n(this,e),(i=t.call(this,r)).setAndUpdateHostConfig_(r),r.fileHost&&(i.isHostCustom=!0),i}return o(e,[{key:"setAndUpdateHostConfig_",value:function(t){var e=t.apiKey,r=(t=t.fileHost,{});Object.keys(Ae.queryParamMap).forEach(function(t){r[t]={key:e}}),t&&(r[t]={key:e}),this.hostConfig_={apiKey:e,dataApiType:"MFS",fileHost:t||we,queryParamMap:u(u({},r),Ae.QUERY_PARAM_MAP_DEFAULT)}}},{key:"addServer",value:function(t,e){t=-1<t.indexOf("://")?t.split("://")[1]:t;var r=this.hostConfig_.queryParamMap[t]?u(u({},this.hostConfig_.queryParamMap[t]),e):e;Object.keys(r).forEach(function(t){null!==r[t]&&void 0!==r[t]&&""!==r[t]||delete r[t]}),this.hostConfig_.queryParamMap[t]=r}},{key:"appendQueryParams",value:function(t){var r=this.hostConfig_.queryParamMap,n=-1<t.indexOf("://")?t.split("://")[1]:t;r=r[g(Object.keys(r).filter(function(t){return n.startsWith(t)}).sort(function(t,e){return e.length-t.length}),1)[0]];return e.appendParamList(t,r)}},{key:"fetch",value:function(t,e,r,n){return n=3<arguments.length&&void 0!==n&&n,t.startsWith("http://")&&(t=t.replace(/http:\/\//gm,"https://")),n||(t=this.appendQueryParams(t)),Jt.get(t,e,r)}},{key:"getMapProductFileUrl",value:function(t,r,n,i,o,a){return y(c(e.prototype),"getMapProductFileUrl",this).call(this,t,r,n,i,o,a)}},{key:"getGlobalMetaFileUrl",value:function(t,r,n,i,o){return o=4<arguments.length&&void 0!==o?o:0,n=y(c(e.prototype),"getGlobalMetaFileUrl",this).call(this,t,r,n,i),i&&i===Ee.MPATH&&(n=e.appendParamList(n,{fvhistory:o})),n}}],[{key:"appendParamList",value:function(t,e){if(!e||"object"!==r(e))return t;var n=t.split("?"),i=g(n,2)[1],o=void 0===i?"":i;return Object.keys(e).filter(function(t){return-1===o.indexOf("".concat(t,"="))}).forEach(function(t){o+="&".concat(t,"=").concat(e[t])}),0<(o=o.startsWith("&")?o.substr(1):o).length?"".concat(n[0],"?").concat(o):t}}]),e}(),qe=function(){function t(){n(this,t)}return o(t,null,[{key:"isPointOnGeoJSONLineString",value:function(t,e){var r=!1;if(e&&1<e.length)for(var n,i,o=1;o<e.length;o+=1)if(n=e[o-1],i=e[o],$t.isPointOnLineSegment(t,n,i)){r=!0;break}return r}},{key:"isPointOnGeoJSONMultiLineString",value:function(e,r){for(var n=!1,i=0;i<r.length;i+=1)if(t.isPointOnGeoJSONLineString(e,r[i])){n=!0;break}return n}},{key:"isPointInsideGeoJSONPolygon",value:function(t,e){var r=!1;if($t.isPointInPolygon(t,e[0])&&(r=!0),r)for(var n=1;n<e.length;n+=1)if($t.isPointInPolygon(t,e[n])){r=!1;break}return r}},{key:"isPointInsideGeoJSONMultiPolygon",value:function(e,r){for(var n=r.length,i=0;i<n;i+=1)if(t.isPointInsideGeoJSONPolygon(e,r[i]))return!0;return!1}},{key:"convertIntAddressToGeometryAddressListFormat",value:function(t){if(t&&"string"==typeof t){var e=[];return t.split(" ").forEach(function(t){e.push.apply(e,m(t.split(" ")))}),e}return null}},{key:"getGeometriesByLonLat",value:function(t,e,r){for(var n=2<arguments.length&&void 0!==r&&r,i=[],o=e.filter(function(e){return $t.isPointInBoundingBox(t,e.getBoundingBox())}),a=0;a<o.length;a+=1){var s=o[a];if(s.isPointInsideGeometry(t,!0)&&(i.push(s),!n))break}return i.sort(function(t,e){return e.getZIndex()-t.getZIndex()})}}]),t}(),Ve=function(){function t(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=2<arguments.length?arguments[2]:void 0;n(this,t),this.venueModel=i,this.id=e,this.properties=u({geometry:[],int_address:[]},r)}return o(t,[{key:"getId",value:function(){return this.id}},{key:"getGeometries",value:function(){var t=this;return this.properties.geometry.filter(function(t){return g(t,2)[1]}).map(function(e){return e=g(e,1)[0],t.venueModel.getGeometryById(e)})}},{key:"getInternalAddress",value:function(){return this.properties.int_address||[]}},{key:"getName",value:function(){return(Array.isArray(this.properties.name)?this.properties.name[0]:this.properties.name)||""}},{key:"getProperties",value:function(){return this.properties}},{key:"getLabelInfo",value:function(){return this.venueModel.metaInformation_.getEntityLabelInfo(this)}}]),t}(),We=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length?arguments[1]:void 0,i=2<arguments.length?arguments[2]:void 0;n(this,t),this.id=e.id,this.properties=e.properties||{},this.labelArea=e.label_area||[],this.geometry=e.geometry||{},this.location=e.location||{},this.level=r,this.zIndex=i,this.state_={isHighlighted:!1,highlightedStyle:{}}}return o(t,[{key:"getId",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"getAddress",value:function(){return qe.convertIntAddressToGeometryAddressListFormat(this.getInternalAddress())}},{key:"getInternalAddress",value:function(){return this.properties.int_address||""}},{key:"getCenter",value:function(){return this.location.coordinates||[]}},{key:"getCoordinates",value:function(){return this.geometry.coordinates||[]}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getStyle",value:function(){return this.getMetaInformation_().getStyle(this)}},{key:"getIcon",value:function(){return this.getMetaInformation_().getIcon(this.getLabelInfo())}},{key:"getLabelArea",value:function(){return this.labelArea||[]}},{key:"getLabelInfo",value:function(){return this.getMetaInformation_().getLabelInfo(this)}},{key:"getLabelStyle",value:function(){return u({fill:"#333333"},this.getMetaInformation_().getLabelStyle(this.getStyle()))}},{key:"getGeometryLabelInfo",value:function(){return this.getMetaInformation_().getGeometryLabelInfo(this)}},{key:"getEntities",value:function(){var t=this;return(this.properties.entities||[]).map(function(e){return t.level.getDrawing().getVenueModel().getEntityById(e)})}},{key:"getLevel",value:function(){return this.level}},{key:"getType",value:function(){return this.geometry.type}},{key:"getZIndex",value:function(){return this.zIndex}},{key:"getBoundingBox",value:function(){var t=this.getType(),e=this.getCoordinates(),r=[];switch(t){case"Point":r=[e,e];break;case gt:case vt:r=e;break;case mt:case yt:r=e.reduce(function(t,e){return t.concat(e)},[]);break;case _t:r=e.reduce(function(t,e){return t.concat(e)},[]).reduce(function(t,e){return t.concat(e)},[])}return $t.getBoundingBoxVertices(r)}},{key:"isIcon",value:function(){var t=this.getLabelInfo();return t&&t.lt===ne.ICON}},{key:"isPointInsideGeometry",value:function(t,e){var r,n=1<arguments.length&&void 0!==e&&e,i=!1;switch(this.getType()){case"Point":r=this.getLabelArea()&&$t.getRectangularCoordinatesOfLabelArea(this.getLabelArea()),i=$t.isPointInPolygon(t,r);break;case gt:break;case vt:i=n&&qe.isPointOnGeoJSONLineString(t,this.getCoordinates());break;case mt:i=n&&qe.isPointOnGeoJSONMultiLineString(t,this.getCoordinates());break;case yt:i=qe.isPointInsideGeoJSONPolygon(t,this.getCoordinates());break;case _t:i=qe.isPointInsideGeoJSONMultiPolygon(t,this.getCoordinates())}return i}},{key:"highlight",value:function(t,e){t=!(0<arguments.length&&void 0!==t)||t,e=1<arguments.length?e:void 0,this.state_.isHighlighted=t,this.state_.highlightedStyle=t?e:{}}},{key:"isHighlighted",value:function(){return Boolean(this.state_.isHighlighted)}},{key:"getHighlightedStyle",value:function(){return this.state_.highlightedStyle||{}}},{key:"toJSON",value:function(){return u({},this.geometry)}},{key:"getMetaInformation_",value:function(){return this.getLevel()?this.getLevel().getDrawing().getVenueModel().metaInformation_:null}}]),t}(),Ye=function(){function t(e){var r=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],a=3<arguments.length?arguments[3]:void 0;n(this,t),this.id=e,this.properties=u({},i),this.zIndexCount=0,this.geometries=o.map(function(t){return r.zIndexCount+=1,new We(t,r,r.zIndexCount)}),this.drawing=a}return o(t,[{key:"getId",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getDrawing",value:function(){return this.drawing}},{key:"getShortName",value:function(){return this.properties["short name"]||""}},{key:"getZIndex",value:function(){return Number(this.properties.zlevel)}},{key:"getFeatureCollectionArray",value:function(){return this.getGeometries().map(function(t){return t.toJSON()})}},{key:"getGeometryById",value:function(t){return this.geometries.find(function(e){return e.getId()===t})}},{key:"getGeometries",value:function(t){return 0<arguments.length&&void 0!==t&&t?this.geometries.sort(function(t,e){return e.getZIndex()-t.getZIndex()}):this.geometries.sort(function(t,e){return t.getZIndex()-e.getZIndex()})}},{key:"getGeometriesByAddress",value:function(t){return this.geometries.filter(function(e){return e.getInternalAddress()===t})}},{key:"isMain",value:function(){return Boolean(this.properties.main)}}]),t}(),Ke=function(){function t(e){var r=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[],s=4<arguments.length?arguments[4]:void 0;n(this,t),this.venueModel=s,this.levels=a.map(function(t){return new Ye(t.id,t.properties,t.features,r)}),this.id=e,this.properties=i,this.frame_=o}return o(t,[{key:"getId",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"isRoot",value:function(){return Boolean(this.properties.is_root)}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getBoundingBox",value:function(){var t=(r=this.frame_).height,e=r.width,r=r.transform;t=(e=g($t.getBoundingBoxVertices([$t.convertMxMy2LonLat(r,[0,0]),$t.convertMxMy2LonLat(r,[0,t]),$t.convertMxMy2LonLat(r,[e,0]),$t.convertMxMy2LonLat(r,[e,t])]),2))[0];return[(e=e[1])[1],t[0],t[1],e[0]]}},{key:"getCenter",value:function(){var t=this.frame_;if(t)return $t.convertMxMy2LonLat(t.transform,[t.width/2,t.height/2])}},{key:"getGeometryById",value:function(t,e){return e?e.getGeometryById(t):this.getGeometries().find(function(e){return e.getId()===t})}},{key:"getGeometries",value:function(){return this.levels.flatMap(function(t){return t.getGeometries()})}},{key:"getLevelById",value:function(t){return this.levels.find(function(e){return e.getId()===t})}},{key:"getLevelByZIndex",value:function(t){return this.levels.find(function(e){return e.getZIndex()===t})}},{key:"getLevels",value:function(){return this.levels}},{key:"getMainLevel",value:function(){return this.levels.find(function(t){return t.isMain()})}},{key:"getVenueModel",value:function(){return this.venueModel}}]),t}(),Xe=bt.STANDARD,Ze=function(){function t(){var e=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:new xe;n(this,t),this.metaInformation_=a,this.id=r.id,this.location=r.location||{},this.properties=u({},r.properties),this.drawings=(r.drawings||[]).map(function(t){var r=t.levels.map(function(t){var e=t.id;return o.find(function(t){return t.id===e})});return new Ke(t.id,t.properties,t.ref_frame,r,e)}),this.entities=(i.entities||[]).map(function(t){return new Ve(t.id,t.properties,e)})}return o(t,[{key:"getDisplaySettings",value:function(){return this.metaInformation_.releaseSettings_.displayOptions.display||Xe}},{key:"getId",value:function(){return this.id}},{key:"getName",value:function(){return this.properties.name}},{key:"getBoundingBox",value:function(){var t,e=(t=g(e=$t.getBoundingBoxVertices(this.getDrawings().flatMap(function(t){var e=g(t.getBoundingBox(),4);t=e[0];return[[e[1],e[2]],[e[3],t]]})),2))[0];return[(t=t[1])[1],e[0],e[1],t[0]]}},{key:"getCenter",value:function(){return this.location.coordinates}},{key:"getEntityById",value:function(t){return this.entities.find(function(e){return e.id===t})}},{key:"getGeometryById",value:function(t){return this.getGeometries().find(function(e){return e.getId()===t})}},{key:"getGeometries",value:function(){return this.getLevels().sort(function(t,e){return t.getZIndex()-e.getZIndex()}).flatMap(function(t){return t.getGeometries()})}},{key:"getGeometriesByLonLat",value:function(t,e,r){var n=this;r=!(2<arguments.length&&void 0!==r)||r;return 0===(e=(1<arguments.length&&void 0!==e?e:[]).map(function(t){return n.getLevelById(t)})).length&&(e=this.drawings.filter(function(e){return e=e.getBoundingBox(),$t.isPointInBoundingBox(t,e)}).flatMap(function(t){return t.getLevels()})),qe.getGeometriesByLonLat(t,e.flatMap(function(t){return t.getGeometries(!0)}),r)}},{key:"getDrawingById",value:function(t){return this.drawings.find(function(e){return e.getId()===t})}},{key:"getDrawings",value:function(){return this.drawings}},{key:"getRootDrawing",value:function(){return this.drawings.find(function(t){return t.isRoot()})}},{key:"getLevelById",value:function(t){return this.getLevels().find(function(e){return e.getId()===t})}},{key:"getLevelsByZIndex",value:function(t){var e=0<arguments.length&&void 0!==t?t:0;return this.getLevels().filter(function(t){return Number(t.getZIndex())===Number(e)})}},{key:"getLevels",value:function(){return this.drawings.flatMap(function(t){return t.getLevels()})}},{key:"getLevelMapFlattenedByZIndex_",value:function(){return this.getLevels().reduce(function(t,e){var r=e.getZIndex();return(t=t)[r]||(t[r]=[]),t[r].push(e),t},{})}},{key:"getIconsInformation",value:function(){var t=new Map;return this.getGeometries().filter(function(t){return t.isIcon()}).forEach(function(e){e=e.getLabelInfo(),t.set(e.iconIdentifier,e)}),Array.from(t.values())}}]),t}(),$e={PRD:"vfs.venue.maps.api.here.com",STG:"vfs.sit.venue.maps.api.here.com"},Je=function(){l(e,Ue);var t=v(e);function e(r){var i=r.apiKey,o=r.fileHost;r=r.token;return n(this,e),r=t.call(this,{apiKey:i,fileHost:o||$e.PRD,token:r}),o&&(r.isHostCustom=!0),r}return o(e,[{key:"fetch",value:function(t,e,r){var n=(o=this.hostConfig_).apiKey,i=o.token,o=u({method:"GET",headers:{}},e);return(e=t).startsWith("http://")&&(e=e.replace(/http:\/\//gm,"https://")),i?(t="Bearer ",i=i.startsWith(t)?i:"".concat(t).concat(i),o.headers instanceof Headers?o.headers.append("Authorization",i):o.headers.Authorization=i):n&&(e="".concat(e,"?apiKey=").concat(n)),Jt.get(e,o,r)}}]),e}(),Qe={isIconsEnabled:!0,isMetaEnabled:!0,metaOptions:{},iconOptions:{}},tr=Object.keys(wt).map(function(t){return{identifier:t,name:void 0,url:void 0}}),er=function(){function t(e){var r=e.apiKey,i=e.baseUrl,o=e.token;e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];n(this,t),o={apiKey:r,fileHost:i,token:o},this.dataApi_=new(e?Ge:Je)(o)}return o(t,[{key:"load",value:function(t,e){var r=this,n=(e=1<arguments.length&&void 0!==e?e:{},(e=u(u({},Qe),e)).isIconsEnabled),i=e.isMetaEnabled,o=e.iconOptions,a=e.metaOptions;return Promise.resolve().then(function(){return i?r.getMeta_(t,a).catch(function(t){return Promise.resolve()}):new xe}).then(function(e){return r.getVenue_(t,e)}).then(function(e){if(Yt.emit(Wt.VENUE_MAP_DATA_LOADED,{data:e}),n){var i=e.getIconsInformation();return r.getIcons_(t,e.metaInformation_,i,o).then(function(){return e})}return e})}},{key:"getVenue_",value:function(t,e){var r=this;return this.getCommunityMap_(t).then(function(e){return Promise.all([Promise.resolve(e),r.getCommunityEntity_(t),r.getLevels_(t,e.drawings.flatMap(function(t){return t.levels.map(function(t){return t.id})}))])}).then(function(t){var r=(n=g(t,3))[0],n=(t=n[1],n[2]);return new Ze(r,t,void 0===n?[]:n,e)})}},{key:"getCommunityMap_",value:function(t){return this.dataApi_.getGeoJsonApi().getCommunityMap(t).catch(function(e){return Promise.reject(new Error("Community map load failed for venue id ".concat(t,' with error "\n ').concat(e.message,'"')))})}},{key:"getCommunityEntity_",value:function(t){return this.dataApi_.getGeoJsonApi().getCommunityEntity(t).catch(function(e){return Promise.reject(new Error("Community Entity failed for venue id ".concat(t,' with error "').concat(e.message,'"')))})}},{key:"getLevels_",value:function(t,e){var r=this;e=1<arguments.length&&void 0!==e?e:[];return Promise.all(e.map(function(e){return r.dataApi_.getGeoJsonApi().getGeoJsonLevelGeometry(t,e).catch(function(t){return Promise.reject(new Error("Level load failed for level id ".concat(e,' with error: "').concat(t.message,'"')))})}))}},{key:"getIcon_",value:function(t,e,r,n){var i=2<arguments.length&&void 0!==r?r:{},o=3<arguments.length&&void 0!==n&&n,a=i.iconIdentifier;n=i.url;return a&&n?this.dataApi_.fetch(this.dataApi_.getNormalizedUrl(n)).then(function(t){return t=new te(u(u({},i),t),o),e.setIcon(a,t),t}):Promise.reject(new Error("Issue with icon data, iconIdentifier and url should be available: ".concat(i)))}},{key:"getIcons_",value:function(t,e,r,n){var i=this,o=(r=2<arguments.length&&void 0!==r?r:[],(3<arguments.length&&void 0!==n?n:{}).isMultiObjectToSplit);return Promise.all(r.map(function(r){return i.getIcon_(t,e,r,o).catch(function(t){return Promise.resolve(r)})})).catch(function(t){return Promise.resolve()})}},{key:"getMeta_",value:function(t,e,r){var n=this,i=1<arguments.length&&void 0!==e?e:{},o=2<arguments.length&&void 0!==r?r:tr,a=new xe;return Promise.resolve().then(function(){return n.getMetaConfig_(t,i).then(function(t){return a.releaseSettings_=t.settings,n.dataApi_.getMetaConfig(t)})}).then(function(e){return n.getMetaFiles_(e,a,o).then(function(){return n.getMetaOverrides_(t,e,a,o)})}).then(function(){return a})}},{key:"getMetaConfig_",value:function(t){return t=this.dataApi_.getMetaConfigUrl(t),this.dataApi_.fetch(t).catch(function(t){return Promise.reject(t)})}},{key:"getMetaFiles_",value:function(t,e,r,n){var i=this,o=(r=2<arguments.length&&void 0!==r?r:[],!(3<arguments.length&&void 0!==n)||n);return Promise.all(r.map(function(r){var n=r.identifier,a=r.name;return!(r=r.url)&&o&&(r=i.dataApi_.getMetaFileUrl(t,n,a)),r=r||i.dataApi_.getGlobalMetaFileUrl(n,a),i.dataApi_.fetch(r).then(function(t){return e.instantiateMetaFileAccessor_(n,t),t}).catch(function(t){return Promise.resolve()})}))}},{key:"getMetaOverrides_",value:function(t,e,r,n){var i=this;n=3<arguments.length&&void 0!==n?n:[];return Promise.all(n.map(function(n){var o=n.identifier,a=n.name;n=o,a=a,a=t&&e&&i.dataApi_.getMetaOverrideFileUrls(t,e,n,a)||[];return Promise.all(a.map(function(t){return i.dataApi_.fetch(t).then(function(t){return r[o]&&r[o].applyOverride(t,!1),Promise.resolve()}).catch(function(t){return Promise.resolve()})}))}))}}]),t}(),rr="https://meta-indoor-routing.api-gateway.ls.hereapi.com",nr=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(n(this,t),!e.apiKey&&!e.token)throw new Error("API key or Token is missing");this.config_=u({baseUrl:rr},e)}return o(t,[{key:"calculateRoute",value:function(t){var e=void 0===(i=t.origin)?{}:i,n=void 0===(o=t.destination)?{}:o,i=function(t,e){if(null==t)return{};var r,n=function(t,e){if(null==t)return{};for(var r,n={},i=Object.keys(t),o=0;o<i.length;o++)r=i[o],0<=e.indexOf(r)||(n[r]=t[r]);return n}(t,e);if(Object.getOwnPropertySymbols)for(var i=Object.getOwnPropertySymbols(t),o=0;o<i.length;o++)r=i[o],0<=e.indexOf(r)||Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r]);return n}(t,["origin","destination"]);if(!e.coordinates||!n.coordinates)throw new Error("Waypoint coordinates are missing");var o=function(t){var e=t.coordinates,r=t.venueId;t=t.levelId,e=e.join(",");return r&&t?e.concat(";indoorMapId=",r,";levelId=",t):e},a=(t=new URL("".concat(this.config_.baseUrl,"/v1/routes")),new URLSearchParams({origin:o(e),destination:o(n),apiKey:this.config_.apiKey}));return Object.entries(i).forEach(function(t){t=(e=g(t,2))[0];var e=e[1];a.append(t,"object"===r(e)?JSON.stringify(e):e)}),t.search=a,fetch(t,{headers:{"X-Api-Key":this.config_.apiKey}}).then(function(t){return t.json()})}}]),t}(),ir=function(){l(e,H.map.Feature);var t=v(e);function e(r){var i;if(n(this,e),i=t.call(this),!(r instanceof Ze))throw new Error("It is mandatory to provide valid instance of venueModel");return i.venueModel=r,i.search_=new dt(r),i.status_={activeDrawingId:r.getRootDrawing().getId(),activeLevelIndex:r.getRootDrawing().getMainLevel().getZIndex()},i.mapObjectStore_=i.getDefaultMapObjectsStore_(),i.drawings=r.getDrawings().map(function(t){return(t=new w(t)).setParentEventTarget(d(i)),t}),i.levels=r.getLevels().map(function(t){var e=new E(t);return e.setParentEventTarget(i.drawings.find(function(t){return t.getId()===e.getData().getDrawing().getId()})),e}),i.geometries=r.getGeometries().map(function(t){var e=new x(t);return e.setParentEventTarget(i.levels.find(function(t){return t.getId()===e.getData().getLevel().getId()})),e}),i}return o(e,[{key:"getData",value:function(){return this.venueModel}},{key:"getBoundingBox",value:function(){return p(H.geo.Rect,m(this.venueModel.getBoundingBox()))}},{key:"getCenter",value:function(){var t=(e=g(this.venueModel.getCenter(),2))[0],e=e[1];return new H.geo.Point(e,t)}},{key:"getId",value:function(){return this.venueModel.getId()}},{key:"getName",value:function(){return this.venueModel.getName()}},{key:"getDrawing",value:function(t){return this.drawings.find(function(e){return e.getId()===t})}},{key:"getDrawings",value:function(){return this.drawings}},{key:"getLevel",value:function(t){return this.levels.find(function(e){return e.getId()===t})}},{key:"getLevels",value:function(){return this.levels}},{key:"getGeometry",value:function(t){return this.geometries.find(function(e){return e.getId()===t})}},{key:"getGeometries",value:function(){return this.geometries}},{key:"getActiveLevels",value:function(){var t=this;return this.getData().getDisplaySettings()===bt.FLATTEN?this.venueModel.getLevelsByZIndex(this.status_.activeLevelIndex).map(function(e){return t.getLevel(e.getId())}):[this.venueModel.getDrawingById(this.status_.activeDrawingId).getLevelByZIndex(this.status_.activeLevelIndex)].map(function(e){return t.getLevel(e.getId())})}},{key:"getActiveDrawing",value:function(){return this.getDrawing(this.status_.activeDrawingId)}},{key:"setActiveDrawing",value:function(t){if(this.status_.activeDrawingId!==t){var r=this.venueModel.getDrawingById(t);if(!r)throw new Error("Drawing ".concat(t," was not found"));var n=this.status_.activeDrawingId;this.status_.activeDrawingId=t,this.setActiveLevelIndex(r.getMainLevel().getZIndex()),this.dispatchEvent(new H.util.ChangeEvent(e.EVENTS.DRAWING_CHANGE,t,n))}}},{key:"getActiveLevelIndex",value:function(){return this.status_.activeLevelIndex}},{key:"setActiveLevelIndex",value:function(t){var r;this.venueModel.getLevelsByZIndex(t)&&(r=this.status_.activeLevelIndex,this.status_.activeLevelIndex=t,this.dispatchEvent(new H.util.ChangeEvent(e.EVENTS.LEVEL_CHANGE,t,r)))}},{key:"isActive",value:function(){var t=this.getParentEventTarget();return!!t&&this===t.activeVenue}},{key:"getHighlightedGeometries",value:function(){var t=this;return this.venueModel.getGeometries().filter(function(t){return t.isHighlighted()}).map(function(e){return t.getGeometry(e.getId())})}},{key:"setHighlightedGeometries",value:function(t,r,n){var i=!(0<arguments.length&&void 0!==t)||t,o=(r=1<arguments.length&&void 0!==r?r:[],n=2<arguments.length&&void 0!==n?n:{},(n=u(u({},it),n)).fillColor),a=n.outlineColor,s=n.outlineWidth;r.forEach(function(t){t.getData().highlight(i,{m:o,o:a,w:s})}),this.dispatchEvent(e.EVENTS.GEOMETRY_HIGHLIGHT)}},{key:"getMapObjects",value:function(t,e){return t=0<arguments.length&&void 0!==t?t:this.getActiveLevelIndex(),e=1<arguments.length&&void 0!==e?e:this.getActiveDrawing(),this.mapObjectStore_[t][e.getId()]}},{key:"setMapObjects",value:function(t,e,r){t=0<arguments.length&&void 0!==t?t:[],e=1<arguments.length&&void 0!==e?e:this.getActiveLevelIndex(),r=2<arguments.length&&void 0!==r?r:this.getActiveDrawing(),this.mapObjectStore_[e]&&this.mapObjectStore_[e][r.getId()]&&(this.mapObjectStore_[e][r.getId()]=m(t)),this.updateMapObjectsVisibility_()}},{key:"search",value:function(t){var e=this;t=0<arguments.length&&void 0!==t?t:"";return this.search_.find(t).flatMap(function(t){return t.geometries.map(function(t){return e.getGeometry(t.getId())})})}},{key:"updateMapObjectsVisibility_",value:function(){Object.values(this.mapObjectStore_).forEach(function(t){Object.values(t).forEach(function(t){return t.forEach(function(t){return t.setVisibility(!1)})})}),this.isActive()&&this.mapObjectStore_[this.getActiveLevelIndex()][this.getActiveDrawing().getId()].forEach(function(t){return t.setVisibility(!0)})}},{key:"getDefaultMapObjectsStore_",value:function(){var t=this,e=this.getData().getDisplaySettings()===bt.FLATTEN;return this.venueModel.getLevels().reduce(function(r,n){var i=n.getZIndex();return(r=u({},r))[i]||(r[i]={}),r[i][n.getDrawing().getId()]=[],e&&(r[i][t.venueModel.getRootDrawing().getId()]=[]),r},{})}}]),e}();function or(t,e,r){return r===gr.ObjectType.SEGMENT_START_MARKER?0===t?pr:vr:r===gr.ObjectType.SEGMENT_FINISH_MARKER?1===e.length||t===e.length-1?dr:yr:"indoor"===e[t].departure.place.type?hr:fr}ir.EVENTS={ACTIVE_VENUE_CHANGE:"activevenuechange",DRAWING_CHANGE:"drawingchange",LEVEL_CHANGE:"levelchange",GEOMETRY_HIGHLIGHT:"geometryhighlight"};var ar=function(){function t(){n(this,t)}return o(t,null,[{key:"getIconLayer",value:function(t){return{type:"FeatureCollection",features:(0<arguments.length&&void 0!==t?t:[]).flatMap(function(t){return t.getData().getGeometries()}).filter(function(t){return t.isIcon()&&t.getIcon()}).map(function(t){var e=(i=g(t.getLabelArea(),2))[0],r=i[1],n=t.getLevel(),i=t.getIcon().getSVG();return{type:"Feature",properties:{id:t.getId(),geometryId:t.getId(),levelId:n.getId(),name:t.getDisplayName(),venueId:n.getDrawing().getVenueModel().getId(),url:i?"data:image/svg+xml;utf8,".concat(encodeURIComponent(i)):""},geometry:{type:Z,coordinates:[e,r]}}})}}},{key:"getLabelLayer",value:function(t){return{type:"FeatureCollection",features:(0<arguments.length&&void 0!==t?t:[]).flatMap(function(t){return t.getData().getGeometries()}).filter(function(t){return t.getDisplayName()&&!t.isIcon()}).map(function(t){var e=(i=g(t.getLabelArea(),2))[0],r=i[1],n=(o=t.getLabelStyle()).fill,i=o.zmin,o=t.getLevel();return{type:"Feature",properties:{id:t.getId(),geometryId:t.getId(),levelId:o.getId(),venueId:o.getDrawing().getVenueModel().getId(),name:t.getDisplayName(),minZoom:i||15,textFillColor:n.toLowerCase()},geometry:{type:Z,coordinates:[e,r]}}})}}},{key:"getGeometryLayer",value:function(t){return{type:"FeatureCollection",features:(0<arguments.length&&void 0!==t?t:[]).flatMap(function(t){return t.getData().getGeometries()}).filter(function(t){return t.getType()!==Z}).map(function(t){var e=(c=t.getHighlightedStyle()||{}).m,r=c.o,n=c.w,i=(h=u({},t.getStyle())).m,o=h.o,a=h.w,s=tt,l=et,c=rt,h=t.getLevel();return{type:"Feature",properties:{id:t.getId(),fillColor:(e||i||s).toLowerCase(),geometryId:t.getId(),levelId:h.getId(),venueId:h.getDrawing().getVenueModel().getId(),outlineColor:(r||o||l).toLowerCase(),outlineWidth:Number(((n||a||c)/3).toFixed(2)),zIndex:t.getZIndex()},geometry:{type:t.getType(),coordinates:t.getCoordinates()}}})}}},{key:"getFootprintLayer",value:function(t){return{type:"FeatureCollection",features:t.flatMap(function(t){var e=t.getData().getRootDrawing().getMainLevel().getId(),r=t.getLevel(e).getData().getGeometries().filter(function(t){return t.getType()===$});return[{type:"Feature",properties:{isFootprint:!0,levelId:e,venueId:t.getId(),zIndex:1},geometry:{type:"MultiPolygon",coordinates:r.map(function(t){return t.getCoordinates()})}},{type:"Feature",properties:{isFootprint:!0,levelId:e,venueId:t.getId(),zIndex:2,venueName:t.getName()},geometry:{type:"Point",coordinates:t.getCenter().toGeoJSON().coordinates.slice(0,2)}}]})}}}]),t}(),sr=function(){function t(){n(this,t)}return o(t,null,[{key:"getStyle",value:function(t){t=0<arguments.length&&void 0!==t?t:[];var e={styles:[{layer:ot.FOOTPRINT,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#613F8E",lineWidth:"2px",renderOrder:1},{layer:ot.FOOTPRINT,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:"#AF91B4",renderOrder:2},{layer:ot.FOOTPRINT,when:["==",["geometry-type"],"Point"],technique:"text",color:"black",size:16,text:["get","venueName"],priority:61},{layer:ot.VECTOR,when:["==",["geometry-type"],"Polygon"],technique:"fill",color:["get","fillColor"],renderOrder:["get","zIndex"]},{layer:ot.VECTOR,technique:"solid-line",color:["get","outlineColor"],lineWidth:["get","outlineWidth"],renderOrder:["get","zIndex"]},{layer:ot.TEXT,minZoomLevel:["get","minZoom"],technique:"text",color:["get","textFillColor"],size:nt,text:["get","name"],priority:60},{layer:ot.ICON,minZoomLevel:18,when:["==",["geometry-type"],"Point"],technique:"labeled-icon",textIsOptional:!0,size:0,imageTexture:["concat","texture",["get","name"]],screenWidth:["interpolate",["linear"],["zoom"],15,3,21,25],screenHeight:["interpolate",["linear"],["zoom"],15,3,21,25],priority:61}],images:{},imageTextures:[]};return t.forEach(function(t){var r="texture"+t.properties.name;e.images[r]||(e.images[r]={url:t.properties.url,preload:!0},e.imageTextures.push({name:r,image:r}))}),new H.map.render.harp.Style(e)}}]),t}(),ur=function(){function t(){n(this,t)}return o(t,null,[{key:"getIconsTextures",value:function(t){var e={},r={},n=(0<arguments.length&&void 0!==t?t:[]).reduce(function(t,e){var r=e.properties.name;return t[r]||(t[r]=[]),t[r].push(e),t},{});return Object.keys(n).forEach(function(t){var i="texture".concat(t),o="sprite".concat(t),s=n[t][0].properties.url;e[i]={url:s,sprites:a({},o,[0,0,50,50])},n[t].forEach(function(t){t=t.properties,r["icon".concat(t.name)]={filter:{name:t.name,$zoom:{min:18}},draw:{points:{interactive:!0,priority:1,size:[[15,"5%"],[16,"10%"],[17,"15%"],[18,"25%"],[19,"35%"],[20,"40%"],[21,"50%"]],texture:i,sprite:o}}}})}),{textures:e,iconLayers:r}}},{key:"getFootprintLayer",value:function(){return{data:{source:"venues",layer:ot.FOOTPRINT},draw:{polygons:{interactive:!0,color:"#AF91B4",order:2},lines:{color:"#613F8E",width:"2px",order:1},points:{color:"[0, 0, 0, 0]",size:"0px",order:3,priority:1,text:{anchor:"center",collide:!1,font:{fill:"black",size:"16px"},text_source:"function() { return feature.venueName }"}}}}}},{key:"getGeometryLayer",value:function(){return{data:{source:"venues",layer:ot.VECTOR},draw:{polygons:{interactive:!0,color:"function() { return feature.fillColor }",order:"function() { return feature.zIndex }"},lines:{color:"function() { return feature.outlineColor }",order:"function() { return feature.zIndex }",width:"function() { return feature.outlineWidth }"}}}}},{key:"getTextLayer",value:function(){return{filter:{$zoom:{min:18}},data:{source:"venues",layer:ot.TEXT},draw:{points:{filter:"function() { return $zoom > feature.minZoom }",color:"[0, 0, 0, 0]",size:"0px",offset:["0px","-10px"],priority:2,text:{font:{fill:"function() { return feature.textFillColor }",size:nt},text_source:"function() { return feature.name }"}}}}}},{key:"getIconLayer",value:function(t){return u({data:{source:"venues",layer:ot.ICON}},t)}},{key:"getStyle",value:function(e){e=(r=t.getIconsTextures(0<arguments.length&&void 0!==e?e:[])).textures;var r=r.iconLayers;r={venue_footprints:t.getFootprintLayer(),venue_geometries:t.getGeometryLayer(),venue_labels:t.getTextLayer(),venue_icons:t.getIconLayer(r)},e=H.gl.yaml.safeDump({sources:{venues:{max_zoom:24,type:"GeoJSONTileSource"}},layers:r,textures:e});return new H.map.render.webgl.Style(e)}}]),t}(),lr={type:"FeatureCollection",features:[]},cr={extent:4096,indexMaxZoom:0,maxZoom:24,tolerance:3},hr=(Ne=function(){l(e,H.map.provider.RemoteTileProvider);var t=v(e);function e(r){return n(this,e),(r=t.call(this,r)).venues=[],r.activeVenue=null,r.dataLayers_={},r.tileIndexes_={},r.addEventListener(ir.EVENTS.ACTIVE_VENUE_CHANGE,r.activeVenueChangeHandler_,void 0,d(r)),r}return o(e,[{key:"setStyle",value:function(t){return this.setStyleInternal(t)}},{key:"getStyle",value:function(){return this.getStyleInternal()}},{key:"isFeatureVisible_",value:function(t,e){var r=t.properties;return this.activeVenue&&r.venueId===this.activeVenue.getId()?e!==ot.FOOTPRINT&&this.activeVenue.getActiveLevels().some(function(t){return t.id===r.levelId}):!0===r.isFootprint&&e===ot.FOOTPRINT}},{key:"requestInternal",value:function(t,e,r,n){function i(n){for(var i=0;i<n.length;i+=1)n[i]=n[i].map(function(n){return X(n,r,t,e,cr.extent)})}var o=this,a={};return Object.keys(this.tileIndexes_).forEach(function(n){var s=o.tileIndexes_[n].getTile(r,t,e);a[n]=s?function(t){var e=[],r=t&&t.features;if(r)for(var n=0,i=r.length;n<i;n+=1){var o=r[n],a=o.type,s=void 0,u=!1;switch(a){case 1:s={type:"MultiPoint",coordinates:o.geometry.map(function(t){return t.slice()})};break;case 2:case 3:s={type:J,coordinates:o.geometry.map(function(t){return t.map(function(t){return t.slice()})})},3===a&&null==(s=K(s))&&(u=!0);break;default:u=!0}u||e.push({geometry:s,id:o.id,properties:o.tags,type:"Feature"})}return{type:"FeatureCollection",features:e}}(s):lr,a[n].features=a[n].features.filter(function(t){return o.isFeatureVisible_(t,n)});for(var u=0;u<a[n].features.length;u+=1){var l=a[n].features[u],c=l.geometry.type;if(c===$||c===J)i(l.geometry.coordinates);else if(c===Q)l.geometry.coordinates.map(i);else for(var h=l.geometry.coordinates,f=0;f<h.length;f+=1)h[f]=X(h[f],r,t,e,cr.extent)}}),n(a),{cancel:function(){}}}},{key:"getActiveVenue",value:function(){return this.activeVenue}},{key:"getVenue",value:function(t){return t?this.venues.find(function(e){return e.getId()===Number(t)}):this.activeVenue}},{key:"setActiveVenue",value:function(t){var e=this.activeVenue;this.activeVenue=t,this.dispatchEvent(new H.util.ChangeEvent(ir.EVENTS.ACTIVE_VENUE_CHANGE,t,e)),this.reload()}},{key:"addVenue",value:function(t,e){var r=1<arguments.length&&void 0!==e&&e;if(!(t instanceof ir))throw new Error("Invalid argument");if(e=t.getId(),this.getVenue(e))throw new Error("Please invoke provider.removeVenue to remove old instance of venue ".concat(e," before adding new"));t.setParentEventTarget(this),this.venues.push(t),r||(this.reloadData_(),this.reloadStyle_())}},{key:"addVenues",value:function(t){var e=this;0<(t=0<arguments.length&&void 0!==t?t:[]).length&&(t.forEach(function(t){t instanceof ir&&e.addVenue(t,!0)}),this.reloadData_(),this.reloadStyle_())}},{key:"removeVenue",value:function(t){var e;t instanceof ir&&-1<this.venues.indexOf(t)&&(e=t.getId(),this.activeVenue&&this.activeVenue.getId()===e&&this.setActiveVenue(null),this.venues.splice(this.venues.indexOf(t),1),this.reloadData_(),this.reloadStyle_(),this.reload())}},{key:"getFeatureProxy",value:function(t,e,r){var n=t.geometryId;t=t.venueId,t=this.getVenue(t);return n?r(t.getGeometries().find(function(t){return t.id===n})):t&&r(t),!0}},{key:"addVenueEventListeners_",value:function(t){t&&(t.addEventListener(ir.EVENTS.GEOMETRY_HIGHLIGHT,this.geometryHighlightHandler_,void 0,this),t.addEventListener(ir.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),t.addEventListener(ir.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this))}},{key:"removeVenueEventListeners_",value:function(t){t&&(t.removeEventListener(ir.EVENTS.GEOMETRY_HIGHLIGHT,this.geometryHighlightHandler_,void 0,this),t.removeEventListener(ir.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),t.removeEventListener(ir.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this))}},{key:"activeVenueChangeHandler_",value:function(t){var e=t.oldValue;t=t.newValue;e&&(this.removeVenueEventListeners_(e),e.updateMapObjectsVisibility_()),t&&(this.addVenueEventListeners_(t),t.updateMapObjectsVisibility_())}},{key:"drawingChangeHandler_",value:function(){this.reload()}},{key:"levelChangeHandler_",value:function(){this.activeVenue&&(this.activeVenue.updateMapObjectsVisibility_(),this.reload())}},{key:"geometryHighlightHandler_",value:function(){this.reloadData_([ot.VECTOR]),this.reload()}},{key:"createDataLayers_",value:function(t){var e=this,r=(t=0<arguments.length&&void 0!==t?t:Object.keys(ot),ot.FOOTPRINT),n=ot.ICON,i=ot.TEXT,o=ot.VECTOR;t.forEach(function(t){switch(t){case o:e.dataLayers_[o]=ar.getGeometryLayer(e.venues);break;case r:e.dataLayers_[r]=ar.getFootprintLayer(e.venues);break;case n:e.dataLayers_[n]=ar.getIconLayer(e.venues);break;case i:e.dataLayers_[i]=ar.getLabelLayer(e.venues);break;default:throw new Error("Unsupported Layer ".concat(t))}})}},{key:"createTileIndexes_",value:function(t){var e=this;(0<arguments.length&&void 0!==t?t:Object.keys(ot)).forEach(function(t){e.tileIndexes_[t]=new W(e.dataLayers_[t],cr)})}},{key:"reloadData_",value:function(t){t=0<arguments.length&&void 0!==t?t:Object.keys(ot),this.createDataLayers_(t),this.createTileIndexes_(t)}},{key:"reloadStyle_",value:function(){var t=this.dataLayers_[ot.ICON]?this.dataLayers_[ot.ICON].features:[];this.getEngineType()===H.Map.EngineType.WEBGL?this.setStyle(ur.getStyle(t)):this.getEngineType()===H.Map.EngineType.HARP&&this.setStyle(sr.getStyle(t))}},{key:"providesGeoJSON",value:function(){return!0}}]),e}(),new H.map.SpatialStyle({strokeColor:"#1ab4bf",lineWidth:3})),fr=new H.map.SpatialStyle({strokeColor:"#1ab4bf",lineWidth:3}),pr=new H.map.Icon("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI1MCIgdmlld0JveD0iMCAwIDQwIDUwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImIiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzNC4yNSAzMS42NTJ6Ii8+PHBhdGggaWQ9ImEiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzNC4yNSAzMS42NTJ6Ii8+PG1hc2sgaWQ9ImMiIHdpZHRoPSIzOCIgaGVpZ2h0PSI0NiIgeD0iMCIgeT0iMCIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZWxsaXBzZSBjeD0iMjAiIGN5PSI0NS4xNiIgZmlsbD0iI0ZGRiIgc3Ryb2tlPSIjOTc5Nzk3IiBzdHJva2Utd2lkdGg9Ii4yNSIgcng9IjMuNSIgcnk9IjMuNSIvPjx1c2UgZmlsbD0iIzAxQjZCMiIgeGxpbms6aHJlZj0iI2IiLz48cGF0aCBmaWxsPSIjMzIzMjMyIiBmaWxsLW9wYWNpdHk9Ii41IiBkPSJNMTEuODEgMzcuNjZoMTYuMzhsLTguMiA4eiIvPjx1c2Ugc3Ryb2tlPSIjNDE2QTg2IiBzdHJva2Utd2lkdGg9Ii41IiBtYXNrPSJ1cmwoI2MpIiB4bGluazpocmVmPSIjYSIvPjxlbGxpcHNlIGN4PSIxOS44MSIgY3k9IjE5LjE5IiBmaWxsPSIjRkZGIiByeD0iNC44MSIgcnk9IjQuODEiLz48L2c+PC9zdmc+"),dr=new H.map.Icon("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI1MCIgdmlld0JveD0iMCAwIDQwIDUwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImEiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzMi44MyAzMy4xMDRjLjQwNy0uMzc0IDEuNDE5LTEuNDUyIDEuNDE5LTEuNDUyeiIvPjxtYXNrIGlkPSJjIiB3aWR0aD0iMzgiIGhlaWdodD0iNDYiIHg9IjAiIHk9IjAiIGZpbGw9IiNmZmYiPjx1c2UgeGxpbms6aHJlZj0iI2EiLz48L21hc2s+PGVsbGlwc2UgaWQ9ImIiIGN4PSIxOS44MDciIGN5PSIxOS4xNjgiIHJ4PSIxMi4zNjMiIHJ5PSIxMi4xOTciLz48bWFzayBpZD0iZCIgd2lkdGg9IjI1LjcyNSIgaGVpZ2h0PSIyNS4zOTQiIHg9Ii0uNSIgeT0iLS41Ij48cGF0aCBmaWxsPSIjZmZmIiBkPSJNNi45NDQgNi40NzFoMjUuNzI1djI1LjM5NEg2Ljk0NHoiLz48dXNlIHhsaW5rOmhyZWY9IiNiIi8+PC9tYXNrPjwvZGVmcz48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxlbGxpcHNlIGN4PSIyMCIgY3k9IjQ1LjE2IiBmaWxsPSIjRkZGIiBzdHJva2U9IiM5Nzk3OTciIHN0cm9rZS13aWR0aD0iLjI1IiByeD0iMy41IiByeT0iMy41Ii8+PHVzZSBmaWxsPSIjMzIzMjMyIiB4bGluazpocmVmPSIjYSIvPjxwYXRoIGZpbGw9IiM3RDdEN0QiIGQ9Ik0xMi4wMTEgMzcuODA1aDE1Ljk3OGwtNy45MTYgOHoiLz48dXNlIHN0cm9rZT0iIzdDN0M3QyIgc3Ryb2tlLXdpZHRoPSIuNSIgbWFzaz0idXJsKCNlKSIgeGxpbms6aHJlZj0iI2EiLz48dXNlIHN0cm9rZT0iI0ZGRiIgc3Ryb2tlLXdpZHRoPSIuNSIgbWFzaz0idXJsKCNjKSIgeGxpbms6aHJlZj0iI2EiLz48ZWxsaXBzZSBmaWxsPSIjRkZGIiBjeD0iMTkuODA3IiBjeT0iMTkuMTY4IiByeD0iMTIuMzYzIiByeT0iMTIuMTk3Ii8+PHBhdGggZmlsbD0iIzMyMzIzMiIgZD0iTTYuODEyIDYuOTQ4aDYuNDV2Ni4zNjRoLTYuNDV6bTAgMTIuNzI3aDYuNDV2Ni4zNjRoLTYuNDV6bTYuNDUtNi4zNjNoNi40NXY2LjM2NGgtNi40NXptMCAxMi43MjdoNi40NXY2LjM2NGgtNi40NXptNi40NS0xOS4wOTFoNi40NXY2LjM2NGgtNi40NXptMCAxMi43MjdoNi40NXY2LjM2NGgtNi40NXptNi40NS02LjM2M2g2LjQ1djYuMzY0aC02LjQ1em0wIDEyLjcyN2g2LjQ1djYuMzY0aC02LjQ1eiIvPjx1c2Ugc3Ryb2tlPSIjRkZGIiBtYXNrPSJ1cmwoI2QpIiB4bGluazpocmVmPSIjYiIgc3Ryb2tlLWxpbmVjYXA9InNxdWFyZSIvPjwvZz48L3N2Zz4="),vr=null,yr=null,gr=function(){function t(e,r){n(this,t),this.indoorMapObjects_=null,this.outdoorMapObjects_=null,this.createRouteObjects_(e,r)}return o(t,[{key:"createRouteObjects_",value:function(e,r){var n=this,i=void 0===(e=e.sections)?[]:e,o=1<arguments.length&&void 0!==r?r:or;this.indoorMapObjects_={},this.outdoorMapObjects_=new H.map.Group;for(var a=function(e){var r,a=i[e],s=(r=a.departure.place).id,l=r.type,c=H.util.flexiblePolyline.decode(a.polyline).polyline,h=void 0,f=void 0;(r=o(e,i,t.ObjectType.SEGMENT_START_MARKER))&&(h=new H.map.Marker(a.departure.place.location,{icon:r})),(r=o(e,i,t.ObjectType.SEGMENT_FINISH_MARKER))&&(f=new H.map.Marker(a.arrival.place.location,{icon:r}));var p,d=o(e,i,t.ObjectType.SEGMENT_POLYLINE);"indoor"===l?(l=function(t){t=0<arguments.length&&void 0!==t?t:[];var e=new Map,r=new H.geo.LineString,n=g(t[0],3)[2];return e.set(n,[r]),t.forEach(function(t){t[2]!==n&&(n=t[2],r=new H.geo.LineString,e.has(n)?e.get(n).push(r):e.set(n,[r])),r.pushLatLngAlt.apply(r,m(t))}),e}(c),p=Array.from(l.keys()).reduce(function(t,e){return t[e]||(t[e]=new H.map.Group),t},{}),d&&l.forEach(function(t,e){t.forEach(function(t){1<t.getPointCount()&&(t=new H.map.Polyline(t,{style:d}),p[e].addObject(t))})}),h&&p[a.departure.place.location.lvl].addObject(h),f&&p[a.arrival.place.location.lvl].addObject(f),n.indoorMapObjects_[s]=u(u({},n.indoorMapObjects_[s]||{}),p)):(d&&(c=new H.geo.LineString(c.flatMap(function(t){return[t[0],t[1],0]})),c=new H.map.Polyline(c,{style:d}),n.outdoorMapObjects_.addObject(c)),h&&n.outdoorMapObjects_.addObject(h),f&&n.outdoorMapObjects_.addObject(f))},s=0;s<i.length;s++)a(s)}},{key:"getIndoorObjects",value:function(){return this.indoorMapObjects_}},{key:"getOutdoorObjects",value:function(){return this.outdoorMapObjects_}}]),t}();gr.ObjectType={SEGMENT_START_MARKER:1,SEGMENT_FINISH_MARKER:2,SEGMENT_POLYLINE:3};var mr=function(){l(e,H.service.Service);var t=v(e);function e(r){var i;n(this,e),i=t.call(this,e,r);var o={apiKey:r.apikey,baseUrl:r.baseUrl&&r.baseUrl.getHost(),token:r.token},a={apiKey:o.apiKey,token:o.token};o.apiKey||(o.apiKey=i.getUrl().getQuery().apikey);var s=r.useLegacy||!1;return i.venueService_=new er(o,s),a.apiKey||(a.apiKey=i.getUrl().getQuery().apikey),r.routingBaseUrl&&(a.baseUrl=r.routingBaseUrl),i.routingService_=new nr(a),i}return o(e,[{key:"loadVenue",value:function(t,e){return e=1<arguments.length&&void 0!==e?e:{},this.venueService_.load(t,e).then(function(t){return new ir(t)})}},{key:"calculateRoute",value:function(t){return this.routingService_.calculateRoute(t)}}]),e}();return mr.CONFIG_KEY="venues",H.service.Platform.prototype.getVenuesService=function(t){return this.createService(mr,t)},Te=function(){l(e,H.ui.Control);var t=v(e);function e(r){var i,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return n(this,e),(i=t.call(this)).provider_=null,i.levelSelectorUI_=null,i.setAlignment(o&&o.alignment||H.ui.LayoutAlignment.RIGHT_BOTTOM),i.addClass("venues-ui"),r instanceof ir&&i.setVenue(r),i}return o(e,[{key:"renderInternal",value:function(t,r){y(c(e.prototype),"renderInternal",this).call(this,t,r),this.createLevelSelectorUI_(t),this.venue&&this.setVenue(this.venue)}},{key:"setVenue",value:function(t){t instanceof ir&&(this.removeEventListeners_(),this.venue=t,this.provider_=t.getParentEventTarget(),this.update_(),this.addEventListeners_())}},{key:"createLevelSelectorUI_",value:function(t){var e=this;t.innerHTML="",this.levelSelectorUI_=null,this.levelSelectorUI_=new Vt(t,null,null,function(t){return e.venue.setActiveLevelIndex(t)})}},{key:"update_",value:function(){var t,e;this.levelSelectorUI_&&(t=this.venue.getActiveDrawing().getData(),e=this.venue.getData().getDisplaySettings(),this.levelSelectorUI_.update(t,e),this.levelChangeHandler_())}},{key:"addEventListeners_",value:function(){this.venue&&(this.venue.addEventListener(ir.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),this.venue.addEventListener(ir.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this)),this.provider_&&this.provider_.addEventListener(ir.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"removeEventListeners_",value:function(){this.venue&&(this.venue.removeEventListener(ir.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),this.venue.removeEventListener(ir.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this)),this.provider_&&this.provider_.removeEventListener(ir.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"levelChangeHandler_",value:function(){this.levelSelectorUI_.switch(this.venue.getActiveLevelIndex())}},{key:"drawingChangeHandler_",value:function(){this.update_()}},{key:"activeVenueChangeHandler_",value:function(t){this.setVenue(t.newValue)}}]),e}(),kt=function(){l(e,H.ui.Control);var t=v(e);function e(r){var i,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return n(this,e),(i=t.call(this)).provider_=null,i.drawingSelectorUI_=null,i.addClass("venues-ui"),i.setAlignment(o&&o.alignment||H.ui.LayoutAlignment.RIGHT_BOTTOM),r instanceof ir&&i.setVenue(r),i}return o(e,[{key:"renderInternal",value:function(t,r){y(c(e.prototype),"renderInternal",this).call(this,t,r),this.createDrawingSelectorUI_(t),this.venue&&this.setVenue(this.venue)}},{key:"setVenue",value:function(t){t instanceof ir&&(this.removeEventListeners_(),this.venue=t,this.provider_=t.getParentEventTarget(),this.drawingSelectorUI_&&this.drawingSelectorUI_.update(t.getData()),this.addEventListeners_())}},{key:"createDrawingSelectorUI_",value:function(t){var e=this;t.innerHTML="",this.drawingSelectorUI_=null,this.drawingSelectorUI_=new zt(t,null,function(t){return e.venue.setActiveDrawing(t)})}},{key:"addEventListeners_",value:function(){this.venue&&this.venue.addEventListener(ir.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this),this.provider_&&this.provider_.addEventListener(ir.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"removeEventListeners_",value:function(){this.venue&&this.venue.removeEventListener(ir.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this),this.provider_&&this.provider_.removeEventListener(ir.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"drawingChangeHandler_",value:function(){this.drawingSelectorUI_.switch(this.venue.getActiveDrawing().id)}},{key:"activeVenueChangeHandler_",value:function(t){this.setVenue(t.newValue)}}]),e}(),Te=Object.freeze({__proto__:null,DrawingControl:kt,LevelControl:Te}),e(".venues-ui * {\n  font-family: 'Fira Sans', 'Helvetica Neue', Helvetica, sans-serif;\n  color: #0F1621; }\n\n.venues-ui .arrow {\n  display: block;\n  width: 100%;\n  height: 100%;\n  background-repeat: no-repeat;\n  background-position: center; }\n  .venues-ui .arrow--up {\n    background-image: url(\"data:image/svg+xml,%0A%3Csvg width='13px' height='9px' viewBox='0 0 13 9' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='VenueMap_Facilities_Detail' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Floorplan-Switcher' transform='translate(-426.000000, -584.000000)' fill='%23383C45'%3E%3Cg id='Map-Controls-Copy' transform='translate(417.753906, 572.000000)'%3E%3Cg id='Chevron,-Dark' transform='translate(15.000000, 16.499023) rotate(-180.000000) translate(-15.000000, -16.499023) translate(9.000000, 12.749023)'%3E%3Cpath d='M6.0105,7.5 L4.1895,5.76404817 L0.1695,1.90510321 C0.057,1.79759174 0,1.68291284 0,1.56106651 C0,1.44065367 0.057,1.32597477 0.1695,1.2184633 L1.2465,0.16771789 C1.347,0.0587729358 1.47,0.00430045872 1.617,0.00430045872 C1.764,0.00430045872 1.887,0.0587729358 1.986,0.166284404 L6.009,3.98365826 L10.023,0.161983945 C10.122,0.0530389908 10.236,0 10.3695,0 C10.503,0 10.62,0.0530389908 10.7205,0.161983945 L11.841,1.21129587 C12.0525,1.43922018 12.0525,1.67144495 11.8425,1.89793578 L7.827,5.76118119 L6.0105,7.5 Z' id='Fill-3'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E\"); }\n  .venues-ui .arrow--down {\n    background-image: url(\"data:image/svg+xml,%0A%3Csvg width='13px' height='9px' viewBox='0 0 13 9' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='VenueMap_Facilities_Detail' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Floorplan-Switcher' transform='translate(-347.000000, -704.000000)' fill='%23383C45'%3E%3Cg id='Map-Controls' transform='translate(338.251953, 572.000000)'%3E%3Cg id='Chevron,-Dark' transform='translate(9.000000, 132.746094)'%3E%3Cpath d='M6.0105,7.5 L4.1895,5.76404817 L0.1695,1.90510321 C0.057,1.79759174 0,1.68291284 0,1.56106651 C0,1.44065367 0.057,1.32597477 0.1695,1.2184633 L1.2465,0.16771789 C1.347,0.0587729358 1.47,0.00430045872 1.617,0.00430045872 C1.764,0.00430045872 1.887,0.0587729358 1.986,0.166284404 L6.009,3.98365826 L10.023,0.161983945 C10.122,0.0530389908 10.236,0 10.3695,0 C10.503,0 10.62,0.0530389908 10.7205,0.161983945 L11.841,1.21129587 C12.0525,1.43922018 12.0525,1.67144495 11.8425,1.89793578 L7.827,5.76118119 L6.0105,7.5 Z' id='Fill-3'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E\"); }\n\n.venues-ui .venues-ui-button {\n  display: block;\n  width: 40px;\n  height: 40px;\n  line-height: 40px;\n  font-size: 16px;\n  font-weight: 600;\n  background-color: #fff;\n  border: none;\n  border-bottom: 1px solid #9FA2A6;\n  cursor: pointer;\n  overflow: hidden;\n  color: #6e737a;\n  text-align: center;\n  text-overflow: ellipsis;\n  white-space: nowrap; }\n  .venues-ui .venues-ui-button:hover, .venues-ui .venues-ui-button--active {\n    background-color: #f0f0f0;\n    color: #0F1621; }\n\n@keyframes fade {\n  0% {\n    opacity: 0; }\n  100% {\n    opacity: 1; } }\n\n.venues-ui__drawings .drawings {\n  position: absolute;\n  top: 0;\n  right: 45px;\n  display: none;\n  opacity: 0;\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6); }\n  .venues-ui__drawings .drawings--open {\n    display: block;\n    opacity: 1;\n    animation: fade 1s; }\n  .venues-ui__drawings .drawings .venues-ui-button {\n    width: auto;\n    padding: 0 10px; }\n    .venues-ui__drawings .drawings .venues-ui-button:first-of-type {\n      border-top-left-radius: 5px;\n      border-top-right-radius: 5px; }\n    .venues-ui__drawings .drawings .venues-ui-button:last-of-type {\n      border-bottom-left-radius: 5px;\n      border-bottom-right-radius: 5px; }\n\n.venues-ui__drawings .trigger {\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6); }\n  .venues-ui__drawings .trigger .arrow {\n    transform: rotate(0);\n    transition: 0.4s; }\n  .venues-ui__drawings .trigger.venues-ui-button--active .arrow {\n    transform: rotate(90deg);\n    transition: 0.4s; }\n\n.venues-ui__levels {\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6); }\n  .venues-ui__levels .levels {\n    overflow: hidden; }\n  .venues-ui__levels .venues-ui-button--up + .levels .venues-ui-button {\n    border-radius: 0; }\n  .venues-ui__levels .venues-ui-button:first-of-type {\n    border-top-left-radius: 5px;\n    border-top-right-radius: 5px; }\n  .venues-ui__levels .venues-ui-button:last-of-type {\n    border-bottom-left-radius: 5px;\n    border-bottom-right-radius: 5px; }\n  .venues-ui__levels .venues-ui-button[disabled=disabled] .arrow {\n    opacity: 0.5; }\n\n.venues-ui__directory {\n  position: absolute;\n  top: 10px;\n  right: 60px;\n  bottom: calc(100% - 45px);\n  width: 350px;\n  overflow: hidden;\n  background: white;\n  border-radius: 5px;\n  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6); }\n  .venues-ui__directory.active {\n    bottom: 10px; }\n  .venues-ui__directory .directory__list {\n    top: 80px;\n    bottom: 20px;\n    position: absolute;\n    overflow-y: scroll;\n    right: 10px;\n    left: 10px;\n    font-size: 12px; }\n    .venues-ui__directory .directory__list svg {\n      width: 25px;\n      height: 25px; }\n  .venues-ui__directory .directory__heading {\n    margin: 8px;\n    font-size: 15px;\n    font-weight: normal;\n    cursor: pointer; }\n  .venues-ui__directory .directory__input {\n    margin: 10px; }\n    .venues-ui__directory .directory__input input {\n      width: 100%;\n      padding: 5px 0; }\n  .venues-ui__directory .directory__trigger {\n    position: absolute;\n    right: 10px;\n    top: 15px;\n    width: 10px;\n    height: 10px; }\n    .venues-ui__directory .directory__trigger .arrow {\n      transform: rotate(0);\n      transition: 0.4s; }\n    .venues-ui__directory .directory__trigger--active .arrow {\n      transform: rotate(-180deg);\n      transition: 0.4s; }\n"),t.Drawing=w,t.Geometry=x,t.Level=E,t.Provider=Ne,t.Route=gr,t.Service=mr,t.Venue=ir,t.ui=Te,Object.defineProperty(t,"__esModule",{value:!0}),t}({})}).call(self),__webpack_exports__.a=H}).call(__webpack_exports__,__webpack_require__(22),__webpack_require__(23)(module))},function(t,e,r){var n=r(24);"string"==typeof n&&(n=[[t.i,n,""]]);var i={transform:void 0};r(26)(n,i);n.locals&&(t.exports=n.locals)},function(t,e,r){t.exports=r(28)},function(t,e,r){"use strict";t.exports=function(t,e){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return t.apply(e,r)}}},function(t,e,r){"use strict";var n=r(0);function i(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,r){if(!e)return t;var o;if(r)o=r(e);else if(n.isURLSearchParams(e))o=e.toString();else{var a=[];n.forEach(e,function(t,e){null!==t&&void 0!==t&&(n.isArray(t)?e+="[]":t=[t],n.forEach(t,function(t){n.isDate(t)?t=t.toISOString():n.isObject(t)&&(t=JSON.stringify(t)),a.push(i(e)+"="+i(t))}))}),o=a.join("&")}if(o){var s=t.indexOf("#");-1!==s&&(t=t.slice(0,s)),t+=(-1===t.indexOf("?")?"?":"&")+o}return t}},function(t,e,r){"use strict";t.exports=function(t,e,r,n,i){return t.config=e,r&&(t.code=r),t.request=n,t.response=i,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},t}},function(t,e,r){"use strict";var n=r(0),i=r(35),o=r(36),a=r(8),s=r(37),u=r(40),l=r(41),c=r(11),h=r(1),f=r(2);t.exports=function(t){return new Promise(function(e,r){var p,d=t.data,v=t.headers,y=t.responseType;function g(){t.cancelToken&&t.cancelToken.unsubscribe(p),t.signal&&t.signal.removeEventListener("abort",p)}n.isFormData(d)&&delete v["Content-Type"];var m=new XMLHttpRequest;if(t.auth){var _=t.auth.username||"",b=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";v.Authorization="Basic "+btoa(_+":"+b)}var x=s(t.baseURL,t.url);function w(){if(m){var n="getAllResponseHeaders"in m?u(m.getAllResponseHeaders()):null,o={data:y&&"text"!==y&&"json"!==y?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:n,config:t,request:m};i(function(t){e(t),g()},function(t){r(t),g()},o),m=null}}if(m.open(t.method.toUpperCase(),a(x,t.params,t.paramsSerializer),!0),m.timeout=t.timeout,"onloadend"in m?m.onloadend=w:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(w)},m.onabort=function(){m&&(r(c("Request aborted",t,"ECONNABORTED",m)),m=null)},m.onerror=function(){r(c("Network Error",t,null,m)),m=null},m.ontimeout=function(){var e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded",n=t.transitional||h.transitional;t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),r(c(e,t,n.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",m)),m=null},n.isStandardBrowserEnv()){var E=(t.withCredentials||l(x))&&t.xsrfCookieName?o.read(t.xsrfCookieName):void 0;E&&(v[t.xsrfHeaderName]=E)}"setRequestHeader"in m&&n.forEach(v,function(t,e){void 0===d&&"content-type"===e.toLowerCase()?delete v[e]:m.setRequestHeader(e,t)}),n.isUndefined(t.withCredentials)||(m.withCredentials=!!t.withCredentials),y&&"json"!==y&&(m.responseType=t.responseType),"function"==typeof t.onDownloadProgress&&m.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&m.upload&&m.upload.addEventListener("progress",t.onUploadProgress),(t.cancelToken||t.signal)&&(p=function(t){m&&(r(!t||t&&t.type?new f("canceled"):t),m.abort(),m=null)},t.cancelToken&&t.cancelToken.subscribe(p),t.signal&&(t.signal.aborted?p():t.signal.addEventListener("abort",p))),d||(d=null),m.send(d)})}},function(t,e,r){"use strict";var n=r(9);t.exports=function(t,e,r,i,o){var a=new Error(t);return n(a,e,r,i,o)}},function(t,e,r){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,r){"use strict";var n=r(0);t.exports=function(t,e){e=e||{};var r={};function i(t,e){return n.isPlainObject(t)&&n.isPlainObject(e)?n.merge(t,e):n.isPlainObject(e)?n.merge({},e):n.isArray(e)?e.slice():e}function o(r){return n.isUndefined(e[r])?n.isUndefined(t[r])?void 0:i(void 0,t[r]):i(t[r],e[r])}function a(t){if(!n.isUndefined(e[t]))return i(void 0,e[t])}function s(r){return n.isUndefined(e[r])?n.isUndefined(t[r])?void 0:i(void 0,t[r]):i(void 0,e[r])}function u(r){return r in e?i(t[r],e[r]):r in t?i(void 0,t[r]):void 0}var l={url:a,method:a,data:a,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:u};return n.forEach(Object.keys(t).concat(Object.keys(e)),function(t){var e=l[t]||o,i=e(t);n.isUndefined(i)&&e!==u||(r[t]=i)}),r}},function(t,e){t.exports={version:"0.25.0"}},function(t,e,r){r(16),t.exports=r(51)},function(t,e,r){Nova.booting(function(t,e,n){t.component("index-here-api-map-field",r(17)),t.component("detail-here-api-map-field",r(20)),t.component("form-here-api-map-field",r(47)),t.config.devtools=!0})},function(t,e,r){var n=r(3)(r(18),r(19),!1,null,null,null);t.exports=n.exports},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["resourceName","field"]}},function(t,e){t.exports={render:function(){var t=this.$createElement;return(this._self._c||t)("span",[this._v(this._s(this.field.name))])},staticRenderFns:[]}},function(t,e,r){var n=r(3)(r(21),r(46),!1,null,null,null);t.exports=n.exports},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(4),i=r(5),o=(r.n(i),r(6)),a=r.n(o);e.default={props:["resource","resourceName","resourceId","field"],data:function(){return{map:null,route_instructions:[],markers:[],distance:null,estimated_time:null,gps_points:[],intervalId:null}},methods:{init:function(t){var e=this.gps_points[0].lat+","+this.gps_points[0].lng,r=this.gps_points.slice(1,-1).map(function(t){return t.lat+","+t.lng}),i={origin:e,destination:this.gps_points[this.gps_points.length-1].lat+","+this.gps_points[this.gps_points.length-1].lng,via:new n.a.service.Url.MultiValueQueryParameter(r),routingMode:this.field.type?this.field.type:"fast",transportMode:this.field.Transport_mode?this.field.Transport_mode:"car",traffic:this.field.traffic_mode?this.field.traffic_mode:"enabled",return:"polyline,turnByTurnActions,actions,instructions,travelSummary"};t.getRoutingService(null,8).calculateRoute(i,this.onSuccess,this.onError)},onSuccess:function(t){this.addRouteShapeToMap(t),this.addMarkers(),this.addCirles(),this.addInstructions(t),this.addDistance(t),this.addEstimatedTravelTime(t),this.refreshMarkersPosistion()},onError:function(t){alert("Can't reach the remote server")},openBubble:function(t,e){this.bubble?(this.bubble.setPosition(t),this.bubble.setContent(e),this.bubble.open()):(this.bubble=new n.a.ui.InfoBubble(t,{content:e}),this.ui.addBubble(this.bubble))},addRouteShapeToMap:function(t){var e=this,r=void 0===this.field.draw_route||this.field.draw_route;t.routes.length&&r&&this.gps_points.length>1&&t.routes[0].sections.forEach(function(t,r){e.addRouteSectionShape(t)})},addRouteSectionShape:function(t){var e=n.a.geo.LineString.fromFlexiblePolyline(t.polyline),r=new n.a.map.Polyline(e,{style:{strokeColor:void 0!==this.field.route_line_color?this.field.route_line_color:"blue",lineWidth:void 0!==this.field.route_line_width?this.field.route_line_width:5}});this.map.addObjects([r]),this.map.getViewModel().setLookAtData({bounds:r.getBoundingBox()}),this.setMapInitPosition()},addMarkers:function(){var t=this,e=new n.a.map.Group;this.gps_points.filter(function(t){return!1!==(t=t).show_marker}).forEach(function(r){r=r;var i=new n.a.map.Icon(r.svg?r.svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="orange"><path d="M10 20S3 10.87 3 7a7 7 0 1 1 14 0c0 3.87-7 13-7 13zm0-11a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></svg>',{size:{w:56,h:56}}),o=new n.a.map.Marker({lat:r.lat,lng:r.lng},{icon:i});o.instruction=r.description,t.field.updateUrl&&(t.markers[r.id]=o),e.addObject(o),e.addEventListener("tap",function(t){this.map.setCenter(t.target.getGeometry()),this.openBubble(t.target.getGeometry(),t.target.instruction,this.ui)}.bind(t),!1)}),this.map.addObject(e)},addCirles:function(){var t=this;console.log("calling add circles"),console.log(this.field.circles),this.field.circles.forEach(function(e){e=JSON.parse(e),console.log(e.color),e.lat&&e.lng&&e.radius&&t.map.addObject(new n.a.map.Circle({lat:e.lat,lng:e.lng},e.radius,{style:{strokeColor:void 0!==e.border_color?e.border_color:"rgba(0, 0, 255, 0.1)",lineWidth:void 0!==e.border_width?e.border_width:5,fillColor:void 0!==e.color?e.color:"rgba(0, 0, 255, 0.1)"}}))})},addInstructions:function(t){var e=this;t.routes.length>0&&this.field.showInstructions&&this.gps_points.length>1&&t.routes[0].sections.forEach(function(t){t.actions.forEach(function(t){e.route_instructions.push(t.instruction)})})},addDistance:function(t){var e=this;this.field.showDistance&&this.gps_points.length>1&&t.routes[0].sections.forEach(function(t){e.distance+=t.travelSummary.length/1e3})},addEstimatedTravelTime:function(t){var e=this;this.field.showTime&&this.gps_points.length>1&&t.routes[0].sections.forEach(function(t){e.estimated_time+=t.travelSummary.duration})},toMMSS:function(t){return Math.floor(t/60)+" minutes "+t%60+" seconds."},setMapInitPosition:function(){this.map.setCenter({lat:void 0!==this.field.center_lat?this.field.center_lat:this.gps_points[0].lat,lng:void 0!==this.field.center_lng?this.field.center_lng:this.gps_points[0].lng}),this.map.setZoom(void 0!==this.field.zoom?this.field.zoom:14)},refreshMarkersPosistion:function(){var t=this;this.field.updateUrl&&(this.intervalId=setInterval(function(){a.a.get(t.field.updateUrl).then(function(e){e.data.forEach(function(e){var r=t.markers[e.id];r&&t.ease(r.getGeometry(),{lat:e.lat,lng:e.lng},4e3,function(t){r.setGeometry({lat:t.lat,lng:t.lng})})})}).catch(function(t){console.log(t)})},this.field.time))},intervalEvent:function(){this.intervalId&&(document.hidden?clearInterval(this.intervalId):this.refreshMarkersPosistion())},ease:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{lat:0,lng:0},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{lat:1,lng:1},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},o=window.requestAnimationFrame||function(t){window.setTimeout(t,16)},a=r/16,s=(e.lat-t.lat)/a,u=(e.lng-t.lng)/a,l=Math.PI/a,c=t.lat,h=t.lng,f=0;o(function t(){f+=l,c+=s*Math.pow(Math.sin(f),2)*2,h+=u*Math.pow(Math.sin(f),2)*2,f<Math.PI?(n({lat:c,lng:h}),o(t)):(n(e),i())})}},mounted:function(){if(this.field.gpsPoints.length<1)return alert("Please provide at least one gps point."),!1;this.gps_points=this.field.gpsPoints.map(function(t){return JSON.parse(t)}),this.routeInstructionsContainer=this.$refs.panel;var t=new n.a.service.Platform({apikey:this.field.globalApiKey||this.field.apiKey}),e=t.createDefaultLayers(),r=new n.a.Map(this.$refs.map,e.vector.normal.map,{center:new n.a.geo.Point(this.gps_points[0].lat,this.gps_points[0].lng),zoom:void 0!==this.field.zoom?this.field.zoom:14,pixelRatio:window.devicePixelRatio||1});window.addEventListener("resize",function(){return r.getViewPort().resize()}),this.map=r,new n.a.mapevents.Behavior(new n.a.mapevents.MapEvents(r)),this.ui=n.a.ui.UI.createDefault(this.map,e),this.init(t),document.addEventListener("visibilitychange",this.intervalEvent)}}},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,r){(t.exports=r(25)(!1)).push([t.i,'.H_ui{font-size:10px;font-family:Lucida Grande,Arial,Helvetica,sans-serif;-moz-user-select:none;-khtml-user-select:none;-webkit-user-select:none;-o-user-select:none;-ms-user-select:none;z-index:2;position:absolute;width:100%;height:100%;left:100%}.H_ui *{box-sizing:content-box;-moz-box-sizing:content-box}.H_noevs{pointer-events:none}.H_l_left{position:absolute;left:16px;margin-left:-100%}.H_l_center{position:absolute;left:-50%}.H_l_right{position:absolute;right:calc(100% + 16px);margin-left:-100%}.H_l_top{top:16px}.H_l_middle{top:50%}.H_l_bottom{bottom:16px}[class^=H_l_]{pointer-events:none}.H_ctl{pointer-events:visiblePainted;pointer-events:auto}.H_l_horizontal .H_ctl{float:left}.H_l_anchor{clear:both;float:right}.H_l_vertical .H_ctl{clear:both}.H_l_right.H_l_middle.H_l_vertical .H_ctl,.H_l_right .H_l_vertical .H_ctl{float:right}.H_ctl{margin:.8em;position:relative;-ms-touch-action:none}.H_btn{cursor:pointer}.H_grp .H_btn,.H_rdo_buttons .H_btn{box-shadow:none}.H_grp .H_btn.H_active,.H_rdo_buttons .H_btn.H_active{background:none}.H_btn{box-shadow:0 0 .4em 0 rgba(15,22,33,.6);border-radius:.5em;width:4em;height:4em;background:#fff}.H_disabled,.H_disabled:hover,.H_rdo_title{cursor:default}.H_rdo_title{font-size:14px;height:40px;line-height:40px;background-color:#575b63;color:#fff;padding-left:16px;padding-right:16px;border-radius:5px 5px 0 0;margin-bottom:8px}.H_ui[dir=rtl] .H_rdo_title{text-align:right}.H_rdo ul{list-style:none;margin:0 auto;padding:0}.H_ctl.H_grp{background:#fff;box-shadow:0 0 .4em 0 rgba(15,22,33,.6);border-radius:.5em}.H_zoom .H_el{position:relative}.H_l_horizontal .H_zoom .H_el:last-child:after,.H_l_vertical .H_zoom .H_el:last-child:after{content:none}.H_l_vertical .H_zoom .H_el{margin-bottom:.1em}.H_l_vertical .H_zoom .H_el:last-child{margin-bottom:0}.H_l_vertical .H_zoom .H_el:after{content:"";position:absolute;width:2.6em;height:.1em;bottom:-.1em;left:.7em;background:rgba(15,22,33,.1)}.H_l_horizontal .H_zoom .H_el{margin-right:.1em}.H_l_horizontal .H_zoom .H_el:last-child{margin-right:0}.H_l_horizontal .H_zoom .H_el:after{content:"";position:absolute;width:.1em;height:2.6em;top:.7em;right:-.1em;background:rgba(15,22,33,.1)}.H_l_horizontal .H_grp .H_btn,.H_l_vertical .H_ctl{float:left}.H_overlay{font-size:14px;color:rgba(15,22,33,.6);box-shadow:0 0 4px 0 rgba(15,22,33,.6);border-radius:5px;position:absolute;min-width:200px;background:#fff;display:none;z-index:100;padding-bottom:4px}.H_overlay .H_separator{content:"";position:relative;display:block;margin:8px 16px;height:1px;background:rgba(15,22,33,.1)}.H_overlay .H_btn,.H_overlay .H_rdo li{width:184px;height:24px;line-height:24px;padding:8px 16px}.H_overlay .H_btn{border-radius:0}.H_overlay .H_btn:hover,.H_overlay .H_rdo li:hover{color:rgba(15,22,33,.8)}.H_overlay .H_btn.H_disabled,.H_overlay .H_btn.H_disabled:hover,.H_overlay .H_rdo.H_disabled li,.H_overlay .H_rdo.H_disabled li:hover{color:rgba(15,22,33,.2)}.H_overlay .H_btn.H_active,.H_overlay .H_btn.H_active:hover,.H_overlay .H_rdo.H_active li,.H_overlay .H_rdo.H_active li:hover{color:#0f1621}.H_overlay>:last-child{clear:both}.H_overlay>.H_btn{white-space:nowrap}.H_overlay.H_open{display:block}.H_overlay:after,.H_overlay:before{content:" ";width:0;height:0;border-style:solid;position:absolute}.H_overlay.H_left:before{border-width:10px 10px 10px 0;border-color:transparent rgba(15,22,33,.2) transparent transparent;left:-12px}.H_overlay.H_left:after{border-width:10px 10px 10px 0;border-color:transparent #fff transparent transparent;left:-10px}.H_overlay.H_top.H_left:after{border-color:transparent #575b63 transparent transparent}.H_overlay.H_right:before{border-width:10px 0 10px 10px;border-color:transparent transparent transparent rgba(15,22,33,.2);left:calc(100% + 1px)}.H_overlay.H_right:after{border-width:10px 0 10px 10px;border-color:transparent transparent transparent #fff;left:100%}.H_overlay.H_top.H_right:after{border-color:transparent transparent transparent #575b63}.H_overlay.H_top:after,.H_overlay.H_top:before{top:10px}.H_overlay.H_bottom:after,.H_overlay.H_bottom:before{bottom:10px}.H_overlay.H_middle:after,.H_overlay.H_middle:before{top:50%;margin-top:-10px}.H_overlay.H_top.H_center:before{border-width:0 10px 10px;border-color:transparent transparent rgba(15,22,33,.2);top:-11px;left:50%;margin-left:-10px}.H_overlay.H_top.H_center:after{border-width:0 10px 10px;border-color:transparent transparent #575b63;top:-10px;left:50%;margin-left:-10px}.H_overlay.H_bottom.H_center:before{border-width:10px 10px 0;border-color:rgba(15,22,33,.2) transparent transparent;bottom:-11px;left:50%;margin-left:-10px}.H_overlay.H_bottom.H_center:after{border-width:10px 10px 0;border-color:#fff transparent transparent;bottom:-10px;left:50%;margin-left:-10px}.H_ib{left:.91em;left:-100%}.H_ib,.H_ib_tail{position:absolute}.H_ib_tail{width:20px;height:10px;margin:-10px}.H_ib_tail:before{bottom:-1px;border:10px solid transparent;right:0}.H_ib_tail:after,.H_ib_tail:before{position:absolute;display:block;content:""}.H_ib_tail:after{bottom:0;border:10px solid #fff}.H_ib.H_ib_top .H_ib_tail:after{border-width:10px 10px 0;border-color:#fff transparent}.H_ib.H_ib_top .H_ib_tail:before{border-top-color:rgba(15,22,33,.2);border-bottom-width:0}.H_ib_notail .H_ib_tail{display:none}.H_ib_body{background:#fff;position:absolute;bottom:.5em;padding:0;right:0;border-radius:5px;margin-right:-3em;box-shadow:0 0 4px 0 rgba(15,22,33,.6);margin-bottom:.5em}.H_ib_close{font-size:.6em;position:absolute;right:12px;width:12px;height:12px;cursor:pointer;top:12px;z-index:1;background:none;box-shadow:none}.H_ui[dir=rtl] .H_ib_close{left:12px;right:auto}.H_ib_close svg.H_icon{top:0;transform:none;width:auto;height:auto}.H_ib_noclose .H_ib_close{display:none}.H_ib_noclose .H_ib_body{padding:0}.H_ib_content{min-width:6em;font:14px Lucida Grande,Arial,Helvetica,sans-serif;line-height:24px;margin:16px 28px 20px 16px;color:rgba(15,22,33,.8);user-select:text;-moz-user-select:text;-khtml-user-select:text;-webkit-user-select:text;-o-user-select:text;-ms-user-select:text}.H_ui[dir=rtl] .H_ib_content{margin:16px 16px 20px 28px}.H_l_horizontal .H_zoom_slider{min-width:262px}.H_slider{cursor:pointer}.H_l_horizontal.H_slider{float:left;height:4em;width:auto;padding:0 1em}.H_slider .H_slider_track{width:.4em;height:100%}.H_l_horizontal.H_slider .H_slider_track{height:.4em;width:100%}.H_l_horizontal.H_slider .H_slider_cont{height:100%}.H_l_horizontal.H_slider .H_slider_knob_cont{margin-top:-.4em}.H_slider{background-color:#fff;padding:1em 0;width:4em}.H_slider .H_slider_cont{position:relative}.H_slider .H_slider_knob_cont,.H_slider .H_slider_knob_halo{width:1.8em;height:1.8em;margin-left:0;border-radius:9em}.H_slider .H_slider_knob{width:1.2em;height:1.2em;background-color:#fff;border-radius:9em;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);top:50%;left:50%;box-shadow:0 0 .5em 0 rgba(15,22,33,.6);position:absolute}.H_slider:hover .H_slider_knob{box-shadow:0 0 .5em 0 rgba(15,22,33,.8)}.H_slider.H_disabled .H_slider_knob{box-shadow:0 0 .5em 0 rgba(15,22,33,.2)}.H_slider.H_slider_active .H_slider_knob{box-shadow:0 0 .5em 0 #0f1621}.H_slider:hover .H_slider_track{background-color:rgba(15,22,33,.8)}.H_disabled .H_slider_track{background-color:rgba(15,22,33,.2)}.H_slider:hover .H_slider_track_active{background-color:rgba(0,182,178,.8)}.H_disabled .H_slider_track_active{background-color:rgba(0,182,178,.2)}.H_slider.H_slider_active .H_slider_track{background-color:#0f1621}.H_slider.H_slider_active .H_slider_track_active{background-color:#00b6b2}.H_slider .H_slider_knob_cont,.H_slider .H_slider_track{position:relative;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.H_slider .H_slider_track{background-color:rgba(15,22,33,.6);overflow:hidden}.H_slider .H_slider_track_active{background-color:#00b6b2;position:absolute;transform:translate(-50%)}.H_slider.H_disabled .H_slider_track{background-color:rgba(15,22,33,.2)}.H_slider.H_disabled .H_slider_track_active{background-color:#bae2e3}.H_slider.H_l_horizontal .H_slider_track_active{transform:translate(-200%,-50%)}.H_slider.H_disabled{cursor:default}.H_context_menu{font-size:14px;min-width:158px;max-width:40%;box-shadow:0 0 .4em 0 rgba(15,22,33,.6);position:absolute;left:-100%;top:0;color:rgba(15,22,33,.6);background-color:#fff;-moz-border-radius:5px;-webkit-border-radius:5px;-o-border-radius:5px;border-radius:5px;padding:16px 16px 4px;-moz-user-select:initial;-khtml-user-select:initial;-webkit-user-select:initial;-o-user-select:initial;-ms-user-select:initial;z-index:200}.H_context_menu_closed{display:none}.H_context_menu_item{text-overflow:ellipsis;overflow:hidden;line-height:24px;margin-bottom:16px;outline:none}.H_context_menu_item.clickable:hover{color:rgba(15,22,33,.8);cursor:pointer}.H_context_menu_item.disabled,.H_context_menu_item.disabled:hover{background:transparent!important;color:rgba(15,22,33,.2);cursor:default!important;-moz-user-select:none;-khtml-user-select:none;-webkit-user-select:none;-o-user-select:none;-ms-user-select:none}.H_context_menu_item_separator{height:0;border-top:1px solid rgba(15,22,33,.1);padding-bottom:16px;line-height:0;font-size:0}.H_scalebar{margin-top:36px;box-shadow:none;display:flex;align-items:center;text-shadow:-1px -1px 0 hsla(0,0%,100%,.7),1px -1px 0 hsla(0,0%,100%,.7),-1px 1px 0 hsla(0,0%,100%,.7),1px 1px 0 hsla(0,0%,100%,.7)}.H_tib_content{width:25em;position:relative;margin:-16px -28px -20px -16px}[dir=rtl] .H_tib_content{margin:-16px -16px -20px -28px}.H_tib .H_tib_desc{padding:0 16px 20px}.H_tib .H_tib_time{color:rgba(15,22,33,.4);margin-top:.8em}.H_tib_right{float:right}.H_tib .H_btn>svg.H_icon{fill:hsla(0,0%,100%,.6)}.H_tib .H_btn:hover>svg.H_icon{fill:#fff}.H_dm_label{font:12px Lucida Grande,Arial,Helvetica,sans-serif;color:#000;text-shadow:1px 1px .5px #fff,1px -1px .5px #fff,-1px 1px .5px #fff,-1px -1px .5px #fff;white-space:nowrap;margin-left:12px;margin-top:-7px;pointer-events:none}svg.H_icon{display:block;position:relative;top:50%;transform:translateY(-50%);margin:auto;width:24px;height:24px;fill:rgba(15,22,33,.6)}svg.H_icon .H_icon_stroke{stroke:rgba(15,22,33,.6);fill:none}.H_btn:hover>svg.H_icon{fill:rgba(15,22,33,.8)}.H_btn:hover>svg.H_icon .H_icon_stroke{stroke:rgba(15,22,33,.8)}.H_btn.H_active{background-color:#cfd0d3}.H_rdo .H_btn.H_active{background:none}.H_active:hover>svg.H_icon,.H_active>svg.H_icon{fill:#0f1621!important}.H_active:hover>svg.H_icon .H_icon_stroke,.H_active>svg.H_icon .H_icon_stroke{stroke:#0f1621}.H_disabled:hover svg.H_icon,.H_disabled svg.H_icon{fill:rgba(15,22,33,.2);cursor:default}.H_disabled:hover svg.H_icon .H_icon_stroke,.H_disabled svg.H_icon .H_icon_stroke{stroke:rgba(15,22,33,.2)}.H_overview{transition:width .2s,height .2s,margin-top .2s,padding .2s;width:0;height:0;overflow:hidden;cursor:default;position:absolute;margin:auto;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;box-shadow:0 0 .4em 0 rgba(15,22,33,.6)}.H_l_vertical .H_overview_active{margin:auto 5px}.H_l_horizontal .H_overview_active{margin:5px auto}.H_l_center .H_overview{left:-9999px;right:-9999px}.H_l_middle .H_overview{top:-9999px;bottom:-9999px}.H_l_right .H_overview{right:100%}.H_l_left .H_overview{left:100%}.H_l_bottom .H_overview{bottom:0}.H_l_center.H_l_bottom .H_overview{bottom:100%}.H_l_top .H_overview{top:0}.H_l_center.H_l_top .H_overview{top:100%}.H_overview .H_overview_map{background-color:hsla(0,0%,100%,.6);-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;box-shadow:0 0 .4em 0 rgba(15,22,33,.6)}.H_overview_map .H_ui{display:none}.H_zoom_lasso{position:absolute;display:none;box-shadow:0 0 .4em 0 rgba(15,22,33,.6);z-index:100000;background-color:rgba(15,22,33,.2)}',""])},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var r=function(t,e){var r=t[1]||"",n=t[3];if(!n)return r;if(e&&"function"==typeof btoa){var i=(a=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),o=n.sources.map(function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"});return[r].concat(o).concat([i]).join("\n")}var a;return[r].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+r+"}":r}).join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(n[o]=!0)}for(i=0;i<t.length;i++){var a=t[i];"number"==typeof a[0]&&n[a[0]]||(r&&!a[2]?a[2]=r:r&&(a[2]="("+a[2]+") and ("+r+")"),e.push(a))}},e}},function(t,e,r){var n,i,o={},a=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=n.apply(this,arguments)),i}),s=function(t){var e={};return function(t){return void 0===e[t]&&(e[t]=function(t){return document.querySelector(t)}.call(this,t)),e[t]}}(),u=null,l=0,c=[],h=r(27);function f(t,e){for(var r=0;r<t.length;r++){var n=t[r],i=o[n.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](n.parts[a]);for(;a<n.parts.length;a++)i.parts.push(m(n.parts[a],e))}else{var s=[];for(a=0;a<n.parts.length;a++)s.push(m(n.parts[a],e));o[n.id]={id:n.id,refs:1,parts:s}}}}function p(t,e){for(var r=[],n={},i=0;i<t.length;i++){var o=t[i],a=e.base?o[0]+e.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};n[a]?n[a].parts.push(s):r.push(n[a]={id:a,parts:[s]})}return r}function d(t,e){var r=s(t.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=c[c.length-1];if("top"===t.insertAt)n?n.nextSibling?r.insertBefore(e,n.nextSibling):r.appendChild(e):r.insertBefore(e,r.firstChild),c.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");r.appendChild(e)}}function v(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=c.indexOf(t);e>=0&&c.splice(e,1)}function y(t){var e=document.createElement("style");return t.attrs.type="text/css",g(e,t.attrs),d(t,e),e}function g(t,e){Object.keys(e).forEach(function(r){t.setAttribute(r,e[r])})}function m(t,e){var r,n,i,o;if(e.transform&&t.css){if(!(o=e.transform(t.css)))return function(){};t.css=o}if(e.singleton){var a=l++;r=u||(u=y(e)),n=x.bind(null,r,a,!1),i=x.bind(null,r,a,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",g(e,t.attrs),d(t,e),e}(e),n=function(t,e,r){var n=r.css,i=r.sourceMap,o=void 0===e.convertToAbsoluteUrls&&i;(e.convertToAbsoluteUrls||o)&&(n=h(n));i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([n],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}.bind(null,r,e),i=function(){v(r),r.href&&URL.revokeObjectURL(r.href)}):(r=y(e),n=function(t,e){var r=e.css,n=e.media;n&&t.setAttribute("media",n);if(t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}.bind(null,r),i=function(){v(r)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else i()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||(e.singleton=a()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var r=p(t,e);return f(r,e),function(t){for(var n=[],i=0;i<r.length;i++){var a=r[i];(s=o[a.id]).refs--,n.push(s)}t&&f(p(t,e),e);for(i=0;i<n.length;i++){var s;if(0===(s=n[i]).refs){for(var u=0;u<s.parts.length;u++)s.parts[u]();delete o[s.id]}}}};var _,b=(_=[],function(t,e){return _[t]=e,_.filter(Boolean).join("\n")});function x(t,e,r,n){var i=r?"":n.css;if(t.styleSheet)t.styleSheet.cssText=b(e,i);else{var o=document.createTextNode(i),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(o,a[e]):t.appendChild(o)}}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var r=e.protocol+"//"+e.host,n=r+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var i,o=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(o)?t:(i=0===o.indexOf("//")?o:0===o.indexOf("/")?r+o:n+o.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")})}},function(t,e,r){"use strict";var n=r(0),i=r(7),o=r(29),a=r(13);var s=function t(e){var r=new o(e),s=i(o.prototype.request,r);return n.extend(s,o.prototype,r),n.extend(s,r),s.create=function(r){return t(a(e,r))},s}(r(1));s.Axios=o,s.Cancel=r(2),s.CancelToken=r(43),s.isCancel=r(12),s.VERSION=r(14).version,s.all=function(t){return Promise.all(t)},s.spread=r(44),s.isAxiosError=r(45),t.exports=s,t.exports.default=s},function(t,e,r){"use strict";var n=r(0),i=r(8),o=r(30),a=r(31),s=r(13),u=r(42),l=u.validators;function c(t){this.defaults=t,this.interceptors={request:new o,response:new o}}c.prototype.request=function(t,e){if("string"==typeof t?(e=e||{}).url=t:e=t||{},!e.url)throw new Error("Provided config url is not valid");(e=s(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var r=e.transitional;void 0!==r&&u.assertOptions(r,{silentJSONParsing:l.transitional(l.boolean),forcedJSONParsing:l.transitional(l.boolean),clarifyTimeoutError:l.transitional(l.boolean)},!1);var n=[],i=!0;this.interceptors.request.forEach(function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(i=i&&t.synchronous,n.unshift(t.fulfilled,t.rejected))});var o,c=[];if(this.interceptors.response.forEach(function(t){c.push(t.fulfilled,t.rejected)}),!i){var h=[a,void 0];for(Array.prototype.unshift.apply(h,n),h=h.concat(c),o=Promise.resolve(e);h.length;)o=o.then(h.shift(),h.shift());return o}for(var f=e;n.length;){var p=n.shift(),d=n.shift();try{f=p(f)}catch(t){d(t);break}}try{o=a(f)}catch(t){return Promise.reject(t)}for(;c.length;)o=o.then(c.shift(),c.shift());return o},c.prototype.getUri=function(t){if(!t.url)throw new Error("Provided config url is not valid");return t=s(this.defaults,t),i(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],function(t){c.prototype[t]=function(e,r){return this.request(s(r||{},{method:t,url:e,data:(r||{}).data}))}}),n.forEach(["post","put","patch"],function(t){c.prototype[t]=function(e,r,n){return this.request(s(n||{},{method:t,url:e,data:r}))}}),t.exports=c},function(t,e,r){"use strict";var n=r(0);function i(){this.handlers=[]}i.prototype.use=function(t,e,r){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},i.prototype.forEach=function(t){n.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=i},function(t,e,r){"use strict";var n=r(0),i=r(32),o=r(12),a=r(1),s=r(2);function u(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new s("canceled")}t.exports=function(t){return u(t),t.headers=t.headers||{},t.data=i.call(t,t.data,t.headers,t.transformRequest),t.headers=n.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),n.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||a.adapter)(t).then(function(e){return u(t),e.data=i.call(t,e.data,e.headers,t.transformResponse),e},function(e){return o(e)||(u(t),e&&e.response&&(e.response.data=i.call(t,e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e,r){"use strict";var n=r(0),i=r(1);t.exports=function(t,e,r){var o=this||i;return n.forEach(r,function(r){t=r.call(o,t,e)}),t}},function(t,e){var r,n,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var u,l=[],c=!1,h=-1;function f(){c&&u&&(c=!1,u.length?l=u.concat(l):h=-1,l.length&&p())}function p(){if(!c){var t=s(f);c=!0;for(var e=l.length;e;){for(u=l,l=[];++h<e;)u&&u[h].run();h=-1,e=l.length}u=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new d(t,e)),1!==l.length||c||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,r){"use strict";var n=r(0);t.exports=function(t,e){n.forEach(t,function(r,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=r,delete t[n])})}},function(t,e,r){"use strict";var n=r(11);t.exports=function(t,e,r){var i=r.config.validateStatus;r.status&&i&&!i(r.status)?e(n("Request failed with status code "+r.status,r.config,null,r.request,r)):t(r)}},function(t,e,r){"use strict";var n=r(0);t.exports=n.isStandardBrowserEnv()?{write:function(t,e,r,i,o,a){var s=[];s.push(t+"="+encodeURIComponent(e)),n.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),n.isString(i)&&s.push("path="+i),n.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,r){"use strict";var n=r(38),i=r(39);t.exports=function(t,e){return t&&!n(e)?i(t,e):e}},function(t,e,r){"use strict";t.exports=function(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}},function(t,e,r){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,r){"use strict";var n=r(0),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,r,o,a={};return t?(n.forEach(t.split("\n"),function(t){if(o=t.indexOf(":"),e=n.trim(t.substr(0,o)).toLowerCase(),r=n.trim(t.substr(o+1)),e){if(a[e]&&i.indexOf(e)>=0)return;a[e]="set-cookie"===e?(a[e]?a[e]:[]).concat([r]):a[e]?a[e]+", "+r:r}}),a):a}},function(t,e,r){"use strict";var n=r(0);t.exports=n.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(t){var n=t;return e&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return t=i(window.location.href),function(e){var r=n.isString(e)?i(e):e;return r.protocol===t.protocol&&r.host===t.host}}():function(){return!0}},function(t,e,r){"use strict";var n=r(14).version,i={};["object","boolean","number","function","string","symbol"].forEach(function(t,e){i[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});var o={};i.transitional=function(t,e,r){function i(t,e){return"[Axios v"+n+"] Transitional option '"+t+"'"+e+(r?". "+r:"")}return function(r,n,a){if(!1===t)throw new Error(i(n," has been removed"+(e?" in "+e:"")));return e&&!o[n]&&(o[n]=!0,console.warn(i(n," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(r,n,a)}},t.exports={assertOptions:function(t,e,r){if("object"!=typeof t)throw new TypeError("options must be an object");for(var n=Object.keys(t),i=n.length;i-- >0;){var o=n[i],a=e[o];if(a){var s=t[o],u=void 0===s||a(s,o,t);if(!0!==u)throw new TypeError("option "+o+" must be "+u)}else if(!0!==r)throw Error("Unknown option "+o)}},validators:i}},function(t,e,r){"use strict";var n=r(2);function i(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var r=this;this.promise.then(function(t){if(r._listeners){var e,n=r._listeners.length;for(e=0;e<n;e++)r._listeners[e](t);r._listeners=null}}),this.promise.then=function(t){var e,n=new Promise(function(t){r.subscribe(t),e=t}).then(t);return n.cancel=function(){r.unsubscribe(e)},n},t(function(t){r.reason||(r.reason=new n(t),e(r.reason))})}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.prototype.subscribe=function(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]},i.prototype.unsubscribe=function(t){if(this._listeners){var e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}},i.source=function(){var t;return{token:new i(function(e){t=e}),cancel:t}},t.exports=i},function(t,e,r){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,r){"use strict";var n=r(0);t.exports=function(t){return n.isObject(t)&&!0===t.isAxiosError}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"border-40 border-b mt-4 mb-4  pb-8"},[r("h4",{staticClass:"font-normal text-80 my-2"},[t._v(t._s(this.field.name))]),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!t.error,expression:"!error"}],ref:"map",staticClass:"rounded-sm",staticStyle:{height:"600px",width:"100%"}}),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:t.distance,expression:"distance"}],staticClass:"mt-4"},[r("b",[t._v("Distance : "+t._s(t.distance)+" Km")])]),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:t.estimated_time,expression:"estimated_time"}]},[r("b",[t._v("Estimated Time : "+t._s(t.toMMSS(t.estimated_time)))])]),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:t.route_instructions.length>0,expression:"route_instructions.length > 0"}]},[r("ul",{staticClass:"h-60 overflow-auto "},t._l(t.route_instructions,function(e,n){return r("li",[t._v("\n                "+t._s(n+1)+"- "+t._s(e)+"\n            ")])}),0)])])},staticRenderFns:[]}},function(t,e,r){var n=r(3)(r(48),r(50),!1,null,null,null);t.exports=n.exports},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(49),i=(r.n(n),r(4)),o=r(5),a=(r.n(o),r(6)),s=r.n(a);e.default={props:["resource","resourceName","resourceId","field"],mixins:[n.FormField,n.HandlesValidationErrors],data:function(){return{map:null,route_instructions:[],markers:[],distance:null,estimated_time:null,gps_points:[],intervalId:null}},methods:{init:function(t){var e=this.gps_points[0].lat+","+this.gps_points[0].lng,r=this.gps_points.slice(1,-1).map(function(t){return t.lat+","+t.lng}),n={origin:e,destination:this.gps_points[this.gps_points.length-1].lat+","+this.gps_points[this.gps_points.length-1].lng,via:new i.a.service.Url.MultiValueQueryParameter(r),routingMode:this.field.type?this.field.type:"fast",transportMode:this.field.Transport_mode?this.field.Transport_mode:"car",traffic:this.field.traffic_mode?this.field.traffic_mode:"enabled",return:"polyline,turnByTurnActions,actions,instructions,travelSummary"};t.getRoutingService(null,8).calculateRoute(n,this.onSuccess,this.onError)},onSuccess:function(t){this.addRouteShapeToMap(t),this.addMarkers(),this.addCirles(),this.addInstructions(t),this.addDistance(t),this.addEstimatedTravelTime(t),this.refreshMarkersPosistion()},onError:function(t){alert("Can't reach the remote server")},openBubble:function(t,e){this.bubble?(this.bubble.setPosition(t),this.bubble.setContent(e),this.bubble.open()):(this.bubble=new i.a.ui.InfoBubble(t,{content:e}),this.ui.addBubble(this.bubble))},addRouteShapeToMap:function(t){var e=this,r=void 0===this.field.draw_route||this.field.draw_route;t.routes.length&&r&&this.gps_points.length>1&&t.routes[0].sections.forEach(function(t,r){e.addRouteSectionShape(t)})},addRouteSectionShape:function(t){var e=i.a.geo.LineString.fromFlexiblePolyline(t.polyline),r=new i.a.map.Polyline(e,{style:{strokeColor:void 0!==this.field.route_line_color?this.field.route_line_color:"blue",lineWidth:void 0!==this.field.route_line_width?this.field.route_line_width:5}});this.map.addObjects([r]),this.map.getViewModel().setLookAtData({bounds:r.getBoundingBox()}),this.setMapInitPosition()},addMarkers:function(){var t=this,e=new i.a.map.Group;this.gps_points.filter(function(t){return!1!==(t=t).show_marker}).forEach(function(r){r=r;var n=new i.a.map.Icon(r.svg?r.svg:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="orange"><path d="M10 20S3 10.87 3 7a7 7 0 1 1 14 0c0 3.87-7 13-7 13zm0-11a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></svg>',{size:{w:56,h:56}}),o=new i.a.map.Marker({lat:r.lat,lng:r.lng},{icon:n});o.instruction=r.description,t.field.updateUrl&&(t.markers[r.id]=o),e.addObject(o),e.addEventListener("tap",function(t){this.map.setCenter(t.target.getGeometry()),this.openBubble(t.target.getGeometry(),t.target.instruction,this.ui)}.bind(t),!1)}),this.map.addObject(e)},addCirles:function(){var t=this;console.log("calling add circles"),console.log(this.field.circles),this.field.circles.forEach(function(e){e=JSON.parse(e),console.log(e.color),e.lat&&e.lng&&e.radius&&t.map.addObject(new i.a.map.Circle({lat:e.lat,lng:e.lng},e.radius,{style:{strokeColor:void 0!==e.border_color?e.border_color:"rgba(0, 0, 255, 0.1)",lineWidth:void 0!==e.border_width?e.border_width:5,fillColor:void 0!==e.color?e.color:"rgba(0, 0, 255, 0.1)"}}))})},addInstructions:function(t){var e=this;t.routes.length>0&&this.field.showInstructions&&this.gps_points.length>1&&t.routes[0].sections.forEach(function(t){t.actions.forEach(function(t){e.route_instructions.push(t.instruction)})})},addDistance:function(t){var e=this;this.field.showDistance&&this.gps_points.length>1&&t.routes[0].sections.forEach(function(t){e.distance+=t.travelSummary.length/1e3})},addEstimatedTravelTime:function(t){var e=this;this.field.showTime&&this.gps_points.length>1&&t.routes[0].sections.forEach(function(t){e.estimated_time+=t.travelSummary.duration})},toMMSS:function(t){return Math.floor(t/60)+" minutes "+t%60+" seconds."},setMapInitPosition:function(){this.map.setCenter({lat:void 0!==this.field.center_lat?this.field.center_lat:this.gps_points[0].lat,lng:void 0!==this.field.center_lng?this.field.center_lng:this.gps_points[0].lng}),this.map.setZoom(void 0!==this.field.zoom?this.field.zoom:14)},refreshMarkersPosistion:function(){var t=this;this.field.updateUrl&&(this.intervalId=setInterval(function(){s.a.get(t.field.updateUrl).then(function(e){e.data.forEach(function(e){var r=t.markers[e.id];r&&t.ease(r.getGeometry(),{lat:e.lat,lng:e.lng},4e3,function(t){r.setGeometry({lat:t.lat,lng:t.lng})})})}).catch(function(t){console.log(t)})},this.field.time))},intervalEvent:function(){this.intervalId&&(document.hidden?clearInterval(this.intervalId):this.refreshMarkersPosistion())},ease:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{lat:0,lng:0},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{lat:1,lng:1},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},o=window.requestAnimationFrame||function(t){window.setTimeout(t,16)},a=r/16,s=(e.lat-t.lat)/a,u=(e.lng-t.lng)/a,l=Math.PI/a,c=t.lat,h=t.lng,f=0;o(function t(){f+=l,c+=s*Math.pow(Math.sin(f),2)*2,h+=u*Math.pow(Math.sin(f),2)*2,f<Math.PI?(n({lat:c,lng:h}),o(t)):(n(e),i())})}},mounted:function(){if(this.field.gpsPoints.length<1)return alert("Please provide at least one gps point."),!1;this.gps_points=this.field.gpsPoints.map(function(t){return JSON.parse(t)}),this.routeInstructionsContainer=this.$refs.panel;var t=new i.a.service.Platform({apikey:this.field.globalApiKey||this.field.apiKey}),e=t.createDefaultLayers(),r=new i.a.Map(this.$refs.map,e.vector.normal.map,{center:new i.a.geo.Point(this.gps_points[0].lat,this.gps_points[0].lng),zoom:void 0!==this.field.zoom?this.field.zoom:14,pixelRatio:window.devicePixelRatio||1});window.addEventListener("resize",function(){return r.getViewPort().resize()}),this.map=r,new i.a.mapevents.Behavior(new i.a.mapevents.MapEvents(r)),this.ui=i.a.ui.UI.createDefault(this.map,e),this.init(t),document.addEventListener("visibilitychange",this.intervalEvent)}}},function(t,e,r){var n;n=function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.i=function(t){return t},r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=41)}([function(t,e,r){"use strict";var n=r(40),i=r(152),o=Object.prototype.toString;function a(t){return"[object Array]"===o.call(t)}function s(t){return null!==t&&"object"==typeof t}function u(t){return"[object Function]"===o.call(t)}function l(t,e){if(null!==t&&void 0!==t)if("object"!=typeof t&&(t=[t]),a(t))for(var r=0,n=t.length;r<n;r++)e.call(null,t[r],r,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}t.exports={isArray:a,isArrayBuffer:function(t){return"[object ArrayBuffer]"===o.call(t)},isBuffer:i,isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:s,isUndefined:function(t){return void 0===t},isDate:function(t){return"[object Date]"===o.call(t)},isFile:function(t){return"[object File]"===o.call(t)},isBlob:function(t){return"[object Blob]"===o.call(t)},isFunction:u,isStream:function(t){return s(t)&&u(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:l,merge:function t(){var e={};function r(r,n){"object"==typeof e[n]&&"object"==typeof r?e[n]=t(e[n],r):e[n]=r}for(var n=0,i=arguments.length;n<i;n++)l(arguments[n],r);return e},extend:function(t,e,r){return l(e,function(e,i){t[i]=r&&"function"==typeof e?n(e,r):e}),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(t,e){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,e,r){var n=r(54)("wks"),i=r(59),o=r(1).Symbol,a="function"==typeof o;(t.exports=function(t){return n[t]||(n[t]=a&&o[t]||(a?o:i)("Symbol."+t))}).store=n},function(t,e){var r=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=r)},function(t,e,r){var n=r(9);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e,r){t.exports=!r(23)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,r){var n=r(1),i=r(3),o=r(16),a=r(7),s=r(17),u=function(t,e,r){var l,c,h,f=t&u.F,p=t&u.G,d=t&u.S,v=t&u.P,y=t&u.B,g=t&u.W,m=p?i:i[e]||(i[e]={}),_=m.prototype,b=p?n:d?n[e]:(n[e]||{}).prototype;for(l in p&&(r=e),r)(c=!f&&b&&void 0!==b[l])&&s(m,l)||(h=c?b[l]:r[l],m[l]=p&&"function"!=typeof b[l]?r[l]:y&&c?o(h,n):g&&b[l]==h?function(t){var e=function(e,r,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,r)}return new t(e,r,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(h):v&&"function"==typeof h?o(Function.call,h):h,v&&((m.virtual||(m.virtual={}))[l]=h,t&u.R&&_&&!_[l]&&a(_,l,h)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e,r){var n=r(11),i=r(53);t.exports=r(5)?function(t,e,r){return n.f(t,e,i(1,r))}:function(t,e,r){return t[e]=r,t}},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){t.exports={}},function(t,e,r){var n=r(4),i=r(118),o=r(138),a=Object.defineProperty;e.f=r(5)?Object.defineProperty:function(t,e,r){if(n(t),e=o(e,!0),n(r),i)try{return a(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},function(t,e,r){var n=r(30),i=r(172),o=r(179),a="[object Null]",s="[object Undefined]",u=n?n.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?s:a:u&&u in Object(t)?i(t):o(t)}},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,e,r){var n=r(14);t.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){var r={}.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)}},function(t,e,r){var n=r(61),i="object"==typeof self&&self&&self.Object===Object&&self,o=n||i||Function("return this")();t.exports=o},function(t,e,r){"use strict";(function(e){var n=r(0),i=r(105),o={"Content-Type":"application/x-www-form-urlencoded"};function a(t,e){!n.isUndefined(t)&&n.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var s,u={adapter:("undefined"!=typeof XMLHttpRequest?s=r(36):void 0!==e&&(s=r(36)),s),transformRequest:[function(t,e){return i(e,"Content-Type"),n.isFormData(t)||n.isArrayBuffer(t)||n.isBuffer(t)||n.isStream(t)||n.isFile(t)||n.isBlob(t)?t:n.isArrayBufferView(t)?t.buffer:n.isURLSearchParams(t)?(a(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):n.isObject(t)?(a(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},n.forEach(["delete","get","head"],function(t){u.headers[t]={}}),n.forEach(["post","put","patch"],function(t){u.headers[t]=n.merge(o)}),t.exports=u}).call(e,r(70))},function(t,e,r){"use strict";e.__esModule=!0;var n,i=r(109),o=(n=i)&&n.__esModule?n:{default:n};e.default=function(t,e,r){return e in t?(0,o.default)(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,r){var n=r(9),i=r(1).document,o=n(i)&&n(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t.exports=!0},function(t,e,r){"use strict";var n=r(14);t.exports.f=function(t){return new function(t){var e,r;this.promise=new t(function(t,n){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=n}),this.resolve=n(e),this.reject=n(r)}(t)}},function(t,e,r){var n=r(11).f,i=r(17),o=r(2)("toStringTag");t.exports=function(t,e,r){t&&!i(t=r?t:t.prototype,o)&&n(t,o,{configurable:!0,value:e})}},function(t,e,r){var n=r(54)("keys"),i=r(59);t.exports=function(t){return n[t]||(n[t]=i(t))}},function(t,e){var r=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:r)(t)}},function(t,e,r){var n=r(48),i=r(21);t.exports=function(t){return n(i(t))}},function(t,e,r){var n=r(18).Symbol;t.exports=n},function(t,e){var r=Array.isArray;t.exports=r},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mapProps=void 0;var n,i=r(194),o=(n=i)&&n.__esModule?n:{default:n};var a={showHelpText:{type:Boolean,default:!1},shownViaNewRelationModal:{type:Boolean,default:!1},resourceId:{type:[Number,String]},resourceName:{type:String},field:{type:Object,required:!0},viaResource:{type:String,required:!1},viaResourceId:{type:[String,Number],required:!1},viaRelationship:{type:String,required:!1},shouldOverrideMeta:{type:Boolean,default:!1}};e.mapProps=function(t){return o.default.pick(a,t)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=["1/2","1/3","2/3","1/4","3/4","1/5","2/5","3/5","4/5","1/6","5/6"]},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(150);Object.defineProperty(e,"default",{enumerable:!0,get:function(){return o(n).default}}),Object.defineProperty(e,"Form",{enumerable:!0,get:function(){return o(n).default}});var i=r(60);function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"Errors",{enumerable:!0,get:function(){return o(i).default}})},function(t,e,r){"use strict";(function(e){var n=r(0),i=r(97),o=r(100),a=r(106),s=r(104),u=r(39),l="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||r(99);t.exports=function(t){return new Promise(function(c,h){var f=t.data,p=t.headers;n.isFormData(f)&&delete p["Content-Type"];var d=new XMLHttpRequest,v="onreadystatechange",y=!1;if("test"===e.env.NODE_ENV||"undefined"==typeof window||!window.XDomainRequest||"withCredentials"in d||s(t.url)||(d=new window.XDomainRequest,v="onload",y=!0,d.onprogress=function(){},d.ontimeout=function(){}),t.auth){var g=t.auth.username||"",m=t.auth.password||"";p.Authorization="Basic "+l(g+":"+m)}if(d.open(t.method.toUpperCase(),o(t.url,t.params,t.paramsSerializer),!0),d.timeout=t.timeout,d[v]=function(){if(d&&(4===d.readyState||y)&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var e="getAllResponseHeaders"in d?a(d.getAllResponseHeaders()):null,r={data:t.responseType&&"text"!==t.responseType?d.response:d.responseText,status:1223===d.status?204:d.status,statusText:1223===d.status?"No Content":d.statusText,headers:e,config:t,request:d};i(c,h,r),d=null}},d.onerror=function(){h(u("Network Error",t,null,d)),d=null},d.ontimeout=function(){h(u("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",d)),d=null},n.isStandardBrowserEnv()){var _=r(102),b=(t.withCredentials||s(t.url))&&t.xsrfCookieName?_.read(t.xsrfCookieName):void 0;b&&(p[t.xsrfHeaderName]=b)}if("setRequestHeader"in d&&n.forEach(p,function(t,e){void 0===f&&"content-type"===e.toLowerCase()?delete p[e]:d.setRequestHeader(e,t)}),t.withCredentials&&(d.withCredentials=!0),t.responseType)try{d.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&d.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){d&&(d.abort(),h(t),d=null)}),void 0===f&&(f=null),d.send(f)})}}).call(e,r(70))},function(t,e,r){"use strict";function n(t){this.message=t}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n},function(t,e,r){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,r){"use strict";var n=r(96);t.exports=function(t,e,r,i,o){var a=new Error(t);return n(a,e,r,i,o)}},function(t,e,r){"use strict";t.exports=function(t,e){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return t.apply(e,r)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mapProps=e.CardSizes=e.SingularOrPlural=e.Minimum=e.Capitalize=e.Inflector=e.Errors=e.TogglesTrashed=e.PreventsFormAbandonment=e.PerPageable=e.PerformsSearches=e.Paginatable=e.InteractsWithResourceInformation=e.InteractsWithQueryString=e.InteractsWithDates=e.HasCards=e.HandlesValidationErrors=e.FormField=e.Filterable=e.Deletable=e.BehavesAsPanel=void 0;var n=T(r(72)),i=T(r(73)),o=T(r(74)),a=T(r(75)),s=T(r(76)),u=T(r(77)),l=T(r(78)),c=T(r(79)),h=T(r(80)),f=T(r(81)),p=T(r(83)),d=T(r(82)),v=T(r(84)),y=T(r(85)),g=T(r(89)),m=T(r(34)),_=T(r(86)),b=T(r(87)),x=r(35),w=T(r(88)),E=r(33);function T(t){return t&&t.__esModule?t:{default:t}}e.BehavesAsPanel=n.default,e.Deletable=i.default,e.Filterable=o.default,e.FormField=a.default,e.HandlesValidationErrors=s.default,e.HasCards=u.default,e.InteractsWithDates=l.default,e.InteractsWithQueryString=c.default,e.InteractsWithResourceInformation=h.default,e.Paginatable=f.default,e.PerformsSearches=p.default,e.PerPageable=d.default,e.PreventsFormAbandonment=v.default,e.TogglesTrashed=y.default,e.Errors=x.Errors,e.Inflector=g.default,e.Capitalize=_.default,e.Minimum=b.default,e.SingularOrPlural=w.default,e.CardSizes=m.default,e.mapProps=E.mapProps},function(t,e,r){t.exports={default:r(113),__esModule:!0}},function(t,e,r){"use strict";e.__esModule=!0;var n,i=r(42),o=(n=i)&&n.__esModule?n:{default:n};e.default=function(t){return function(){var e=t.apply(this,arguments);return new o.default(function(t,r){return function n(i,a){try{var s=e[i](a),u=s.value}catch(t){return void r(t)}if(!s.done)return o.default.resolve(u).then(function(t){n("next",t)},function(t){n("throw",t)});t(u)}("next")})}}},function(t,e,r){t.exports=r(200)},function(t,e,r){var n=r(15),i=r(2)("toStringTag"),o="Arguments"==n(function(){return arguments}());t.exports=function(t){var e,r,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?r:o?n(e):"Object"==(a=n(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,r){var n=r(1).document;t.exports=n&&n.documentElement},function(t,e,r){var n=r(15);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e,r){"use strict";var n=r(24),i=r(6),o=r(134),a=r(7),s=r(10),u=r(122),l=r(26),c=r(130),h=r(2)("iterator"),f=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,r,d,v,y,g){u(r,e,d);var m,_,b,x=function(t){if(!f&&t in A)return A[t];switch(t){case"keys":case"values":return function(){return new r(this,t)}}return function(){return new r(this,t)}},w=e+" Iterator",E="values"==v,T=!1,A=t.prototype,k=A[h]||A["@@iterator"]||v&&A[v],S=k||x(v),M=v?E?x("entries"):S:void 0,O="Array"==e&&A.entries||k;if(O&&(b=c(O.call(new t)))!==Object.prototype&&b.next&&(l(b,w,!0),n||"function"==typeof b[h]||a(b,h,p)),E&&k&&"values"!==k.name&&(T=!0,S=function(){return k.call(this)}),n&&!g||!f&&!T&&A[h]||a(A,h,S),s[e]=S,s[w]=p,v)if(m={values:E?S:x("values"),keys:y?S:x("keys"),entries:M},g)for(_ in m)_ in A||o(A,_,m[_]);else i(i.P+i.F*(f||T),e,m);return m}},function(t,e,r){var n=r(131),i=r(46);t.exports=Object.keys||function(t){return n(t,i)}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,r){var n=r(4),i=r(9),o=r(25);t.exports=function(t,e){if(n(t),i(e)&&e.constructor===t)return e;var r=o.f(t);return(0,r.resolve)(e),r.promise}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,r){var n=r(3),i=r(1),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:r(24)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e,r){var n=r(4),i=r(14),o=r(2)("species");t.exports=function(t,e){var r,a=n(t).constructor;return void 0===a||void 0==(r=n(a)[o])?e:i(r)}},function(t,e,r){var n,i,o,a=r(16),s=r(119),u=r(47),l=r(22),c=r(1),h=c.process,f=c.setImmediate,p=c.clearImmediate,d=c.MessageChannel,v=c.Dispatch,y=0,g={},m=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},_=function(t){m.call(t.data)};f&&p||(f=function(t){for(var e=[],r=1;arguments.length>r;)e.push(arguments[r++]);return g[++y]=function(){s("function"==typeof t?t:Function(t),e)},n(y),y},p=function(t){delete g[t]},"process"==r(15)(h)?n=function(t){h.nextTick(a(m,t,1))}:v&&v.now?n=function(t){v.now(a(m,t,1))}:d?(o=(i=new d).port2,i.port1.onmessage=_,n=a(o.postMessage,o,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(n=function(t){c.postMessage(t+"","*")},c.addEventListener("message",_,!1)):n="onreadystatechange"in l("script")?function(t){u.appendChild(l("script")).onreadystatechange=function(){u.removeChild(this),m.call(t)}}:function(t){setTimeout(a(m,t,1),0)}),t.exports={set:f,clear:p}},function(t,e,r){var n=r(28),i=Math.min;t.exports=function(t){return t>0?i(n(t),9007199254740991):0}},function(t,e,r){var n=r(21);t.exports=function(t){return Object(n(t))}},function(t,e){var r=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+n).toString(36))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var i=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.record(e)}return n(t,[{key:"all",value:function(){return this.errors}},{key:"has",value:function(t){var e=this.errors.hasOwnProperty(t);e||(e=Object.keys(this.errors).filter(function(e){return e.startsWith(t+".")||e.startsWith(t+"[")}).length>0);return e}},{key:"first",value:function(t){return this.get(t)[0]}},{key:"get",value:function(t){return this.errors[t]||[]}},{key:"any",value:function(){return Object.keys(this.errors).length>0}},{key:"record",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.errors=t}},{key:"clear",value:function(t){if(t){var e=Object.assign({},this.errors);Object.keys(e).filter(function(e){return e===t||e.startsWith(t+".")||e.startsWith(t+"[")}).forEach(function(t){return delete e[t]}),this.errors=e}else this.errors={}}}]),t}();e.default=i},function(t,e,r){(function(e){var r="object"==typeof e&&e&&e.Object===Object&&e;t.exports=r}).call(e,r(71))},function(t,e){var r=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");t.exports=function(t){return r.test(t)}},function(t,e){var r=9007199254740991,n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var i=typeof t;return!!(e=null==e?r:e)&&("number"==i||"symbol"!=i&&n.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e){t.exports=function(t){return t}},function(t,e,r){var n=r(67),i=r(68);t.exports=function(t){return null!=t&&i(t.length)&&!n(t)}},function(t,e,r){var n=r(12),i=r(8),o="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",u="[object Proxy]";t.exports=function(t){if(!i(t))return!1;var e=n(t);return e==a||e==s||e==o||e==u}},function(t,e){var r=9007199254740991;t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}},function(t,e,r){var n=r(12),i=r(13),o="[object Symbol]";t.exports=function(t){return"symbol"==typeof t||i(t)&&n(t)==o}},function(t,e){var r,n,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(t){r=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var u,l=[],c=!1,h=-1;function f(){c&&u&&(c=!1,u.length?l=u.concat(l):h=-1,l.length&&p())}function p(){if(!c){var t=s(f);c=!0;for(var e=l.length;e;){for(u=l,l=[];++h<e;)u&&u[h].run();h=-1,e=l.length}u=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new d(t,e)),1!==l.length||c||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["resourceName","resourceId","resource","panel"],methods:{actionExecuted:function(){this.$emit("actionExecuted")}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=r(110),o=(n=i)&&n.__esModule?n:{default:n};function a(t){return _.map(t,function(t){return t.id.value})}e.default={methods:{openDeleteModal:function(){this.deleteModalOpen=!0},deleteResources:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.viaManyToMany?this.detachResources(t):Nova.request({url:"/nova-api/"+this.resourceName,method:"delete",params:(0,o.default)({},this.queryString,{resources:a(t)})}).then(r||function(){e.deleteModalOpen=!1,e.getResources()}).then(function(){Nova.$emit("resources-deleted")})},deleteSelectedResources:function(){this.deleteResources(this.selectedResources)},deleteAllMatchingResources:function(){var t=this;return this.viaManyToMany?this.detachAllMatchingResources():Nova.request({url:this.deleteAllMatchingResourcesEndpoint,method:"delete",params:(0,o.default)({},this.queryString,{resources:"all"})}).then(function(){t.deleteModalOpen=!1,t.getResources()}).then(function(){Nova.$emit("resources-deleted")})},detachResources:function(t){var e=this;return Nova.request({url:"/nova-api/"+this.resourceName+"/detach",method:"delete",params:(0,o.default)({},this.queryString,{resources:a(t)},{pivots:function(t){return _.filter(_.map(t,function(t){return t.id.pivotValue}))}(t)})}).then(function(){e.deleteModalOpen=!1,e.getResources()}).then(function(){Nova.$emit("resources-detached")})},detachAllMatchingResources:function(){var t=this;return Nova.request({url:"/nova-api/"+this.resourceName+"/detach",method:"delete",params:(0,o.default)({},this.queryString,{resources:"all"})}).then(function(){t.deleteModalOpen=!1,t.getResources()}).then(function(){Nova.$emit("resources-detached")})},forceDeleteResources:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Nova.request({url:"/nova-api/"+this.resourceName+"/force",method:"delete",params:(0,o.default)({},this.queryString,{resources:a(t)})}).then(r||function(){e.deleteModalOpen=!1,e.getResources()}).then(function(){Nova.$emit("resources-deleted")})},forceDeleteSelectedResources:function(){this.forceDeleteResources(this.selectedResources)},forceDeleteAllMatchingResources:function(){var t=this;return Nova.request({url:this.forceDeleteSelectedResourcesEndpoint,method:"delete",params:(0,o.default)({},this.queryString,{resources:"all"})}).then(function(){t.deleteModalOpen=!1,t.getResources()}).then(function(){Nova.$emit("resources-deleted")})},restoreResources:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Nova.request({url:"/nova-api/"+this.resourceName+"/restore",method:"put",params:(0,o.default)({},this.queryString,{resources:a(t)})}).then(r||function(){e.restoreModalOpen=!1,e.getResources()}).then(function(){Nova.$emit("resources-restored")})},restoreSelectedResources:function(){this.restoreResources(this.selectedResources)},restoreAllMatchingResources:function(){var t=this;return Nova.request({url:this.restoreAllMatchingResourcesEndpoint,method:"put",params:(0,o.default)({},this.queryString,{resources:"all"})}).then(function(){t.restoreModalOpen=!1,t.getResources()}).then(function(){Nova.$emit("resources-restored")})}},computed:{deleteAllMatchingResourcesEndpoint:function(){return this.lens?"/nova-api/"+this.resourceName+"/lens/"+this.lens:"/nova-api/"+this.resourceName},forceDeleteSelectedResourcesEndpoint:function(){return this.lens?"/nova-api/"+this.resourceName+"/lens/"+this.lens+"/force":"/nova-api/"+this.resourceName+"/force"},restoreAllMatchingResourcesEndpoint:function(){return this.lens?"/nova-api/"+this.resourceName+"/lens/"+this.lens+"/restore":"/nova-api/"+this.resourceName+"/restore"},queryString:function(){return{search:this.currentSearch,filters:this.encodedFilters,trashed:this.currentTrashed,viaResource:this.viaResource,viaResourceId:this.viaResourceId,viaRelationship:this.viaRelationship}}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(r(44)),i=a(r(20)),o=a(r(43));function a(t){return t&&t.__esModule?t:{default:t}}e.default={methods:{clearSelectedFilters:function(){var t=(0,o.default)(n.default.mark(function t(e){var r;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=5;break}return t.next=3,this.$store.dispatch(this.resourceName+"/resetFilterState",{resourceName:this.resourceName,lens:e});case 3:t.next=7;break;case 5:return t.next=7,this.$store.dispatch(this.resourceName+"/resetFilterState",{resourceName:this.resourceName});case 7:this.updateQueryString((r={},(0,i.default)(r,this.pageParameter,1),(0,i.default)(r,this.filterParameter,""),r));case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),filterChanged:function(){var t;this.updateQueryString((t={},(0,i.default)(t,this.pageParameter,1),(0,i.default)(t,this.filterParameter,this.$store.getters[this.resourceName+"/currentEncodedFilters"]),t))},initializeFilters:function(){var t=(0,o.default)(n.default.mark(function t(e){return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.$store.commit(this.resourceName+"/clearFilters"),t.next=3,this.$store.dispatch(this.resourceName+"/fetchFilters",{resourceName:this.resourceName,viaResource:this.viaResource,viaResourceId:this.viaResourceId,viaRelationship:this.viaRelationship,lens:e});case 3:return t.next=5,this.initializeState(e);case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),initializeState:function(){var t=(0,o.default)(n.default.mark(function t(e){return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.initialEncodedFilters){t.next=5;break}return t.next=3,this.$store.dispatch(this.resourceName+"/initializeCurrentFilterValuesFromQueryString",this.initialEncodedFilters);case 3:t.next=7;break;case 5:return t.next=7,this.$store.dispatch(this.resourceName+"/resetFilterState",{resourceName:this.resourceName,lens:e});case 7:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},computed:{filterParameter:function(){return this.resourceName+"_filter"}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(33);e.default={props:(0,n.mapProps)(["shownViaNewRelationModal","field","viaResource","viaResourceId","viaRelationship","resourceName","showHelpText"]),data:function(){return{value:""}},mounted:function(){var t=this;this.setInitialValue(),this.field.fill=this.fill,Nova.$on(this.field.attribute+"-value",function(e){t.value=e})},destroyed:function(){Nova.$off(this.field.attribute+"-value")},methods:{setInitialValue:function(){this.value=void 0!==this.field.value&&null!==this.field.value?this.field.value:""},fill:function(t){t.append(this.field.attribute,String(this.value))},handleChange:function(t){this.value=t.target.value,this.field&&Nova.$emit(this.field.attribute+"-change",this.value)}},computed:{isReadonly:function(){return this.field.readonly||_.get(this.field,"extraAttributes.readonly")}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(35);e.default={props:{errors:{default:function(){return new n.Errors}}},data:function(){return{errorClass:"border-danger"}},computed:{errorClasses:function(){return this.hasError?[this.errorClass]:[]},fieldAttribute:function(){return this.field.attribute},validationKey:function(){return this.field.validationKey},hasError:function(){return this.errors.has(this.validationKey)},firstError:function(){if(this.hasError)return this.errors.first(this.validationKey)}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(r(44)),i=a(r(43)),o=a(r(34));function a(t){return t&&t.__esModule?t:{default:t}}e.default={props:{loadCards:{type:Boolean,default:!0}},data:function(){return{cards:[]}},created:function(){this.fetchCards()},watch:{cardsEndpoint:function(){this.fetchCards()}},methods:{fetchCards:function(){var t=(0,i.default)(n.default.mark(function t(){var e,r;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.loadCards){t.next=6;break}return t.next=3,Nova.request().get(this.cardsEndpoint,{params:this.extraCardParams});case 3:e=t.sent,r=e.data,this.cards=r;case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},computed:{shouldShowCards:function(){return this.cards.length>0},smallCards:function(){return _.filter(this.cards,function(t){return-1!==o.default.indexOf(t.width)})},largeCards:function(){return _.filter(this.cards,function(t){return"full"==t.width})},extraCardParams:function(){return null}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={methods:{toAppTimezone:function(t){return t?moment.tz(t,this.userTimezone).clone().tz(Nova.config.timezone).format("YYYY-MM-DD HH:mm:ss"):t},fromAppTimezone:function(t){return t?moment.tz(t,Nova.config.timezone).clone().tz(this.userTimezone).format("YYYY-MM-DD HH:mm:ss"):t},localizeDateTimeField:function(t){if(!t.value)return t.value;var e=moment.tz(t.value,Nova.config.timezone).clone().tz(this.userTimezone);return t.format?e.format(t.format):this.usesTwelveHourTime?e.format("YYYY-MM-DD h:mm:ss A"):e.format("YYYY-MM-DD HH:mm:ss")},localizeDateField:function(t){if(!t.value)return t.value;var e=moment.tz(t.value,Nova.config.timezone).clone().tz(this.userTimezone);return t.format?e.format(t.format):e.format("YYYY-MM-DD")}},computed:{userTimezone:function(){return Nova.config.userTimezone?Nova.config.userTimezone:moment.tz.guess()},usesTwelveHourTime:function(){return _.endsWith((new Date).toLocaleString(),"AM")||_.endsWith((new Date).toLocaleString(),"PM")}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=r(188),o=(n=i)&&n.__esModule?n:{default:n};e.default={methods:{updateQueryString:function(t){this.$router.push({query:(0,o.default)(t,this.$route.query)}).catch(function(t){if("NavigationDuplicated"!=t.name)throw t})}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={computed:{resourceInformation:function(){var t=this;return _.find(Nova.config.resources,function(e){return e.uriKey==t.resourceName})},viaResourceInformation:function(){var t=this;if(this.viaResource)return _.find(Nova.config.resources,function(e){return e.uriKey==t.viaResource})},authorizedToCreate:function(){return this.resourceInformation.authorizedToCreate}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=r(20),o=(n=i)&&n.__esModule?n:{default:n};e.default={methods:{selectPreviousPage:function(){this.updateQueryString((0,o.default)({},this.pageParameter,this.currentPage-1))},selectNextPage:function(){this.updateQueryString((0,o.default)({},this.pageParameter,this.currentPage+1))}},computed:{currentPage:function(){return parseInt(this.$route.query[this.pageParameter]||1)}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=r(20),o=(n=i)&&n.__esModule?n:{default:n};e.default={data:function(){return{perPage:25}},methods:{initializePerPageFromQueryString:function(){this.perPage=this.currentPerPage},perPageChanged:function(){this.updateQueryString((0,o.default)({},this.perPageParameter,this.perPage))}},computed:{currentPerPage:function(){return this.$route.query[this.perPageParameter]||25}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=r(187),o=(n=i)&&n.__esModule?n:{default:n};e.default={data:function(){return{search:"",selectedResource:"",availableResources:[]}},methods:{selectResource:function(t){this.selectedResource=t,this.field&&Nova.$emit(this.field.attribute+"-change",this.selectedResource.value)},handleSearchCleared:function(){this.availableResources=[]},clearSelection:function(){this.selectedResource="",this.availableResources=[],this.field&&Nova.$emit(this.field.attribute+"-change",null)},performSearch:function(t){var e=this;this.search=t;var r=t.trim();""!=r&&this.debouncer(function(){e.getAvailableResources(r)},500)},debouncer:(0,o.default)(function(t){return t()},500)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={beforeRouteLeave:function(t,e,r){this.canLeave?r():window.confirm(this.__("Do you really want to leave? You have unsaved changes."))?r():r(!1)},data:function(){return{canLeave:!0}},methods:{updateFormStatus:function(){this.canLeave=!1}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{withTrashed:!1}},methods:{toggleWithTrashed:function(){this.withTrashed=!this.withTrashed},enableWithTrashed:function(){this.withTrashed=!0},disableWithTrashed:function(){this.withTrashed=!1}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return(0,o.default)(t)};var n,i=r(199),o=(n=i)&&n.__esModule?n:{default:n}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=r(42),o=(n=i)&&n.__esModule?n:{default:n};e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return o.default.all([t,new o.default(function(t){setTimeout(function(){return t()},e)})]).then(function(t){return t[0]})}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if((0,a.default)(e)&&null==e.match(/^(.*)[A-Za-zÀ-ÖØ-öø-ÿ]$/))return e;if(t>1||0==t)return i.Inflector.pluralize(e);return i.Inflector.singularize(e)};var n,i=r(41),o=r(191),a=(n=o)&&n.__esModule?n:{default:n}},function(t,e,r){"use strict";var n={uncountableWords:["equipment","information","rice","money","species","series","fish","sheep","moose","deer","news"],pluralRules:[[new RegExp("(m)an$","gi"),"$1en"],[new RegExp("(pe)rson$","gi"),"$1ople"],[new RegExp("(child)$","gi"),"$1ren"],[new RegExp("^(ox)$","gi"),"$1en"],[new RegExp("(ax|test)is$","gi"),"$1es"],[new RegExp("(octop|vir)us$","gi"),"$1i"],[new RegExp("(alias|status)$","gi"),"$1es"],[new RegExp("(bu)s$","gi"),"$1ses"],[new RegExp("(buffal|tomat|potat)o$","gi"),"$1oes"],[new RegExp("([ti])um$","gi"),"$1a"],[new RegExp("sis$","gi"),"ses"],[new RegExp("(?:([^f])fe|([lr])f)$","gi"),"$1$2ves"],[new RegExp("(hive)$","gi"),"$1s"],[new RegExp("([^aeiouy]|qu)y$","gi"),"$1ies"],[new RegExp("(x|ch|ss|sh)$","gi"),"$1es"],[new RegExp("(matr|vert|ind)ix|ex$","gi"),"$1ices"],[new RegExp("([m|l])ouse$","gi"),"$1ice"],[new RegExp("(quiz)$","gi"),"$1zes"],[new RegExp("s$","gi"),"s"],[new RegExp("$","gi"),"s"]],singularRules:[[new RegExp("(m)en$","gi"),"$1an"],[new RegExp("(pe)ople$","gi"),"$1rson"],[new RegExp("(child)ren$","gi"),"$1"],[new RegExp("([ti])a$","gi"),"$1um"],[new RegExp("((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$","gi"),"$1$2sis"],[new RegExp("(hive)s$","gi"),"$1"],[new RegExp("(tive)s$","gi"),"$1"],[new RegExp("(curve)s$","gi"),"$1"],[new RegExp("([lr])ves$","gi"),"$1f"],[new RegExp("([^fo])ves$","gi"),"$1fe"],[new RegExp("([^aeiouy]|qu)ies$","gi"),"$1y"],[new RegExp("(s)eries$","gi"),"$1eries"],[new RegExp("(m)ovies$","gi"),"$1ovie"],[new RegExp("(x|ch|ss|sh)es$","gi"),"$1"],[new RegExp("([m|l])ice$","gi"),"$1ouse"],[new RegExp("(bus)es$","gi"),"$1"],[new RegExp("(o)es$","gi"),"$1"],[new RegExp("(shoe)s$","gi"),"$1"],[new RegExp("(cris|ax|test)es$","gi"),"$1is"],[new RegExp("(octop|vir)i$","gi"),"$1us"],[new RegExp("(alias|status)es$","gi"),"$1"],[new RegExp("^(ox)en","gi"),"$1"],[new RegExp("(vert|ind)ices$","gi"),"$1ex"],[new RegExp("(matr)ices$","gi"),"$1ix"],[new RegExp("(quiz)zes$","gi"),"$1"],[new RegExp("s$","gi"),""]],nonTitlecasedWords:["and","or","nor","a","an","the","so","but","to","of","at","by","from","into","on","onto","off","out","in","over","with","for"],idSuffix:new RegExp("(_ids|_id)$","g"),underbar:new RegExp("_","g"),spaceOrUnderbar:new RegExp("[ _]","g"),uppercase:new RegExp("([A-Z])","g"),underbarPrefix:new RegExp("^_"),applyRules:function(t,e,r,n){if(n)t=n;else if(!(r.indexOf(t.toLowerCase())>-1))for(var i=0;i<e.length;i++)if(t.match(e[i][0])){t=t.replace(e[i][0],e[i][1]);break}return t},pluralize:function(t,e){return this.applyRules(t,this.pluralRules,this.uncountableWords,e)},singularize:function(t,e){return this.applyRules(t,this.singularRules,this.uncountableWords,e)},camelize:function(t,e){for(var r=t.split("/"),n=0;n<r.length;n++){for(var i=r[n].split("_"),o=e&&n+1===r.length?1:0;o<i.length;o++)i[o]=i[o].charAt(0).toUpperCase()+i[o].substring(1);r[n]=i.join("")}(t=r.join("::"),!0===e)&&(t=t.charAt(0).toLowerCase()+t.slice(1));return t},underscore:function(t){for(var e=t.split("::"),r=0;r<e.length;r++)e[r]=e[r].replace(this.uppercase,"_$1"),e[r]=e[r].replace(this.underbarPrefix,"");return t=e.join("/").toLowerCase()},humanize:function(t,e){return t=(t=(t=t.toLowerCase()).replace(this.idSuffix,"")).replace(this.underbar," "),e||(t=this.capitalize(t)),t},capitalize:function(t){return t=(t=t.toLowerCase()).substring(0,1).toUpperCase()+t.substring(1)},dasherize:function(t){return t=t.replace(this.spaceOrUnderbar,"-")},camel2words:function(t,e){!0===e?(t=this.camelize(t),t=this.underscore(t)):t=t.toLowerCase();for(var r=(t=t.replace(this.underbar," ")).split(" "),n=0;n<r.length;n++){for(var i=r[n].split("-"),o=0;o<i.length;o++)this.nonTitlecasedWords.indexOf(i[o].toLowerCase())<0&&(i[o]=this.capitalize(i[o]));r[n]=i.join("-")}return t=(t=r.join(" ")).substring(0,1).toUpperCase()+t.substring(1)},demodulize:function(t){var e=t.split("::");return t=e[e.length-1]},tableize:function(t){return t=this.pluralize(this.underscore(t))},classify:function(t){return t=this.singularize(this.camelize(t))},foreignKey:function(t,e){return t=this.underscore(this.demodulize(t))+(e?"":"_")+"id"},ordinalize:function(t){for(var e=t.split(" "),r=0;r<e.length;r++){if(NaN===parseInt(e[r])){var n=e[r].substring(e[r].length-2),i=e[r].substring(e[r].length-1),o="th";"11"!=n&&"12"!=n&&"13"!=n&&("1"===i?o="st":"2"===i?o="nd":"3"===i&&(o="rd")),e[r]+=o}}return t=e.join(" ")}};t.exports=n},function(t,e,r){t.exports=r(91)},function(t,e,r){"use strict";var n=r(0),i=r(40),o=r(93),a=r(19);function s(t){var e=new o(t),r=i(o.prototype.request,e);return n.extend(r,o.prototype,e),n.extend(r,e),r}var u=s(a);u.Axios=o,u.create=function(t){return s(n.merge(a,t))},u.Cancel=r(37),u.CancelToken=r(92),u.isCancel=r(38),u.all=function(t){return Promise.all(t)},u.spread=r(107),t.exports=u,t.exports.default=u},function(t,e,r){"use strict";var n=r(37);function i(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var r=this;t(function(t){r.reason||(r.reason=new n(t),e(r.reason))})}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var t;return{token:new i(function(e){t=e}),cancel:t}},t.exports=i},function(t,e,r){"use strict";var n=r(19),i=r(0),o=r(94),a=r(95);function s(t){this.defaults=t,this.interceptors={request:new o,response:new o}}s.prototype.request=function(t){"string"==typeof t&&(t=i.merge({url:arguments[0]},arguments[1])),(t=i.merge(n,{method:"get"},this.defaults,t)).method=t.method.toLowerCase();var e=[a,void 0],r=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)r=r.then(e.shift(),e.shift());return r},i.forEach(["delete","get","head","options"],function(t){s.prototype[t]=function(e,r){return this.request(i.merge(r||{},{method:t,url:e}))}}),i.forEach(["post","put","patch"],function(t){s.prototype[t]=function(e,r,n){return this.request(i.merge(n||{},{method:t,url:e,data:r}))}}),t.exports=s},function(t,e,r){"use strict";var n=r(0);function i(){this.handlers=[]}i.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},i.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},i.prototype.forEach=function(t){n.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=i},function(t,e,r){"use strict";var n=r(0),i=r(98),o=r(38),a=r(19),s=r(103),u=r(101);function l(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return l(t),t.baseURL&&!s(t.url)&&(t.url=u(t.baseURL,t.url)),t.headers=t.headers||{},t.data=i(t.data,t.headers,t.transformRequest),t.headers=n.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),n.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||a.adapter)(t).then(function(e){return l(t),e.data=i(e.data,e.headers,t.transformResponse),e},function(e){return o(e)||(l(t),e&&e.response&&(e.response.data=i(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e,r){"use strict";t.exports=function(t,e,r,n,i){return t.config=e,r&&(t.code=r),t.request=n,t.response=i,t}},function(t,e,r){"use strict";var n=r(39);t.exports=function(t,e,r){var i=r.config.validateStatus;r.status&&i&&!i(r.status)?e(n("Request failed with status code "+r.status,r.config,null,r.request,r)):t(r)}},function(t,e,r){"use strict";var n=r(0);t.exports=function(t,e,r){return n.forEach(r,function(r){t=r(t,e)}),t}},function(t,e,r){"use strict";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function i(){this.message="String contains an invalid character"}i.prototype=new Error,i.prototype.code=5,i.prototype.name="InvalidCharacterError",t.exports=function(t){for(var e,r,o=String(t),a="",s=0,u=n;o.charAt(0|s)||(u="=",s%1);a+=u.charAt(63&e>>8-s%1*8)){if((r=o.charCodeAt(s+=.75))>255)throw new i;e=e<<8|r}return a}},function(t,e,r){"use strict";var n=r(0);function i(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,r){if(!e)return t;var o;if(r)o=r(e);else if(n.isURLSearchParams(e))o=e.toString();else{var a=[];n.forEach(e,function(t,e){null!==t&&void 0!==t&&(n.isArray(t)?e+="[]":t=[t],n.forEach(t,function(t){n.isDate(t)?t=t.toISOString():n.isObject(t)&&(t=JSON.stringify(t)),a.push(i(e)+"="+i(t))}))}),o=a.join("&")}return o&&(t+=(-1===t.indexOf("?")?"?":"&")+o),t}},function(t,e,r){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,r){"use strict";var n=r(0);t.exports=n.isStandardBrowserEnv()?{write:function(t,e,r,i,o,a){var s=[];s.push(t+"="+encodeURIComponent(e)),n.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),n.isString(i)&&s.push("path="+i),n.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,r){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,r){"use strict";var n=r(0);t.exports=n.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(t){var n=t;return e&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return t=i(window.location.href),function(e){var r=n.isString(e)?i(e):e;return r.protocol===t.protocol&&r.host===t.host}}():function(){return!0}},function(t,e,r){"use strict";var n=r(0);t.exports=function(t,e){n.forEach(t,function(r,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=r,delete t[n])})}},function(t,e,r){"use strict";var n=r(0),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,r,o,a={};return t?(n.forEach(t.split("\n"),function(t){if(o=t.indexOf(":"),e=n.trim(t.substr(0,o)).toLowerCase(),r=n.trim(t.substr(o+1)),e){if(a[e]&&i.indexOf(e)>=0)return;a[e]="set-cookie"===e?(a[e]?a[e]:[]).concat([r]):a[e]?a[e]+", "+r:r}}),a):a}},function(t,e,r){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,r){t.exports={default:r(111),__esModule:!0}},function(t,e,r){t.exports={default:r(112),__esModule:!0}},function(t,e,r){"use strict";e.__esModule=!0;var n,i=r(108),o=(n=i)&&n.__esModule?n:{default:n};e.default=o.default||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}},function(t,e,r){r(142),t.exports=r(3).Object.assign},function(t,e,r){r(143);var n=r(3).Object;t.exports=function(t,e,r){return n.defineProperty(t,e,r)}},function(t,e,r){r(144),r(146),r(149),r(145),r(147),r(148),t.exports=r(3).Promise},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e,r,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(r+": incorrect invocation!");return t}},function(t,e,r){var n=r(29),i=r(57),o=r(137);t.exports=function(t){return function(e,r,a){var s,u=n(e),l=i(u.length),c=o(a,l);if(t&&r!=r){for(;l>c;)if((s=u[c++])!=s)return!0}else for(;l>c;c++)if((t||c in u)&&u[c]===r)return t||c||0;return!t&&-1}}},function(t,e,r){var n=r(16),i=r(121),o=r(120),a=r(4),s=r(57),u=r(140),l={},c={};(e=t.exports=function(t,e,r,h,f){var p,d,v,y,g=f?function(){return t}:u(t),m=n(r,h,e?2:1),_=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(p=s(t.length);p>_;_++)if((y=e?m(a(d=t[_])[0],d[1]):m(t[_]))===l||y===c)return y}else for(v=g.call(t);!(d=v.next()).done;)if((y=i(v,m,d.value,e))===l||y===c)return y}).BREAK=l,e.RETURN=c},function(t,e,r){t.exports=!r(5)&&!r(23)(function(){return 7!=Object.defineProperty(r(22)("div"),"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t,e,r){var n=void 0===r;switch(e.length){case 0:return n?t():t.call(r);case 1:return n?t(e[0]):t.call(r,e[0]);case 2:return n?t(e[0],e[1]):t.call(r,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(r,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(r,e[0],e[1],e[2],e[3])}return t.apply(r,e)}},function(t,e,r){var n=r(10),i=r(2)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||o[i]===t)}},function(t,e,r){var n=r(4);t.exports=function(t,e,r,i){try{return i?e(n(r)[0],r[1]):e(r)}catch(e){var o=t.return;throw void 0!==o&&n(o.call(t)),e}}},function(t,e,r){"use strict";var n=r(127),i=r(53),o=r(26),a={};r(7)(a,r(2)("iterator"),function(){return this}),t.exports=function(t,e,r){t.prototype=n(a,{next:i(1,r)}),o(t,e+" Iterator")}},function(t,e,r){var n=r(2)("iterator"),i=!1;try{var o=[7][n]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var r=!1;try{var o=[7],a=o[n]();a.next=function(){return{done:r=!0}},o[n]=function(){return a},t(o)}catch(t){}return r}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,r){var n=r(1),i=r(56).set,o=n.MutationObserver||n.WebKitMutationObserver,a=n.process,s=n.Promise,u="process"==r(15)(a);t.exports=function(){var t,e,r,l=function(){var n,i;for(u&&(n=a.domain)&&n.exit();t;){i=t.fn,t=t.next;try{i()}catch(n){throw t?r():e=void 0,n}}e=void 0,n&&n.enter()};if(u)r=function(){a.nextTick(l)};else if(!o||n.navigator&&n.navigator.standalone)if(s&&s.resolve){var c=s.resolve(void 0);r=function(){c.then(l)}}else r=function(){i.call(n,l)};else{var h=!0,f=document.createTextNode("");new o(l).observe(f,{characterData:!0}),r=function(){f.data=h=!h}}return function(n){var i={fn:n,next:void 0};e&&(e.next=i),t||(t=i,r()),e=i}}},function(t,e,r){"use strict";var n=r(50),i=r(129),o=r(132),a=r(58),s=r(48),u=Object.assign;t.exports=!u||r(23)(function(){var t={},e={},r=Symbol(),n="abcdefghijklmnopqrst";return t[r]=7,n.split("").forEach(function(t){e[t]=t}),7!=u({},t)[r]||Object.keys(u({},e)).join("")!=n})?function(t,e){for(var r=a(t),u=arguments.length,l=1,c=i.f,h=o.f;u>l;)for(var f,p=s(arguments[l++]),d=c?n(p).concat(c(p)):n(p),v=d.length,y=0;v>y;)h.call(p,f=d[y++])&&(r[f]=p[f]);return r}:u},function(t,e,r){var n=r(4),i=r(128),o=r(46),a=r(27)("IE_PROTO"),s=function(){},u=function(){var t,e=r(22)("iframe"),n=o.length;for(e.style.display="none",r(47).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),u=t.F;n--;)delete u.prototype[o[n]];return u()};t.exports=Object.create||function(t,e){var r;return null!==t?(s.prototype=n(t),r=new s,s.prototype=null,r[a]=t):r=u(),void 0===e?r:i(r,e)}},function(t,e,r){var n=r(11),i=r(4),o=r(50);t.exports=r(5)?Object.defineProperties:function(t,e){i(t);for(var r,a=o(e),s=a.length,u=0;s>u;)n.f(t,r=a[u++],e[r]);return t}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,r){var n=r(17),i=r(58),o=r(27)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),n(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,r){var n=r(17),i=r(29),o=r(116)(!1),a=r(27)("IE_PROTO");t.exports=function(t,e){var r,s=i(t),u=0,l=[];for(r in s)r!=a&&n(s,r)&&l.push(r);for(;e.length>u;)n(s,r=e[u++])&&(~o(l,r)||l.push(r));return l}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,r){var n=r(7);t.exports=function(t,e,r){for(var i in e)r&&t[i]?t[i]=e[i]:n(t,i,e[i]);return t}},function(t,e,r){t.exports=r(7)},function(t,e,r){"use strict";var n=r(1),i=r(3),o=r(11),a=r(5),s=r(2)("species");t.exports=function(t){var e="function"==typeof i[t]?i[t]:n[t];a&&e&&!e[s]&&o.f(e,s,{configurable:!0,get:function(){return this}})}},function(t,e,r){var n=r(28),i=r(21);t.exports=function(t){return function(e,r){var o,a,s=String(i(e)),u=n(r),l=s.length;return u<0||u>=l?t?"":void 0:(o=s.charCodeAt(u))<55296||o>56319||u+1===l||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):o:t?s.slice(u,u+2):a-56320+(o-55296<<10)+65536}}},function(t,e,r){var n=r(28),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=n(t))<0?i(t+e,0):o(t,e)}},function(t,e,r){var n=r(9);t.exports=function(t,e){if(!n(t))return t;var r,i;if(e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!n(i=r.call(t)))return i;if(!e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,r){var n=r(1).navigator;t.exports=n&&n.userAgent||""},function(t,e,r){var n=r(45),i=r(2)("iterator"),o=r(10);t.exports=r(3).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[n(t)]}},function(t,e,r){"use strict";var n=r(114),i=r(124),o=r(10),a=r(29);t.exports=r(49)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?r:"values"==e?t[r]:[r,t[r]])},"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},function(t,e,r){var n=r(6);n(n.S+n.F,"Object",{assign:r(126)})},function(t,e,r){var n=r(6);n(n.S+n.F*!r(5),"Object",{defineProperty:r(11).f})},function(t,e){},function(t,e,r){"use strict";var n,i,o,a,s=r(24),u=r(1),l=r(16),c=r(45),h=r(6),f=r(9),p=r(14),d=r(115),v=r(117),y=r(55),g=r(56).set,m=r(125)(),_=r(25),b=r(51),x=r(139),w=r(52),E=u.TypeError,T=u.process,A=T&&T.versions,k=A&&A.v8||"",S=u.Promise,M="process"==c(T),O=function(){},I=i=_.f,L=!!function(){try{var t=S.resolve(1),e=(t.constructor={})[r(2)("species")]=function(t){t(O,O)};return(M||"function"==typeof PromiseRejectionEvent)&&t.then(O)instanceof e&&0!==k.indexOf("6.6")&&-1===x.indexOf("Chrome/66")}catch(t){}}(),C=function(t){var e;return!(!f(t)||"function"!=typeof(e=t.then))&&e},R=function(t,e){if(!t._n){t._n=!0;var r=t._c;m(function(){for(var n=t._v,i=1==t._s,o=0,a=function(e){var r,o,a,s=i?e.ok:e.fail,u=e.resolve,l=e.reject,c=e.domain;try{s?(i||(2==t._h&&j(t),t._h=1),!0===s?r=n:(c&&c.enter(),r=s(n),c&&(c.exit(),a=!0)),r===e.promise?l(E("Promise-chain cycle")):(o=C(r))?o.call(r,u,l):u(r)):l(n)}catch(t){c&&!a&&c.exit(),l(t)}};r.length>o;)a(r[o++]);t._c=[],t._n=!1,e&&!t._h&&P(t)})}},P=function(t){g.call(u,function(){var e,r,n,i=t._v,o=N(t);if(o&&(e=b(function(){M?T.emit("unhandledRejection",i,t):(r=u.onunhandledrejection)?r({promise:t,reason:i}):(n=u.console)&&n.error&&n.error("Unhandled promise rejection",i)}),t._h=M||N(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},N=function(t){return 1!==t._h&&0===(t._a||t._c).length},j=function(t){g.call(u,function(){var e;M?T.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})})},D=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),R(e,!0))},z=function(t){var e,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw E("Promise can't be resolved itself");(e=C(t))?m(function(){var n={_w:r,_d:!1};try{e.call(t,l(z,n,1),l(D,n,1))}catch(t){D.call(n,t)}}):(r._v=t,r._s=1,R(r,!1))}catch(t){D.call({_w:r,_d:!1},t)}}};L||(S=function(t){d(this,S,"Promise","_h"),p(t),n.call(this);try{t(l(z,this,1),l(D,this,1))}catch(t){D.call(this,t)}},(n=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(133)(S.prototype,{then:function(t,e){var r=I(y(this,S));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=M?T.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&R(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new n;this.promise=t,this.resolve=l(z,t,1),this.reject=l(D,t,1)},_.f=I=function(t){return t===S||t===a?new o(t):i(t)}),h(h.G+h.W+h.F*!L,{Promise:S}),r(26)(S,"Promise"),r(135)("Promise"),a=r(3).Promise,h(h.S+h.F*!L,"Promise",{reject:function(t){var e=I(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(s||!L),"Promise",{resolve:function(t){return w(s&&this===a?S:this,t)}}),h(h.S+h.F*!(L&&r(123)(function(t){S.all(t).catch(O)})),"Promise",{all:function(t){var e=this,r=I(e),n=r.resolve,i=r.reject,o=b(function(){var r=[],o=0,a=1;v(t,!1,function(t){var s=o++,u=!1;r.push(void 0),a++,e.resolve(t).then(function(t){u||(u=!0,r[s]=t,--a||n(r))},i)}),--a||n(r)});return o.e&&i(o.v),r.promise},race:function(t){var e=this,r=I(e),n=r.reject,i=b(function(){v(t,!1,function(t){e.resolve(t).then(r.resolve,n)})});return i.e&&n(i.v),r.promise}})},function(t,e,r){"use strict";var n=r(136)(!0);r(49)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=n(e,r),this._i+=t.length,{value:t,done:!1})})},function(t,e,r){"use strict";var n=r(6),i=r(3),o=r(1),a=r(55),s=r(52);n(n.P+n.R,"Promise",{finally:function(t){var e=a(this,i.Promise||o.Promise),r="function"==typeof t;return this.then(r?function(r){return s(e,t()).then(function(){return r})}:t,r?function(r){return s(e,t()).then(function(){throw r})}:t)}})},function(t,e,r){"use strict";var n=r(6),i=r(25),o=r(51);n(n.S,"Promise",{try:function(t){var e=i.f(this),r=o(t);return(r.e?e.reject:e.resolve)(r.v),e.promise}})},function(t,e,r){r(141);for(var n=r(1),i=r(7),o=r(10),a=r(2)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var l=s[u],c=n[l],h=c&&c.prototype;h&&!h[a]&&i(h,a,l),o[l]=o.Array}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=r(60),a=(n=o)&&n.__esModule?n:{default:n},s=r(151);var u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.processing=!1,this.successful=!1,this.withData(e).withOptions(r).withErrors({})}return i(t,[{key:"withData",value:function(t){for(var e in(0,s.isArray)(t)&&(t=t.reduce(function(t,e){return t[e]="",t},{})),this.setInitialValues(t),this.errors=new a.default,this.processing=!1,this.successful=!1,t)(0,s.guardAgainstReservedFieldName)(e),this[e]=t[e];return this}},{key:"withErrors",value:function(t){return this.errors=new a.default(t),this}},{key:"withOptions",value:function(t){if(this.__options={resetOnSuccess:!0},t.hasOwnProperty("resetOnSuccess")&&(this.__options.resetOnSuccess=t.resetOnSuccess),t.hasOwnProperty("onSuccess")&&(this.onSuccess=t.onSuccess),t.hasOwnProperty("onFail")&&(this.onFail=t.onFail),this.__http=t.http||window.axios||r(90),!this.__http)throw new Error("No http library provided. Either pass an http option, or install axios.");return this}},{key:"data",value:function(){var t={};for(var e in this.initial)t[e]=this[e];return t}},{key:"only",value:function(t){var e=this;return t.reduce(function(t,r){return t[r]=e[r],t},{})}},{key:"reset",value:function(){(0,s.merge)(this,this.initial),this.errors.clear()}},{key:"setInitialValues",value:function(t){this.initial={},(0,s.merge)(this.initial,t)}},{key:"populate",value:function(t){var e=this;return Object.keys(t).forEach(function(r){var n,i,o;(0,s.guardAgainstReservedFieldName)(r),e.hasOwnProperty(r)&&(0,s.merge)(e,(n={},i=r,o=t[r],i in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,n))}),this}},{key:"clear",value:function(){for(var t in this.initial)this[t]="";this.errors.clear()}},{key:"post",value:function(t){return this.submit("post",t)}},{key:"put",value:function(t){return this.submit("put",t)}},{key:"patch",value:function(t){return this.submit("patch",t)}},{key:"delete",value:function(t){return this.submit("delete",t)}},{key:"submit",value:function(t,e){var r=this;return this.__validateRequestType(t),this.errors.clear(),this.processing=!0,this.successful=!1,new Promise(function(n,i){r.__http[t](e,r.hasFiles()?(0,s.objectToFormData)(r.data()):r.data()).then(function(t){r.processing=!1,r.onSuccess(t.data),n(t.data)}).catch(function(t){r.processing=!1,r.onFail(t),i(t)})})}},{key:"hasFiles",value:function(){for(var t in this.initial)if(this[t]instanceof File||this[t]instanceof FileList)return!0;return!1}},{key:"onSuccess",value:function(t){this.successful=!0,this.__options.resetOnSuccess&&this.reset()}},{key:"onFail",value:function(t){this.successful=!1,t.response&&t.response.data.errors&&this.errors.record(t.response.data.errors)}},{key:"hasError",value:function(t){return this.errors.has(t)}},{key:"getError",value:function(t){return this.errors.first(t)}},{key:"getErrors",value:function(t){return this.errors.get(t)}},{key:"__validateRequestType",value:function(t){var e=["get","delete","head","post","put","patch"];if(-1===e.indexOf(t))throw new Error("`"+t+"` is not a valid request type, must be one of: `"+e.join("`, `")+"`.")}}],[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(new t).withData(e)}}]),t}();e.default=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},e.guardAgainstReservedFieldName=function(t){if(-1!==i.indexOf(t))throw new Error("Field name "+t+" isn't allowed to be used in a Form or Errors instance.")},e.merge=function(t,e){for(var r in e)t[r]=o(e[r])},e.cloneDeep=o,e.objectToFormData=a;var i=e.reservedFieldNames=["__http","__options","__validateRequestType","clear","data","delete","errors","getError","getErrors","hasError","initial","onFail","only","onSuccess","patch","populate","post","processing","successful","put","reset","submit","withData","withErrors","withOptions"];function o(t){if(null===t)return null;if(Array.isArray(t))return[].concat(function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}(t));if("object"===(void 0===t?"undefined":n(t))){var e={};for(var r in t)e[r]=o(t[r]);return e}return t}function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new FormData,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(var n in t)u(e,s(r,n),t[n]);return e}function s(t,e){return t?t+"["+e+"]":e}function u(t,e,r){return r instanceof Date?t.append(e,r.toISOString()):r instanceof File?t.append(e,r,r.name):"object"!==(void 0===r?"undefined":n(r))?t.append(e,r):void a(r,t,e)}},function(t,e){function r(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}t.exports=function(t){return null!=t&&(r(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&r(t.slice(0,0))}(t)||!!t._isBuffer)}},function(t,e){t.exports=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}},function(t,e,r){var n=r(164),i=r(189),o=r(31),a=r(190),s=r(63),u=r(192),l=Object.prototype.hasOwnProperty;t.exports=function(t,e){var r=o(t),c=!r&&i(t),h=!r&&!c&&a(t),f=!r&&!c&&!h&&u(t),p=r||c||h||f,d=p?n(t.length,String):[],v=d.length;for(var y in t)!e&&!l.call(t,y)||p&&("length"==y||h&&("offset"==y||"parent"==y)||f&&("buffer"==y||"byteLength"==y||"byteOffset"==y)||s(y,v))||d.push(y);return d}},function(t,e){t.exports=function(t,e){for(var r=-1,n=null==t?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}},function(t,e){t.exports=function(t){return t.split("")}},function(t,e,r){var n=r(12),i=r(13),o="[object Arguments]";t.exports=function(t){return i(t)&&n(t)==o}},function(t,e,r){var n=r(67),i=r(175),o=r(8),a=r(184),s=/^\[object .+?Constructor\]$/,u=Function.prototype,l=Object.prototype,c=u.toString,h=l.hasOwnProperty,f=RegExp("^"+c.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!o(t)||i(t))&&(n(t)?f:s).test(a(t))}},function(t,e,r){var n=r(12),i=r(68),o=r(13),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return o(t)&&i(t.length)&&!!a[n(t)]}},function(t,e,r){var n=r(8),i=r(176),o=r(177),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!n(t))return o(t);var e=i(t),r=[];for(var s in t)("constructor"!=s||!e&&a.call(t,s))&&r.push(s);return r}},function(t,e,r){var n=r(65),i=r(180),o=r(181);t.exports=function(t,e){return o(i(t,e,n),t+"")}},function(t,e,r){var n=r(186),i=r(170),o=r(65),a=i?function(t,e){return i(t,"toString",{configurable:!0,enumerable:!1,value:n(e),writable:!0})}:o;t.exports=a},function(t,e){t.exports=function(t,e,r){var n=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(r=r>i?i:r)<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var o=Array(i);++n<i;)o[n]=t[n+e];return o}},function(t,e){t.exports=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}},function(t,e,r){var n=r(30),i=r(155),o=r(31),a=r(69),s=1/0,u=n?n.prototype:void 0,l=u?u.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(o(e))return i(e,t)+"";if(a(e))return l?l.call(e):"";var r=e+"";return"0"==r&&1/e==-s?"-0":r}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,r){var n=r(163);t.exports=function(t,e,r){var i=t.length;return r=void 0===r?i:r,!e&&r>=i?t:n(t,e,r)}},function(t,e,r){var n=r(18)["__core-js_shared__"];t.exports=n},function(t,e,r){var n=r(167),i=r(62),o=r(183),a=r(198);t.exports=function(t){return function(e){e=a(e);var r=i(e)?o(e):void 0,s=r?r[0]:e.charAt(0),u=r?n(r,1).join(""):e.slice(1);return s[t]()+u}}},function(t,e,r){var n=r(171),i=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=i},function(t,e,r){var n=r(158),i=r(173);t.exports=function(t,e){var r=i(t,e);return n(r)?r:void 0}},function(t,e,r){var n=r(30),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=n?n.toStringTag:void 0;t.exports=function(t){var e=o.call(t,s),r=t[s];try{t[s]=void 0;var n=!0}catch(t){}var i=a.call(t);return n&&(e?t[s]=r:delete t[s]),i}},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,r){var n=r(64),i=r(66),o=r(63),a=r(8);t.exports=function(t,e,r){if(!a(r))return!1;var s=typeof e;return!!("number"==s?i(r)&&o(e,r.length):"string"==s&&e in r)&&n(r[e],t)}},function(t,e,r){var n,i=r(168),o=(n=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";t.exports=function(t){return!!o&&o in t}},function(t,e){var r=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||r)}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}},function(t,e,r){(function(t){var n=r(61),i="object"==typeof e&&e&&!e.nodeType&&e,o=i&&"object"==typeof t&&t&&!t.nodeType&&t,a=o&&o.exports===i&&n.process,s=function(){try{var t=o&&o.require&&o.require("util").types;return t||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=s}).call(e,r(32)(t))},function(t,e){var r=Object.prototype.toString;t.exports=function(t){return r.call(t)}},function(t,e,r){var n=r(153),i=Math.max;t.exports=function(t,e,r){return e=i(void 0===e?t.length-1:e,0),function(){for(var o=arguments,a=-1,s=i(o.length-e,0),u=Array(s);++a<s;)u[a]=o[e+a];a=-1;for(var l=Array(e+1);++a<e;)l[a]=o[a];return l[e]=r(u),n(t,this,l)}}},function(t,e,r){var n=r(162),i=r(182)(n);t.exports=i},function(t,e){var r=800,n=16,i=Date.now;t.exports=function(t){var e=0,o=0;return function(){var a=i(),s=n-(a-o);if(o=a,s>0){if(++e>=r)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,r){var n=r(156),i=r(62),o=r(185);t.exports=function(t){return i(t)?o(t):n(t)}},function(t,e){var r=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return r.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e){var r="[\\ud800-\\udfff]",n="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",o="[^\\ud800-\\udfff]",a="(?:\\ud83c[\\udde6-\\uddff]){2}",s="[\\ud800-\\udbff][\\udc00-\\udfff]",u="(?:"+n+"|"+i+")"+"?",l="[\\ufe0e\\ufe0f]?"+u+("(?:\\u200d(?:"+[o,a,s].join("|")+")[\\ufe0e\\ufe0f]?"+u+")*"),c="(?:"+[o+n+"?",n,a,s,r].join("|")+")",h=RegExp(i+"(?="+i+")|"+c+l,"g");t.exports=function(t){return t.match(h)||[]}},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e,r){var n=r(8),i=r(195),o=r(197),a="Expected a function",s=Math.max,u=Math.min;t.exports=function(t,e,r){var l,c,h,f,p,d,v=0,y=!1,g=!1,m=!0;if("function"!=typeof t)throw new TypeError(a);function _(e){var r=l,n=c;return l=c=void 0,v=e,f=t.apply(n,r)}function b(t){var r=t-d;return void 0===d||r>=e||r<0||g&&t-v>=h}function x(){var t=i();if(b(t))return w(t);p=setTimeout(x,function(t){var r=e-(t-d);return g?u(r,h-(t-v)):r}(t))}function w(t){return p=void 0,m&&l?_(t):(l=c=void 0,f)}function E(){var t=i(),r=b(t);if(l=arguments,c=this,d=t,r){if(void 0===p)return function(t){return v=t,p=setTimeout(x,e),y?_(t):f}(d);if(g)return clearTimeout(p),p=setTimeout(x,e),_(d)}return void 0===p&&(p=setTimeout(x,e)),f}return e=o(e)||0,n(r)&&(y=!!r.leading,h=(g="maxWait"in r)?s(o(r.maxWait)||0,e):h,m="trailing"in r?!!r.trailing:m),E.cancel=function(){void 0!==p&&clearTimeout(p),v=0,l=d=c=p=void 0},E.flush=function(){return void 0===p?f:w(i())},E}},function(t,e,r){var n=r(161),i=r(64),o=r(174),a=r(193),s=Object.prototype,u=s.hasOwnProperty,l=n(function(t,e){t=Object(t);var r=-1,n=e.length,l=n>2?e[2]:void 0;for(l&&o(e[0],e[1],l)&&(n=1);++r<n;)for(var c=e[r],h=a(c),f=-1,p=h.length;++f<p;){var d=h[f],v=t[d];(void 0===v||i(v,s[d])&&!u.call(t,d))&&(t[d]=c[d])}return t});t.exports=l},function(t,e,r){var n=r(157),i=r(13),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,u=n(function(){return arguments}())?n:function(t){return i(t)&&a.call(t,"callee")&&!s.call(t,"callee")};t.exports=u},function(t,e,r){(function(t){var n=r(18),i=r(196),o="object"==typeof e&&e&&!e.nodeType&&e,a=o&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===o?n.Buffer:void 0,u=(s?s.isBuffer:void 0)||i;t.exports=u}).call(e,r(32)(t))},function(t,e,r){var n=r(12),i=r(31),o=r(13),a="[object String]";t.exports=function(t){return"string"==typeof t||!i(t)&&o(t)&&n(t)==a}},function(t,e,r){var n=r(159),i=r(166),o=r(178),a=o&&o.isTypedArray,s=a?i(a):n;t.exports=s},function(t,e,r){var n=r(154),i=r(160),o=r(66);t.exports=function(t){return o(t)?n(t,!0):i(t)}},function(t,e,r){(function(t,n){var i;(function(){var o,a=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",l="__lodash_hash_undefined__",c=500,h="__lodash_placeholder__",f=1,p=2,d=4,v=1,y=2,g=1,m=2,_=4,b=8,x=16,w=32,E=64,T=128,A=256,k=512,S=30,M="...",O=800,I=16,L=1,C=2,R=1/0,P=9007199254740991,N=1.7976931348623157e308,j=NaN,D=4294967295,z=D-1,H=D>>>1,F=[["ary",T],["bind",g],["bindKey",m],["curry",b],["curryRight",x],["flip",k],["partial",w],["partialRight",E],["rearg",A]],B="[object Arguments]",U="[object Array]",G="[object AsyncFunction]",q="[object Boolean]",V="[object Date]",W="[object DOMException]",Y="[object Error]",K="[object Function]",X="[object GeneratorFunction]",Z="[object Map]",$="[object Number]",J="[object Null]",Q="[object Object]",tt="[object Proxy]",et="[object RegExp]",rt="[object Set]",nt="[object String]",it="[object Symbol]",ot="[object Undefined]",at="[object WeakMap]",st="[object WeakSet]",ut="[object ArrayBuffer]",lt="[object DataView]",ct="[object Float32Array]",ht="[object Float64Array]",ft="[object Int8Array]",pt="[object Int16Array]",dt="[object Int32Array]",vt="[object Uint8Array]",yt="[object Uint8ClampedArray]",gt="[object Uint16Array]",mt="[object Uint32Array]",_t=/\b__p \+= '';/g,bt=/\b(__p \+=) '' \+/g,xt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,wt=/&(?:amp|lt|gt|quot|#39);/g,Et=/[&<>"']/g,Tt=RegExp(wt.source),At=RegExp(Et.source),kt=/<%-([\s\S]+?)%>/g,St=/<%([\s\S]+?)%>/g,Mt=/<%=([\s\S]+?)%>/g,Ot=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,It=/^\w*$/,Lt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ct=/[\\^$.*+?()[\]{}|]/g,Rt=RegExp(Ct.source),Pt=/^\s+|\s+$/g,Nt=/^\s+/,jt=/\s+$/,Dt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,zt=/\{\n\/\* \[wrapped with (.+)\] \*/,Ht=/,? & /,Ft=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Bt=/\\(\\)?/g,Ut=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Gt=/\w*$/,qt=/^[-+]0x[0-9a-f]+$/i,Vt=/^0b[01]+$/i,Wt=/^\[object .+?Constructor\]$/,Yt=/^0o[0-7]+$/i,Kt=/^(?:0|[1-9]\d*)$/,Xt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Zt=/($^)/,$t=/['\n\r\u2028\u2029\\]/g,Jt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Qt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",te="[\\ud800-\\udfff]",ee="["+Qt+"]",re="["+Jt+"]",ne="\\d+",ie="[\\u2700-\\u27bf]",oe="[a-z\\xdf-\\xf6\\xf8-\\xff]",ae="[^\\ud800-\\udfff"+Qt+ne+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",se="\\ud83c[\\udffb-\\udfff]",ue="[^\\ud800-\\udfff]",le="(?:\\ud83c[\\udde6-\\uddff]){2}",ce="[\\ud800-\\udbff][\\udc00-\\udfff]",he="[A-Z\\xc0-\\xd6\\xd8-\\xde]",fe="(?:"+oe+"|"+ae+")",pe="(?:"+he+"|"+ae+")",de="(?:"+re+"|"+se+")"+"?",ve="[\\ufe0e\\ufe0f]?"+de+("(?:\\u200d(?:"+[ue,le,ce].join("|")+")[\\ufe0e\\ufe0f]?"+de+")*"),ye="(?:"+[ie,le,ce].join("|")+")"+ve,ge="(?:"+[ue+re+"?",re,le,ce,te].join("|")+")",me=RegExp("['’]","g"),_e=RegExp(re,"g"),be=RegExp(se+"(?="+se+")|"+ge+ve,"g"),xe=RegExp([he+"?"+oe+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[ee,he,"$"].join("|")+")",pe+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[ee,he+fe,"$"].join("|")+")",he+"?"+fe+"+(?:['’](?:d|ll|m|re|s|t|ve))?",he+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ne,ye].join("|"),"g"),we=RegExp("[\\u200d\\ud800-\\udfff"+Jt+"\\ufe0e\\ufe0f]"),Ee=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Te=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ae=-1,ke={};ke[ct]=ke[ht]=ke[ft]=ke[pt]=ke[dt]=ke[vt]=ke[yt]=ke[gt]=ke[mt]=!0,ke[B]=ke[U]=ke[ut]=ke[q]=ke[lt]=ke[V]=ke[Y]=ke[K]=ke[Z]=ke[$]=ke[Q]=ke[et]=ke[rt]=ke[nt]=ke[at]=!1;var Se={};Se[B]=Se[U]=Se[ut]=Se[lt]=Se[q]=Se[V]=Se[ct]=Se[ht]=Se[ft]=Se[pt]=Se[dt]=Se[Z]=Se[$]=Se[Q]=Se[et]=Se[rt]=Se[nt]=Se[it]=Se[vt]=Se[yt]=Se[gt]=Se[mt]=!0,Se[Y]=Se[K]=Se[at]=!1;var Me={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Oe=parseFloat,Ie=parseInt,Le="object"==typeof t&&t&&t.Object===Object&&t,Ce="object"==typeof self&&self&&self.Object===Object&&self,Re=Le||Ce||Function("return this")(),Pe="object"==typeof e&&e&&!e.nodeType&&e,Ne=Pe&&"object"==typeof n&&n&&!n.nodeType&&n,je=Ne&&Ne.exports===Pe,De=je&&Le.process,ze=function(){try{var t=Ne&&Ne.require&&Ne.require("util").types;return t||De&&De.binding&&De.binding("util")}catch(t){}}(),He=ze&&ze.isArrayBuffer,Fe=ze&&ze.isDate,Be=ze&&ze.isMap,Ue=ze&&ze.isRegExp,Ge=ze&&ze.isSet,qe=ze&&ze.isTypedArray;function Ve(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function We(t,e,r,n){for(var i=-1,o=null==t?0:t.length;++i<o;){var a=t[i];e(n,a,r(a),t)}return n}function Ye(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}function Ke(t,e){for(var r=null==t?0:t.length;r--&&!1!==e(t[r],r,t););return t}function Xe(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(!e(t[r],r,t))return!1;return!0}function Ze(t,e){for(var r=-1,n=null==t?0:t.length,i=0,o=[];++r<n;){var a=t[r];e(a,r,t)&&(o[i++]=a)}return o}function $e(t,e){return!!(null==t?0:t.length)&&sr(t,e,0)>-1}function Je(t,e,r){for(var n=-1,i=null==t?0:t.length;++n<i;)if(r(e,t[n]))return!0;return!1}function Qe(t,e){for(var r=-1,n=null==t?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}function tr(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}function er(t,e,r,n){var i=-1,o=null==t?0:t.length;for(n&&o&&(r=t[++i]);++i<o;)r=e(r,t[i],i,t);return r}function rr(t,e,r,n){var i=null==t?0:t.length;for(n&&i&&(r=t[--i]);i--;)r=e(r,t[i],i,t);return r}function nr(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}var ir=hr("length");function or(t,e,r){var n;return r(t,function(t,r,i){if(e(t,r,i))return n=r,!1}),n}function ar(t,e,r,n){for(var i=t.length,o=r+(n?1:-1);n?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function sr(t,e,r){return e==e?function(t,e,r){var n=r-1,i=t.length;for(;++n<i;)if(t[n]===e)return n;return-1}(t,e,r):ar(t,lr,r)}function ur(t,e,r,n){for(var i=r-1,o=t.length;++i<o;)if(n(t[i],e))return i;return-1}function lr(t){return t!=t}function cr(t,e){var r=null==t?0:t.length;return r?dr(t,e)/r:j}function hr(t){return function(e){return null==e?o:e[t]}}function fr(t){return function(e){return null==t?o:t[e]}}function pr(t,e,r,n,i){return i(t,function(t,i,o){r=n?(n=!1,t):e(r,t,i,o)}),r}function dr(t,e){for(var r,n=-1,i=t.length;++n<i;){var a=e(t[n]);a!==o&&(r=r===o?a:r+a)}return r}function vr(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}function yr(t){return function(e){return t(e)}}function gr(t,e){return Qe(e,function(e){return t[e]})}function mr(t,e){return t.has(e)}function _r(t,e){for(var r=-1,n=t.length;++r<n&&sr(e,t[r],0)>-1;);return r}function br(t,e){for(var r=t.length;r--&&sr(e,t[r],0)>-1;);return r}var xr=fr({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),wr=fr({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Er(t){return"\\"+Me[t]}function Tr(t){return we.test(t)}function Ar(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function kr(t,e){return function(r){return t(e(r))}}function Sr(t,e){for(var r=-1,n=t.length,i=0,o=[];++r<n;){var a=t[r];a!==e&&a!==h||(t[r]=h,o[i++]=r)}return o}function Mr(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}function Or(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=[t,t]}),r}function Ir(t){return Tr(t)?function(t){var e=be.lastIndex=0;for(;be.test(t);)++e;return e}(t):ir(t)}function Lr(t){return Tr(t)?function(t){return t.match(be)||[]}(t):function(t){return t.split("")}(t)}var Cr=fr({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Rr=function t(e){var r,n=(e=null==e?Re:Rr.defaults(Re.Object(),e,Rr.pick(Re,Te))).Array,i=e.Date,Jt=e.Error,Qt=e.Function,te=e.Math,ee=e.Object,re=e.RegExp,ne=e.String,ie=e.TypeError,oe=n.prototype,ae=Qt.prototype,se=ee.prototype,ue=e["__core-js_shared__"],le=ae.toString,ce=se.hasOwnProperty,he=0,fe=(r=/[^.]+$/.exec(ue&&ue.keys&&ue.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",pe=se.toString,de=le.call(ee),ve=Re._,ye=re("^"+le.call(ce).replace(Ct,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ge=je?e.Buffer:o,be=e.Symbol,we=e.Uint8Array,Me=ge?ge.allocUnsafe:o,Le=kr(ee.getPrototypeOf,ee),Ce=ee.create,Pe=se.propertyIsEnumerable,Ne=oe.splice,De=be?be.isConcatSpreadable:o,ze=be?be.iterator:o,ir=be?be.toStringTag:o,fr=function(){try{var t=Ho(ee,"defineProperty");return t({},"",{}),t}catch(t){}}(),Pr=e.clearTimeout!==Re.clearTimeout&&e.clearTimeout,Nr=i&&i.now!==Re.Date.now&&i.now,jr=e.setTimeout!==Re.setTimeout&&e.setTimeout,Dr=te.ceil,zr=te.floor,Hr=ee.getOwnPropertySymbols,Fr=ge?ge.isBuffer:o,Br=e.isFinite,Ur=oe.join,Gr=kr(ee.keys,ee),qr=te.max,Vr=te.min,Wr=i.now,Yr=e.parseInt,Kr=te.random,Xr=oe.reverse,Zr=Ho(e,"DataView"),$r=Ho(e,"Map"),Jr=Ho(e,"Promise"),Qr=Ho(e,"Set"),tn=Ho(e,"WeakMap"),en=Ho(ee,"create"),rn=tn&&new tn,nn={},on=ha(Zr),an=ha($r),sn=ha(Jr),un=ha(Qr),ln=ha(tn),cn=be?be.prototype:o,hn=cn?cn.valueOf:o,fn=cn?cn.toString:o;function pn(t){if(Ms(t)&&!gs(t)&&!(t instanceof gn)){if(t instanceof yn)return t;if(ce.call(t,"__wrapped__"))return fa(t)}return new yn(t)}var dn=function(){function t(){}return function(e){if(!Ss(e))return{};if(Ce)return Ce(e);t.prototype=e;var r=new t;return t.prototype=o,r}}();function vn(){}function yn(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=o}function gn(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=D,this.__views__=[]}function mn(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function _n(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function bn(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function xn(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new bn;++e<r;)this.add(t[e])}function wn(t){var e=this.__data__=new _n(t);this.size=e.size}function En(t,e){var r=gs(t),n=!r&&ys(t),i=!r&&!n&&xs(t),o=!r&&!n&&!i&&js(t),a=r||n||i||o,s=a?vr(t.length,ne):[],u=s.length;for(var l in t)!e&&!ce.call(t,l)||a&&("length"==l||i&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Wo(l,u))||s.push(l);return s}function Tn(t){var e=t.length;return e?t[xi(0,e-1)]:o}function An(t,e){return ua(ro(t),Pn(e,0,t.length))}function kn(t){return ua(ro(t))}function Sn(t,e,r){(r===o||ps(t[e],r))&&(r!==o||e in t)||Cn(t,e,r)}function Mn(t,e,r){var n=t[e];ce.call(t,e)&&ps(n,r)&&(r!==o||e in t)||Cn(t,e,r)}function On(t,e){for(var r=t.length;r--;)if(ps(t[r][0],e))return r;return-1}function In(t,e,r,n){return Hn(t,function(t,i,o){e(n,t,r(t),o)}),n}function Ln(t,e){return t&&no(e,iu(e),t)}function Cn(t,e,r){"__proto__"==e&&fr?fr(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function Rn(t,e){for(var r=-1,i=e.length,a=n(i),s=null==t;++r<i;)a[r]=s?o:Qs(t,e[r]);return a}function Pn(t,e,r){return t==t&&(r!==o&&(t=t<=r?t:r),e!==o&&(t=t>=e?t:e)),t}function Nn(t,e,r,n,i,a){var s,u=e&f,l=e&p,c=e&d;if(r&&(s=i?r(t,n,i,a):r(t)),s!==o)return s;if(!Ss(t))return t;var h=gs(t);if(h){if(s=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&ce.call(t,"index")&&(r.index=t.index,r.input=t.input),r}(t),!u)return ro(t,s)}else{var v=Uo(t),y=v==K||v==X;if(xs(t))return Zi(t,u);if(v==Q||v==B||y&&!i){if(s=l||y?{}:qo(t),!u)return l?function(t,e){return no(t,Bo(t),e)}(t,function(t,e){return t&&no(e,ou(e),t)}(s,t)):function(t,e){return no(t,Fo(t),e)}(t,Ln(s,t))}else{if(!Se[v])return i?t:{};s=function(t,e,r){var n,i,o,a=t.constructor;switch(e){case ut:return $i(t);case q:case V:return new a(+t);case lt:return function(t,e){var r=e?$i(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,r);case ct:case ht:case ft:case pt:case dt:case vt:case yt:case gt:case mt:return Ji(t,r);case Z:return new a;case $:case nt:return new a(t);case et:return(o=new(i=t).constructor(i.source,Gt.exec(i))).lastIndex=i.lastIndex,o;case rt:return new a;case it:return n=t,hn?ee(hn.call(n)):{}}}(t,v,u)}}a||(a=new wn);var g=a.get(t);if(g)return g;a.set(t,s),Rs(t)?t.forEach(function(n){s.add(Nn(n,e,r,n,t,a))}):Os(t)&&t.forEach(function(n,i){s.set(i,Nn(n,e,r,i,t,a))});var m=h?o:(c?l?Co:Lo:l?ou:iu)(t);return Ye(m||t,function(n,i){m&&(n=t[i=n]),Mn(s,i,Nn(n,e,r,i,t,a))}),s}function jn(t,e,r){var n=r.length;if(null==t)return!n;for(t=ee(t);n--;){var i=r[n],a=e[i],s=t[i];if(s===o&&!(i in t)||!a(s))return!1}return!0}function Dn(t,e,r){if("function"!=typeof t)throw new ie(u);return ia(function(){t.apply(o,r)},e)}function zn(t,e,r,n){var i=-1,o=$e,s=!0,u=t.length,l=[],c=e.length;if(!u)return l;r&&(e=Qe(e,yr(r))),n?(o=Je,s=!1):e.length>=a&&(o=mr,s=!1,e=new xn(e));t:for(;++i<u;){var h=t[i],f=null==r?h:r(h);if(h=n||0!==h?h:0,s&&f==f){for(var p=c;p--;)if(e[p]===f)continue t;l.push(h)}else o(e,f,n)||l.push(h)}return l}pn.templateSettings={escape:kt,evaluate:St,interpolate:Mt,variable:"",imports:{_:pn}},pn.prototype=vn.prototype,pn.prototype.constructor=pn,yn.prototype=dn(vn.prototype),yn.prototype.constructor=yn,gn.prototype=dn(vn.prototype),gn.prototype.constructor=gn,mn.prototype.clear=function(){this.__data__=en?en(null):{},this.size=0},mn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},mn.prototype.get=function(t){var e=this.__data__;if(en){var r=e[t];return r===l?o:r}return ce.call(e,t)?e[t]:o},mn.prototype.has=function(t){var e=this.__data__;return en?e[t]!==o:ce.call(e,t)},mn.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=en&&e===o?l:e,this},_n.prototype.clear=function(){this.__data__=[],this.size=0},_n.prototype.delete=function(t){var e=this.__data__,r=On(e,t);return!(r<0||(r==e.length-1?e.pop():Ne.call(e,r,1),--this.size,0))},_n.prototype.get=function(t){var e=this.__data__,r=On(e,t);return r<0?o:e[r][1]},_n.prototype.has=function(t){return On(this.__data__,t)>-1},_n.prototype.set=function(t,e){var r=this.__data__,n=On(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this},bn.prototype.clear=function(){this.size=0,this.__data__={hash:new mn,map:new($r||_n),string:new mn}},bn.prototype.delete=function(t){var e=Do(this,t).delete(t);return this.size-=e?1:0,e},bn.prototype.get=function(t){return Do(this,t).get(t)},bn.prototype.has=function(t){return Do(this,t).has(t)},bn.prototype.set=function(t,e){var r=Do(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this},xn.prototype.add=xn.prototype.push=function(t){return this.__data__.set(t,l),this},xn.prototype.has=function(t){return this.__data__.has(t)},wn.prototype.clear=function(){this.__data__=new _n,this.size=0},wn.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},wn.prototype.get=function(t){return this.__data__.get(t)},wn.prototype.has=function(t){return this.__data__.has(t)},wn.prototype.set=function(t,e){var r=this.__data__;if(r instanceof _n){var n=r.__data__;if(!$r||n.length<a-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new bn(n)}return r.set(t,e),this.size=r.size,this};var Hn=ao(Yn),Fn=ao(Kn,!0);function Bn(t,e){var r=!0;return Hn(t,function(t,n,i){return r=!!e(t,n,i)}),r}function Un(t,e,r){for(var n=-1,i=t.length;++n<i;){var a=t[n],s=e(a);if(null!=s&&(u===o?s==s&&!Ns(s):r(s,u)))var u=s,l=a}return l}function Gn(t,e){var r=[];return Hn(t,function(t,n,i){e(t,n,i)&&r.push(t)}),r}function qn(t,e,r,n,i){var o=-1,a=t.length;for(r||(r=Vo),i||(i=[]);++o<a;){var s=t[o];e>0&&r(s)?e>1?qn(s,e-1,r,n,i):tr(i,s):n||(i[i.length]=s)}return i}var Vn=so(),Wn=so(!0);function Yn(t,e){return t&&Vn(t,e,iu)}function Kn(t,e){return t&&Wn(t,e,iu)}function Xn(t,e){return Ze(e,function(e){return Ts(t[e])})}function Zn(t,e){for(var r=0,n=(e=Wi(e,t)).length;null!=t&&r<n;)t=t[ca(e[r++])];return r&&r==n?t:o}function $n(t,e,r){var n=e(t);return gs(t)?n:tr(n,r(t))}function Jn(t){return null==t?t===o?ot:J:ir&&ir in ee(t)?function(t){var e=ce.call(t,ir),r=t[ir];try{t[ir]=o;var n=!0}catch(t){}var i=pe.call(t);return n&&(e?t[ir]=r:delete t[ir]),i}(t):function(t){return pe.call(t)}(t)}function Qn(t,e){return t>e}function ti(t,e){return null!=t&&ce.call(t,e)}function ei(t,e){return null!=t&&e in ee(t)}function ri(t,e,r){for(var i=r?Je:$e,a=t[0].length,s=t.length,u=s,l=n(s),c=1/0,h=[];u--;){var f=t[u];u&&e&&(f=Qe(f,yr(e))),c=Vr(f.length,c),l[u]=!r&&(e||a>=120&&f.length>=120)?new xn(u&&f):o}f=t[0];var p=-1,d=l[0];t:for(;++p<a&&h.length<c;){var v=f[p],y=e?e(v):v;if(v=r||0!==v?v:0,!(d?mr(d,y):i(h,y,r))){for(u=s;--u;){var g=l[u];if(!(g?mr(g,y):i(t[u],y,r)))continue t}d&&d.push(y),h.push(v)}}return h}function ni(t,e,r){var n=null==(t=ea(t,e=Wi(e,t)))?t:t[ca(Ea(e))];return null==n?o:Ve(n,t,r)}function ii(t){return Ms(t)&&Jn(t)==B}function oi(t,e,r,n,i){return t===e||(null==t||null==e||!Ms(t)&&!Ms(e)?t!=t&&e!=e:function(t,e,r,n,i,a){var s=gs(t),u=gs(e),l=s?U:Uo(t),c=u?U:Uo(e),h=(l=l==B?Q:l)==Q,f=(c=c==B?Q:c)==Q,p=l==c;if(p&&xs(t)){if(!xs(e))return!1;s=!0,h=!1}if(p&&!h)return a||(a=new wn),s||js(t)?Oo(t,e,r,n,i,a):function(t,e,r,n,i,o,a){switch(r){case lt:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case ut:return!(t.byteLength!=e.byteLength||!o(new we(t),new we(e)));case q:case V:case $:return ps(+t,+e);case Y:return t.name==e.name&&t.message==e.message;case et:case nt:return t==e+"";case Z:var s=Ar;case rt:var u=n&v;if(s||(s=Mr),t.size!=e.size&&!u)return!1;var l=a.get(t);if(l)return l==e;n|=y,a.set(t,e);var c=Oo(s(t),s(e),n,i,o,a);return a.delete(t),c;case it:if(hn)return hn.call(t)==hn.call(e)}return!1}(t,e,l,r,n,i,a);if(!(r&v)){var d=h&&ce.call(t,"__wrapped__"),g=f&&ce.call(e,"__wrapped__");if(d||g){var m=d?t.value():t,_=g?e.value():e;return a||(a=new wn),i(m,_,r,n,a)}}return!!p&&(a||(a=new wn),function(t,e,r,n,i,a){var s=r&v,u=Lo(t),l=u.length,c=Lo(e).length;if(l!=c&&!s)return!1;for(var h=l;h--;){var f=u[h];if(!(s?f in e:ce.call(e,f)))return!1}var p=a.get(t),d=a.get(e);if(p&&d)return p==e&&d==t;var y=!0;a.set(t,e),a.set(e,t);for(var g=s;++h<l;){f=u[h];var m=t[f],_=e[f];if(n)var b=s?n(_,m,f,e,t,a):n(m,_,f,t,e,a);if(!(b===o?m===_||i(m,_,r,n,a):b)){y=!1;break}g||(g="constructor"==f)}if(y&&!g){var x=t.constructor,w=e.constructor;x!=w&&"constructor"in t&&"constructor"in e&&!("function"==typeof x&&x instanceof x&&"function"==typeof w&&w instanceof w)&&(y=!1)}return a.delete(t),a.delete(e),y}(t,e,r,n,i,a))}(t,e,r,n,oi,i))}function ai(t,e,r,n){var i=r.length,a=i,s=!n;if(null==t)return!a;for(t=ee(t);i--;){var u=r[i];if(s&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++i<a;){var l=(u=r[i])[0],c=t[l],h=u[1];if(s&&u[2]){if(c===o&&!(l in t))return!1}else{var f=new wn;if(n)var p=n(c,h,l,t,e,f);if(!(p===o?oi(h,c,v|y,n,f):p))return!1}}return!0}function si(t){return!(!Ss(t)||fe&&fe in t)&&(Ts(t)?ye:Wt).test(ha(t))}function ui(t){return"function"==typeof t?t:null==t?Iu:"object"==typeof t?gs(t)?di(t[0],t[1]):pi(t):Hu(t)}function li(t){if(!$o(t))return Gr(t);var e=[];for(var r in ee(t))ce.call(t,r)&&"constructor"!=r&&e.push(r);return e}function ci(t){if(!Ss(t))return function(t){var e=[];if(null!=t)for(var r in ee(t))e.push(r);return e}(t);var e=$o(t),r=[];for(var n in t)("constructor"!=n||!e&&ce.call(t,n))&&r.push(n);return r}function hi(t,e){return t<e}function fi(t,e){var r=-1,i=_s(t)?n(t.length):[];return Hn(t,function(t,n,o){i[++r]=e(t,n,o)}),i}function pi(t){var e=zo(t);return 1==e.length&&e[0][2]?Qo(e[0][0],e[0][1]):function(r){return r===t||ai(r,t,e)}}function di(t,e){return Ko(t)&&Jo(e)?Qo(ca(t),e):function(r){var n=Qs(r,t);return n===o&&n===e?tu(r,t):oi(e,n,v|y)}}function vi(t,e,r,n,i){t!==e&&Vn(e,function(a,s){if(i||(i=new wn),Ss(a))!function(t,e,r,n,i,a,s){var u=ra(t,r),l=ra(e,r),c=s.get(l);if(c)Sn(t,r,c);else{var h=a?a(u,l,r+"",t,e,s):o,f=h===o;if(f){var p=gs(l),d=!p&&xs(l),v=!p&&!d&&js(l);h=l,p||d||v?gs(u)?h=u:bs(u)?h=ro(u):d?(f=!1,h=Zi(l,!0)):v?(f=!1,h=Ji(l,!0)):h=[]:Ls(l)||ys(l)?(h=u,ys(u)?h=qs(u):Ss(u)&&!Ts(u)||(h=qo(l))):f=!1}f&&(s.set(l,h),i(h,l,n,a,s),s.delete(l)),Sn(t,r,h)}}(t,e,s,r,vi,n,i);else{var u=n?n(ra(t,s),a,s+"",t,e,i):o;u===o&&(u=a),Sn(t,s,u)}},ou)}function yi(t,e){var r=t.length;if(r)return Wo(e+=e<0?r:0,r)?t[e]:o}function gi(t,e,r){var n=-1;return e=Qe(e=e.length?Qe(e,function(t){return gs(t)?function(e){return Zn(e,1===t.length?t[0]:t)}:t}):[Iu],yr(jo())),function(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}(fi(t,function(t,r,i){return{criteria:Qe(e,function(e){return e(t)}),index:++n,value:t}}),function(t,e){return function(t,e,r){for(var n=-1,i=t.criteria,o=e.criteria,a=i.length,s=r.length;++n<a;){var u=Qi(i[n],o[n]);if(u){if(n>=s)return u;var l=r[n];return u*("desc"==l?-1:1)}}return t.index-e.index}(t,e,r)})}function mi(t,e,r){for(var n=-1,i=e.length,o={};++n<i;){var a=e[n],s=Zn(t,a);r(s,a)&&ki(o,Wi(a,t),s)}return o}function _i(t,e,r,n){var i=n?ur:sr,o=-1,a=e.length,s=t;for(t===e&&(e=ro(e)),r&&(s=Qe(t,yr(r)));++o<a;)for(var u=0,l=e[o],c=r?r(l):l;(u=i(s,c,u,n))>-1;)s!==t&&Ne.call(s,u,1),Ne.call(t,u,1);return t}function bi(t,e){for(var r=t?e.length:0,n=r-1;r--;){var i=e[r];if(r==n||i!==o){var o=i;Wo(i)?Ne.call(t,i,1):zi(t,i)}}return t}function xi(t,e){return t+zr(Kr()*(e-t+1))}function wi(t,e){var r="";if(!t||e<1||e>P)return r;do{e%2&&(r+=t),(e=zr(e/2))&&(t+=t)}while(e);return r}function Ei(t,e){return oa(ta(t,e,Iu),t+"")}function Ti(t){return Tn(pu(t))}function Ai(t,e){var r=pu(t);return ua(r,Pn(e,0,r.length))}function ki(t,e,r,n){if(!Ss(t))return t;for(var i=-1,a=(e=Wi(e,t)).length,s=a-1,u=t;null!=u&&++i<a;){var l=ca(e[i]),c=r;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(i!=s){var h=u[l];(c=n?n(h,l,u):o)===o&&(c=Ss(h)?h:Wo(e[i+1])?[]:{})}Mn(u,l,c),u=u[l]}return t}var Si=rn?function(t,e){return rn.set(t,e),t}:Iu,Mi=fr?function(t,e){return fr(t,"toString",{configurable:!0,enumerable:!1,value:Su(e),writable:!0})}:Iu;function Oi(t){return ua(pu(t))}function Ii(t,e,r){var i=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(r=r>o?o:r)<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;for(var a=n(o);++i<o;)a[i]=t[i+e];return a}function Li(t,e){var r;return Hn(t,function(t,n,i){return!(r=e(t,n,i))}),!!r}function Ci(t,e,r){var n=0,i=null==t?n:t.length;if("number"==typeof e&&e==e&&i<=H){for(;n<i;){var o=n+i>>>1,a=t[o];null!==a&&!Ns(a)&&(r?a<=e:a<e)?n=o+1:i=o}return i}return Ri(t,e,Iu,r)}function Ri(t,e,r,n){var i=0,a=null==t?0:t.length;if(0===a)return 0;for(var s=(e=r(e))!=e,u=null===e,l=Ns(e),c=e===o;i<a;){var h=zr((i+a)/2),f=r(t[h]),p=f!==o,d=null===f,v=f==f,y=Ns(f);if(s)var g=n||v;else g=c?v&&(n||p):u?v&&p&&(n||!d):l?v&&p&&!d&&(n||!y):!d&&!y&&(n?f<=e:f<e);g?i=h+1:a=h}return Vr(a,z)}function Pi(t,e){for(var r=-1,n=t.length,i=0,o=[];++r<n;){var a=t[r],s=e?e(a):a;if(!r||!ps(s,u)){var u=s;o[i++]=0===a?0:a}}return o}function Ni(t){return"number"==typeof t?t:Ns(t)?j:+t}function ji(t){if("string"==typeof t)return t;if(gs(t))return Qe(t,ji)+"";if(Ns(t))return fn?fn.call(t):"";var e=t+"";return"0"==e&&1/t==-R?"-0":e}function Di(t,e,r){var n=-1,i=$e,o=t.length,s=!0,u=[],l=u;if(r)s=!1,i=Je;else if(o>=a){var c=e?null:Eo(t);if(c)return Mr(c);s=!1,i=mr,l=new xn}else l=e?[]:u;t:for(;++n<o;){var h=t[n],f=e?e(h):h;if(h=r||0!==h?h:0,s&&f==f){for(var p=l.length;p--;)if(l[p]===f)continue t;e&&l.push(f),u.push(h)}else i(l,f,r)||(l!==u&&l.push(f),u.push(h))}return u}function zi(t,e){return null==(t=ea(t,e=Wi(e,t)))||delete t[ca(Ea(e))]}function Hi(t,e,r,n){return ki(t,e,r(Zn(t,e)),n)}function Fi(t,e,r,n){for(var i=t.length,o=n?i:-1;(n?o--:++o<i)&&e(t[o],o,t););return r?Ii(t,n?0:o,n?o+1:i):Ii(t,n?o+1:0,n?i:o)}function Bi(t,e){var r=t;return r instanceof gn&&(r=r.value()),er(e,function(t,e){return e.func.apply(e.thisArg,tr([t],e.args))},r)}function Ui(t,e,r){var i=t.length;if(i<2)return i?Di(t[0]):[];for(var o=-1,a=n(i);++o<i;)for(var s=t[o],u=-1;++u<i;)u!=o&&(a[o]=zn(a[o]||s,t[u],e,r));return Di(qn(a,1),e,r)}function Gi(t,e,r){for(var n=-1,i=t.length,a=e.length,s={};++n<i;){var u=n<a?e[n]:o;r(s,t[n],u)}return s}function qi(t){return bs(t)?t:[]}function Vi(t){return"function"==typeof t?t:Iu}function Wi(t,e){return gs(t)?t:Ko(t,e)?[t]:la(Vs(t))}var Yi=Ei;function Ki(t,e,r){var n=t.length;return r=r===o?n:r,!e&&r>=n?t:Ii(t,e,r)}var Xi=Pr||function(t){return Re.clearTimeout(t)};function Zi(t,e){if(e)return t.slice();var r=t.length,n=Me?Me(r):new t.constructor(r);return t.copy(n),n}function $i(t){var e=new t.constructor(t.byteLength);return new we(e).set(new we(t)),e}function Ji(t,e){var r=e?$i(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}function Qi(t,e){if(t!==e){var r=t!==o,n=null===t,i=t==t,a=Ns(t),s=e!==o,u=null===e,l=e==e,c=Ns(e);if(!u&&!c&&!a&&t>e||a&&s&&l&&!u&&!c||n&&s&&l||!r&&l||!i)return 1;if(!n&&!a&&!c&&t<e||c&&r&&i&&!n&&!a||u&&r&&i||!s&&i||!l)return-1}return 0}function to(t,e,r,i){for(var o=-1,a=t.length,s=r.length,u=-1,l=e.length,c=qr(a-s,0),h=n(l+c),f=!i;++u<l;)h[u]=e[u];for(;++o<s;)(f||o<a)&&(h[r[o]]=t[o]);for(;c--;)h[u++]=t[o++];return h}function eo(t,e,r,i){for(var o=-1,a=t.length,s=-1,u=r.length,l=-1,c=e.length,h=qr(a-u,0),f=n(h+c),p=!i;++o<h;)f[o]=t[o];for(var d=o;++l<c;)f[d+l]=e[l];for(;++s<u;)(p||o<a)&&(f[d+r[s]]=t[o++]);return f}function ro(t,e){var r=-1,i=t.length;for(e||(e=n(i));++r<i;)e[r]=t[r];return e}function no(t,e,r,n){var i=!r;r||(r={});for(var a=-1,s=e.length;++a<s;){var u=e[a],l=n?n(r[u],t[u],u,r,t):o;l===o&&(l=t[u]),i?Cn(r,u,l):Mn(r,u,l)}return r}function io(t,e){return function(r,n){var i=gs(r)?We:In,o=e?e():{};return i(r,t,jo(n,2),o)}}function oo(t){return Ei(function(e,r){var n=-1,i=r.length,a=i>1?r[i-1]:o,s=i>2?r[2]:o;for(a=t.length>3&&"function"==typeof a?(i--,a):o,s&&Yo(r[0],r[1],s)&&(a=i<3?o:a,i=1),e=ee(e);++n<i;){var u=r[n];u&&t(e,u,n,a)}return e})}function ao(t,e){return function(r,n){if(null==r)return r;if(!_s(r))return t(r,n);for(var i=r.length,o=e?i:-1,a=ee(r);(e?o--:++o<i)&&!1!==n(a[o],o,a););return r}}function so(t){return function(e,r,n){for(var i=-1,o=ee(e),a=n(e),s=a.length;s--;){var u=a[t?s:++i];if(!1===r(o[u],u,o))break}return e}}function uo(t){return function(e){var r=Tr(e=Vs(e))?Lr(e):o,n=r?r[0]:e.charAt(0),i=r?Ki(r,1).join(""):e.slice(1);return n[t]()+i}}function lo(t){return function(e){return er(Tu(yu(e).replace(me,"")),t,"")}}function co(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=dn(t.prototype),n=t.apply(r,e);return Ss(n)?n:r}}function ho(t){return function(e,r,n){var i=ee(e);if(!_s(e)){var a=jo(r,3);e=iu(e),r=function(t){return a(i[t],t,i)}}var s=t(e,r,n);return s>-1?i[a?e[s]:s]:o}}function fo(t){return Io(function(e){var r=e.length,n=r,i=yn.prototype.thru;for(t&&e.reverse();n--;){var a=e[n];if("function"!=typeof a)throw new ie(u);if(i&&!s&&"wrapper"==Po(a))var s=new yn([],!0)}for(n=s?n:r;++n<r;){var l=Po(a=e[n]),c="wrapper"==l?Ro(a):o;s=c&&Xo(c[0])&&c[1]==(T|b|w|A)&&!c[4].length&&1==c[9]?s[Po(c[0])].apply(s,c[3]):1==a.length&&Xo(a)?s[l]():s.thru(a)}return function(){var t=arguments,n=t[0];if(s&&1==t.length&&gs(n))return s.plant(n).value();for(var i=0,o=r?e[i].apply(this,t):n;++i<r;)o=e[i].call(this,o);return o}})}function po(t,e,r,i,a,s,u,l,c,h){var f=e&T,p=e&g,d=e&m,v=e&(b|x),y=e&k,_=d?o:co(t);return function g(){for(var m=arguments.length,b=n(m),x=m;x--;)b[x]=arguments[x];if(v)var w=No(g),E=function(t,e){for(var r=t.length,n=0;r--;)t[r]===e&&++n;return n}(b,w);if(i&&(b=to(b,i,a,v)),s&&(b=eo(b,s,u,v)),m-=E,v&&m<h){var T=Sr(b,w);return xo(t,e,po,g.placeholder,r,b,T,l,c,h-m)}var A=p?r:this,k=d?A[t]:t;return m=b.length,l?b=function(t,e){for(var r=t.length,n=Vr(e.length,r),i=ro(t);n--;){var a=e[n];t[n]=Wo(a,r)?i[a]:o}return t}(b,l):y&&m>1&&b.reverse(),f&&c<m&&(b.length=c),this&&this!==Re&&this instanceof g&&(k=_||co(k)),k.apply(A,b)}}function vo(t,e){return function(r,n){return function(t,e,r,n){return Yn(t,function(t,i,o){e(n,r(t),i,o)}),n}(r,t,e(n),{})}}function yo(t,e){return function(r,n){var i;if(r===o&&n===o)return e;if(r!==o&&(i=r),n!==o){if(i===o)return n;"string"==typeof r||"string"==typeof n?(r=ji(r),n=ji(n)):(r=Ni(r),n=Ni(n)),i=t(r,n)}return i}}function go(t){return Io(function(e){return e=Qe(e,yr(jo())),Ei(function(r){var n=this;return t(e,function(t){return Ve(t,n,r)})})})}function mo(t,e){var r=(e=e===o?" ":ji(e)).length;if(r<2)return r?wi(e,t):e;var n=wi(e,Dr(t/Ir(e)));return Tr(e)?Ki(Lr(n),0,t).join(""):n.slice(0,t)}function _o(t){return function(e,r,i){return i&&"number"!=typeof i&&Yo(e,r,i)&&(r=i=o),e=Fs(e),r===o?(r=e,e=0):r=Fs(r),function(t,e,r,i){for(var o=-1,a=qr(Dr((e-t)/(r||1)),0),s=n(a);a--;)s[i?a:++o]=t,t+=r;return s}(e,r,i=i===o?e<r?1:-1:Fs(i),t)}}function bo(t){return function(e,r){return"string"==typeof e&&"string"==typeof r||(e=Gs(e),r=Gs(r)),t(e,r)}}function xo(t,e,r,n,i,a,s,u,l,c){var h=e&b;e|=h?w:E,(e&=~(h?E:w))&_||(e&=~(g|m));var f=[t,e,i,h?a:o,h?s:o,h?o:a,h?o:s,u,l,c],p=r.apply(o,f);return Xo(t)&&na(p,f),p.placeholder=n,aa(p,t,e)}function wo(t){var e=te[t];return function(t,r){if(t=Gs(t),(r=null==r?0:Vr(Bs(r),292))&&Br(t)){var n=(Vs(t)+"e").split("e");return+((n=(Vs(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}var Eo=Qr&&1/Mr(new Qr([,-0]))[1]==R?function(t){return new Qr(t)}:Nu;function To(t){return function(e){var r=Uo(e);return r==Z?Ar(e):r==rt?Or(e):function(t,e){return Qe(e,function(e){return[e,t[e]]})}(e,t(e))}}function Ao(t,e,r,i,a,s,l,c){var f=e&m;if(!f&&"function"!=typeof t)throw new ie(u);var p=i?i.length:0;if(p||(e&=~(w|E),i=a=o),l=l===o?l:qr(Bs(l),0),c=c===o?c:Bs(c),p-=a?a.length:0,e&E){var d=i,v=a;i=a=o}var y=f?o:Ro(t),k=[t,e,r,i,a,d,v,s,l,c];if(y&&function(t,e){var r=t[1],n=e[1],i=r|n,o=i<(g|m|T),a=n==T&&r==b||n==T&&r==A&&t[7].length<=e[8]||n==(T|A)&&e[7].length<=e[8]&&r==b;if(!o&&!a)return t;n&g&&(t[2]=e[2],i|=r&g?0:_);var s=e[3];if(s){var u=t[3];t[3]=u?to(u,s,e[4]):s,t[4]=u?Sr(t[3],h):e[4]}(s=e[5])&&(u=t[5],t[5]=u?eo(u,s,e[6]):s,t[6]=u?Sr(t[5],h):e[6]),(s=e[7])&&(t[7]=s),n&T&&(t[8]=null==t[8]?e[8]:Vr(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i}(k,y),t=k[0],e=k[1],r=k[2],i=k[3],a=k[4],!(c=k[9]=k[9]===o?f?0:t.length:qr(k[9]-p,0))&&e&(b|x)&&(e&=~(b|x)),e&&e!=g)S=e==b||e==x?function(t,e,r){var i=co(t);return function a(){for(var s=arguments.length,u=n(s),l=s,c=No(a);l--;)u[l]=arguments[l];var h=s<3&&u[0]!==c&&u[s-1]!==c?[]:Sr(u,c);return(s-=h.length)<r?xo(t,e,po,a.placeholder,o,u,h,o,o,r-s):Ve(this&&this!==Re&&this instanceof a?i:t,this,u)}}(t,e,c):e!=w&&e!=(g|w)||a.length?po.apply(o,k):function(t,e,r,i){var o=e&g,a=co(t);return function e(){for(var s=-1,u=arguments.length,l=-1,c=i.length,h=n(c+u),f=this&&this!==Re&&this instanceof e?a:t;++l<c;)h[l]=i[l];for(;u--;)h[l++]=arguments[++s];return Ve(f,o?r:this,h)}}(t,e,r,i);else var S=function(t,e,r){var n=e&g,i=co(t);return function e(){return(this&&this!==Re&&this instanceof e?i:t).apply(n?r:this,arguments)}}(t,e,r);return aa((y?Si:na)(S,k),t,e)}function ko(t,e,r,n){return t===o||ps(t,se[r])&&!ce.call(n,r)?e:t}function So(t,e,r,n,i,a){return Ss(t)&&Ss(e)&&(a.set(e,t),vi(t,e,o,So,a),a.delete(e)),t}function Mo(t){return Ls(t)?o:t}function Oo(t,e,r,n,i,a){var s=r&v,u=t.length,l=e.length;if(u!=l&&!(s&&l>u))return!1;var c=a.get(t),h=a.get(e);if(c&&h)return c==e&&h==t;var f=-1,p=!0,d=r&y?new xn:o;for(a.set(t,e),a.set(e,t);++f<u;){var g=t[f],m=e[f];if(n)var _=s?n(m,g,f,e,t,a):n(g,m,f,t,e,a);if(_!==o){if(_)continue;p=!1;break}if(d){if(!nr(e,function(t,e){if(!mr(d,e)&&(g===t||i(g,t,r,n,a)))return d.push(e)})){p=!1;break}}else if(g!==m&&!i(g,m,r,n,a)){p=!1;break}}return a.delete(t),a.delete(e),p}function Io(t){return oa(ta(t,o,ma),t+"")}function Lo(t){return $n(t,iu,Fo)}function Co(t){return $n(t,ou,Bo)}var Ro=rn?function(t){return rn.get(t)}:Nu;function Po(t){for(var e=t.name+"",r=nn[e],n=ce.call(nn,e)?r.length:0;n--;){var i=r[n],o=i.func;if(null==o||o==t)return i.name}return e}function No(t){return(ce.call(pn,"placeholder")?pn:t).placeholder}function jo(){var t=pn.iteratee||Lu;return t=t===Lu?ui:t,arguments.length?t(arguments[0],arguments[1]):t}function Do(t,e){var r,n,i=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof e?"string":"hash"]:i.map}function zo(t){for(var e=iu(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,Jo(i)]}return e}function Ho(t,e){var r=function(t,e){return null==t?o:t[e]}(t,e);return si(r)?r:o}var Fo=Hr?function(t){return null==t?[]:(t=ee(t),Ze(Hr(t),function(e){return Pe.call(t,e)}))}:Uu,Bo=Hr?function(t){for(var e=[];t;)tr(e,Fo(t)),t=Le(t);return e}:Uu,Uo=Jn;function Go(t,e,r){for(var n=-1,i=(e=Wi(e,t)).length,o=!1;++n<i;){var a=ca(e[n]);if(!(o=null!=t&&r(t,a)))break;t=t[a]}return o||++n!=i?o:!!(i=null==t?0:t.length)&&ks(i)&&Wo(a,i)&&(gs(t)||ys(t))}function qo(t){return"function"!=typeof t.constructor||$o(t)?{}:dn(Le(t))}function Vo(t){return gs(t)||ys(t)||!!(De&&t&&t[De])}function Wo(t,e){var r=typeof t;return!!(e=null==e?P:e)&&("number"==r||"symbol"!=r&&Kt.test(t))&&t>-1&&t%1==0&&t<e}function Yo(t,e,r){if(!Ss(r))return!1;var n=typeof e;return!!("number"==n?_s(r)&&Wo(e,r.length):"string"==n&&e in r)&&ps(r[e],t)}function Ko(t,e){if(gs(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!Ns(t))||It.test(t)||!Ot.test(t)||null!=e&&t in ee(e)}function Xo(t){var e=Po(t),r=pn[e];if("function"!=typeof r||!(e in gn.prototype))return!1;if(t===r)return!0;var n=Ro(r);return!!n&&t===n[0]}(Zr&&Uo(new Zr(new ArrayBuffer(1)))!=lt||$r&&Uo(new $r)!=Z||Jr&&"[object Promise]"!=Uo(Jr.resolve())||Qr&&Uo(new Qr)!=rt||tn&&Uo(new tn)!=at)&&(Uo=function(t){var e=Jn(t),r=e==Q?t.constructor:o,n=r?ha(r):"";if(n)switch(n){case on:return lt;case an:return Z;case sn:return"[object Promise]";case un:return rt;case ln:return at}return e});var Zo=ue?Ts:Gu;function $o(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||se)}function Jo(t){return t==t&&!Ss(t)}function Qo(t,e){return function(r){return null!=r&&r[t]===e&&(e!==o||t in ee(r))}}function ta(t,e,r){return e=qr(e===o?t.length-1:e,0),function(){for(var i=arguments,o=-1,a=qr(i.length-e,0),s=n(a);++o<a;)s[o]=i[e+o];o=-1;for(var u=n(e+1);++o<e;)u[o]=i[o];return u[e]=r(s),Ve(t,this,u)}}function ea(t,e){return e.length<2?t:Zn(t,Ii(e,0,-1))}function ra(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var na=sa(Si),ia=jr||function(t,e){return Re.setTimeout(t,e)},oa=sa(Mi);function aa(t,e,r){var n=e+"";return oa(t,function(t,e){var r=e.length;if(!r)return t;var n=r-1;return e[n]=(r>1?"& ":"")+e[n],e=e.join(r>2?", ":" "),t.replace(Dt,"{\n/* [wrapped with "+e+"] */\n")}(n,function(t,e){return Ye(F,function(r){var n="_."+r[0];e&r[1]&&!$e(t,n)&&t.push(n)}),t.sort()}(function(t){var e=t.match(zt);return e?e[1].split(Ht):[]}(n),r)))}function sa(t){var e=0,r=0;return function(){var n=Wr(),i=I-(n-r);if(r=n,i>0){if(++e>=O)return arguments[0]}else e=0;return t.apply(o,arguments)}}function ua(t,e){var r=-1,n=t.length,i=n-1;for(e=e===o?n:e;++r<e;){var a=xi(r,i),s=t[a];t[a]=t[r],t[r]=s}return t.length=e,t}var la=function(t){var e=ss(t,function(t){return r.size===c&&r.clear(),t}),r=e.cache;return e}(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Lt,function(t,r,n,i){e.push(n?i.replace(Bt,"$1"):r||t)}),e});function ca(t){if("string"==typeof t||Ns(t))return t;var e=t+"";return"0"==e&&1/t==-R?"-0":e}function ha(t){if(null!=t){try{return le.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function fa(t){if(t instanceof gn)return t.clone();var e=new yn(t.__wrapped__,t.__chain__);return e.__actions__=ro(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var pa=Ei(function(t,e){return bs(t)?zn(t,qn(e,1,bs,!0)):[]}),da=Ei(function(t,e){var r=Ea(e);return bs(r)&&(r=o),bs(t)?zn(t,qn(e,1,bs,!0),jo(r,2)):[]}),va=Ei(function(t,e){var r=Ea(e);return bs(r)&&(r=o),bs(t)?zn(t,qn(e,1,bs,!0),o,r):[]});function ya(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var i=null==r?0:Bs(r);return i<0&&(i=qr(n+i,0)),ar(t,jo(e,3),i)}function ga(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var i=n-1;return r!==o&&(i=Bs(r),i=r<0?qr(n+i,0):Vr(i,n-1)),ar(t,jo(e,3),i,!0)}function ma(t){return null!=t&&t.length?qn(t,1):[]}function _a(t){return t&&t.length?t[0]:o}var ba=Ei(function(t){var e=Qe(t,qi);return e.length&&e[0]===t[0]?ri(e):[]}),xa=Ei(function(t){var e=Ea(t),r=Qe(t,qi);return e===Ea(r)?e=o:r.pop(),r.length&&r[0]===t[0]?ri(r,jo(e,2)):[]}),wa=Ei(function(t){var e=Ea(t),r=Qe(t,qi);return(e="function"==typeof e?e:o)&&r.pop(),r.length&&r[0]===t[0]?ri(r,o,e):[]});function Ea(t){var e=null==t?0:t.length;return e?t[e-1]:o}var Ta=Ei(Aa);function Aa(t,e){return t&&t.length&&e&&e.length?_i(t,e):t}var ka=Io(function(t,e){var r=null==t?0:t.length,n=Rn(t,e);return bi(t,Qe(e,function(t){return Wo(t,r)?+t:t}).sort(Qi)),n});function Sa(t){return null==t?t:Xr.call(t)}var Ma=Ei(function(t){return Di(qn(t,1,bs,!0))}),Oa=Ei(function(t){var e=Ea(t);return bs(e)&&(e=o),Di(qn(t,1,bs,!0),jo(e,2))}),Ia=Ei(function(t){var e=Ea(t);return e="function"==typeof e?e:o,Di(qn(t,1,bs,!0),o,e)});function La(t){if(!t||!t.length)return[];var e=0;return t=Ze(t,function(t){if(bs(t))return e=qr(t.length,e),!0}),vr(e,function(e){return Qe(t,hr(e))})}function Ca(t,e){if(!t||!t.length)return[];var r=La(t);return null==e?r:Qe(r,function(t){return Ve(e,o,t)})}var Ra=Ei(function(t,e){return bs(t)?zn(t,e):[]}),Pa=Ei(function(t){return Ui(Ze(t,bs))}),Na=Ei(function(t){var e=Ea(t);return bs(e)&&(e=o),Ui(Ze(t,bs),jo(e,2))}),ja=Ei(function(t){var e=Ea(t);return e="function"==typeof e?e:o,Ui(Ze(t,bs),o,e)}),Da=Ei(La);var za=Ei(function(t){var e=t.length,r=e>1?t[e-1]:o;return Ca(t,r="function"==typeof r?(t.pop(),r):o)});function Ha(t){var e=pn(t);return e.__chain__=!0,e}function Fa(t,e){return e(t)}var Ba=Io(function(t){var e=t.length,r=e?t[0]:0,n=this.__wrapped__,i=function(e){return Rn(e,t)};return!(e>1||this.__actions__.length)&&n instanceof gn&&Wo(r)?((n=n.slice(r,+r+(e?1:0))).__actions__.push({func:Fa,args:[i],thisArg:o}),new yn(n,this.__chain__).thru(function(t){return e&&!t.length&&t.push(o),t})):this.thru(i)});var Ua=io(function(t,e,r){ce.call(t,r)?++t[r]:Cn(t,r,1)});var Ga=ho(ya),qa=ho(ga);function Va(t,e){return(gs(t)?Ye:Hn)(t,jo(e,3))}function Wa(t,e){return(gs(t)?Ke:Fn)(t,jo(e,3))}var Ya=io(function(t,e,r){ce.call(t,r)?t[r].push(e):Cn(t,r,[e])});var Ka=Ei(function(t,e,r){var i=-1,o="function"==typeof e,a=_s(t)?n(t.length):[];return Hn(t,function(t){a[++i]=o?Ve(e,t,r):ni(t,e,r)}),a}),Xa=io(function(t,e,r){Cn(t,r,e)});function Za(t,e){return(gs(t)?Qe:fi)(t,jo(e,3))}var $a=io(function(t,e,r){t[r?0:1].push(e)},function(){return[[],[]]});var Ja=Ei(function(t,e){if(null==t)return[];var r=e.length;return r>1&&Yo(t,e[0],e[1])?e=[]:r>2&&Yo(e[0],e[1],e[2])&&(e=[e[0]]),gi(t,qn(e,1),[])}),Qa=Nr||function(){return Re.Date.now()};function ts(t,e,r){return e=r?o:e,e=t&&null==e?t.length:e,Ao(t,T,o,o,o,o,e)}function es(t,e){var r;if("function"!=typeof e)throw new ie(u);return t=Bs(t),function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=o),r}}var rs=Ei(function(t,e,r){var n=g;if(r.length){var i=Sr(r,No(rs));n|=w}return Ao(t,n,e,r,i)}),ns=Ei(function(t,e,r){var n=g|m;if(r.length){var i=Sr(r,No(ns));n|=w}return Ao(e,n,t,r,i)});function is(t,e,r){var n,i,a,s,l,c,h=0,f=!1,p=!1,d=!0;if("function"!=typeof t)throw new ie(u);function v(e){var r=n,a=i;return n=i=o,h=e,s=t.apply(a,r)}function y(t){var r=t-c;return c===o||r>=e||r<0||p&&t-h>=a}function g(){var t=Qa();if(y(t))return m(t);l=ia(g,function(t){var r=e-(t-c);return p?Vr(r,a-(t-h)):r}(t))}function m(t){return l=o,d&&n?v(t):(n=i=o,s)}function _(){var t=Qa(),r=y(t);if(n=arguments,i=this,c=t,r){if(l===o)return function(t){return h=t,l=ia(g,e),f?v(t):s}(c);if(p)return Xi(l),l=ia(g,e),v(c)}return l===o&&(l=ia(g,e)),s}return e=Gs(e)||0,Ss(r)&&(f=!!r.leading,a=(p="maxWait"in r)?qr(Gs(r.maxWait)||0,e):a,d="trailing"in r?!!r.trailing:d),_.cancel=function(){l!==o&&Xi(l),h=0,n=c=i=l=o},_.flush=function(){return l===o?s:m(Qa())},_}var os=Ei(function(t,e){return Dn(t,1,e)}),as=Ei(function(t,e,r){return Dn(t,Gs(e)||0,r)});function ss(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new ie(u);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=t.apply(this,n);return r.cache=o.set(i,a)||o,a};return r.cache=new(ss.Cache||bn),r}function us(t){if("function"!=typeof t)throw new ie(u);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}ss.Cache=bn;var ls=Yi(function(t,e){var r=(e=1==e.length&&gs(e[0])?Qe(e[0],yr(jo())):Qe(qn(e,1),yr(jo()))).length;return Ei(function(n){for(var i=-1,o=Vr(n.length,r);++i<o;)n[i]=e[i].call(this,n[i]);return Ve(t,this,n)})}),cs=Ei(function(t,e){var r=Sr(e,No(cs));return Ao(t,w,o,e,r)}),hs=Ei(function(t,e){var r=Sr(e,No(hs));return Ao(t,E,o,e,r)}),fs=Io(function(t,e){return Ao(t,A,o,o,o,e)});function ps(t,e){return t===e||t!=t&&e!=e}var ds=bo(Qn),vs=bo(function(t,e){return t>=e}),ys=ii(function(){return arguments}())?ii:function(t){return Ms(t)&&ce.call(t,"callee")&&!Pe.call(t,"callee")},gs=n.isArray,ms=He?yr(He):function(t){return Ms(t)&&Jn(t)==ut};function _s(t){return null!=t&&ks(t.length)&&!Ts(t)}function bs(t){return Ms(t)&&_s(t)}var xs=Fr||Gu,ws=Fe?yr(Fe):function(t){return Ms(t)&&Jn(t)==V};function Es(t){if(!Ms(t))return!1;var e=Jn(t);return e==Y||e==W||"string"==typeof t.message&&"string"==typeof t.name&&!Ls(t)}function Ts(t){if(!Ss(t))return!1;var e=Jn(t);return e==K||e==X||e==G||e==tt}function As(t){return"number"==typeof t&&t==Bs(t)}function ks(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=P}function Ss(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Ms(t){return null!=t&&"object"==typeof t}var Os=Be?yr(Be):function(t){return Ms(t)&&Uo(t)==Z};function Is(t){return"number"==typeof t||Ms(t)&&Jn(t)==$}function Ls(t){if(!Ms(t)||Jn(t)!=Q)return!1;var e=Le(t);if(null===e)return!0;var r=ce.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&le.call(r)==de}var Cs=Ue?yr(Ue):function(t){return Ms(t)&&Jn(t)==et};var Rs=Ge?yr(Ge):function(t){return Ms(t)&&Uo(t)==rt};function Ps(t){return"string"==typeof t||!gs(t)&&Ms(t)&&Jn(t)==nt}function Ns(t){return"symbol"==typeof t||Ms(t)&&Jn(t)==it}var js=qe?yr(qe):function(t){return Ms(t)&&ks(t.length)&&!!ke[Jn(t)]};var Ds=bo(hi),zs=bo(function(t,e){return t<=e});function Hs(t){if(!t)return[];if(_s(t))return Ps(t)?Lr(t):ro(t);if(ze&&t[ze])return function(t){for(var e,r=[];!(e=t.next()).done;)r.push(e.value);return r}(t[ze]());var e=Uo(t);return(e==Z?Ar:e==rt?Mr:pu)(t)}function Fs(t){return t?(t=Gs(t))===R||t===-R?(t<0?-1:1)*N:t==t?t:0:0===t?t:0}function Bs(t){var e=Fs(t),r=e%1;return e==e?r?e-r:e:0}function Us(t){return t?Pn(Bs(t),0,D):0}function Gs(t){if("number"==typeof t)return t;if(Ns(t))return j;if(Ss(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Ss(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Pt,"");var r=Vt.test(t);return r||Yt.test(t)?Ie(t.slice(2),r?2:8):qt.test(t)?j:+t}function qs(t){return no(t,ou(t))}function Vs(t){return null==t?"":ji(t)}var Ws=oo(function(t,e){if($o(e)||_s(e))no(e,iu(e),t);else for(var r in e)ce.call(e,r)&&Mn(t,r,e[r])}),Ys=oo(function(t,e){no(e,ou(e),t)}),Ks=oo(function(t,e,r,n){no(e,ou(e),t,n)}),Xs=oo(function(t,e,r,n){no(e,iu(e),t,n)}),Zs=Io(Rn);var $s=Ei(function(t,e){t=ee(t);var r=-1,n=e.length,i=n>2?e[2]:o;for(i&&Yo(e[0],e[1],i)&&(n=1);++r<n;)for(var a=e[r],s=ou(a),u=-1,l=s.length;++u<l;){var c=s[u],h=t[c];(h===o||ps(h,se[c])&&!ce.call(t,c))&&(t[c]=a[c])}return t}),Js=Ei(function(t){return t.push(o,So),Ve(su,o,t)});function Qs(t,e,r){var n=null==t?o:Zn(t,e);return n===o?r:n}function tu(t,e){return null!=t&&Go(t,e,ei)}var eu=vo(function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=pe.call(e)),t[e]=r},Su(Iu)),ru=vo(function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=pe.call(e)),ce.call(t,e)?t[e].push(r):t[e]=[r]},jo),nu=Ei(ni);function iu(t){return _s(t)?En(t):li(t)}function ou(t){return _s(t)?En(t,!0):ci(t)}var au=oo(function(t,e,r){vi(t,e,r)}),su=oo(function(t,e,r,n){vi(t,e,r,n)}),uu=Io(function(t,e){var r={};if(null==t)return r;var n=!1;e=Qe(e,function(e){return e=Wi(e,t),n||(n=e.length>1),e}),no(t,Co(t),r),n&&(r=Nn(r,f|p|d,Mo));for(var i=e.length;i--;)zi(r,e[i]);return r});var lu=Io(function(t,e){return null==t?{}:function(t,e){return mi(t,e,function(e,r){return tu(t,r)})}(t,e)});function cu(t,e){if(null==t)return{};var r=Qe(Co(t),function(t){return[t]});return e=jo(e),mi(t,r,function(t,r){return e(t,r[0])})}var hu=To(iu),fu=To(ou);function pu(t){return null==t?[]:gr(t,iu(t))}var du=lo(function(t,e,r){return e=e.toLowerCase(),t+(r?vu(e):e)});function vu(t){return Eu(Vs(t).toLowerCase())}function yu(t){return(t=Vs(t))&&t.replace(Xt,xr).replace(_e,"")}var gu=lo(function(t,e,r){return t+(r?"-":"")+e.toLowerCase()}),mu=lo(function(t,e,r){return t+(r?" ":"")+e.toLowerCase()}),_u=uo("toLowerCase");var bu=lo(function(t,e,r){return t+(r?"_":"")+e.toLowerCase()});var xu=lo(function(t,e,r){return t+(r?" ":"")+Eu(e)});var wu=lo(function(t,e,r){return t+(r?" ":"")+e.toUpperCase()}),Eu=uo("toUpperCase");function Tu(t,e,r){return t=Vs(t),(e=r?o:e)===o?function(t){return Ee.test(t)}(t)?function(t){return t.match(xe)||[]}(t):function(t){return t.match(Ft)||[]}(t):t.match(e)||[]}var Au=Ei(function(t,e){try{return Ve(t,o,e)}catch(t){return Es(t)?t:new Jt(t)}}),ku=Io(function(t,e){return Ye(e,function(e){e=ca(e),Cn(t,e,rs(t[e],t))}),t});function Su(t){return function(){return t}}var Mu=fo(),Ou=fo(!0);function Iu(t){return t}function Lu(t){return ui("function"==typeof t?t:Nn(t,f))}var Cu=Ei(function(t,e){return function(r){return ni(r,t,e)}}),Ru=Ei(function(t,e){return function(r){return ni(t,r,e)}});function Pu(t,e,r){var n=iu(e),i=Xn(e,n);null!=r||Ss(e)&&(i.length||!n.length)||(r=e,e=t,t=this,i=Xn(e,iu(e)));var o=!(Ss(r)&&"chain"in r&&!r.chain),a=Ts(t);return Ye(i,function(r){var n=e[r];t[r]=n,a&&(t.prototype[r]=function(){var e=this.__chain__;if(o||e){var r=t(this.__wrapped__);return(r.__actions__=ro(this.__actions__)).push({func:n,args:arguments,thisArg:t}),r.__chain__=e,r}return n.apply(t,tr([this.value()],arguments))})}),t}function Nu(){}var ju=go(Qe),Du=go(Xe),zu=go(nr);function Hu(t){return Ko(t)?hr(ca(t)):function(t){return function(e){return Zn(e,t)}}(t)}var Fu=_o(),Bu=_o(!0);function Uu(){return[]}function Gu(){return!1}var qu=yo(function(t,e){return t+e},0),Vu=wo("ceil"),Wu=yo(function(t,e){return t/e},1),Yu=wo("floor");var Ku,Xu=yo(function(t,e){return t*e},1),Zu=wo("round"),$u=yo(function(t,e){return t-e},0);return pn.after=function(t,e){if("function"!=typeof e)throw new ie(u);return t=Bs(t),function(){if(--t<1)return e.apply(this,arguments)}},pn.ary=ts,pn.assign=Ws,pn.assignIn=Ys,pn.assignInWith=Ks,pn.assignWith=Xs,pn.at=Zs,pn.before=es,pn.bind=rs,pn.bindAll=ku,pn.bindKey=ns,pn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return gs(t)?t:[t]},pn.chain=Ha,pn.chunk=function(t,e,r){e=(r?Yo(t,e,r):e===o)?1:qr(Bs(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var a=0,s=0,u=n(Dr(i/e));a<i;)u[s++]=Ii(t,a,a+=e);return u},pn.compact=function(t){for(var e=-1,r=null==t?0:t.length,n=0,i=[];++e<r;){var o=t[e];o&&(i[n++]=o)}return i},pn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=n(t-1),r=arguments[0],i=t;i--;)e[i-1]=arguments[i];return tr(gs(r)?ro(r):[r],qn(e,1))},pn.cond=function(t){var e=null==t?0:t.length,r=jo();return t=e?Qe(t,function(t){if("function"!=typeof t[1])throw new ie(u);return[r(t[0]),t[1]]}):[],Ei(function(r){for(var n=-1;++n<e;){var i=t[n];if(Ve(i[0],this,r))return Ve(i[1],this,r)}})},pn.conforms=function(t){return function(t){var e=iu(t);return function(r){return jn(r,t,e)}}(Nn(t,f))},pn.constant=Su,pn.countBy=Ua,pn.create=function(t,e){var r=dn(t);return null==e?r:Ln(r,e)},pn.curry=function t(e,r,n){var i=Ao(e,b,o,o,o,o,o,r=n?o:r);return i.placeholder=t.placeholder,i},pn.curryRight=function t(e,r,n){var i=Ao(e,x,o,o,o,o,o,r=n?o:r);return i.placeholder=t.placeholder,i},pn.debounce=is,pn.defaults=$s,pn.defaultsDeep=Js,pn.defer=os,pn.delay=as,pn.difference=pa,pn.differenceBy=da,pn.differenceWith=va,pn.drop=function(t,e,r){var n=null==t?0:t.length;return n?Ii(t,(e=r||e===o?1:Bs(e))<0?0:e,n):[]},pn.dropRight=function(t,e,r){var n=null==t?0:t.length;return n?Ii(t,0,(e=n-(e=r||e===o?1:Bs(e)))<0?0:e):[]},pn.dropRightWhile=function(t,e){return t&&t.length?Fi(t,jo(e,3),!0,!0):[]},pn.dropWhile=function(t,e){return t&&t.length?Fi(t,jo(e,3),!0):[]},pn.fill=function(t,e,r,n){var i=null==t?0:t.length;return i?(r&&"number"!=typeof r&&Yo(t,e,r)&&(r=0,n=i),function(t,e,r,n){var i=t.length;for((r=Bs(r))<0&&(r=-r>i?0:i+r),(n=n===o||n>i?i:Bs(n))<0&&(n+=i),n=r>n?0:Us(n);r<n;)t[r++]=e;return t}(t,e,r,n)):[]},pn.filter=function(t,e){return(gs(t)?Ze:Gn)(t,jo(e,3))},pn.flatMap=function(t,e){return qn(Za(t,e),1)},pn.flatMapDeep=function(t,e){return qn(Za(t,e),R)},pn.flatMapDepth=function(t,e,r){return r=r===o?1:Bs(r),qn(Za(t,e),r)},pn.flatten=ma,pn.flattenDeep=function(t){return null!=t&&t.length?qn(t,R):[]},pn.flattenDepth=function(t,e){return null!=t&&t.length?qn(t,e=e===o?1:Bs(e)):[]},pn.flip=function(t){return Ao(t,k)},pn.flow=Mu,pn.flowRight=Ou,pn.fromPairs=function(t){for(var e=-1,r=null==t?0:t.length,n={};++e<r;){var i=t[e];n[i[0]]=i[1]}return n},pn.functions=function(t){return null==t?[]:Xn(t,iu(t))},pn.functionsIn=function(t){return null==t?[]:Xn(t,ou(t))},pn.groupBy=Ya,pn.initial=function(t){return null!=t&&t.length?Ii(t,0,-1):[]},pn.intersection=ba,pn.intersectionBy=xa,pn.intersectionWith=wa,pn.invert=eu,pn.invertBy=ru,pn.invokeMap=Ka,pn.iteratee=Lu,pn.keyBy=Xa,pn.keys=iu,pn.keysIn=ou,pn.map=Za,pn.mapKeys=function(t,e){var r={};return e=jo(e,3),Yn(t,function(t,n,i){Cn(r,e(t,n,i),t)}),r},pn.mapValues=function(t,e){var r={};return e=jo(e,3),Yn(t,function(t,n,i){Cn(r,n,e(t,n,i))}),r},pn.matches=function(t){return pi(Nn(t,f))},pn.matchesProperty=function(t,e){return di(t,Nn(e,f))},pn.memoize=ss,pn.merge=au,pn.mergeWith=su,pn.method=Cu,pn.methodOf=Ru,pn.mixin=Pu,pn.negate=us,pn.nthArg=function(t){return t=Bs(t),Ei(function(e){return yi(e,t)})},pn.omit=uu,pn.omitBy=function(t,e){return cu(t,us(jo(e)))},pn.once=function(t){return es(2,t)},pn.orderBy=function(t,e,r,n){return null==t?[]:(gs(e)||(e=null==e?[]:[e]),gs(r=n?o:r)||(r=null==r?[]:[r]),gi(t,e,r))},pn.over=ju,pn.overArgs=ls,pn.overEvery=Du,pn.overSome=zu,pn.partial=cs,pn.partialRight=hs,pn.partition=$a,pn.pick=lu,pn.pickBy=cu,pn.property=Hu,pn.propertyOf=function(t){return function(e){return null==t?o:Zn(t,e)}},pn.pull=Ta,pn.pullAll=Aa,pn.pullAllBy=function(t,e,r){return t&&t.length&&e&&e.length?_i(t,e,jo(r,2)):t},pn.pullAllWith=function(t,e,r){return t&&t.length&&e&&e.length?_i(t,e,o,r):t},pn.pullAt=ka,pn.range=Fu,pn.rangeRight=Bu,pn.rearg=fs,pn.reject=function(t,e){return(gs(t)?Ze:Gn)(t,us(jo(e,3)))},pn.remove=function(t,e){var r=[];if(!t||!t.length)return r;var n=-1,i=[],o=t.length;for(e=jo(e,3);++n<o;){var a=t[n];e(a,n,t)&&(r.push(a),i.push(n))}return bi(t,i),r},pn.rest=function(t,e){if("function"!=typeof t)throw new ie(u);return Ei(t,e=e===o?e:Bs(e))},pn.reverse=Sa,pn.sampleSize=function(t,e,r){return e=(r?Yo(t,e,r):e===o)?1:Bs(e),(gs(t)?An:Ai)(t,e)},pn.set=function(t,e,r){return null==t?t:ki(t,e,r)},pn.setWith=function(t,e,r,n){return n="function"==typeof n?n:o,null==t?t:ki(t,e,r,n)},pn.shuffle=function(t){return(gs(t)?kn:Oi)(t)},pn.slice=function(t,e,r){var n=null==t?0:t.length;return n?(r&&"number"!=typeof r&&Yo(t,e,r)?(e=0,r=n):(e=null==e?0:Bs(e),r=r===o?n:Bs(r)),Ii(t,e,r)):[]},pn.sortBy=Ja,pn.sortedUniq=function(t){return t&&t.length?Pi(t):[]},pn.sortedUniqBy=function(t,e){return t&&t.length?Pi(t,jo(e,2)):[]},pn.split=function(t,e,r){return r&&"number"!=typeof r&&Yo(t,e,r)&&(e=r=o),(r=r===o?D:r>>>0)?(t=Vs(t))&&("string"==typeof e||null!=e&&!Cs(e))&&!(e=ji(e))&&Tr(t)?Ki(Lr(t),0,r):t.split(e,r):[]},pn.spread=function(t,e){if("function"!=typeof t)throw new ie(u);return e=null==e?0:qr(Bs(e),0),Ei(function(r){var n=r[e],i=Ki(r,0,e);return n&&tr(i,n),Ve(t,this,i)})},pn.tail=function(t){var e=null==t?0:t.length;return e?Ii(t,1,e):[]},pn.take=function(t,e,r){return t&&t.length?Ii(t,0,(e=r||e===o?1:Bs(e))<0?0:e):[]},pn.takeRight=function(t,e,r){var n=null==t?0:t.length;return n?Ii(t,(e=n-(e=r||e===o?1:Bs(e)))<0?0:e,n):[]},pn.takeRightWhile=function(t,e){return t&&t.length?Fi(t,jo(e,3),!1,!0):[]},pn.takeWhile=function(t,e){return t&&t.length?Fi(t,jo(e,3)):[]},pn.tap=function(t,e){return e(t),t},pn.throttle=function(t,e,r){var n=!0,i=!0;if("function"!=typeof t)throw new ie(u);return Ss(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),is(t,e,{leading:n,maxWait:e,trailing:i})},pn.thru=Fa,pn.toArray=Hs,pn.toPairs=hu,pn.toPairsIn=fu,pn.toPath=function(t){return gs(t)?Qe(t,ca):Ns(t)?[t]:ro(la(Vs(t)))},pn.toPlainObject=qs,pn.transform=function(t,e,r){var n=gs(t),i=n||xs(t)||js(t);if(e=jo(e,4),null==r){var o=t&&t.constructor;r=i?n?new o:[]:Ss(t)&&Ts(o)?dn(Le(t)):{}}return(i?Ye:Yn)(t,function(t,n,i){return e(r,t,n,i)}),r},pn.unary=function(t){return ts(t,1)},pn.union=Ma,pn.unionBy=Oa,pn.unionWith=Ia,pn.uniq=function(t){return t&&t.length?Di(t):[]},pn.uniqBy=function(t,e){return t&&t.length?Di(t,jo(e,2)):[]},pn.uniqWith=function(t,e){return e="function"==typeof e?e:o,t&&t.length?Di(t,o,e):[]},pn.unset=function(t,e){return null==t||zi(t,e)},pn.unzip=La,pn.unzipWith=Ca,pn.update=function(t,e,r){return null==t?t:Hi(t,e,Vi(r))},pn.updateWith=function(t,e,r,n){return n="function"==typeof n?n:o,null==t?t:Hi(t,e,Vi(r),n)},pn.values=pu,pn.valuesIn=function(t){return null==t?[]:gr(t,ou(t))},pn.without=Ra,pn.words=Tu,pn.wrap=function(t,e){return cs(Vi(e),t)},pn.xor=Pa,pn.xorBy=Na,pn.xorWith=ja,pn.zip=Da,pn.zipObject=function(t,e){return Gi(t||[],e||[],Mn)},pn.zipObjectDeep=function(t,e){return Gi(t||[],e||[],ki)},pn.zipWith=za,pn.entries=hu,pn.entriesIn=fu,pn.extend=Ys,pn.extendWith=Ks,Pu(pn,pn),pn.add=qu,pn.attempt=Au,pn.camelCase=du,pn.capitalize=vu,pn.ceil=Vu,pn.clamp=function(t,e,r){return r===o&&(r=e,e=o),r!==o&&(r=(r=Gs(r))==r?r:0),e!==o&&(e=(e=Gs(e))==e?e:0),Pn(Gs(t),e,r)},pn.clone=function(t){return Nn(t,d)},pn.cloneDeep=function(t){return Nn(t,f|d)},pn.cloneDeepWith=function(t,e){return Nn(t,f|d,e="function"==typeof e?e:o)},pn.cloneWith=function(t,e){return Nn(t,d,e="function"==typeof e?e:o)},pn.conformsTo=function(t,e){return null==e||jn(t,e,iu(e))},pn.deburr=yu,pn.defaultTo=function(t,e){return null==t||t!=t?e:t},pn.divide=Wu,pn.endsWith=function(t,e,r){t=Vs(t),e=ji(e);var n=t.length,i=r=r===o?n:Pn(Bs(r),0,n);return(r-=e.length)>=0&&t.slice(r,i)==e},pn.eq=ps,pn.escape=function(t){return(t=Vs(t))&&At.test(t)?t.replace(Et,wr):t},pn.escapeRegExp=function(t){return(t=Vs(t))&&Rt.test(t)?t.replace(Ct,"\\$&"):t},pn.every=function(t,e,r){var n=gs(t)?Xe:Bn;return r&&Yo(t,e,r)&&(e=o),n(t,jo(e,3))},pn.find=Ga,pn.findIndex=ya,pn.findKey=function(t,e){return or(t,jo(e,3),Yn)},pn.findLast=qa,pn.findLastIndex=ga,pn.findLastKey=function(t,e){return or(t,jo(e,3),Kn)},pn.floor=Yu,pn.forEach=Va,pn.forEachRight=Wa,pn.forIn=function(t,e){return null==t?t:Vn(t,jo(e,3),ou)},pn.forInRight=function(t,e){return null==t?t:Wn(t,jo(e,3),ou)},pn.forOwn=function(t,e){return t&&Yn(t,jo(e,3))},pn.forOwnRight=function(t,e){return t&&Kn(t,jo(e,3))},pn.get=Qs,pn.gt=ds,pn.gte=vs,pn.has=function(t,e){return null!=t&&Go(t,e,ti)},pn.hasIn=tu,pn.head=_a,pn.identity=Iu,pn.includes=function(t,e,r,n){t=_s(t)?t:pu(t),r=r&&!n?Bs(r):0;var i=t.length;return r<0&&(r=qr(i+r,0)),Ps(t)?r<=i&&t.indexOf(e,r)>-1:!!i&&sr(t,e,r)>-1},pn.indexOf=function(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var i=null==r?0:Bs(r);return i<0&&(i=qr(n+i,0)),sr(t,e,i)},pn.inRange=function(t,e,r){return e=Fs(e),r===o?(r=e,e=0):r=Fs(r),function(t,e,r){return t>=Vr(e,r)&&t<qr(e,r)}(t=Gs(t),e,r)},pn.invoke=nu,pn.isArguments=ys,pn.isArray=gs,pn.isArrayBuffer=ms,pn.isArrayLike=_s,pn.isArrayLikeObject=bs,pn.isBoolean=function(t){return!0===t||!1===t||Ms(t)&&Jn(t)==q},pn.isBuffer=xs,pn.isDate=ws,pn.isElement=function(t){return Ms(t)&&1===t.nodeType&&!Ls(t)},pn.isEmpty=function(t){if(null==t)return!0;if(_s(t)&&(gs(t)||"string"==typeof t||"function"==typeof t.splice||xs(t)||js(t)||ys(t)))return!t.length;var e=Uo(t);if(e==Z||e==rt)return!t.size;if($o(t))return!li(t).length;for(var r in t)if(ce.call(t,r))return!1;return!0},pn.isEqual=function(t,e){return oi(t,e)},pn.isEqualWith=function(t,e,r){var n=(r="function"==typeof r?r:o)?r(t,e):o;return n===o?oi(t,e,o,r):!!n},pn.isError=Es,pn.isFinite=function(t){return"number"==typeof t&&Br(t)},pn.isFunction=Ts,pn.isInteger=As,pn.isLength=ks,pn.isMap=Os,pn.isMatch=function(t,e){return t===e||ai(t,e,zo(e))},pn.isMatchWith=function(t,e,r){return r="function"==typeof r?r:o,ai(t,e,zo(e),r)},pn.isNaN=function(t){return Is(t)&&t!=+t},pn.isNative=function(t){if(Zo(t))throw new Jt(s);return si(t)},pn.isNil=function(t){return null==t},pn.isNull=function(t){return null===t},pn.isNumber=Is,pn.isObject=Ss,pn.isObjectLike=Ms,pn.isPlainObject=Ls,pn.isRegExp=Cs,pn.isSafeInteger=function(t){return As(t)&&t>=-P&&t<=P},pn.isSet=Rs,pn.isString=Ps,pn.isSymbol=Ns,pn.isTypedArray=js,pn.isUndefined=function(t){return t===o},pn.isWeakMap=function(t){return Ms(t)&&Uo(t)==at},pn.isWeakSet=function(t){return Ms(t)&&Jn(t)==st},pn.join=function(t,e){return null==t?"":Ur.call(t,e)},pn.kebabCase=gu,pn.last=Ea,pn.lastIndexOf=function(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var i=n;return r!==o&&(i=(i=Bs(r))<0?qr(n+i,0):Vr(i,n-1)),e==e?function(t,e,r){for(var n=r+1;n--;)if(t[n]===e)return n;return n}(t,e,i):ar(t,lr,i,!0)},pn.lowerCase=mu,pn.lowerFirst=_u,pn.lt=Ds,pn.lte=zs,pn.max=function(t){return t&&t.length?Un(t,Iu,Qn):o},pn.maxBy=function(t,e){return t&&t.length?Un(t,jo(e,2),Qn):o},pn.mean=function(t){return cr(t,Iu)},pn.meanBy=function(t,e){return cr(t,jo(e,2))},pn.min=function(t){return t&&t.length?Un(t,Iu,hi):o},pn.minBy=function(t,e){return t&&t.length?Un(t,jo(e,2),hi):o},pn.stubArray=Uu,pn.stubFalse=Gu,pn.stubObject=function(){return{}},pn.stubString=function(){return""},pn.stubTrue=function(){return!0},pn.multiply=Xu,pn.nth=function(t,e){return t&&t.length?yi(t,Bs(e)):o},pn.noConflict=function(){return Re._===this&&(Re._=ve),this},pn.noop=Nu,pn.now=Qa,pn.pad=function(t,e,r){t=Vs(t);var n=(e=Bs(e))?Ir(t):0;if(!e||n>=e)return t;var i=(e-n)/2;return mo(zr(i),r)+t+mo(Dr(i),r)},pn.padEnd=function(t,e,r){t=Vs(t);var n=(e=Bs(e))?Ir(t):0;return e&&n<e?t+mo(e-n,r):t},pn.padStart=function(t,e,r){t=Vs(t);var n=(e=Bs(e))?Ir(t):0;return e&&n<e?mo(e-n,r)+t:t},pn.parseInt=function(t,e,r){return r||null==e?e=0:e&&(e=+e),Yr(Vs(t).replace(Nt,""),e||0)},pn.random=function(t,e,r){if(r&&"boolean"!=typeof r&&Yo(t,e,r)&&(e=r=o),r===o&&("boolean"==typeof e?(r=e,e=o):"boolean"==typeof t&&(r=t,t=o)),t===o&&e===o?(t=0,e=1):(t=Fs(t),e===o?(e=t,t=0):e=Fs(e)),t>e){var n=t;t=e,e=n}if(r||t%1||e%1){var i=Kr();return Vr(t+i*(e-t+Oe("1e-"+((i+"").length-1))),e)}return xi(t,e)},pn.reduce=function(t,e,r){var n=gs(t)?er:pr,i=arguments.length<3;return n(t,jo(e,4),r,i,Hn)},pn.reduceRight=function(t,e,r){var n=gs(t)?rr:pr,i=arguments.length<3;return n(t,jo(e,4),r,i,Fn)},pn.repeat=function(t,e,r){return e=(r?Yo(t,e,r):e===o)?1:Bs(e),wi(Vs(t),e)},pn.replace=function(){var t=arguments,e=Vs(t[0]);return t.length<3?e:e.replace(t[1],t[2])},pn.result=function(t,e,r){var n=-1,i=(e=Wi(e,t)).length;for(i||(i=1,t=o);++n<i;){var a=null==t?o:t[ca(e[n])];a===o&&(n=i,a=r),t=Ts(a)?a.call(t):a}return t},pn.round=Zu,pn.runInContext=t,pn.sample=function(t){return(gs(t)?Tn:Ti)(t)},pn.size=function(t){if(null==t)return 0;if(_s(t))return Ps(t)?Ir(t):t.length;var e=Uo(t);return e==Z||e==rt?t.size:li(t).length},pn.snakeCase=bu,pn.some=function(t,e,r){var n=gs(t)?nr:Li;return r&&Yo(t,e,r)&&(e=o),n(t,jo(e,3))},pn.sortedIndex=function(t,e){return Ci(t,e)},pn.sortedIndexBy=function(t,e,r){return Ri(t,e,jo(r,2))},pn.sortedIndexOf=function(t,e){var r=null==t?0:t.length;if(r){var n=Ci(t,e);if(n<r&&ps(t[n],e))return n}return-1},pn.sortedLastIndex=function(t,e){return Ci(t,e,!0)},pn.sortedLastIndexBy=function(t,e,r){return Ri(t,e,jo(r,2),!0)},pn.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var r=Ci(t,e,!0)-1;if(ps(t[r],e))return r}return-1},pn.startCase=xu,pn.startsWith=function(t,e,r){return t=Vs(t),r=null==r?0:Pn(Bs(r),0,t.length),e=ji(e),t.slice(r,r+e.length)==e},pn.subtract=$u,pn.sum=function(t){return t&&t.length?dr(t,Iu):0},pn.sumBy=function(t,e){return t&&t.length?dr(t,jo(e,2)):0},pn.template=function(t,e,r){var n=pn.templateSettings;r&&Yo(t,e,r)&&(e=o),t=Vs(t),e=Ks({},e,n,ko);var i,a,s=Ks({},e.imports,n.imports,ko),u=iu(s),l=gr(s,u),c=0,h=e.interpolate||Zt,f="__p += '",p=re((e.escape||Zt).source+"|"+h.source+"|"+(h===Mt?Ut:Zt).source+"|"+(e.evaluate||Zt).source+"|$","g"),d="//# sourceURL="+(ce.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ae+"]")+"\n";t.replace(p,function(e,r,n,o,s,u){return n||(n=o),f+=t.slice(c,u).replace($t,Er),r&&(i=!0,f+="' +\n__e("+r+") +\n'"),s&&(a=!0,f+="';\n"+s+";\n__p += '"),n&&(f+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),c=u+e.length,e}),f+="';\n";var v=ce.call(e,"variable")&&e.variable;v||(f="with (obj) {\n"+f+"\n}\n"),f=(a?f.replace(_t,""):f).replace(bt,"$1").replace(xt,"$1;"),f="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var y=Au(function(){return Qt(u,d+"return "+f).apply(o,l)});if(y.source=f,Es(y))throw y;return y},pn.times=function(t,e){if((t=Bs(t))<1||t>P)return[];var r=D,n=Vr(t,D);e=jo(e),t-=D;for(var i=vr(n,e);++r<t;)e(r);return i},pn.toFinite=Fs,pn.toInteger=Bs,pn.toLength=Us,pn.toLower=function(t){return Vs(t).toLowerCase()},pn.toNumber=Gs,pn.toSafeInteger=function(t){return t?Pn(Bs(t),-P,P):0===t?t:0},pn.toString=Vs,pn.toUpper=function(t){return Vs(t).toUpperCase()},pn.trim=function(t,e,r){if((t=Vs(t))&&(r||e===o))return t.replace(Pt,"");if(!t||!(e=ji(e)))return t;var n=Lr(t),i=Lr(e);return Ki(n,_r(n,i),br(n,i)+1).join("")},pn.trimEnd=function(t,e,r){if((t=Vs(t))&&(r||e===o))return t.replace(jt,"");if(!t||!(e=ji(e)))return t;var n=Lr(t);return Ki(n,0,br(n,Lr(e))+1).join("")},pn.trimStart=function(t,e,r){if((t=Vs(t))&&(r||e===o))return t.replace(Nt,"");if(!t||!(e=ji(e)))return t;var n=Lr(t);return Ki(n,_r(n,Lr(e))).join("")},pn.truncate=function(t,e){var r=S,n=M;if(Ss(e)){var i="separator"in e?e.separator:i;r="length"in e?Bs(e.length):r,n="omission"in e?ji(e.omission):n}var a=(t=Vs(t)).length;if(Tr(t)){var s=Lr(t);a=s.length}if(r>=a)return t;var u=r-Ir(n);if(u<1)return n;var l=s?Ki(s,0,u).join(""):t.slice(0,u);if(i===o)return l+n;if(s&&(u+=l.length-u),Cs(i)){if(t.slice(u).search(i)){var c,h=l;for(i.global||(i=re(i.source,Vs(Gt.exec(i))+"g")),i.lastIndex=0;c=i.exec(h);)var f=c.index;l=l.slice(0,f===o?u:f)}}else if(t.indexOf(ji(i),u)!=u){var p=l.lastIndexOf(i);p>-1&&(l=l.slice(0,p))}return l+n},pn.unescape=function(t){return(t=Vs(t))&&Tt.test(t)?t.replace(wt,Cr):t},pn.uniqueId=function(t){var e=++he;return Vs(t)+e},pn.upperCase=wu,pn.upperFirst=Eu,pn.each=Va,pn.eachRight=Wa,pn.first=_a,Pu(pn,(Ku={},Yn(pn,function(t,e){ce.call(pn.prototype,e)||(Ku[e]=t)}),Ku),{chain:!1}),pn.VERSION="4.17.19",Ye(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){pn[t].placeholder=pn}),Ye(["drop","take"],function(t,e){gn.prototype[t]=function(r){r=r===o?1:qr(Bs(r),0);var n=this.__filtered__&&!e?new gn(this):this.clone();return n.__filtered__?n.__takeCount__=Vr(r,n.__takeCount__):n.__views__.push({size:Vr(r,D),type:t+(n.__dir__<0?"Right":"")}),n},gn.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),Ye(["filter","map","takeWhile"],function(t,e){var r=e+1,n=r==L||3==r;gn.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:jo(t,3),type:r}),e.__filtered__=e.__filtered__||n,e}}),Ye(["head","last"],function(t,e){var r="take"+(e?"Right":"");gn.prototype[t]=function(){return this[r](1).value()[0]}}),Ye(["initial","tail"],function(t,e){var r="drop"+(e?"":"Right");gn.prototype[t]=function(){return this.__filtered__?new gn(this):this[r](1)}}),gn.prototype.compact=function(){return this.filter(Iu)},gn.prototype.find=function(t){return this.filter(t).head()},gn.prototype.findLast=function(t){return this.reverse().find(t)},gn.prototype.invokeMap=Ei(function(t,e){return"function"==typeof t?new gn(this):this.map(function(r){return ni(r,t,e)})}),gn.prototype.reject=function(t){return this.filter(us(jo(t)))},gn.prototype.slice=function(t,e){t=Bs(t);var r=this;return r.__filtered__&&(t>0||e<0)?new gn(r):(t<0?r=r.takeRight(-t):t&&(r=r.drop(t)),e!==o&&(r=(e=Bs(e))<0?r.dropRight(-e):r.take(e-t)),r)},gn.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},gn.prototype.toArray=function(){return this.take(D)},Yn(gn.prototype,function(t,e){var r=/^(?:filter|find|map|reject)|While$/.test(e),n=/^(?:head|last)$/.test(e),i=pn[n?"take"+("last"==e?"Right":""):e],a=n||/^find/.test(e);i&&(pn.prototype[e]=function(){var e=this.__wrapped__,s=n?[1]:arguments,u=e instanceof gn,l=s[0],c=u||gs(e),h=function(t){var e=i.apply(pn,tr([t],s));return n&&f?e[0]:e};c&&r&&"function"==typeof l&&1!=l.length&&(u=c=!1);var f=this.__chain__,p=!!this.__actions__.length,d=a&&!f,v=u&&!p;if(!a&&c){e=v?e:new gn(this);var y=t.apply(e,s);return y.__actions__.push({func:Fa,args:[h],thisArg:o}),new yn(y,f)}return d&&v?t.apply(this,s):(y=this.thru(h),d?n?y.value()[0]:y.value():y)})}),Ye(["pop","push","shift","sort","splice","unshift"],function(t){var e=oe[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",n=/^(?:pop|shift)$/.test(t);pn.prototype[t]=function(){var t=arguments;if(n&&!this.__chain__){var i=this.value();return e.apply(gs(i)?i:[],t)}return this[r](function(r){return e.apply(gs(r)?r:[],t)})}}),Yn(gn.prototype,function(t,e){var r=pn[e];if(r){var n=r.name+"";ce.call(nn,n)||(nn[n]=[]),nn[n].push({name:e,func:r})}}),nn[po(o,m).name]=[{name:"wrapper",func:o}],gn.prototype.clone=function(){var t=new gn(this.__wrapped__);return t.__actions__=ro(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=ro(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=ro(this.__views__),t},gn.prototype.reverse=function(){if(this.__filtered__){var t=new gn(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},gn.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,r=gs(t),n=e<0,i=r?t.length:0,o=function(t,e,r){for(var n=-1,i=r.length;++n<i;){var o=r[n],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=Vr(e,t+a);break;case"takeRight":t=qr(t,e-a)}}return{start:t,end:e}}(0,i,this.__views__),a=o.start,s=o.end,u=s-a,l=n?s:a-1,c=this.__iteratees__,h=c.length,f=0,p=Vr(u,this.__takeCount__);if(!r||!n&&i==u&&p==u)return Bi(t,this.__actions__);var d=[];t:for(;u--&&f<p;){for(var v=-1,y=t[l+=e];++v<h;){var g=c[v],m=g.iteratee,_=g.type,b=m(y);if(_==C)y=b;else if(!b){if(_==L)continue t;break t}}d[f++]=y}return d},pn.prototype.at=Ba,pn.prototype.chain=function(){return Ha(this)},pn.prototype.commit=function(){return new yn(this.value(),this.__chain__)},pn.prototype.next=function(){this.__values__===o&&(this.__values__=Hs(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?o:this.__values__[this.__index__++]}},pn.prototype.plant=function(t){for(var e,r=this;r instanceof vn;){var n=fa(r);n.__index__=0,n.__values__=o,e?i.__wrapped__=n:e=n;var i=n;r=r.__wrapped__}return i.__wrapped__=t,e},pn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof gn){var e=t;return this.__actions__.length&&(e=new gn(this)),(e=e.reverse()).__actions__.push({func:Fa,args:[Sa],thisArg:o}),new yn(e,this.__chain__)}return this.thru(Sa)},pn.prototype.toJSON=pn.prototype.valueOf=pn.prototype.value=function(){return Bi(this.__wrapped__,this.__actions__)},pn.prototype.first=pn.prototype.head,ze&&(pn.prototype[ze]=function(){return this}),pn}();Re._=Rr,(i=function(){return Rr}.call(e,r,e,n))===o||(n.exports=i)}).call(this)}).call(e,r(71),r(32)(t))},function(t,e,r){var n=r(18);t.exports=function(){return n.Date.now()}},function(t,e){t.exports=function(){return!1}},function(t,e,r){var n=r(8),i=r(69),o=NaN,a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(i(t))return o;if(n(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=n(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var r=u.test(t);return r||l.test(t)?c(t.slice(2),r?2:8):s.test(t)?o:+t}},function(t,e,r){var n=r(165);t.exports=function(t){return null==t?"":n(t)}},function(t,e,r){var n=r(169)("toUpperCase");t.exports=n},function(t,e,r){var n=function(){return this}()||Function("return this")(),i=n.regeneratorRuntime&&Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime")>=0,o=i&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,t.exports=r(201),i)n.regeneratorRuntime=o;else try{delete n.regeneratorRuntime}catch(t){n.regeneratorRuntime=void 0}},function(t,e){!function(e){"use strict";var r,n=Object.prototype,i=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag",l="object"==typeof t,c=e.regeneratorRuntime;if(c)l&&(t.exports=c);else{(c=e.regeneratorRuntime=l?t.exports:{}).wrap=b;var h="suspendedStart",f="suspendedYield",p="executing",d="completed",v={},y={};y[a]=function(){return this};var g=Object.getPrototypeOf,m=g&&g(g(L([])));m&&m!==n&&i.call(m,a)&&(y=m);var _=T.prototype=w.prototype=Object.create(y);E.prototype=_.constructor=T,T.constructor=E,T[u]=E.displayName="GeneratorFunction",c.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},c.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,T):(t.__proto__=T,u in t||(t[u]="GeneratorFunction")),t.prototype=Object.create(_),t},c.awrap=function(t){return{__await:t}},A(k.prototype),k.prototype[s]=function(){return this},c.AsyncIterator=k,c.async=function(t,e,r,n){var i=new k(b(t,e,r,n));return c.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},A(_),_[u]="Generator",_[a]=function(){return this},_.toString=function(){return"[object Generator]"},c.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},c.values=L,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,i){return s.type="throw",s.arg=t,e.next=n,i&&(e.method="next",e.arg=r),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),O(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;O(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:L(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),v}}}function b(t,e,r,n){var i=e&&e.prototype instanceof w?e:w,o=Object.create(i.prototype),a=new I(n||[]);return o._invoke=function(t,e,r){var n=h;return function(i,o){if(n===p)throw new Error("Generator is already running");if(n===d){if("throw"===i)throw o;return C()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=S(a,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var u=x(t,e,r);if("normal"===u.type){if(n=r.done?d:f,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=d,r.method="throw",r.arg=u.arg)}}}(t,r,a),o}function x(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}function w(){}function E(){}function T(){}function A(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function k(t){var e;this._invoke=function(r,n){function o(){return new Promise(function(e,o){!function e(r,n,o,a){var s=x(t[r],t,n);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==typeof l&&i.call(l,"__await")?Promise.resolve(l.__await).then(function(t){e("next",t,o,a)},function(t){e("throw",t,o,a)}):Promise.resolve(l).then(function(t){u.value=t,o(u)},a)}a(s.arg)}(r,n,e,o)})}return e=e?e.then(o,o):o()}}function S(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,S(t,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=x(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,v;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,v):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function L(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(i.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=r,e.done=!0,e};return o.next=o}}return{next:C}}function C(){return{value:r,done:!0}}}(function(){return this}()||Function("return this")())}])},t.exports=n()},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"border-40 border-b p-8"},[r("h4",{staticClass:"font-normal text-80 my-2"},[t._v(t._s(this.field.name))]),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!t.error,expression:"!error"}],ref:"map",staticClass:"rounded-sm",staticStyle:{height:"600px",width:"100%"}}),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:t.distance,expression:"distance"}],staticClass:"mt-4"},[r("b",[t._v("Distance : "+t._s(t.distance)+" Km")])]),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:t.estimated_time,expression:"estimated_time"}]},[r("b",[t._v("Estimated Time : "+t._s(t.toMMSS(t.estimated_time)))])]),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:t.route_instructions.length>0,expression:"route_instructions.length > 0"}]},[r("ul",{staticClass:"h-60 overflow-auto "},t._l(t.route_instructions,function(e,n){return r("li",[t._v("\n                "+t._s(n+1)+"- "+t._s(e)+"\n            ")])}),0)])])},staticRenderFns:[]}},function(t,e){}]);